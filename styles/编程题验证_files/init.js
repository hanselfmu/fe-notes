define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupBatchAddSubAccount",["nc","cpn","../../../../../core/siteConfig","../../../../../util/util","../../../../../action/user","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new q(a);return k.wrap(b,{title:"批量添加子账号",content:b.html(),width:600,hasNoFooter:!0}),b}function e(){var a=this,b=l.show({target:a.getEl(".js-upload-excel"),url:n.getUploadUrl(m.uploadType.file),fileType:"*.xlsx;",call:function(b){a.excelUrl=b.data,a.getEl(".js-upload-excel").html("Excel上传【已上传】")}});a.pushChild(b)}var f=a("nc"),g=a("cpn"),h=(f.$,f.Base),i=f.Clazz,j=f.Component,k=g.Popup,l=g.AttachUpload,m=a("../../../../../core/siteConfig"),n=a("../../../../../util/util"),o=a("../../../../../action/user"),p=a("../../../extend/bll/task"),q=c.exports=i.create();i.mix(q,j,{_template:['<div style="padding-bottom:20px;">','<span style="font-size:14px;">请先<a href="//static.nowcoder.com/files/%e7%89%9b%e5%ae%a2%e5%ad%90%e8%b4%a6%e6%88%b7%e6%89%b9%e9%87%8f%e6%b7%bb%e5%8a%a0%e6%a8%a1%e6%9d%bfv3.xlsx" target="_blank" class="link-green">下载上传模板</a>，根据填写说明将信息补充完整后上传</span>','<div style="text-align:center;margin:20px 0px;">','<a href="javascrpt:void(0);" class="btn btn-info js-upload-excel" style="width:160px;">上传Excel文件</a>',"</div>",'<div style="text-align:center;">','<a href="javascrpt:void(0);" class="btn btn-primary js-submit" style="width:160px;">上传完毕，创建账号</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initAttachUpload()}},{name:"click .js-submit",handler:function(){var a=this;if(!a.excelUrl)return k.alert("请先上传Excel文件");var b=a.rawConfig;o.batchAddSubUser({type:"POST",body:{excel:a.excelUrl},call:function(c){var d=k.mask("请稍等...");p.getTaskProgress(!0,c.data,function(c){var e=c.content;if(c.error){if(d.close(),3===c.type){var f=JSON.parse(e),g=h.id(f.code);if(e=(f.msg||"").replace(/\n+/g,"<br />"),"1308"===g)return new k({title:"提醒",content:['<div style="font-size:14px;padding:20px 0;text-align:center;line-height:2;">',"<div>"+e+"</div>","<div>"+(f.errorFileUrl?'<a class="link-green" href="'+f.errorFileUrl+'" target="_blank">点击下载错误名单</a>':"")+"</div>","</div>"].join(""),okTxt:"我知道了",close:function(){b.ok&&b.ok()}})}k.alert(e)}else c.end?(d.close(),a.popup.close(),k.tips("操作成功"),b.ok&&b.ok()):e&&"暂无进度"!==e&&d.getEl(".warning-word").html(e)})},error:function(a){k.alert(a.msg)}})}}],show:d},{initAttachUpload:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupChangeDepartment",["nc","cpn","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/user"],function(a,b,c){function d(a){a=a||{};var b=new q(a),c=m.wrap(b,{title:"修改机构",content:b.html(),width:720,cancelTxt:"取消",ok:function(){return b.submit(),!0}});return c.fixPosition(),b}function e(){function a(a){function b(a,d){j.forEach(a,function(a){c.push({text:a.department,value:j.id(a.id),parent:d}),b(a.subDepartments,j.id(a.id))})}var c=[];return b(a),c}var b=this,c=b.rawConfig,d=b.getEl();b.departmentSelect=new n({renderTo:d.find(".js-department-select"),renderBy:"replaceWith",options:a(c.departmentData)})}function f(a){var b=this,c=b.rawConfig,d=b.departmentSelect.val();if(0===d.length)return m.alert("管理的机构不能为空");var e=m.mask("修改中...");p.batchOperationSubUsers({type:"PUT",params:{userId:c.userId},body:j.extend(c.cond,{newDepartmentIds:d},a),call:function(a){o.getTaskProgress(!0,a.data,function(a){var d=a.content;if(a.error){e.close();var f=j.json(d,{});1006===f.code&&m.confirm(f.msg,j.bind(b.submit,b,{confirm:1})),1006!==f.code&&m.alert(d)}else a.end?(e.close(),b.popup.close(),m.tips("操作成功"),c.call&&c.call()):d&&"暂无进度"!==d&&e.getEl(".warning-word").html(d)})},error:function(a){e.close(),m.alert(a.msg)}})}function g(a){return{count:a.count}}var h=a("nc"),i=a("cpn"),j=(h.$,h.Base),k=h.Clazz,l=h.Component,m=i.Popup,n=i.SelectMult,o=a("../../../extend/bll/task"),p=a("../../../../../action/user"),q=c.exports=k.create();k.mix(q,l,{_template:['<div class="pop-written" style="overflow-y:inherit;">','<div class="pop-written-status">','<i class="icon-group"></i>共勾选子账号：<span class="font-green js-deliver-num">#{count}</span>',"</div>",'<div class="pop-plan-item">','<div class="pop-plan-label">管理的机构</div>','<div class="js-department-select"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}}],show:d},{initCpn:e,submit:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupChangeRole",["nc","cpn","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/user"],function(a,b,c){function d(a){a=a||{};var b=new q(a),c=m.wrap(b,{title:"转换角色",content:b.html(),width:720,cancelTxt:"取消",ok:function(){return b.submit(),!0}});return c.fixPosition(),b}function e(){var a=this,b=a.rawConfig,c=a.getEl();a.roleSelect=new n({renderTo:c.find(".js-role-select"),renderBy:"replaceWith",options:j.map(b.roleData,function(a){return{text:a.name,value:j.id(a.id)}})})}function f(a){var b=this,c=b.rawConfig,d=b.roleSelect.val();if(0===d.length)return m.alert("角色不能为空");var e=m.mask("修改中...");p.batchOperationSubUsers({type:"PUT",params:{userId:c.userId},body:j.extend(c.cond,{newRoles:d},a),call:function(a){o.getTaskProgress(!0,a.data,function(a){var d=a.content;if(a.error){e.close();var f=j.json(d,{});1006===f.code&&m.confirm(f.msg,j.bind(b.submit,b,{confirm:1})),1006!==f.code&&m.alert(d)}else a.end?(e.close(),b.popup.close(),m.tips("操作成功"),c.call&&c.call()):d&&"暂无进度"!==d&&e.getEl(".warning-word").html(d)})},error:function(a){e.close(),m.alert(a.msg)}})}function g(a){return{count:a.count}}var h=a("nc"),i=a("cpn"),j=(h.$,h.Base),k=h.Clazz,l=h.Component,m=i.Popup,n=i.SelectMult,o=a("../../../extend/bll/task"),p=a("../../../../../action/user"),q=c.exports=k.create();k.mix(q,l,{_template:['<div class="pop-written" style="overflow-y:inherit;">','<div class="pop-written-status">','<i class="icon-group"></i>共勾选子账号：<span class="font-green js-deliver-num">#{count}</span>',"</div>",'<div class="pop-plan-item">','<div class="pop-plan-label">新角色</div>','<div class="js-role-select"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}}],show:d},{initCpn:e,submit:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupEditDepartment",["nc","cpn","../../../../../action/user","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new t(a);return q.wrap(b,{title:(a.departmentId?"编辑":"新增")+(a.parentDepartmentId?"子":"")+"机构",content:b.html(),width:600,cancelTxt:"取消",ok:function(){return b.check()&&b.save(),!0}}),b}function e(){var a=this,b=a.rawConfig;a.nameIpt=new r({renderTo:a.getEl(".js-input-name"),renderBy:"replaceWith",placeholder:"输入机构名称，不能超过20个字符",value:b.name||"",listeners:{change:function(){if(b.parentDepartmentId?a.checkSubDepartmentName():a.checkDepartmentName())return a.repeatingName=!1,this.errorTips();var c=a.repeatingName="该"+(b.parentDepartmentId?"子":"")+"机构已存在";this.errorTips(c)}}}),a.introIpt=new r({renderTo:a.getEl(".js-input-intro"),renderBy:"replaceWith",placeholder:"输入机构简介，不能超过100个字符",value:b.intro||""})}function f(){var a=this;return m.trim(a.nameIpt.val()).length>20?(q.alert("机构名称不能超过20个字符"),!1):m.trim(a.introIpt.val()).length>100?(q.alert("机构简介不能超过100个字符"),!1):a.repeatingName?(q.alert(a.repeatingName),!1):!0}function g(a){var b=this,c=b.rawConfig;return a=a||b.rawConfig.departmentData,!n.find(a,function(a){return n.id(a)!==c.departmentId&&a.department===m.trim(b.nameIpt.val())})}function h(){var a=this,b=a.rawConfig,c=n.find(b.departmentData,function(a){return n.id(a)===b.parentDepartmentId})||{};return a.checkDepartmentName(c.subDepartments)}function i(){var a=this,b=a.rawConfig,c=m.trim(a.nameIpt.val()),d=m.trim(a.introIpt.val());return 0===arguments.length?b.departmentId?{departmentId:b.departmentId,departmentNewName:c,remark:d}:{parentDepartmentId:b.parentDepartmentId,departmentName:c,remark:d,role:1}:void 0}function j(){var a=this,b=a.rawConfig,c=m.trim(a.nameIpt.val()),d=m.trim(a.introIpt.val()),e=!!b.departmentId;s[e?"updateDepartmentName":"addDepartment"]({type:e?"PUT":"POST",params:{userId:b.userId},body:a.val(),call:function(){a.popup.close(),q.tips("操作成功"),b.ok&&b.ok(c,d)},error:function(a){q.alert(a.msg)}})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Base,o=k.Clazz,p=k.Component,q=l.Popup,r=l.Input,s=a("../../../../../action/user"),t=c.exports=o.create();o.mix(t,p,{_template:["<div>",'<div class="form-group" style="width:410px;margin-left:auto;margin-right:auto;">','<label class="control-label">机构名称</label>','<div class="js-input-name"></div>',"</div>",'<div class="form-group" style="width:410px;margin-left:auto;margin-right:auto;">','<label class="control-label">机构简介</label>','<div class="js-input-intro"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;b.departmentId=n.id(b.departmentId),b.parentDepartmentId=n.id(b.parentDepartmentId),a.initCpn()}}],show:d},{initCpn:e,check:f,checkDepartmentName:g,checkSubDepartmentName:h,val:i,save:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupEditRole",["nc","cpn","../../../../../action/user","../../../../../util/ajax","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new w(a),c=r.wrap(b,{title:a.id?"编辑角色":"新建角色",content:b.html(),width:720,cancelTxt:"取消",ok:function(){return b.check()&&b.submit(),!0}});return c.fixPosition(),b}function e(){function a(a){var b=arguments.callee;n.forReverse(a,function(c,d){c.id&&!v.has(c.id)&&a.splice(d,1),c.sub&&b(c.sub),c.sub&&0===c.sub.length&&a.splice(d,1)})}var b=this,c=b.authorityConf=[{name:"简历库",id:100,sub:[{name:"职位管理",sub:[{name:"设置招聘主页",id:101},{name:"管理招聘项目(新增/修改/删除)",id:102},{name:"管理招聘职位(新增/修改/删除)",id:103}]},{name:"应聘管理",sub:[{name:"管理阶段",noCheckbox:!0,sub:[{name:"内推-简历初选",id:110},{name:"内推-笔试",id:111},{name:"内推-面试",id:112},{name:"简历初选",id:113},{name:"笔试",id:114},{name:"面试",id:115},{name:"待发offer",id:116}]},{name:"管理操作",noCheckbox:!0,sub:[{name:"查看简历",id:120},{name:"下载简历",id:121},{name:"转移阶段和状态",id:122},{name:"标签",id:123},{name:"安排笔试(关联/查看试卷)",id:124},{name:"安排面试(关联项目/查看面试详情)",id:125}]}]},{name:"其他",sub:[{name:"简历统计",id:130},{name:"找简历",id:131},{name:"做题简历",id:132}]}]},{name:"笔试",id:200},{name:"面试",id:300},{name:"题库管理",id:400}];a(c)}function f(){var a=this;a.getEl(".js-main").html(q.execTpl(['<div v-for="(item1, index1) in items1" class="pop-create-role-mod">','<div :class="cls1(index1)"></div>','<div v-if="item1.sub" class="pop-create-bd">','<div v-for="(item2, index2) in item1.sub" class="pop-detail-item">','<div class="pop-detail-hd">','<div :class="cls2(index1, index2)"></div>',"<h3>#{item2.name}</h3>","</div>",'<div v-if="item2.sub" class="pop-detail-bd">','<div v-if="hasLabel(item2)">','<div v-for="(item3, index3) in item2.sub" class="form-group pop-create-detail">','<label v-if="hasLabel(item2)" class="control-label">#{item3.name}</label>','<div class="control-group" style="width:548px;">','<section :class="bottomBorder(index3, item2.sub.length)">','<span v-for="(item4, index4) in item3.sub" :class="cls4(index1, index2, index3, index4)"></span>',"</section>","</div>","</div>","</div>","<div v-else>",'<div class="form-group pop-create-detail">','<div class="control-group" style="width:658px;">',"<section>",'<span v-for="(item3, index3) in item2.sub" :class="cls3(index1, index2, index3)"></span>',"</section>","</div>","</div>","</div>","</div>","</div>","</div>","</div>"],{items1:a.authorityConf,cls1:function(a){return["pop-create-hd js",a].join("-")},cls2:function(a,b){return["pop-detail-oprt js",a,b].join("-")},cls3:function(a,b,c){return["js",a,b,c].join("-")},cls4:function(a,b,c,d){return["js",a,b,c,d].join("-")},bottomBorder:function(a,b){return b-1>a?"fill-space-box":""},hasLabel:function(a){return a&&a.sub&&a.sub[0]&&a.sub[0].sub}}))}function g(){function a(f,g){f=f||e.authorityConf,g=g||[],n.forEach(f,function(f,h){var i=g.slice();i.push(h),f.link=i;var j=i.length,k=e.getEl(".js-"+i.join("-"));f.noCheckbox||(f.checkbox=new t({renderTo:k,text:2===j?"全选":f.name,change:function(){var a=this.isChecked(),g=d(i.slice());if(f.id&&(e.value[f.id]=a),1===j)return k.closest(".pop-create-role-mod")[a?"addClass":"removeClass"]("open"),void b(g.sub,a);var h=d(f.link.slice(0,2));if(2===j)return b(h.sub,a);if(3===j||4===j){if(a)return h.checkbox.checked(c(h.sub));h.checkbox.isChecked()&&h.checkbox.checked(!1)}}})),f.sub&&a(f.sub,i)})}function b(a,c){n.forEach(a,function(a){a.checkbox&&(a.checkbox.checked(c),a.id&&(e.value[a.id]=c)),a.sub&&b(a.sub,c)})}function c(a,b){return(b=void 0===b?!0:b)?(n.forEach(a,function(a){return a.checkbox&&a.id?(b=b&&a.checkbox.isChecked(),b?"":n.BREAK):void(b=b&&c(a.sub,b))}),b):!1}function d(a,b){b=b||e.authorityConf;var c=b[a.shift()];return 0===a.length?c:d(a,c.sub)}var e=this;e.nameCpn=new s({renderTo:e.getEl(".js-role-name"),renderBy:"replaceWith"}),a()}function h(){var a=this,b=a.rawConfig,c=a.value={};if(b.id){a.nameCpn.val(b.name);var d=b.permission;n.forEach(d,function(a){c[a]=!0}),n.forEach(a.authorityConf,function(a){a.id&&c[a.id]&&(a.checkbox&&a.checkbox.checked(),a.checkbox.getEl().closest(".pop-create-role-mod").addClass("open")),n.forEach(a.sub,function(a){var b=!0;n.forEach(a.sub,function(a){if(!a.sub){var d=c[a.id];return b=b&&d,void(d&&a.checkbox.checked())}n.forEach(a.sub,function(a){var d=c[a.id];b=b&&d,d&&a.checkbox.checked()})}),b&&a.checkbox&&a.checkbox.checked()})})}}function i(){var a=this,b=m.trim(a.nameCpn.val());if(!b)return a.nameCpn.errorTips("请填写角色名称"),!1;if(b.length>20)return a.nameCpn.errorTips("角色名称不能超过20个字符"),!1;var c=a.rawConfig,d=!!n.find(c.roleData,function(a){return a.name===b});return d&&c.name!==b?(a.nameCpn.errorTips("该角色名称已存在"),!1):!0}function j(){function a(f){u.updateRole({type:"PUT",body:{name:e,permission:c.join(","),id:d,confirm:f?1:0},call:function(){b.popup.close(),r.tips("操作成功"),b.fire("refreshRole")},error:function(b){return f||1006!==b.code?void r.alert(b.msg):void r.confirm(b.msg,function(){a(!0)})}})}var b=this,c=[];n.forEach(b.value,function(a,b){a&&c.push(b)});var d=n.id(b.rawConfig.id),e=m.trim(b.nameCpn.val());return d?a():void u.newRole({type:"POST",body:{name:e,permission:c.join(",")},call:function(){b.popup.close(),r.tips("操作成功"),b.fire("refreshRole")},error:function(a){r.alert(a.msg)}})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Base,o=k.Clazz,p=k.Component,q=k.Node,r=l.Popup,s=l.Input,t=l.CheckBox,u=a("../../../../../action/user"),v=a("../../../../../util/switch"),w=c.exports=o.create();o.mix(w,p,{_template:['<div class="pop-create-role">','<div class="form-group">','<label class="control-label" style="width:60px;padding-left:0px;text-align:left;">角色名称</label>','<div class="js-role-name"></div>',"</div>",'<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initAuthorityConf(),a.initAuthorityHtml(),a.initCpns(),a.initValue()}}],show:d},{initAuthorityConf:e,initAuthorityHtml:f,initCpns:g,initValue:h,check:i,submit:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/cpn/popupEditSubAccount",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../action/user"],function(a,b,c){function d(a){a=a||{};var b=new z(a),c=u.wrap(b,{title:(a.subUserId?"编辑":"创建")+"子账号",content:b.html(),width:900,cancelTxt:"取消",ok:function(){return b.check()&&b.save(),!0}});return c.fixPosition(),b}function e(a){var b=this;b.filterConf=a;var c=b.filter=new w({renderTo:b.getEl(),noSumbit:!0,line:[{items:[a.name,a.email,a.password]},{items:[a.role,a.department]},{items:[a.date]}],listeners:{submit:o.bind(b.submit,b)}});c.getEl().css("background-color","#fff"),c.getEl(".filter-row:not(:last)").css("margin-bottom","15px"),c.getEl('input[type="password"]').css("padding","5px").css("border","none")}function f(){var a=this,b={id:"name",title:"账号名称",type:"input"},c={id:"email",title:"登录邮箱",type:"input"},d={id:"password",title:"登录密码",type:"input",conf:{type:"password",listeners:{focus:function(){!a.passwordEdited&&a.subUserId&&(a.filter.getItem("password").val(""),a.passwordEdited=!0)}}}},e=a.departmentFilterConf={id:"department",title:"管理的机构",type:"selectMult",conf:{options:a.getDepartmentOption(a.departmentData)}},f={id:"date",type:"diy",create:function(b,c,d){b.html(['<label class="filter-label">有效期</label>','<div class="js-date"></div>','<div class="js-check"></div>'].join(""));var e=new x({renderTo:b.find(".js-date"),renderBy:"replaceWith",change:function(){e.errorTips(!1)}});a.dateCheck=new v({renderTo:b.find(".js-check"),renderBy:"replaceWith",text:"长期有效",change:function(){e.disabled(this.isChecked())}}),e.getEl().css("margin-right","10px"),d.cpn=e}},g={id:"role",title:"角色类型",type:"selectMult",conf:{options:o.map(a.roleData,function(a){return{text:a.name,value:o.id(a.id)}})}};return{name:b,email:c,password:d,department:e,date:f,role:g}}function g(a){var b=this,c=b.filter,d=c.getItem("name"),e=c.getItem("email"),f=c.getItem("password"),g=c.getItem("department"),h=c.getItem("date"),i=c.getItem("role");if(0===arguments.length){var j=h.val(),k=h.isDisabled();return a={name:n.trim(d.val()),email:n.trim(e.val()),password:b.subUserId&&!b.passwordEdited?void 0:n.trim(f.val()),departmentId:g.val(),validBeginTime:k?null:j.startDate?[j.startDate,j.startTime||"00:00:00"].join(" "):void 0,validEndTime:k?null:j.endDate?[j.endDate,j.endTime||"23:59:59"].join(" "):void 0,roles:i.val().join(",")}}var k=null===a.validBeginTime&&null===a.validEndTime,l=a.validBeginTime?s.form(new Date(a.validBeginTime)).split(" "):["",""],m=a.validEndTime?s.form(new Date(a.validEndTime)).split(" "):["",""];a=a||{},d.val(a.name),e.val(a.email),f.val(a.password||(b.subUserId?"******":"")),g.val("select"===b.filterConf.department.type?(a.departmentId||[])[0]:a.departmentId),h.val({startDate:l[0],startTime:l[1],endDate:m[0],endTime:m[1]}),b.dateCheck.checked(k),h.disabled(k);var p=a.roles||a.roleList;p=o.isArray(p)?p:(p||"").split(","),i.val(o.map(p,function(a){return o.id(a)})),b.fixDepartment(a)}function h(){var a=this,b=!0,c=a.filter,d=a.val(),e=c.getItem("name"),f=c.getItem("email"),g=c.getItem("password"),h=c.getItem("department"),i=c.getItem("date"),j=c.getItem("role"),k=d.name.length,l=d.password,m=i.val();if((1>k||k>20)&&(b=!1,e.errorTips("长度在1- 20个字符之间")),d.email)if(r.isEmail(d.email)){var n=o.find(a.subUserData,function(b){return b.email===d.email&&o.id(b.id)!==a.subUserId});n&&(b=!1),n&&f.errorTips("邮箱已被占用")}else b=!1,f.errorTips("邮箱格式不正确");else b=!1,f.errorTips("请填写邮箱");return a.subUserId&&!a.passwordEdited||!(l.length<6||l.length>20)||(b=!1,g.errorTips("长度在6-20个字符之间")),0===d.roles.length&&(b=!1,j.error()),0===d.departmentId.length&&(b=!1,h.error()),i.isDisabled()||m.startDate&&m.endDate||(b=!1,i.errorTips("请填写完整的有效期")),b}function i(){var a=this,b=a.getEl();if(!t.mark(b)){var c=a.val(),d=a.rawConfig;y[a.subUserId?"updateSubUser":"addSubUser"]({type:a.subUserId?"PUT":"POST",params:{userId:a.module.getUserId()},body:a.subUserId?o.extend(c,{subUserId:a.subUserId}):c,call:function(b){a.popup.close(),u.tips("操作成功"),d.ok&&d.ok(b.data)},error:function(a){u.alert(a.msg)},always:function(){t.clear(b)}})}}function j(a){var b=this,c=o.isArray(a.roles)?a.roles:(a.roles+"").split(","),d=b.filterConf,e=o.contains(c,"1"),f=d.department.type;e&&"select"===f||!e&&"selectMult"===f||(d.department.type=e?"select":"selectMult",d.department.conf.options=b.getDepartmentOption(b.departmentData,e),b.filter.destroy(),b.initFilter(d),b.val(a))}function k(a){function b(a,d){o.forEach(a,function(a){c.push({text:a.department,value:o.id(a.id),parent:d}),b(a.subDepartments,o.id(a.id))})}var c=[];return b(a),c}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=l.Component,r=l.Str,s=l.Time,t=l.Limit,u=(l.Node,m.Popup),v=(m.CheckGroup,m.CheckBox),w=a("../../../../../component/filter/filter"),x=a("../../../../../component/dateSelect"),y=a("../../../../../action/user"),z=c.exports=p.create();p.mix(z,q,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.subUserId=o.id(b.subUserId),a.departmentData=b.departmentData||[],a.subUserData=b.subUserData||[],a.roleData=b.roleData||[],a.module=b.module,a.initFilter(a.getFilterConf()),b.data&&a.val(b.data)}}],show:d},{initFilter:e,getFilterConf:f,val:g,check:h,save:i,fixDepartment:j,getDepartmentOption:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/index/department",["nc","cpn","../../../../../action/user","../../../../../util/ajax","../cpn/popupEditDepartment"],function(a,b,c){function d(){var a=this,b=a.module,c=a.getOpenDepartmentId();b.getDepartment(function(b){a.departmentData=b,a.renderDepartment(),k.forEach(c,function(b){a.getEl('.js-department-item[data-id="'+b+'"]').addClass("open")}),a.fire("refreshDepartment",b)},function(c){b.renderNone(a.getEl(),c)})}function e(){var a=this;a.getEl().html(n.execTpl(['<div class="profile-info-box sub-account-mod">','<div class="profile-caption">','<h3 class="info-title prf-none">机构管理</h3>',"</div>",'<div v-for="(item, index) in items" class="info-box js-department-item" :data-id="item.id" :data-index="index">','<div class="tab-user-account js-department-div">','<span class="account-group">#{item.department}<i class="icon-pencil js-update-department"></i><i class="icon-trash js-delete-department"></i></span>','<span class="account-name">#{(item.subDepartments || []).length}个子机构</span>','<span class="account-switch on">收起<i class="icon-angle-up"></i></span>','<span class="account-switch off">展开详情<i class="icon-angle-down"></i></span>',"</div>",'<div class="info-box-main">','<ul class="user-sub-account user-account-list">','<li v-for="(subItem, subIndex) in item.subDepartments" class="js-sub-department-item" :data-id="subItem.id" :data-index="subIndex">','<span class="sub-department-name">#{subItem.department}</span>','<span class="sub-department-intro">#{subItem.remark}</span>','<div class="sub-acc-btn-box">','<a href="javascript:void(0);" class="link-green js-update-sub-department">修改</a>','<a href="javascript:void(0);" class="link-green js-delete-sub-department">删除</a>',"</div>","</li>","</ul>",'<div class="add-input-box js-account-add-u" style="display:none;"></div>','<a href="javascript:void(0);" class="set-add-btn js-add-sub-department"><i class="icon-plus-sign"></i>添加子机构</a>',"</div>","</div>",'<a href="javascript:void(0);" class="btn btn-primary new-btn-add js-add-department">+ 添加机构</a>',"</div>"],{items:a.departmentData}))}function f(){var a=this,b=[];return k.forEach(a.getEl(".js-department-item.open"),function(a){b.push(j(a).attr("data-id"))}),b}function g(a){var b=this,c=b.module.getUserId();p.deleteCheck({type:"GET",params:{userId:c},body:{departmentId:a.departmentId},call:function(d){o.confirm(d.data.manageDetail,function(){p.deleteDepartment({type:"DELETE",params:{userId:c},body:{departmentId:a.departmentId},call:function(){o.tips("操作成功",function(){b.refreshDepartment()})},error:function(a){o.alert(a.msg)}})})},error:function(a){o.alert(a.msg)}})}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Base,l=h.Clazz,m=h.Component,n=h.Node,o=i.Popup,p=a("../../../../../action/user"),q=a("../cpn/popupEditDepartment"),r=c.exports=l.create();l.mix(r,m,{_template:'<div class="profile-info-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.departmentData=b.data,a.renderDepartment()}},{name:"click div.js-department-div",handler:function(a){var b=j(a.currentTarget),c=b.closest(".js-department-item");c[c.hasClass("open")?"removeClass":"addClass"]("open")}},{name:"click .js-add-department",handler:function(){var a=this;q.show({userId:a.module.getUserId(),departmentData:a.departmentData,ok:function(){a.refreshDepartment()}})}},{name:"click.stop .js-update-department",handler:function(a){var b=this,c=j(a.currentTarget).closest(".js-department-item").attr("data-index"),d=b.departmentData[c];q.show({userId:b.module.getUserId(),departmentData:b.departmentData,departmentId:d.id,name:d.department,intro:d.remark,ok:function(){b.refreshDepartment()}})}},{name:"click.stop .js-delete-department",handler:function(a){{var b=this;j(a.currentTarget)}b.deleteDepartment({departmentId:j(a.currentTarget).closest(".js-department-item").attr("data-id")})}},{name:"click.stop .js-add-sub-department",handler:function(a){var b=this;q.show({userId:b.module.getUserId(),departmentData:b.departmentData,parentDepartmentId:j(a.currentTarget).closest(".js-department-item").attr("data-id"),ok:function(){b.refreshDepartment()}})}},{name:"click.stop .js-update-sub-department",handler:function(a){var b=this,c=j(a.currentTarget),d=b.departmentData[c.closest(".js-department-item").attr("data-index")],e=d.subDepartments[c.closest(".js-sub-department-item").attr("data-index")];q.show({userId:b.module.getUserId(),departmentData:b.departmentData,parentDepartmentId:c.id,departmentId:e.id,name:e.department,intro:e.remark,ok:function(){b.refreshDepartment()}})}},{name:"click.stop .js-delete-sub-department",handler:function(a){var b=this;b.deleteDepartment({departmentId:j(a.currentTarget).closest(".js-sub-department-item").attr("data-id")})}}]},{refreshDepartment:d,renderDepartment:e,getOpenDepartmentId:f,deleteDepartment:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/index/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/user","../../../../../util/ajax","../../util","../../../../../util/switch","./subAccount","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/table","../../../../../component/selectAll","../../../../../component/department","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../cpn/popupEditSubAccount","../../../../../component/dateSelect","../cpn/popupBatchAddSubAccount","../cpn/popupChangeRole","../cpn/popupChangeDepartment","./department","../cpn/popupEditDepartment","./role","../cpn/popupEditRole"],function(a,b,c){function d(a,b){var c=this,d=c.getEl();d.html(""),c.department=new o({renderTo:d,module:c,data:a,listeners:{refreshDepartment:function(a){c.subAccount&&c.subAccount.updateDepartmentData(a)}}}),c.roleCpn=new p({renderTo:d,module:c,roleData:b,listeners:{refreshRole:function(a){c.subAccount&&c.subAccount.updateRoleData(a)}}}),c.subAccount=new n({renderTo:d,module:c,data:a,roleData:b})}function e(a,b){var c=this;l.getSimpleFullDepartments({type:"GET",params:{userId:c.getUserId()},call:function(b){var c=b.data||[];h.isFunction(a)&&a(c)},error:function(a){var d=a.msg||"出现错误";return h.isFunction(b)?b(d):"popup"===b?j.alert(d):void c.renderNone(b||c.getEl(),d)}})}var f=a("nc"),g=a("cpn"),h=(f.$,f.Base),i=f.Clazz,j=g.Popup,k=a("../../../../../core/module"),l=a("../../../../../action/user"),m=(a("../../../../../core/siteConfig"),a("../../util")),n=a("./subAccount"),o=a("./department"),p=a("./role"),q=c.exports=i.create();i.mix(q,k,{style:"/stylesheets/styles/system/setting.css",title:"账号权限管理",_template:'<div class="com-setting"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b,"加载中..."),a.getDepartment(function(b){m.getRoles(function(c){a.initCpns(b,c)},a.getEl())})}}]},{initCpns:d,getDepartment:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/index/role",["nc","cpn","../../../../../action/user","../../../../../util/ajax","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../util","../../../../../util/switch","../cpn/popupEditRole"],function(a,b,c){function d(){var a=this;q.getRoles(function(b){a.roleData=b,a.fire("refreshRole",b),a.renderTable()},a.getEl(".js-main"))}function e(){function a(a){return m.execTpl('<a v-for="item in items" href="javascript:void(0);" :class="cls(item)" :title="title(item)" style="margin-right:5px;"></a>',{items:a,cls:function(a){return"js-tips js-"+a.key+" icon-"+a.icon+(a.official?" font-gray":" font-green")},title:function(a){return a.official?"预设角色，不支持操作":a.title}})}function b(a,b,c){var d=(a||"").split(","),e={};j.forEach(d,function(a){var b=g[a];if(b){var c=e[b.module]=e[b.module]||{};if(b.moduleId!==+a){var d=c[b.area]=c[b.area]||[];d.push(b.name)}}});var f=[];return j.forEach(e,function(a,b){var d=[];j.forEach(a,function(a,b){d.push(b+"："+a.join("、"))}),0===d.length&&d.push(1===c.id&&"笔试"===b?"只有判题权限":b+"所有操作权限"),1===c.id&&"笔试"===b&&(b="判题",d=[]),f.push("<span"+(j.size(d)>0?' class="js-tips" title="'+d.join("<br>")+'">':">")+b+"</span>")}),f.join("、")}function c(a){var b=d.roleIdMap=d.roleIdMap||{};b[a.id]=a}var d=this;d.getEl().html(['<div class="profile-caption">','<h3 class="info-title prf-none">角色管理</h3>',"</div>",'<div class="js-main" style="margin-bottom:20px;"></div>','<a href="javascript:void(0);" class="btn btn-primary new-btn-add js-add-role">+ 添加角色</a>'].join(""));var e=d.roleData;if(0===e.length)return d.module.renderNone(d.getEl(".js-main"),"暂无角色");var f={head:[{text:"角色名称",width:"10%"},{text:"操作权限",width:"25%"},{text:"操作",width:"10%"}],list:[]},g=q.getRoleAuthority();j.forEach(e,function(d){c(d);var e=[d.name,b(d.permission,d.permissionNameList,d),a([{key:"edit",icon:"edit",title:"编辑",official:d.official},{key:"trash",icon:"trash",title:"删除",official:d.official}])];f.list.push({items:e,attr:{"data-id":d.id}})}),d.getEl(".js-main").html(p.getHtml(f))}function f(a){return i(a.currentTarget).closest("tr").attr("data-id")}var g=a("nc"),h=a("cpn"),i=g.$,j=g.Base,k=g.Clazz,l=g.Component,m=g.Node,n=h.Popup,o=(h.Tips,a("../../../../../action/user")),p=a("../../../../../component/table"),q=(a("../../../../../core/siteConfig"),a("../../util")),r=a("../cpn/popupEditRole"),s=c.exports=k.create();k.mix(s,l,{_template:'<div class="profile-info-box sub-account-mod"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.roleData=b.roleData,a.renderTable()}},{name:"click .js-add-role",handler:function(){var a=this;r.show({module:a,roleData:a.roleData,listeners:{refreshRole:function(){a.refreshTable()}}})}},{name:"click .js-edit",handler:function(a){var b=this,c=b.roleIdMap[b.getLineId(a)];c.official||r.show({module:b,permission:(c.permission||"").split(","),name:c.name,id:c.id,roleData:b.roleData,listeners:{refreshRole:function(){b.refreshTable()}}})}},{name:"click .js-trash",handler:function(a){function b(a){o.deleteRole({type:"DELETE",body:{id:d.id,confirm:a?1:0},call:function(){n.tips("操作成功",function(){c.refreshTable()})},error:function(c){return a||1006!==c.code?void n.alert(c.msg):void n.confirm(c.msg,function(){b(!0)})}})}var c=this,d=c.roleIdMap[c.getLineId(a)];d.official||n.confirm("确定删除该角色？",function(){b()})}}]},{refreshTable:d,renderTable:e,getLineId:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/index/subAccount",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/department","../../../../../util/switch","../../../../../action/user","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../cpn/popupEditSubAccount","../../../../../component/dateSelect","../cpn/popupBatchAddSubAccount","../cpn/popupChangeRole","../cpn/popupChangeDepartment"],function(a,b,c){function d(a){var b=this;b.module=a.module,b.departmentData=a.data||[],b.roleData=a.roleData||[],b.dataMap={}}function e(){var a=this;a.initFilter(),a.tableCpn=new H({renderTo:a.getEl(".js-main"),needSelect:!0})}function f(){var a=this,b={id:"role",title:"角色",type:"select",conf:{options:a.getOption("role"),listeners:{change:z.bind(a.refreshSubUser,a)}}},c={id:"department",title:"管理的机构",type:"select",conf:{options:a.getOption("department"),listeners:{change:z.bind(a.refreshSubUser,a)}}},d={id:"status",title:"状态",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0},{text:"正常",value:"0"},{text:"停用",value:"2"}],listeners:{change:z.bind(a.refreshSubUser,a)}}};a.filter=new G({renderTo:a.getEl(".js-filter"),noSumbit:!0,line:[{items:[b,c,d]}],listeners:{submit:z.bind(a.submit,a)}}),a.filter.getEl().css({padding:0,background:"#fff",margin:0}),a.filter.getEl(".filter-label").css("width","auto")}function g(){var a=this,b=a.tableCpn.selectAll,c=b.getSelectCount();E.confirm("您勾选了"+c+"个账号，删除后将不可恢复，确定删除？",function(){var c=E.mask("删除中...");O.batchOperationSubUsers({type:"PUT",params:{userId:a.module.getUserId()},body:z.extend(a.val(),{subUserIds:b.selectIds,operation:"delete",isAll:b.isSelectAll?1:2}),call:function(b){J.getTaskProgress(!0,b.data,function(b){var d=b.content;b.error?(c.close(),E.alert(d)):b.end?(c.close(),E.tips("操作成功"),a.clearAllChk(),a.refreshSubUser(),a.updateValidSubUser(!0)):d&&"暂无进度"!==d&&c.getEl(".warning-word").html(d)})},error:function(a){c.close(),E.alert(a.msg)}})})}function h(){var a=this,b=a.tableCpn.selectAll;M.show({userId:a.module.getUserId(),count:b.getSelectCount(),roleData:a.roleData,cond:z.extend(a.val(),{subUserIds:b.selectIds,isAll:b.isSelectAll?1:2,operation:"updateRoles"}),call:function(){a.clearAllChk(),a.refreshSubUser(),a.updateValidSubUser(!0)}})}function i(){var a=this,b=a.tableCpn.selectAll;N.show({userId:a.module.getUserId(),count:b.getSelectCount(),departmentData:a.departmentData,cond:z.extend(a.val(),{subUserIds:b.selectIds,isAll:b.isSelectAll?1:2,operation:"updateDepartments"}),call:function(){a.clearAllChk(),a.refreshSubUser(),a.updateValidSubUser(!0)}})}function j(a){var b=this;a.departmentId=z.map(a.departments,function(a){return z.id(a.id)}),K.show({departmentData:b.departmentData,subUserData:b.subUserData,roleData:b.roleData,subUserId:a.id,module:b.module,data:a,ok:function(){b.refreshSubUser()}})}function k(a){var b=this;E.confirm("删除后，该账号不可找回，只能重新创建，确定删除"+a.name+"？",function(){O.batchOperationSubUsers({type:"PUT",params:{userId:b.module.getUserId()},body:{subUserIds:a.id,operation:"delete"},call:function(){E.tips("操作成功"),b.clearAllChk(),b.refreshSubUser(),b.updateValidSubUser()},error:function(a){E.alert(a.msg)}})})}function l(a,b){var c=this,d=b.getEl();if(!D.mark(d)){var e=2===a.status?0:2;O.updateSubUserStatus({type:"PUT",params:{userId:c.module.getUserId()},body:{subUserId:a.id,status:e},call:function(){c.refreshSubUser(),c.updateValidSubUser(0===e)},error:function(a){E.alert(a.msg),D.clear(d)}})}}function m(){var a=this,b=a.filter,c=b.getItem("role"),d=b.getItem("department"),e=b.getItem("status");return{role:"-1"===c.val()?void 0:c.val(),departmentId:"-1"===d.val()?void 0:d.val(),status:"-1"===e.val()?void 0:e.val()}}function n(a){var b=this;b.departmentData=a,b.fixOption("department"),b.clearAllChk(),b.refreshSubUser()}function o(a){var b=this;b.roleData=a,b.fixOption("role"),b.clearAllChk(),b.refreshSubUser()}function p(a){var b=this,c=b.module,d=b.getEl();O.getAllSubUsers({params:{userId:c.getUserId()},query:b.val(),call:function(c){b.subUserData=c.data||[],b.renderDepartment(),z.isFunction(a)&&a()},error:function(a){c.renderNone(d,a.msg)}})}function q(){var a=this,b=a.subUserData;if(a.getEl(".js-account-count").html(b.length),0===b.length)return a.tableCpn.renderNone("暂无子账号");var c={head:[{text:"账号名称",width:10},{text:"登录邮箱",width:20},{text:"密码",width:5},{text:"管理的机构"},{text:"角色"},{text:"状态",width:5},{text:"有效期",width:20},{text:"操作",width:12}],list:[]};z.forEach(b,function(b){a.dataMap[b.id]=b;var d=[b.name,b.email,"*****",z.map(b.departments,function(a){return a.department}).join("|"),(b.roleNameList||[]).join("|"),'<span class="js-status">'+(2===b.status?"停用":b.valid?"正常":"过期")+"</span>",b.validBeginTime||b.validEndTime?[C.form(new Date(b.validBeginTime)),C.form(new Date(b.validEndTime))].join("<br>~</br>"):"长期有效",['<a href="javascript:void(0);" class="icon-edit font-green js-action-item js-tips" data-method="actionEdit" title="编辑" style="margin-right:5px;"></a>','<a href="javascript:void(0);" class="icon-trash font-green js-action-item js-tips" data-method="actionDel" title="删除" style="margin-right:5px;"></a>','<span class="js-switch"></span>'].join("")];c.list.push({items:d,attr:{"data-id":b.id}})}),a.tableCpn.updateHtml(c,{totalPage:1,totalCount:b.length}),z.forEach(a.getEl(".js-switch"),function(b){var c=a.getLineItem(b),d=new F({renderTo:b,renderBy:"replaceWith",cls:"js-tips",checked:0===c.status,change:function(){a.actionBan(c,this)}});d.getEl().attr("title",0===c.status?"正常":"已停用"),d.getEl(".nk-switch").css("margin-right",0)})}function r(){var a=this;a.tableCpn&&a.tableCpn.selectAll.clear()}function s(a){var b=this,c=b.filter,d=c.getItem(a),e=d.val(),f=b.getOption(a);d.replaceOptions(f);var g=z.find(f,function(a){return a.value===e});d.val(g?g.value:"-1")}function t(a){var b=this;return"role"===a?[{text:"不限",value:"-1",checked:!0}].concat(z.map(b.roleData,function(a){return{text:a.name,value:z.id(a.id)}})):"department"===a?[{text:"不限",value:"-1",checked:!0}].concat(I.getOption(b.departmentData)):void 0}function u(a){return a?(window.user.hasValidSubUser=!0,void P.reset()):void O.hasValidSub({type:"GET",call:function(a){window.user.hasValidSubUser=a.data,P.reset()},error:function(){location.reload()}})}function v(a){var b=this,c=y(a).closest("tr"),d=y.trim(c.attr("data-id"));return b.dataMap[d]}var w=a("nc"),x=a("cpn"),y=w.$,z=w.Base,A=w.Clazz,B=w.Component,C=w.Time,D=w.Limit,E=x.Popup,F=(x.Tips,x.Switch),G=a("../../../../../component/filter/filter"),H=a("../../../../../component/table"),I=a("../../../../../component/department"),J=a("../../../extend/bll/task"),K=a("../cpn/popupEditSubAccount"),L=a("../cpn/popupBatchAddSubAccount"),M=a("../cpn/popupChangeRole"),N=a("../cpn/popupChangeDepartment"),O=a("../../../../../action/user"),P=a("../../../../../util/switch"),Q=c.exports=A.create();A.mix(Q,B,{_template:['<div class="profile-info-box sub-account-mod">','<div class="profile-caption">','<h3 class="info-title prf-none">子账号</h3>',"</div>",'<div class="js-filter"></div>','<div class="js-tool" style="font-size:14px;">','<span>共<span class="font-green js-account-count">0</span>条</span>','<span style="float:right;">','<a href="javascript:void(0);" class="link-green manage-sub-oprt" style="margin-right:10px;">批量修改','<ul style="top:16px;width:120px;">','<li data-index="4" data-sub-index="0" class="js-action-batch" data-method="actionBatchEditRole">批量修改角色</li>','<li data-index="4" data-sub-index="1" class="js-action-batch" data-method="actionBatchEditDepartment">批量修改机构</li>',"</ul>","</a>",'<a href="javascript:void(0);" class="link-green js-action-batch" data-method="actionBatchDel" style="margin-right:10px;">批量删除</a>','<a href="javascript:void(0);" class="link-green js-action-operation">系统操作记录</a>',"</span>","</div>",'<div class="js-table-home">','<div class="js-main" style="margin-bottom:20px;"></div>','<a href="javascript:void(0);" class="btn btn-primary new-btn-add js-add-account">+ 添加子账号</a>','<a href="javascript:void(0);" class="link-green js-batch-add-account" style="font-size:14px;">批量添加子账号</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.refreshSubUser()}},{name:"click .js-add-account",handler:function(){var a=this;K.show({departmentData:a.departmentData,subUserData:a.subUserData,roleData:a.roleData,module:a.module,ok:function(){a.clearAllChk(),a.refreshSubUser(),a.updateValidSubUser(!0)}})}},{name:"click .js-action-batch",handler:function(a){var b=this,c=y(a.currentTarget),d=y.trim(c.attr("data-method")),e=b.tableCpn.selectAll,f=e.getSelectCount();!f&&E.alert("请先选择要操作的账号"),f&&d&&b[d]&&b[d]()}},{name:"click .js-batch-add-account",handler:function(){var a=this;L.show({module:a.module,ok:function(){a.clearAllChk(),a.refreshSubUser(),a.updateValidSubUser(!0)}})}},{name:"click .js-action-item",handler:function(a){var b=this,c=y(a.currentTarget),d=b.getLineItem(c),e=y.trim(c.attr("data-method"));d&&e&&b[e]&&b[e](d)}},{name:"click .js-action-operation",handler:function(){var a=this;a.module.nav("account",{action:"authority/operation/index"})}}]},{initialize:d,initCpns:e,initFilter:f,actionBatchDel:g,actionBatchEditRole:h,actionBatchEditDepartment:i,actionEdit:j,actionDel:k,actionBan:l,val:m,updateDepartmentData:n,updateRoleData:o,refreshSubUser:p,renderDepartment:q,clearAllChk:r,fixOption:s,getOption:t,updateValidSubUser:u,getLineItem:v})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/authority/operation/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/table","../../../../../component/selectAll","../../../../../component/dateSelect","../../util","../../../../../action/user","../../../../../util/switch","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(){var a=this;a.getEl().html(['<div class="js-filter-box"></div>','<div class="import-tool clearfix">','<span class="import-census">','<span class="census-num">共有<span class="font-green js-record-count">0</span>条记录</span>每页显示</label><span class="js-pagesize"></span></span>',"</span>",'<ul class="manage-hd-oprt">','<li class="manage-sub-oprt">','<i class="resume-ico8"></i>','<span class="manage-oprt-green js-download-log">导出操作记录</span>',"</li>","</ul>","</div>",'<div class="js-table-box" style="margin-bottom:100px;"></div>'].join(""))}function e(a){{var b=this,c=b.getFilterConf(a);b.filter=new x({renderTo:b.getEl(".js-filter-box"),submitTxt:"查询",line:[{border:!0,items:[c.target,c.type]},{border:!0,items:[c.role,c.date]},{items:[c.keyword]}],clearAll:function(){b.val({})},listeners:{submit:function(){b.search(!0)}}})}b.fixType(),b.pageSizeCpn=new u({renderTo:b.getEl(".js-pagesize"),size:"xsmall",options:[{text:20,value:20,checked:!0},{text:50,value:50},{text:100,value:100}],change:function(){b.search(!0)}}),b.tableCpn=new y({renderTo:b.getEl(".js-table-box"),needSelect:!1,needFixHeader:!1,pageChange:function(a){b.goTop(),b.page=a,b.search()}})}function f(a){var b=this,c=b.tableCpn;c.renderWait(),a&&(b.page=1),B.getActionLog({type:"GET",params:{userId:b.getUserId()},query:q.extend({page:b.page||1,pageSize:b.pageSizeCpn.val()},b.val()),call:function(a){b.renderSearch(a.data||{})},error:function(a){b.getEl(".js-record-count").html(0),c.renderNone(a.msg)}})}function g(a){var b=this,c=b.tableCpn;if(b.getEl(".js-record-count").html(a.totalCount),0===a.datas.length)return c.renderNone("暂无系统操作记录");var d={head:[{text:"操作类型",width:15},{text:"操作详情"},{text:"操作账号",width:25},{text:"登陆IP",width:15},{text:"操作时间",width:15}],list:[]};q.forEach(a.datas,function(a,b){var c=[a.actionTypeStr,a.actionDetail,a.roleName+"-"+a.actorName+"("+a.actorEmail+")",a.actorIp,s.form(new Date(a.createTime))];d.list.push({items:c,attr:{"data-index":b}})}),c.updateHtml(d,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage})}function h(a){var b=this,c=b.filter,d=c.getItem("target"),e=c.getItem("type"),f=c.getItem("role"),g=c.getItem("date"),h=c.getItem("keyword");if(0===arguments.length){var i=g.val(),j=h.ipt.val();return{actionObjectTypes:b.ifSelectAll(d)?null:d.val(),actionTypes:b.ifSelectAll(e)?null:e.val(),actorRoles:b.ifSelectAll(f)?null:f.val(),beginTime:i.startDate?[i.startDate,i.startTime||"00:00:00"].join(" "):null,endTime:i.endDate?[i.endDate,i.endTime||"23:59:59"].join(" "):null,keyword:j?j:null}}a=a||{},d.val(a.actionObjectTypes||b.getAllValue("target")),b.fixType(),e.val(a.actionTypes||b.getAllValue("type")),f.val(a.actorRoles||b.getAllValue("role"));var k=(a.beginTime||"").split(" "),l=(a.endTime||"").split(" ");g.val({startDate:k[0],startTime:k[1],endDate:l[0],endTime:l[1]},!0),h.ipt.val(a.keyword)}function i(a){var b=this,c={};c.target={id:"target",title:"操作对象",type:"selectMult",conf:{options:[{text:"笔试系统",value:"1",checked:!0},{text:"面试系统",value:"2",checked:!0},{text:"简历系统",value:"3",checked:!0},{text:"题库",value:"4",checked:!0}],listeners:{change:function(){b.fixType()}}}},c.type={id:"type",title:"操作类型",type:"selectMult",conf:{options:[]}};var d=[];return q.forEach(a,function(a){1!==a.id&&d.push({text:a.name,value:q.id(a.id),checked:!0})}),c.role={id:"role",title:"账号角色",type:"selectMult",conf:{options:d}},c.date={id:"date",type:"diy",create:function(a,c,d){a.html(['<label class="filter-label">操作时间</label>','<div class="js-date"></div>','<div class="js-today"></div>','<div class="js-week"></div>'].join(""));var e=new z({renderTo:a.find(".js-date"),renderBy:"replaceWith",change:function(a){var c=b.getBeforeN(6),d=b.getBeforeN(),e=b.getBeforeN(-1);return b.todayCheck.checked(!1),b.weekCheck.checked(!1),"00:00:00"===a.startTime&&"00:00:00"===a.endTime&&a.startDate===d&&a.endDate===e?b.todayCheck.checked():"00:00:00"===a.startTime&&"00:00:00"===a.endTime&&a.startDate===c&&a.endDate===e?b.weekCheck.checked():void 0}});b.todayCheck=new t({renderTo:a.find(".js-today"),renderBy:"replaceWith",text:"今天",change:function(){if(this.isChecked()){var a=b.getBeforeN(),c=b.getBeforeN(-1);e.val({startDate:a,startTime:"00:00:00",endDate:c,endTime:"00:00:00"}),b.weekCheck.checked(!1)}}}),b.todayCheck.getEl().css("margin-right","10px"),b.weekCheck=new t({renderTo:a.find(".js-week"),renderBy:"replaceWith",text:"最近7天",change:function(){if(this.isChecked()){var a=b.getBeforeN(6),c=b.getBeforeN(-1);e.val({startDate:a,startTime:"00:00:00",endDate:c,endTime:"00:00:00"}),b.todayCheck.checked(!1)}}}),e.getEl().css("margin-right","10px"),d.cpn=e}},c.keyword={id:"keyword",title:"关键词",type:"search",conf:{placeholder:"输入操作关键字/账号名称/邮箱搜索"}},c}function j(){function a(a){return a=+a,{1:[{text:"笔试项目管理",value:"11",checked:!0},{text:"试卷管理",value:"12",checked:!0},{text:"考生管理",value:"13",checked:!0},{text:"测试账号管理",value:"14",checked:!0},{text:"下载试卷",value:"15",checked:!0},{text:"下载成绩",value:"16",checked:!0},{text:"作弊判定",value:"17",checked:!0}],2:[{text:"面试项目管理",value:"21",checked:!0},{text:"面试任务管理",value:"22",checked:!0},{text:"场次管理",value:"23",checked:!0},{text:"导出面试记录",value:"24",checked:!0}],3:[{text:"招聘主页",value:"1",checked:!0},{text:"招聘项目管理",value:"2",checked:!0},{text:"职位管理",value:"3",checked:!0},{text:"查看简历",value:"4",checked:!0},{text:"转移简历",value:"5",checked:!0},{text:"下载简历",value:"6",checked:!0}],4:[{text:"录入／编辑题目",value:"31",checked:!0},{text:"删除题目",value:"32",checked:!0}]}[a]}var b=this,c=b.filter,d=c.getItem("target"),e=c.getItem("type"),f=c.getItemConf("type"),g=d.val(),h=!b.ifSelectAll(d)&&0!==g.length;c.getItemEl("type")[h?"show":"hide"](),f.condHide=!h,c.updateCond();var i=[];q.forEach(g,function(b){i=i.concat(a(b))}),e.rawConfig.needSearch=i.length>5,e.replaceOptions(i)}function k(a){var b=a.val()||[],c=a.rawConfig.options;return b.length===c.length}function l(a){var b=this,c=b.filter.getItem(a);return q.map(c.rawConfig.options,function(a){return a.value})}function m(a){a=+a||0;var b=(new Date).getTime()-24*a*3600*1e3,c=s.form(new Date(b),"yyyy-MM-dd");return c}function n(){return{crumb:[{title:" 账号权限管理",module:"account",action:"authority/index/index"}]}}var o=a("nc"),p=a("cpn"),q=(o.$,o.Base),r=o.Clazz,s=(o.Component,o.Time),t=p.CheckBox,u=p.Select,v=(p.Pager,p.Popup),w=a("../../../../../core/module"),x=a("../../../../../component/filter/filter"),y=a("../../../../../component/table"),z=a("../../../../../component/dateSelect"),A=a("../../util"),B=a("../../../../../action/user"),C=a("../../../extend/bll/task"),D=c.exports=r.create();r.mix(D,w,{style:"/stylesheets/styles/system/setting.css",title:"系统操作记录",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;A.getRoles(function(b){a.initContainer(),a.initCpns(b),a.search(!0)},a.getEl())}},{name:"click .js-download-log",handler:function(){var a=this;B.downloadActionLog({params:{userId:a.getUserId()},query:q.extend({page:a.page,pageSize:a.pageSizeCpn.val()},a.val()),call:function(b){var c=2,d="";a.getWin().addTask({title:"账号操作记录_"+window.user.companyName+"_"+s.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return 2!==c?a&&a(c):void C.getTaskProgress(!1,b.data,function(b){var e=b.end,f=b.content,g=b.error,h=b.progress;g?(c=1,a&&a(c,h)):e?(c=0,d=f,a&&a(c,h)):a&&a(c,h)})},getResult:function(){return{type:3,data:d}}})},error:function(a){v.alert(a.msg)}})}}]},{initContainer:d,initCpns:e,search:f,renderSearch:g,val:h,getFilterConf:i,fixType:j,ifSelectAll:k,getAllValue:l,getBeforeN:m,getCrumbConf:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/cpn/popupDepartment",["nc","cpn","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new r(a),c=o.wrap(b,{title:"选择所属分组",content:b.html(),width:860,okTxt:"确定",cancelTxt:"重选",hasScroll:!0,ok:function(){var d=b.getEl().find("#js-department-input"),e=d.val();if(!e)return b.departmentIpt.setErrorTips("请选择分组"),o.alert("请选择分组"),!0;if(e.length>20)return b.departmentIpt.setErrorTips("名字长度不能超过20个字"),o.alert("名字长度不能超过20个字"),!0;var f=l.id(b.departmentId)||"0";if("0"===f)for(var g=0,h=b.departments.length;h>g;g++)b.departments[g].department===e&&(f=b.departments[g].id);return"0"===f?(q.addDepartment({params:{userId:a.uid},body:{departmentName:e},type:"POST",call:function(b){a.call&&a.call(b.data,e),c.close()},error:function(a){o.alert(a.msg)}}),!0):void(a.call&&a.call(f,e))},cancel:function(){return b.getEl().find("a.tag-label").removeClass("selected"),b.getEl().find("#js-department-input").val(""),b.departmentId=0,!0}});return c.popupContent.addClass("clearfix"),c.fixPosition(),b}function e(){var a=this;a.departments=[]}function f(){var a=this,b=a.rawConfig;q.getDepartments({params:{userId:b.uid},query:{},call:function(b){a.departments=b.data||[],a.getEl().html(a.getStr(b.data)),a.departmentIpt=p.transform(a.getEl().find("#js-department-input"))},error:function(b){a.popup.close(),o.alert(b.msg)}})}function g(a){var b="";return b+='<div class="tag-edit-input"><span>判题账号所属分组（部门、机构、地区、职位）：</span><input type="text" value="" id="js-department-input" placeholder="" maxlength="40"></div>',b+='<div class="pop-collect-tag"><span class="pop-collect-label">我的分组：</span><div class="tags-box">',l.forEach(a,function(a){b+='<a href="javascript:void(0);" class="tag-label" data-id="'+a.id+'">'+a.department+"</a>"}),b+="</div></div>"}function h(){var a=this;return{content:a.getDepartments()}}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Base,m=i.Component,n=i.Clazz,o=(i.Limit,j.Popup),p=j.Input,q=a("../../../../action/user"),r=c.exports=n.create();n.mix(r,m,{_template:'<div><div style="text-align:center;font-size:14px;">加载中...</div></div>',listeners:[{name:"render",type:"custom",handler:function(){}},{name:"click.prevent a.tag-label",handler:function(a){var b=this,c=k(a.currentTarget);b.getEl().find("#js-department-input").val(c.hasClass("selected")?"":c.html()),b.departmentId=c.hasClass("selected")?0:c.attr("data-id");var d=c.hasClass("selected");b.getEl().find("a.tag-label").removeClass("selected"),c[d?"removeClass":"addClass"]("selected"),b.popup.ok()}}],show:d},{initialize:e,getStr:g,getDepartments:f,_getData:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/cpn/popupDepartmentEdit",["nc","cpn","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new n(a),c=l.wrap(b,{title:"修改分组名称",content:b.html(),width:650,okTxt:"确定",cancelTxt:"取消",hasScroll:!0,ok:function(){var d=b.getEl().find("#js-department-input"),e=d.val();return e?e!==a.departmentName?e.length>20?(l.alert("名字长度不能超过20个字"),!0):(m.updateDepartmentName({params:{userId:a.uid},body:{departmentNewName:e,departmentId:a.departmentId},type:"PUT",call:function(){a.call&&a.call(e),c.close()},error:function(a){l.alert(a.msg)}}),!0):void 0:(l.alert("请选择分组"),!0)},cancel:function(){}});return c.popupContent.addClass("clearfix"),c.fixPosition(),b}function e(){}function f(){var a=this,b="";return b+='<div class="tag-edit-input"><span>判题账号所属分组：</span><input type="text" value="'+a.rawConfig.departmentName+'" id="js-department-input" placeholder="" maxlength="40"></div>'}function g(){var a=this;return{content:a.getStr()}}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=(h.Base,h.Limit,i.Popup),m=(i.Input,a("../../../../action/user")),n=c.exports=k.create();k.mix(n,j,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){}}],show:d},{initialize:e,getStr:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/cpn/feedBack",["nc","../../../../../action/helper","../../../../../util/ajax","cpn","../../../../../componentSan/radio","../../../../../componentSan/input"],function(a,b,c){function d(){}function e(a){var b=this;""===b.data.get("canSolve")&&(b.data.set("canSolve",a),a&&b.judge())}function f(){var a=this,b=a.data.get("canSolve");h.judge({type:"PUT",body:{entityId:a.data.get("contentId"),judge:b?1:2,reasonType:b?void 0:a.data.get("reasonType"),advice:b?void 0:a.data.get("advice")},call:function(){a.data.set("submited",!0),a.data.set("error","")},error:function(b){a.data.set("error",b.msg)}})}var g=a("nc"),h=(g.Base,a("../../../../../action/helper")),i=a("../../../../../componentSan/radio"),j=a("../../../../../componentSan/input"),k=window.san;c.exports=k.defineComponent({template:['<div class="help-feedback-wrapper">',"<h4>以上内容能否解决你的问题呢？</h4>",'<div class="help-feedback-btnbox">','<a href="javascript:void(0);" class="solve-btn{{canCls}}" on-click="clickSolve(true)"><i class="help-ico solve-icon"></i>能解决</a>','<a href="javascript:void(0);" class="solve-btn{{canNotCls}}" on-click="clickSolve(false)"><i class="help-ico unsolve-icon"></i>不能解决</a>',"</div>","<div class=\"help-feedback-box\" style=\"display:{{canSolve === false ? 'block' : 'none'}}\">",'<div class="feedback-radios"><cpn-radio options="{{radioOptions}}" value="{= reasonType =}"></cpn-radio></div>','<cpn-input type="textarea" value="{= advice =}"></cpn-input>','<a href="javascript:void(0);" class="btn btn-primary btn-sm" on-click="judge">提交</a>',"</div>",'<div s-if="error" class="help-feedback-tips" style="color:#FF411C">{{error}}</div>','<div s-else-if="submited" class="help-feedback-tips"><i class="help-ico feedback-tips-ico"></i>您的反馈已经提交成功 !</div>',"</div>"].join(""),initData:function(){return{contentId:"",canSolve:"",radioOptions:[{text:"字太多，不想看",value:"1"},{text:"太复杂，看不懂",value:"2"},{text:"其他",value:"3"}],reasonType:"1",submited:!1,error:"",advice:""}},computed:{canCls:function(){var a=this,b=a.data.get("canSolve");return b===!0?" selected":b===!1?" disabled":""},canNotCls:function(){var a=this,b=a.data.get("canSolve");return b===!1?" selected":b===!0?" disabled":""}},components:{"cpn-input":j,"cpn-radio":i},attached:d,clickSolve:e,judge:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/index",["nc","cpn","../../../../core/moduleSan","../../../../util/util","../../../../core/siteConfig","../../../../componentSan/none","../../../../componentSan/wait","../../../../componentSan/input","./page/nav","./page/overview","../../../../action/helper","../../../../util/ajax","../../../../util/permission","./page/content","./cpn/feedBack","../../../../componentSan/radio","./page/edit","../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../component/editorSub/hEditor/plugin/autoLink","../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../component/editorSub/hEditor/plugin/imageBar","../../../../component/editorSub/hEditor/plugin/toolbar","../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../util/uploadRemote","../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../component/popupSub/popupUploadImage","./util"],function(a,b,c){function d(){var a=this;a.initWatch(),a.updateNavData()}function e(){var a=this;k.forEach(["openType","selectEntity","displayType","search","contentId"],function(b){a.watch(b,function(){var c={},d=c[b]=a.data.get(b);a.addParam(c),"displayType"===b&&3!==d&&a.data.set("editId",0)})})}function f(){var a=this;u.getNav({query:{},call:function(b){var c=b.data||[];k.forEach(c,function(a){var b=a.formEntity=[];a.entity[1]||k.forEach(a.entity,function(a,c){b.push({text:a,id:+c})})}),a.data.set("nav",c),a.selectDefault()},error:function(b){a.data.set("navError",b.msg)}})}function g(){var a=this;if(!a.data.get("selectEntity").length){var b=a.data.get("nav"),c=b[0];return c.entity[1]?void a.data.set("selectEntity",[c.typeId]):void a.data.set("selectEntity",[c.typeId,2])}}function h(){var a=this,b=a.data.get("searchWord").trim();return b?(a.data.set("displayType",2),void a.data.set("search",b)):l.alert("请输入搜索内容")}var i=a("nc"),j=a("cpn"),k=(i.$,i.Base),l=j.Popup,m=a("../../../../core/moduleSan"),n=a("../../../../componentSan/none"),o=a("../../../../componentSan/wait"),p=a("../../../../componentSan/input"),q=a("./page/nav"),r=a("./page/overview"),s=a("./page/content"),t=a("./page/edit"),u=a("../../../../action/helper"),v=a("./util");c.exports=m.defineComponent({style:"/stylesheets/styles/help/help.css",title:"帮助中心",template:['<div class="help-container">','<div class="search-wrapper">','<div class="search-input-wrap">','<cpn-input placeholder="输入问题关键词，如：录题" value="{= searchWord =}" on-pressEnter="clickSearch"></cpn-input>','<span class="input-group-btn"><button class="btn btn-primary" on-click="clickSearch">搜索</button></span>',"</div>","</div>",'<cpn-none s-if="navError">{{navError}}</cpn-none>','<cpn-wait s-else-if="!nav">加载中...</cpn-wait>','<div s-else class="help-main clearfix">','<cpn-nav s-if="displayType !== 2" openType="{= openType =}" nav="{= nav =}" selectEntity="{= selectEntity =}" displayType="{= displayType =}" search="{= search =}"></cpn-nav>','<cpn-overview s-if="displayType === 0 || displayType === 2" ','selectEntity="{= selectEntity =}" contentId="{= contentId =}" ','displayType="{= displayType =}" search="{= search =}"',' editId="{= editId =}"></cpn-overview>','<cpn-content s-if="displayType === 1" contentId="{{contentId}}" displayType="{{displayType}}" selectEntity="{= selectEntity =}" search="{{search}}"></cpn-content>','<cpn-editor s-if="displayType === 3" editId="{{editId}}" selectEntity="{{selectEntity}}" displayType="{= displayType =}" contentId="{= contentId =}"></cpn-editor>',"</div>","</div>"].join(""),hideCrumb:!0,hideLeft:!0},{components:{"cpn-none":n,"cpn-wait":o,"cpn-input":p,"cpn-nav":q,"cpn-overview":r,"cpn-content":s,"cpn-editor":t},initData:function(){var a=this,b=a.getParam(),c=v.beType("Number",+b.displayType||0,0);return{displayType:3===c?0:c,searchWord:v.beType("String",b.search,""),openType:v.beType("Object",b.openType,{}),navError:"",nav:null,selectEntity:v.beType("Array",b.selectEntity,[]),contentId:v.beType("Number",b.contentId,0),search:v.beType("String",b.search,""),editId:0}},attached:d,initWatch:e,selectDefault:g,updateNavData:f,clickSearch:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/page/content",["nc","../../../../../action/helper","../../../../../util/ajax","cpn","../../../../../componentSan/none","../../../../../componentSan/wait","../cpn/feedBack","../../../../../componentSan/radio","../../../../../componentSan/input"],function(a,b,c){function d(){var a=this;a.initWatch(),a.updateContent()}function e(){var a=this;a.watch("contentId",function(){a.updateContent()})}function f(){var a=this;i.getContent({query:{id:a.data.get("contentId")},call:function(b){a.data.set("data",b.data||{}),a.updateSelectEntity()},error:function(b){a.data.set("error",b.msg)}})}function g(){var a=this;if(a.data.get("data")){var b=a.data.get("data"),c=[b.type];b.entityType&&c.push(b.entityType),a.data.set("selectEntity",c)}}var h=a("nc"),i=(h.Base,a("../../../../../action/helper")),j=a("../../../../../componentSan/none"),k=a("../../../../../componentSan/wait"),l=a("../cpn/feedBack"),m=window.san;c.exports=m.defineComponent({template:['<div class="help-content">','<cpn-none s-if="error">{{error}}</cpn-none>','<cpn-wait s-else-if="!data">加载中...</cpn-wait>',"<template s-else>",'<h1 class="help-title">{{data.title}}</h1>','<div class="module-box">','<div class="help-detail-cont">','<div s-html="data.content" style="margin-bottom:20px;"></div>','<cpn-feedback contentId="{{contentId}}"></cpn-feedback>',"</div>","</div>","</template>","</div>"].join(""),components:{"cpn-none":j,"cpn-wait":k,"cpn-feedback":l},initData:function(){return{error:"",contentId:"",data:null,selectEntity:"",search:""}},attached:d,initWatch:e,updateContent:f,updateSelectEntity:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/page/edit",["nc","cpn","../../../../../action/helper","../../../../../util/ajax","../../../../../componentSan/none","../../../../../componentSan/wait","../../../../../componentSan/input","../cpn/feedBack","../../../../../componentSan/radio","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(){var a=this;a.initWatch(),a.updateContent()}function e(){var a=this;a.watch("editId",function(){a.updateContent()})}function f(){var a=this;if(a.editor)return a.editor.destroy();var b=a.data.get("data")||{};a.editor=new p({renderTo:a.ref("editorBox"),isAdmin:!0,content:b.content,height:500})}function g(){var a=this,b=a.data.get("editId");return b?void l.getContent({query:{id:b},call:function(b){var c=b.data||{};a.data.set("data",c),a.data.set("title",c.title),window.setTimeout(function(){a.initEditBox()},0)},error:function(b){a.data.set("error",b.msg)}}):void a.initEditBox()}function h(){var a=this,b=a.data.get("editId");if(b)return l.editPost({type:"POST",body:{id:b,title:a.data.get("title"),content:a.editor.val()},call:function(){k.tips("操作成功"),a.data.set("contentId",b),a.data.set("displayType",1)},error:function(a){k.alert(a.msg)}});var c=a.data.get("selectEntity");l.addPost({type:"POST",body:{title:a.data.get("title"),content:a.editor.val(),type:c[0],entityType:c[1],isDoc:0},call:function(b){k.tips("操作成功"),a.data.set("contentId",b.data),a.data.set("displayType",1)},error:function(a){k.alert(a.msg)}})}var i=a("nc"),j=a("cpn"),k=(i.Base,j.Popup),l=a("../../../../../action/helper"),m=a("../../../../../componentSan/none"),n=a("../../../../../componentSan/wait"),o=a("../../../../../componentSan/input"),p=(a("../cpn/feedBack"),a("../../../../../component/editorSub/hEditor/index")),q=window.san;c.exports=q.defineComponent({template:['<div class="help-content">','<cpn-none s-if="error">{{error}}</cpn-none>','<cpn-wait s-else-if="editId && !data">加载中...</cpn-wait>',"<template s-else>",'<div class="editor-title">','<cpn-input value="{= title =}"></cpn-input>',"</div>",'<div class="editor-box" s-ref="editorBox"></div>','<a href="javascript:void(0);" class="btn btn-primary btn-auto" on-click="clickSubmit" style="margin-top:20px;">提交</a>',"</template>","</div>"].join(""),components:{"cpn-none":m,"cpn-wait":n,"cpn-input":o},initData:function(){return{error:"",editId:"",data:null,title:"",selectEntity:[],contentId:"",displayType:3}},attached:d,initWatch:e,initEditBox:f,updateContent:g,clickSubmit:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/page/nav",["nc"],function(a,b,c){function d(){var a=this;a.initWatch()}function e(){function a(){var a=b.data.get("selectEntity")[0],c=b.data.get("nav"),d=j.findIndex(c,function(b){return j.id(b.typeId)===j.id(a)}),e=c[d];e&&!e.entity[1]&&!b.data.get("openType")[a]&&b.data.set("openType."+a,!0)}var b=this;a(),b.watch("selectEntity",a)}function f(a,b){var c=this,d=b.typeId;if(a)return c.clickGo(d);var e=c.data.get("openType"),f="openType."+d;e[d]?c.data.set(f,void 0):c.data.set(f,!0)}function g(a,b){var c=this,d=[a];b&&d.push(b),c.data.set("selectEntity",d),c.data.set("displayType",0),c.data.set("search","")}function h(a,b){var c=this;c.data.set("addTypeId",a),c.data.set("addEntityId",b),c.data.set("displayType",3)}var i=a("nc"),j=i.Base,k=window.san;c.exports=k.defineComponent({template:['<div class="help-side-bar">',"<ul>",'<li s-for="item, index in nav" class="help-menu-item',"{{openType[item.typeId] ? ' open' : ''}}","{{item.entity[1] ? ' has-no-sub' : ''}}","{{selectTypeId === item.typeId ? ' selected' : ''}}\">",'<a href="javascript:void(0);" on-click="clickNav(item.entity[1], item)">','<i s-if="!item.entity[1]" class="help-ico menu-unfold"></i><i s-if="!item.entity[1]" class="help-ico menu-fold"></i> {{item.type}}',"</a>",'<ul class="help-sub-menu">',"<li s-for=\"subItem in item.formEntity\" class=\"{{selectTypeId === item.typeId && selectEntityId === subItem.id ? 'selected' : ''}}\">",'<a href="javascript:void(0);" on-click="clickGo(item.typeId, subItem.id)">{{subItem.text}}</a>',"</li>","</ul>","</li>","</ul>","</div>"].join(""),initData:function(){return{nav:null,openType:{},selectEntity:[],displayType:0,search:""}},computed:{selectTypeId:function(){var a=this;return a.data.get("selectEntity")[0]},selectEntityId:function(){var a=this;return a.data.get("selectEntity")[1]}},attached:d,initWatch:e,clickNav:f,clickGo:g,clickAdd:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/page/overview",["nc","cpn","../../../../../core/siteConfig","../../../../../action/helper","../../../../../util/ajax","../../../../../componentSan/none","../../../../../componentSan/wait","../../../../../util/permission","../../../../../util/util"],function(a,b,c){function d(){var a=this;a.trash=[],a.initWatch(),a.updateData()}function e(){var a=this;r.forEach(a.trash,function(a){a&&a.destroy&&a.destroy()})}function f(){var a=this;a.watch("selectEntity",r.bind(a.updateData,a)),a.watch("search",r.bind(a.updateData,a))}function g(){var a=this,b=a.ref("addDoc");if(b){var c=u.show({target:b,url:A.getUploadUrl(v.uploadType.file),fileType:"*",call:function(b){var c=b.data||"",d=/.+_(.+)\.+/.exec(c)[1]||"",e=a.data.get("selectEntity");w.addPost({type:"POST",body:{title:d,type:e[0],entityType:e[1],url:c,isDoc:1},call:function(){t.tips("操作成功"),a.updateData()},error:function(a){t.alert(a.msg)}})}});a.trash.push(c)}}function h(){var a=this;a.data.get("search")?a.search():a.updateOverview()}function i(){var a=this,b=a.data.get("selectEntity");return 0===b.length?(a.data.set("doc",[]),void a.data.set("post",[])):void w.getOverview({query:{type:b[0],entityType:b[1]},call:function(b){a.handleData(b.data||{})},error:function(b){a.data.set("error",b.msg)}})}function j(){var a=this;w.search({query:{query:a.data.get("search")},call:function(b){a.handleData(b.data||{})},error:function(b){a.data.set("error",b.msg)}})}function k(a){var b=this,c=a.doc=a.doc||[],d=a.post||[];b.data.set("doc",c),b.data.set("post",d),b.data.set("error",0===c.length&&0===d.length&&b.data.get("search")?"1":""),window.setTimeout(function(){b.initAttachUpload()})}function l(a){var b=this;b.data.set("contentId",a),b.data.set("displayType",{0:1,2:1}[b.data.get("displayType")])}function m(a){var b=this;b.data.set("editId",a),b.data.set("displayType",3)}function n(a,b){var c=this;s.Event(a).stopPropagation(),w.delPost({type:"POST",body:{id:b},call:function(){c.updateData()},error:function(a){t.alert(a.msg)}})}function o(){var a=this;a.data.set("search",""),a.data.set("displayType",0),a.updateData()}var p=a("nc"),q=a("cpn"),r=p.Base,s=p.$,t=q.Popup,u=q.AttachUpload,v=a("../../../../../core/siteConfig"),w=a("../../../../../action/helper"),x=a("../../../../../componentSan/none"),y=a("../../../../../componentSan/wait"),z=a("../../../../../util/permission"),A=a("../../../../../util/util"),B=window.san;c.exports=B.defineComponent({template:["<div class=\"help-content{{displayType === 2 ? ' help-content-full' : ''}}\">",'<cpn-none s-if="error && search" width="344px"><div style="text-align:left">','<div>很抱歉，没有找到与你搜索相关的内容<a href="javascript:void(0);" class="link-green" on-click="goCommon">< 返回</a></div>','<div style="margin:10px 0px 20px;color:#a6a6a6">温馨提示：</div>','<div style="color:#a6a6a6">建议您采用”产品+问题“的形式搜索，如：如何组织笔试</div>',"</div></cpn-none>",'<cpn-none s-else-if="error">{{error}}</cpn-none>','<cpn-wait s-else-if="!doc && !post">加载中...</cpn-wait>',"<template s-else>",'<div s-if="(canEdit && doc) || (!canEdit && doc.length)" class="module-box">','<div class="module-head clearfix"><h1>操作文档<a s-if="canEdit" s-ref="addDoc" href="javascript:void(0);" class="link-green" style="margin-left:20px;">新增</a></h1></div>','<div class="help-detail-cont">','<span class="help-detail-btn" s-for="item in doc">','<a class="btn btn-primary btn-auto" href="{{item.url}}" download="{{item.title}}" target="_blank">{{item.title}}</a>','<span s-if="canEdit" class="del-tag" on-click="clickDel($event, item.id)">x</span>',"</span>","</div>","</div>",'<div s-if="(canEdit && post) || (!canEdit && post.length)" class="module-box">','<div class="module-head clearfix"><h1>常见问题<a s-if="canEdit" href="javascript:void(0);" class="link-green" style="margin-left:20px;" on-click="clickEdit(0)">新增</a></h1></div>','<div class="help-detail-cont">','<p s-for="item in post">','<a href="javascript:void(0);" on-click="clickItem(item.id)">{{item.title}}</a>','<a s-if="canEdit" href="javascript:void(0);" class="link-green" on-click="clickEdit(item.id)" style="margin-left:20px;">编辑</a>','<a s-if="canEdit" href="javascript:void(0);" class="link-green" on-click="clickDel($event, item.id)" style="margin-left:20px;">删除</a>',"</p>","</div>","</div>","</template>","</div>"].join(""),components:{"cpn-none":x,"cpn-wait":y},initData:function(){return{selectEntity:[],error:"",doc:null,post:null,contentId:"",displayType:0,search:"",editId:""}},computed:{canEdit:function(){var a=this;return z.can("helpCenterEditor")&&!a.data.get("search")}},attached:d,disposed:e,initWatch:f,initAttachUpload:g,updateData:h,updateOverview:i,search:j,handleData:k,clickItem:l,clickEdit:m,clickDel:n,goCommon:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/helper/util",["nc"],function(a,b,c){function d(a,b,c){var d=["Array","Object","String","Number"],e=-1!==f.findIndex(d,function(b){return b===a});return e?f["is"+a](b)?b:c:void 0}var e=a("nc"),f=e.Base,g=e.Clazz,h=c.exports=g.create();f.extend(h,{beType:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/email",["nc","cpn","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.wrongEmail={}}function e(){var a=this,b=a.getEl();a.emailIpt=s.transform(b.find(".js-email"),{blur:function(){a.checkEmail()}}),a.codeIpt=s.transform(b.find(".js-code"))}function f(){function a(){k.addClass("btn-default").removeClass("btn-primary"),d=!0,f=window.setTimeout(function(){e--,k.html(e+"秒后重新获取"),e>0?a():b()},1e3)}function b(){f&&window.clearTimeout(f),e=60,d=!1,k.html("获取验证码"),k.addClass("btn-primary").removeClass("btn-default")}function c(){k.addClass("btn-default").removeClass("btn-primary"),d=!0,k.html("发送中...")}var d,e,f,g=this,h=g.getEl(),i=g.getWin(),j=g.getModule(),k=h.find(".js-send-code"),l=h.find(".js-submit-email");b(),h.find("dd.js-old-email").html(i.getUserByKey("email")),k.on("click",function(){g.checkVal(!0)&&(d||(d=!0,u.sendEmailCode({body:{email:n.trim(g.emailIpt.val())},call:function(){a(),t.tips("4位数字验证码已发送至您的公司邮箱<br/>请查看后输入")},error:function(a){t.alert(a.msg),b()}}),c()))}),l.on("click",function(){if(g.checkVal()&&!q.mark(l)){var a=g.val();u.updateEmail({type:"PUT",params:{userId:j.getUserId()},body:a,call:function(){t.tips("操作成功"),g.emailIpt.val(""),g.codeIpt.val(""),delete g.wrongEmail[a.email],delete g.wrongEmail[i.getUserByKey("email")],i.updateUser("email",a.email),h.find(".js-old-email").html(a.email)},always:function(){q.clear(l)}})}})}function g(){var a=this;return{email:n.trim(a.emailIpt.val()),code:n.trim(a.codeIpt.val())}}function h(a){var b=this,c=b.getWin(),d=b.val();return r.isEmail(d.email)?d.email===c.getUserByKey("email")?void b.emailIpt.setErrorTips("新邮箱不能与原来的一致"):b.wrongEmail[d.email]?void b.emailIpt.setErrorTips("该邮箱已被注册"):a||d.code?!0:void b.codeIpt.setErrorTips("请填写正确的验证码"):void b.emailIpt.setErrorTips("请填写正确的邮箱")}function i(){var a=this;if(a.checkVal(!0)){var b=n.trim(a.emailIpt.val());u.checkEmailAvailable({query:{email:b},call:function(c){"1"===c.data&&(a.emailIpt.setErrorTips("该邮箱已被注册"),a.wrongEmail[b]=!0)}})}}function j(){var a=this;return a.rawConfig.module}function k(){var a=this;return a.getModule().getWin()}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Component,p=l.Clazz,q=(l.Base,l.Limit),r=l.Str,s=m.Input,t=m.Popup,u=a("../../../../action/user"),v=c.exports=p.create();p.mix(v,o,{_template:['<div class="profile-info-box edit-box">','<div class="profile-caption"><h3 class="info-title prf-none">登录邮箱</h3></div>','<div class="info-box set-msg-box info-edit-box">','<dl><dt>原邮箱</dt><dd class="old-email js-old-email">&nbsp;</dd></dl>','<dl><dt>新邮箱</dt><dd class="control-group js-email"><input type="text" class="form-control new-email"></dd></dl>',"<dl>","<dt>验证码</dt>",'<dd class="btn-group phone-code" style="display:block">','<div class="control-group js-code"><input type="text" name="code" placeholder="请输入验证码"></div>','<span class="input-group-btn"><button class="btn btn-primary js-send-code" style="padding:0 5px;">获取验证码</button></span>',"</dd>","</dl>",'<dl><dt>&nbsp;</dt><dd><a href="javascript:void(0);" class="btn  btn-primary btn-lg btn-info-save js-submit-email">保存</a></dd></dl>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn(),a.initEmail()}}]},{initialize:d,initCpn:e,initEmail:f,val:g,checkVal:h,checkEmail:i,getModule:j,getWin:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/user","../../../../util/ajax","./name","./email","./pwd","./phone","./interview"],function(a,b,c){function d(a){var b=this;k.updateUser({type:"PUT",params:{userId:b.getUserId()},body:a.data,call:a.call,always:a.always})}var e=a("nc"),f=a("cpn"),g=(e.$,e.Clazz),h=e.Base,i=(e.Limit,e.Dom),j=(f.Input,f.Popup,a("../../../../core/module")),k=a("../../../../action/user"),l=(a("../../../../util/util"),a("./name")),m=a("./email"),n=a("./pwd"),o=(a("./phone"),a("./interview")),p=c.exports=g.create();g.mix(p,j,{style:"/stylesheets/styles/system/setting.css",title:"账户设置",_template:'<div class="com-setting"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam(),c={};h.forEach([{module:l,name:"name"},{module:m,name:"email"},{module:o,name:"interview"},{module:n,name:"pwd"}],function(b){var d=b.module,e=b.name;c[e]=new d({renderTo:a.getEl(),module:a})});var d=b.attachTo?c[b.attachTo]:null;d&&window.setTimeout(function(){i.scrollToEl({scrollEl:a.getSysWinEl(),el:d.getEl(),animation:!0})},250)}}]},{updateUser:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/interview",["nc","cpn","../../../../action/user","../../../../util/ajax","../../../../util/util","../../../../core/siteConfig"],function(a,b,c){function d(){var a=this,b=a.getModule();r.getSelfInterview({type:"GET",call:function(b){var c=a.data=b.data,d=c.hasSelfServiceInterviewPermission?"renderData":"renderNone";a[d]&&a[d](!c.emailPostfixs)},error:function(){b.renderWait(a.contentEl,'出现错误，<a href="javascript:void(0)" class="js-reload link-green">点击重试</a>')}})}function e(){var a=this,b=a.contentEl;b.html(['<div class="empty-wrap">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="empty-tip">您暂未购买此服务。面试官自主预约适用于社招，面试官可以为候选人创建视频面试链接。详询：</div>','<p class="empty-tip">座机：010-84873384</p>','<p class="empty-tip">邮箱：admin@nowcoder.com</p>',"</div>"].join(""))}function f(a){function b(){var b=o.execTpl(['<div class="info-tips">','<p v-if="data.emailPostfixs">您已开通此服务，请将下面的链接分享给你的面试官，面试官可以自主预约候选人，完成面试。</p>',"<p v-else>您已开通此服务，请先设置面试官邮箱后缀，然后将下面的链接分享给你的面试官，面试官可以自主预约候选人，完成面试。</p>","<p>如果HR需要查询预约详情以及面试记录，请到面试项目中的面试官自主预约项目查询。</p>","<p>详询 座机：010-84873384，邮箱：admin@nowcoder.com</p>","</div>",'<div class="info-box info-edit-box">',"<dl>","<dt>面试官自主预约地址</dt>","<dd>",'<a :href="url" target="_blank" class="link-green">#{url}</a>','<a href="javascript:void(0);" :data-clipboard-text="url"  class="js-copy link-green">复制链接</a>',"</dd>","</dl>",'<dl v-if="isEdit">',"<dt>面试官邮箱后缀</dt>",'<dd class="control-group js-postfix"></dd>',"</dl>",'<dl v-if="isEdit">',"<dt>&nbsp;</dt>",'<dd><a href="javascript:void(0);" class="btn  btn-primary btn-lg btn-info-save js-submit">保存</a></dd>',"</dl>",'<dl v-if="!isEdit">',"<dt>面试官邮箱后缀</dt>",'<dd>#{data.emailPostfixs || \'\'} <a href="javascript:void(0);" class="link-modify link-green js-modify">修改</a></dd>',"</dl>","</div>"],{data:f,isEdit:!!a,url:"https://www.nowcoder.com/selfinterview/"+f.companyDesId});g.html(b)}function c(){var a=(f||{}).emailPostfixs||"",b=new p({renderTo:g.find(".js-postfix"),placeholder:"@nowcoder.com 多个用空格分隔",value:a});g.find(".js-submit").on("click",function(){var c=n.uniq(k.trim(b.val()).split(/(?:\s|;|；|,|，)+/)),d=c.length>0&&n.every(c,function(a){return/^@[0-9A-Z]+(?:\.[0-9A-Z]+)+$/i.test(a)});if(!d)return b.setErrorTips("请填写正确的邮箱后缀");var g=c.join(" ");g===a?e.renderData():r.updateSelfInterview({type:"PUT",body:{postfix:c.join(" ")},call:function(){f.emailPostfixs=c.join(" "),e.renderData()},error:function(a){q.alert(a.msg)}})})}function d(){g.find(".js-modify").on("click",function(){e.renderData(!0)})}var e=this,f=e.data,g=e.contentEl;b(),(a?c:d)(),s.copy(g.find(".js-copy"),function(){q.tips("复制成功")})}function g(){var a=this;return a.rawConfig.module}function h(){var a=this;return a.getModule().getWin()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Limit,i.Node),p=j.Input,q=j.Popup,r=a("../../../../action/user"),s=a("../../../../util/util"),t=c.exports=m.create();m.mix(t,l,{_template:['<div class="profile-info-box edit-box interview-auto-mod">','<div class="profile-caption"><h3 class="info-title prf-none">配置面试自主预约功能</h3></div>','<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentEl=b.find(".js-content"),a.getModule().renderWait(a.contentEl),a.fetch()}},{name:"click .js-reload",handler:function(){var a=this;a.fetch()}}]},{fetch:d,renderNone:e,renderData:f,getModule:g,getWin:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/name",["nc","cpn","../../../../action/user","../../../../util/ajax","../../../../util/util","../../../../core/siteConfig"],function(a,b,c){function d(){function a(){c||(c=k(["<div>","<dl>","<dt>公司名称</dt>",'<dd class="control-group"><input type="text" class="form-control" placeholder="请输入公司全称"></dd>',"</dl>","<dl>","<dt>&nbsp;</dt>",'<dd><a href="javascript:void(0);" class="btn btn-primary btn-lg js-submit-name">保存</a></dd>',"</dl>","</div>"].join("")),i.append(c),d=q.transform(c.find("dd.control-group")));var a=k.trim(f.getUserByKey("companyName"));d.val(a),i.children().hide(),c.show()}function b(){var a=k.trim(f.getUserByKey("companyName"));j.find("dd span").html(n.encodeHTML(a)+"&nbsp;"),i.children().hide(),j.show()}var c,d,e=this,f=e.getWin(),g=e.getModule(),h=e.getEl(),i=h.find("div.js-name-info"),j=i.find("dl.js-show-name");b(),i.on("click","a.js-edit-name",function(){a()}),i.on("click","a.js-submit-name",function(a){var c=k(a.currentTarget),e=k.trim(d.val());return e?e===k.trim(f.getUserByKey("companyName"))?void b():void(o.mark(c)||g.updateUser({data:{companyName:e},call:function(){r.tips("操作成功"),f.updateUser("companyName",e),b()},always:function(){o.clear(c)}})):d.setErrorTips("请填写正确的公司名称")})}function e(){var a=this,b=a.getModule(),c=a.getWin(),d=a.getEl(),e=d.find("div.head-pic"),f=e.find("img");f.attr("src",c.getUserByKey("headUrl")||"//uploadfiles.nowcoder.com/images/20160723/56_1469258463201_F8D58201856E4DC632535F3424E9E822");var g=p.show({target:e,url:t.getUploadUrl(1),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",call:function(a){var d=a.data;f.attr("src",d),k(".nowcoder-header span.header-user-photo img").attr("src",d),b.updateUser({data:{headUrl:d}}),c.updateUser("headUrl",d)}});a.pushChild(g)}function f(){function a(a){e=a;var b=a.data;new r({title:"提示",content:'<div style="font-size:14px;">apiKey：'+b.apiKey+"<br />secretKey："+b.secretKey+"</div>",ok:function(){}})}var b=this,c=b.getEl(),d=(b.getModule(),b.getWin()),e=null;c.find(".js-user-id").html(d.getUserByKey("id")),c.find(".js-show-key").on("click",function(){return e?a(e):void s.getApiKey({type:"POST",call:a,error:function(a){r.alert(a.msg)}})})}function g(){var a=this;return a.rawConfig.module}function h(){var a=this;return a.getModule().getWin()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Str,o=(i.Base,i.Limit),p=j.AttachUpload,q=j.Input,r=j.Popup,s=a("../../../../action/user"),t=a("../../../../util/util"),u=c.exports=m.create();m.mix(u,l,{_template:['<div class="profile-info-box">','<div class="profile-caption"><h3 class="info-title">公司信息</h3></div>','<div class="info-box">','<div class="js-name-info">','<dl class="js-show-name">',"<dt>公司名称</dt>",'<dd><span></span><a href="javascript:void(0);" class="link-modify link-green js-edit-name">修改</a></dd>',"</dl>","</div>","<dl>","<dt>公司logo</dt>",'<dd><div class="head-pic" style="display:inline-block;position:relative;"><a href="javascript:void(0);"><img src="#{avatar}"></a></div>&nbsp;</dd>',"</dl>","<dl>","<dt>公司ID</dt>","<dd>",'<span class="js-user-id"></span>','<a href="javascript:void(0);" class="link-modify link-green js-show-key">查看API KEY</a>','<a href="javascript:void(0);" class="help-wrapper link-gray">','<i class="icon-question-sign"></i>','<div class="tooltip bottom tooltip-info" style="top:25px;width:200px;right:-160px;">','<div class="tooltip-arrow" style="left:35px;"><i></i></div>','<div class="tooltip-inner">如需对接牛客网笔面试系统，请提供您的API KEY</div>',"</div>","</a>","</dd>","</dl>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initName(),a.initAvatar(),a.initApiKey()}}]},{initName:d,initAvatar:e,initApiKey:f,getModule:g,getWin:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/phone",["nc","cpn","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(){var a=this,b=a.getEl();a.phoneIpt=q.transform(b.find(".js-phone"))}function e(){var a=this,b=a.getWin(),c=a.getEl();c.find("dd.js-old-phone").val(o.encodeHTML(b.getUserByKey("phone"))+"&nbsp;"),c.find(".js-submit-phone").on("click",function(d){var e=l(d.currentTarget);if(a.checkVal()&&!p.mark(e)){var f=a.val();s.updateUser({body:{phone:f},call:function(){r.tips("操作成功"),a.phoneIpt.val(""),b.updateUser("phone",f),c.find(".js-old-phone").html(f)},always:function(){p.clear(e)}})}})}function f(){var a=this;return l.trim(a.phoneIpt.val())}function g(){var a=this,b=a.getWin(),c=a.val(),d=c.phone;return o.isPhone(d)?d===b.getUserByKey("phone")?void a.phoneIpt.setErrorTips("新手机号码不能与原来的一致"):!0:void a.phoneIpt.setErrorTips("请填写正确的手机号码")}function h(){var a=this;return a.rawConfig.module}function i(){var a=this;return a.getModule().getWin()}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=j.Str,p=(j.Base,j.Limit),q=k.Input,r=k.Popup,s=a("../../../../action/user"),t=c.exports=n.create();n.mix(t,m,{_template:['<div class="profile-info-box edit-box">','<div class="profile-caption">','<h3 class="info-title prf-none">绑定手机</h3>',"</div>",'<div class="info-box set-msg-box info-edit-box">',"<dl>","<dt>原手机号码</dt>",'<dd class="old-email js-old-phone">&nbsp;</dd>','<span class="verify-tips"></span>',"</dl>","<dl>","<dt>新手机号码</dt>",'<dd class="control-group js-phone">','<input type="text" class="form-control new-email">',"</dd>","</dl>","<dl>","<dt>&nbsp;</dt>",'<dd><a href="javascript:void(0);" class="btn  btn-primary btn-lg btn-info-save js-submit-phone">保存</a></dd>',"</dl>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn(),a.initPhone()}}]},{initCpn:d,initPhone:e,val:f,checkVal:g,getModule:h,getWin:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/pwd",["nc","cpn","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(){var a=this,b=a.getEl();a.pwdIpt=p.transform(b.find(".js-pwd"),{focus:function(){a.newPwdIpt.none()}}),a.newPwdIpt=p.transform(b.find(".js-new-pwd"),{focus:function(){a.pwdIpt.none(),a.newRePwdIpt.none()}}),a.newRePwdIpt=p.transform(b.find(".js-new-re-pwd"),{focus:function(){a.newPwdIpt.none()}})}function e(){var a=this,b=a.getEl(),c=a.getModule();b.find(".js-submit-pwd").on("click",function(b){if(a.checkVal()){var d=l(b.currentTarget);if(!o.mark(d)){var e=a.val();delete e.reNewPwd,r.updatePwd({type:"PUT",params:{userId:c.getUserId()},body:e,call:function(){q.tips("操作成功"),a.pwdIpt.val(""),a.newPwdIpt.val(""),a.newRePwdIpt.val("")},error:function(b){return 1007===b.code?void a.pwdIpt.setErrorTips("原密码不正确"):void q.alert(b.msg)},always:function(){o.clear(d)}})}}})}function f(){var a=this;return{oldPwd:l.trim(a.pwdIpt.val()),newPwd:l.trim(a.newPwdIpt.val()),reNewPwd:l.trim(a.newRePwdIpt.val())}}function g(){var a=this,b=a.val();return b.oldPwd?!b.newPwd||b.newPwd.length<6||b.newPwd.length>30?void a.newPwdIpt.setErrorTips("请填写正确新密码，长度为 6 ~ 30"):b.oldPwd===b.newPwd?(a.pwdIpt.setErrorTips("原密码和新密码不能一致"),void a.newPwdIpt.setErrorTips("原密码和新密码不能一致")):b.newPwd!==b.reNewPwd?(a.newPwdIpt.setErrorTips("密码不一致"),void a.newRePwdIpt.setErrorTips("密码不一致")):!0:void a.pwdIpt.setErrorTips("请填写正确的原密码")}function h(){var a=this;return a.rawConfig.module}function i(){var a=this;return a.getModule().getWin()}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=(j.Base,j.Limit),p=k.Input,q=k.Popup,r=a("../../../../action/user"),s=c.exports=n.create();n.mix(s,m,{_template:['<div class="profile-info-box edit-box">','<div class="profile-caption"><h3 class="info-title prf-none">登录密码</h3></div>','<div class="info-box set-msg-box info-edit-box">','<dl><dt>原密码</dt><dd class="control-group js-pwd"><input type="password" class="form-control old-pw"></dd></dl>','<dl><dt>新密码</dt><dd class="control-group js-new-pwd"><input type="password" class="form-control new-pw"></dd></dl>','<dl><dt>重输新密码</dt><dd class="control-group js-new-re-pwd"><input type="password" class="form-control new-repw"></dd></dl>','<dl><dt>&nbsp;</dt><dd><a href="javascript:void(0);" class="btn  btn-primary btn-lg btn-info-save js-submit-pwd">保存</a></dd></dl>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn(),a.initPwd()}}]},{initCpn:d,initPwd:e,val:f,checkVal:g,getModule:h,getWin:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/index/subAccount",["nc","cpn","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../util/ajax","../cpn/popupDepartment","../../../../action/user","../cpn/popupDepartmentEdit","../../../../util/util","../../../../core/siteConfig"],function(a,b,c){function d(){var a=this;H.getSimpleFullDepartments({params:{userId:a.getUserId()},query:{},call:function(b){a.currentData=b.data,a.refreshList()}})}function e(){var a=this;a.addMap={};var b=z.map(a.currentData,function(b){return y.execTpl('<div class="info-box js-department-item" data-id=#{id}>#{itemHtml}</div>',{id:b.id,name:b.department,itemHtml:a.getDepartmentHtml(b)})}).join("");a.getEl(".js-department-list").html(b)}function f(a,b,c){var d=this,e=d.getEl(".js-department-item[data-id="+a.id+"]");e.html(d.getDepartmentHtml(a)),b&&(e.addClass("open"),B.scrollToEl({scrollEl:d.getModule().getSysWinEl(),el:e,animation:!0})),d.addMap[a.id]=!1,c&&d.addDepartmentUser(a.id)}function g(a){return{name:v.trim(a.find("input.js-name").val()),email:v.trim(a.find("input.js-email").val()),password:v.trim(a.find("input.js-pwd").val()),departmentId:v.trim(a.find("input.js-department").val())}}function h(a,b){var c=this,d=c.val(a),e=d.name?y.isEmail(d.email)?"":"请填写正确的邮箱":"名称不能为空";if(!b){var f=d.password;e=f?f.length<6?"密码长度必须大于6位":f.length>30?"密码长度必须小于30位":"":"密码不能为空"}return e&&C.alert(e),!e}function i(){var a=this;return a.rawConfig.module}function j(){var a=this;return a.getModule().getWin()}function k(){var a=this;return a.getModule().getUserId()}function l(a){var b=this;a=z.id(a);var c=z.find(b.currentData,function(b){return z.id(b.id)===a});return c||{}}function m(a,b){b=z.id(b);var c=z.find(a.userList,function(a){return z.id(a.id)===b});return c||{}}function n(a){var b=v(a).closest(".js-department-item");return v.trim(b.attr("data-id"))}function o(a){var b=this,c=b.getEl(),d=c.find(".js-department-item[data-id="+a+"]"),e=d.find("div.js-account-add-u");b.addMap[a]||(b.addMap[a]=!0,e.html(b.getSubUserHtml(a)).show(),e.find(".js-sub-ok").on("click",function(c){v(c.currentTarget);if(b.checkVal(e)&&!A.mark(e)){var d=b.val(e);H.addSubUser({params:{userId:b.getUserId()},body:d,call:function(c){var d=b.getDepartmentById(a);d.userList.push(c.data),d.subUserCount=d.userList.length,b.refreshDepartment(d),b.addMap[a]=!1,b.getWin().updateUser("hasSubUser",!0)},error:function(a){C.alert(a.msg)},always:function(){A.clear(e)}})}}),e.find(".js-sub-cancel").on("click",function(){e.html("").hide(""),b.addMap[a]=!1})),e.find("input.js-name").focus()}function p(a,b){var c=this,d=c.getDepartmentById(a),e=c.getUserById(d,b),f=c.getEl("li.js-user[data-id="+b+"]");f.html(c.getSubUserHtml(a,e)),f.find(".js-sub-ok").on("click",function(){if(c.checkVal(f,!0)){var a=c.val(f);a.subUserId=b,H.updateSubUser({params:{userId:c.getUserId()},body:a,type:"PUT",call:function(){e.name=a.name,e.email=a.email,c.refreshDepartment(d)},error:function(a){C.alert(a.msg)}})}}),f.find(".js-sub-cancel").on("click",function(){c.refreshDepartment(d)})}function q(a){var b="";return z.forEach(a.userList,function(a,c){b+=y.execTpl(['<li class="js-user" data-id="#{id}">','<span class="sub-acc-order">账号#{pos}</span>','<span class="sub-acc-name">#{subName}</span>','<span class="user-mail">#{subEmail}</span>','<span class="user-pwd">#{pwd}</span>','<div class="sub-acc-btn-box">','<a href="javascript:void(0);" class="link-green js-sub-alter">修改</a>','<a href="javascript:void(0);" class="link-green js-sub-delete">删除</a>',"</div>","</li>"].join(""),{id:a.id,pos:c+1,subName:a.name,subEmail:a.email||"---",pwd:"******"})}),y.execTpl(['<div class="tab-user-account js-department-div">','<span class="account-group">#{departmentName}<i class="icon-pencil js-update-department"></i><i class="icon-trash js-delete-department"></i></span>','<span class="account-name">#{subUserCount}</span>','<span class="account-switch on">收起<i class="icon-angle-up"></i></span>','<span class="account-switch off">展开详情<i class="icon-angle-down"></i></span>',"</div>",'<div class="info-box-main">','<ul class="user-sub-account user-account-list">#{userContentHtml}</ul>','<div class="add-input-box js-account-add-u" style="display:none;"></div>','<a href="javascript:void(0);" class="set-add-btn js-add-department-user"><i class="icon-plus-sign"></i>添加本组新账号</a>',"</div>"].join(""),{id:a.id,departmentName:a.department,subUserCount:a.subUserCount?a.subUserCount+"个账号":"无账号",userContentHtml:b})}function r(a,b){var c=!!b;return b=b||{},y.execTpl(['<span class="sub-acc-order">#{title}</span>','<input class="add-input add-name js-name" value="#{name}" type="text" placeholder="名称">','<input class="add-input add-mail js-email" value="#{email}" type="text" placeholder="登录邮箱">','<input class="add-input add-psw js-pwd" value="#{password}" type="password" placeholder="6位以上登录密码">','<input class="add-input js-department" type="hidden" value="#{id}">','<div class="sub-acc-btn-box">','<a class="link-green js-sub-ok" href="javascript:void(0);">确定</a>','<a class="link-green js-sub-cancel" href="javascript:void(0);">取消</a>',"</div>"].join(""),{id:a,title:c?"账号":"新账号",name:b.name,email:b.email,password:b.password})}function s(){function a(){var a=b.getModule().getWin(),d=a.showLoading("导入中...");H.batchAddSubUser({body:{excel:c},call:function(a){E.getTaskProgress(!0,a.data,function(a){{var c=a.end,e=a.content,f=a.error,g=a.type;a.progress}if(f){if(d.close(),3===g){var h=JSON.parse(e),i=z.id(h.code);if(e=(h.msg||"").replace(/\n+/g,"<br />"),"1308"===i)return new C({title:"提醒",content:['<div style="font-size:14px;padding:20px 0;text-align:center;line-height:2;">',"<div>"+e+"</div>","<div>"+(h.errorFileUrl?'<a class="link-green" href="'+h.errorFileUrl+'" target="_blank">点击下载错误名单</a>':"")+"</div>","</div>"].join(""),okTxt:"我知道了"})}C.alert(e)}else c?(d.close(),b.initList(),C.tips("操作成功")):e&&"暂无进度"!==e&&d.getEl(".warning-word").html(e)})},error:function(a){d.close(),C.alert(a.msg)}})}var b=this,c="";new C({title:"添加判题账号",content:['<div style="text-align:center;">','<div style="font-size:14px;padding:20px 0;">请先<a href="'+H.downloadBatchAddSubUserTemplateUrl()+'" class="link-green" target="_blank">点击下载判题账号上传模板</a>，按模板填写判题账号信息后上传。</div>','<div style="padding:20px 0;"><a href="javascript:void(0);" class="btn btn-primary js-upload" style="width:160px;">上传判题账号Excel文件</a></div>',"</div>"].join(""),hasNoFooter:!0,render:function(){var b=this,d=b.getEl(".js-upload"),e=D.show({target:d,url:I.getUploadUrl(J.uploadType.file),fileType:"*.xlsx;",call:function(b){c=b.data,a()}});b.pushChild(e)}})}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Component,x=t.Clazz,y=t.Str,z=t.Base,A=t.Limit,B=(t.Uri,t.Dom),C=u.Popup,D=u.AttachUpload,E=a("../../extend/bll/task"),F=a("../cpn/popupDepartment"),G=a("../cpn/popupDepartmentEdit"),H=a("../../../../action/user"),I=a("../../../../util/util"),J=a("../../../../core/siteConfig"),K=c.exports=x.create();x.mix(K,w,{_template:['<div class="profile-info-box sub-account-mod">','<div class="profile-caption js-sub-head">','<h3 class="info-title">判题账号</h3>',"</div>",'<div class="js-department-list"></div>','<a href="javascript:void(0);" class="btn btn-primary new-btn-add js-add-account">+ 添加新账号</a>','<a href="javascript:void(0);" class="link-green link-btn js-batch-add">+ 批量添加</a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initList()}},{name:"click div.js-department-div",handler:function(a){var b=v(a.currentTarget),c=b.closest(".js-department-item");c[c.hasClass("open")?"removeClass":"addClass"]("open")}},{name:"click a.js-add-account",handler:function(){var a=this;F.show({uid:a.getUserId(),call:function(b,c){var b=z.id(b),d=a.getDepartmentById(b);0===z.size(d)&&(d={id:b,department:c,subUserCount:0,userList:[]},a.currentData.push(d)),a.refreshList(),a.refreshDepartment(d,!0,!0)}})}},{name:"click .js-batch-add",handler:function(){var a=this;a.batchAccount()}},{name:"click a.js-add-department-user",handler:function(a){var b=this,c=a.currentTarget,d=b.getDepartmentLineId(c);b.addDepartmentUser(d)}},{name:"click a.js-sub-alter",handler:function(a){var b=this,c=v(a.currentTarget),d=c.closest("li.js-user"),e=v.trim(d.attr("data-id")),f=b.getDepartmentLineId(c);e&&f&&b.editDepartmentUser(f,e)}},{name:"click a.js-sub-delete",handler:function(a){var b=this,c=v(a.currentTarget),d=c.closest("li.js-user"),e=v.trim(d.attr("data-id")),f=b.getDepartmentLineId(c);f&&e&&C.confirm("如本账号已阅卷，已处理的试卷将无法重新分配，确定删除吗？",function(){H.batchOperationSubUsers({type:"PUT",params:{userId:b.getUserId()},body:{subUserId:e,operation:"delete"},call:function(){var a=b.getDepartmentById(f);z.forReverse(a.userList,function(b,c){z.id(b.id)===e&&a.userList.splice(c,1)}),a.subUserCount=a.userList.length,b.refreshDepartment(a)}})})}},{name:"click.stop i.js-delete-department",handler:function(a){var b=this,c=v(a.currentTarget),d=b.getDepartmentLineId(c);d&&C.confirm("删除时该分组内所有的判题账号均会删除，确定删除吗？",function(){H.deleteDepartment({params:{userId:b.getUserId()},body:{departmentId:d},type:"DELETE",call:function(){z.forReverse(b.currentData,function(a,c){z.id(a.id)===d&&b.currentData.splice(c,1)}),b.refreshList()}})})}},{name:"click.stop i.js-update-department",handler:function(a){var b=this,c=v(a.currentTarget),d=b.getDepartmentLineId(c),e=b.getDepartmentById(d);G.show({uid:b.getUserId(),departmentId:d,departmentName:e.department,call:function(a){e.department=a,b.refreshDepartment(e)}})}}]},{initList:d,refreshList:e,refreshDepartment:f,val:g,checkVal:h,getModule:i,getWin:j,getUserId:k,getDepartmentById:l,getUserById:m,getDepartmentLineId:n,addDepartmentUser:o,editDepartmentUser:p,getDepartmentHtml:q,getSubUserHtml:r,batchAccount:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/judgingSetting",["nc","cpn","..//../../core/module","../../../util/util","../../../core/siteConfig","../../../component/popupSub/popupCommon","../../../action/user","../../../util/ajax"],function(a,b,c){function d(){{var a=this;a.getParam()}s.getUserJudgingSetting({params:{userId:a.getUserId()},query:{},call:function(b){var c=b.data;a.renderData(c)},error:function(b){a.renderNone(a.oEl,b.msg)}})}function e(a){var b=this;b.aOptions=[{id:"name",name:"分配的题目",checked:!0,type:1}],l.forEach(a.judgingPermission,function(a){b.aOptions.push({id:a.id,name:a.name,checked:a.select,type:0})});var c="";l.forEach(b.aOptions,function(a){c+=m.execTpl(['<label class="checkbox js-checkbox-#{id}" data-id="#{id}" style="position: relative">','<span class="icons"></span>','<span class="menu-label">#{name}</span>','<div class="tooltip bottom tooltip-info js-tip-#{id}" style="min-width:20px; display: none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">系统设定不可取消</div>',"</div>","</label>"].join(""),{name:a.type?a.name+' <span class="font-gray">(必选)</span>':a.name,id:a.id})});var d=m.execTpl(['<div class="module-box">','<div class="module-head clearfix">',"<h2>默认判题分配方式</h2>","</div>",'<div class="module-body">','<div class="setting-pannel">','<div class="setting-pannel-wrapper">','<div class="check-radio-box js-judging-alloc-type">','<label class="radio checked"><span class="icons"></span><input type="radio" value="0"> 整卷分配：每张试卷由同一个考官打分，分配操作简单，适合绝大部分情况。</label>','<label class="radio"><span class="icons"></span><input type="radio" value="1"> 按题目分配：每张试卷由多个考官打分，适合考官只判确定的某道题。</label>',"</div>","</div>","</div>","</div>","</div>",'<div class="module-box">','<div class="module-head clearfix">',"<h2>阅卷官查看权限</h2>","</div>",'<div class="module-body">','<div class="setting-pannel">','<div class="setting-pannel-wrapper">',c,"</div>","</div>",'<div class="btn-set-wrapper">','<a href="javascript:void(0);" class="btn btn-primary js-save-btn">保存</a>',"</div>","</div>","</div>"].join(""),{});b.oEl.html(d),b.initIpt(),b.val(a)}function f(){var a=this,b=a.getEl();a.allocChkGroup=new o({el:b.find(".js-judging-alloc-type label.radio")}),a.aChkGroup={},l.forEach(a.aOptions,function(b){var c=p.transform(a.oEl.find(".js-checkbox-"+b.id));c.checked(b.checked),1===b.type&&c.disabled(),a.aChkGroup[b.id]=c,n.hover(c.getEl(),function(a){var c=j(a.currentTarget),d=c.attr("data-id"),e=c.find(".js-tip-"+d),f=e.find(".tooltip-inner");1===b.type?e.show():e.hide(),1===b.type&&f.show()},function(a){var b=j(a.currentTarget),c=b.attr("data-id"),d=b.find(".js-tip-"+c),e=d.find(".tooltip-inner");d.hide(),e.hide()})})}function g(a){var b=this;if(0===arguments.length){var c={};return l.forEach(b.aOptions,function(a){0!==a.type||b.aChkGroup[a.id].isChecked()||(c[a.id]=!1)}),{allocType:b.allocChkGroup.val(),judgingPermission:JSON.stringify(c)}}b.allocChkGroup.val(l.id(a.judgingType)||"0"),l.forEach(a.judgingPermission,function(a){b.aChkGroup[a.id].checked(a.value)})}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Clazz,l=h.Base,m=h.Str,n=h.Dom,o=i.CheckGroup,p=i.CheckBox,q=i.Popup,r=a("..//../../core/module"),s=(a("../../../component/popupSub/popupCommon"),a("../../../action/user")),t=c.exports=k.create();k.mix(t,r,{style:"/stylesheets/styles/system/assignedSetting.css",title:"判题设置",_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.oEl=a.getEl(),a.renderWait(a.oEl,"数据加载中..."),a.initData()}},{name:"click a.js-save-btn",handler:function(){var a=this,b=a.val();s.updateUserJudgingSetting({type:"PUT",params:{userId:a.getUserId()},body:b,call:function(){a.getWin().updateUser("judgingAllocType",b.allocType),q.tips("保存成功",1e3,function(){var b=a.getParam(),c=b.back;c&&c.module&&c.param&&a.nav(c.module,c.param)})},error:function(a){q.alert(a.msg)}})}}]},{initData:d,initIpt:f,renderData:e,val:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/email/index",["nc","cpn","./notice","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/dailyNotice","../../../../../action/common","./template","./util","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(){var a=this;a.templateCpn=new i({renderTo:a.getEl(),module:a.module,listeners:{showNotice:function(){a.noticeCpn.showCpn()},hideNotice:function(){a.noticeCpn.hideCpn()},fixVariableInfo:function(){a.noticeCpn.fixVariableInfo()}}}),a.noticeCpn=new h({renderTo:a.getEl(),module:a.module,getVariableData:function(){return a.templateCpn.getVariableData()},getEmailData:function(){return a.templateCpn.val()},listeners:{change:function(){a.fire("change")}}})}var e=a("nc"),f=(a("cpn"),e.$,e.Base,e.Clazz),g=e.Component,h=a("./notice"),i=a("./template"),j=c.exports=f.create();f.mix(j,g,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.initCpns()}}]},{initCpns:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/email/notice",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/dailyNotice","../../../../../action/common"],function(a,b,c){function d(a){var b=this;if(!b["inited_"+a]){var c=p.show({target:b.getEl(a),url:q.getUploadUrl(r.uploadType.file),fileType:"*.xlsx;",call:function(a){var c=b.rawConfig.getEmailData(),d=a.data;t.sendEmail({type:"POST",body:{excel:d,confirm:0,emailSubject:c.title,emailContent:c.val},call:function(a){var c=l.json(a.data),e=['<div style="width:100%;text-align:center;font-size:14px;">',"本次共有",c.successCount,"个用户已成功导入",c.errorCount?"<br>共有"+c.errorCount+"条信息格式错误无法导入":"",c.errorFileUrl?'<br><a class="font-green" href="'+c.errorFileUrl+'" target="_blank">点击下载错误名单</a>':"","</div>"].join("");new o({title:"提醒",content:e,okTxt:"我知道了"}),b.noticeCount=c.successCount,b.excelUrl=d,b.fixNoticeInfo()},error:function(a){if(1005===a.code)return o.alert("邮件标题或内容不能为空");if(1501===a.code){var c=o.alert('通知名单模板和邮件模板字段不匹配，请重新<a href="javascript:void(0);" class="js-download-default font-green">下载通知名单上传模板</a>，完善后重新上传');return void c.getEl(".js-download-default").on("click",l.bind(b.downloadDefault,b))}o.alert(a.msg)}})}});b["inited_"+a]=!0,b.pushChild(c)}}function e(){var a=this;a.getEl(".js-notice-count").html(a.noticeCount),a.getEl(".js-notice-info").show(),a.getEl(".js-upload-tpl-btn").hide(),a.initUploadBtn(".js-upload-tpl")}function f(){var a=this,b=a.rawConfig.getVariableData(),c=l.map(b,function(a){return a.title});a.getEl(".js-variable-info").html(c.join("、"))}function g(){var a=this;a.fixVariableInfo(),a.getEl().show(),a.initUploadBtn(".js-upload-tpl-btn")}function h(){var a=this;a.getEl().hide()}function i(){var a=this,b=a.rawConfig.getVariableData(),c=l.map(b,function(a){return a.title});c.unshift("邮箱");var d=u.downloadExcelTemplateUrl({type:"GET",query:{titleList:c,sheetName:"通知名单导入模板"}});window.open(d)}var j=a("nc"),k=a("cpn"),l=(j.$,j.Base),m=j.Clazz,n=j.Component,o=(j.Time,k.Popup),p=(k.Tips,k.Pager,k.AttachUpload),q=(a("../../../../../component/table"),a("../../../../../util/util")),r=a("../../../../../core/siteConfig"),s=a("../../../extend/bll/task"),t=a("../../../../../action/dailyNotice"),u=a("../../../../../action/common"),v=c.exports=m.create();m.mix(v,n,{_template:['<div class="module-box" style="display:none;">','<div class="module-head clearfix"><h1>通知对象</h1></div>','<div class="module-body">','<div class="notice-object-panel">','<div class="notice-object-hd">','邮件模板中包含以下字段：<span class="js-variable-info"></span>，请先<a href="javascript:void(0);" class="link-green js-download-default">下载通知名单导入模板</a>，完善模板后上传通知名单Excel',"</div>",'<div class="notice-object-bd">','<p class="js-notice-info" style="display:none;">通知对象：<span class="js-notice-count"></span>人，<a href="javascript:void(0);" class="link-green js-upload-tpl">点击替换通知名单</a></p>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-upload-tpl js-upload-tpl-btn">上传通知名单</a>',"</div>","</div>",'<div class="notice-object-btn">','<a href="javascript:void(0);" class="btn btn-primary js-send-email">发送邮件通知</a>','<a href="javascript:void(0);" class="btn btn-default js-go-back">暂不发送</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module}},{name:"click .js-download-default",handler:function(){var a=this;a.downloadDefault()}},{name:"click .js-send-email",handler:function(){var a=this,b=a.rawConfig.getEmailData();return b.title?b.val?a.excelUrl?void new o({title:"发送确认",content:['<div style="font-size:14px;text-align:left">',"本次发送通知的情况：","<br>通知对象：",a.noticeCount,"个","<br>邮件：",a.noticeCount,"封","<br><br>是否确认发送？","</div>"].join(""),cancelTxt:"取消",ok:function(){t.sendEmail({type:"POST",body:{excel:a.excelUrl,confirm:1,emailSubject:b.title,emailContent:b.val},call:function(b){var c=a.module.getWin(),d=2;c.addTask({title:"发送邮件通知",waitTxt:"发送中",getStatus:function(c){return 2!==d?c&&c(d):void s.getTaskProgress(!1,b.data,function(b){var e=b.end,f=(b.content,b.error),g=b.progress;f?(d=1,c&&c(d,g)):e?(d=0,c&&c(d,g),a.fire("change")):c&&c(d,g)})},getResult:function(){return{type:3}}})},error:function(b){if(1101===b.code){var c=l.json(b.msg,{});new o({title:"余额不足",width:600,content:'<span style="font-size:14px;">'+c.msg+"</span>",okTxt:"去充值",cancelTxt:"一会儿再充",listeners:{ok:function(){a.module.nav("purchase",{action:"recharge"})},cancel:function(){}}})}else o.alert(b.msg)}})}}):o.alert("请先上传通知名单"):o.alert("邮件内容不能为空"):o.alert("邮件标题不能为空")}},{name:"click .js-go-back",handler:function(){var a=this;a.module.getWin().navBack()}}]},{initUploadBtn:d,fixNoticeInfo:e,fixVariableInfo:f,showCpn:g,hideCpn:h,downloadDefault:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/email/popupTplEdit",["nc","cpn","./util","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};{var b=new r(a);o.wrap(b,{title:"编辑邮件模板",noUnique:!0,content:b.html(),width:920,ok:function(){return b.check()?void(a.ok&&a.ok(b.val())):!0},cancel:function(){}})}return b}function e(a){var b=this;b.variable=a.variable}function f(b){var c=this,d=(c.rawConfig,c.getEl()),e=d.find(".js-content");c.nameIpt=p.transform(d.find(".js-name")),e.html(['<div class="form-group">','<label class="control-label">邮件标题</label>','<div class="control-group js-title">','<input type="text" placeholder="邮件标题">',"</div>","</div>",'<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>',q.getNameList(c.variable),"</div>",'<div class="editor-box js-editor"></div>'].join("")),c.titleIpt=p.transform(e.find(".js-title")),a.async("../../../../../component/editorSub/hEditor/index",function(a){c.contentIpt=new a({width:e.width(),height:200,renderTo:e,noCodeSelect:!0,noToolbarFixed:!0,noAutoHeight:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,|,table,subscript,superscript,removeformat".split(",")},render:function(){c.contentIpt=c.contentIpt||this,c.popup.fixPosition(),this.waitCreated(b)}})})}function g(a){{var b=this;b.rawConfig}if(0===arguments.length){var c={templateContent:{name:k.trim(b.nameIpt.val()),value:{}}};return c.templateContent.value.emailSubject=k.trim(b.titleIpt.val()),c.templateContent.value.emailContent=q.html2tpl(b.variable,k.trim(b.contentIpt.val())),c.templateContent=JSON.stringify(c.templateContent),c}a=n.json(a.templateContent,{}),b.nameIpt.val(a.name),b.titleIpt.val(a.value.emailSubject),b.contentIpt.val(q.tpl2html(b.variable,a.value.emailContent))}function h(){var a=this,b=(a.rawConfig,a.val()),c=a.nameIpt,d=n.json(b.templateContent);if(!d.name)return void c.setErrorTips("名称不能为空");if(d.name.length>20)return void c.setErrorTips("名称最长为20个字符");var e=d.value||{};return e.emailSubject?!e.emailContent||a.contentIpt&&!a.contentIpt.text()?void o.alert("邮件正文不能为空"):!0:void a.titleIpt.setErrorTips("邮件标题不能空")}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Limit,j.Popup),p=j.Input,q=a("./util"),r=c.exports=m.create();m.mix(r,l,{_template:['<div class="pop-mod-set" style="max-height:none;">','<div class="form-group">','<label class="control-label">模板名称</label>','<div class="control-group js-name"><input type="text" placeholder="模板名称"></div>',"</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initCpn(function(){b.data&&a.val(b.data)})}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=k(a.currentTarget),d=k.trim(c.attr("data-name")),e=q.name2img(b.variable,d);e&&b.contentIpt&&b.contentIpt.waitCreated(function(){b.contentIpt.getEditor().exec("insertimage",e)})}}],show:d},{initialize:e,initCpn:f,val:g,check:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/email/template",["nc","cpn","./util","../../../../../action/common","../../../../../util/ajax","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage","../../../../../action/dailyNotice"],function(a,b,c){function d(){var a=this;a.getEmailVariables(function(b){a.variableData=b,a.getTemplate(function(b){a.templateData=b,a.renderContainer(),a.initEditor(),a.renderDefault(),a.fire("showNotice")},function(b){a.module.renderNone(a.getEl(),b),a.fire("hideNotice")})},function(b){a.module.renderNone(a.getEl(),b),a.fire("hideNotice")})}function e(){var a=this;a.getEl().html(['<div class="module-head clearfix">',"<h1>编辑邮件模板</h1>","</div>",'<div class="module-body">','<div class="info-edit-box">','<div class="form-group">','<label class="control-label">邮件标题：</label>','<div class="control-group">','<input class="js-title" type="text" placeholder="请输入邮件标题" value="">',"</div>","</div>",'<div class="notice-editor">','<div class="notice-tool-bar">','<a href="javascript:void(0);" class="js-save"><i class="icon-save"></i>保存为模板</a>','<a href="javascript:void(0);" class="js-load"><i class="icon-download"></i>载入已有模板</a>',"</div>",'<label class="control-label">邮件正文：</label>','<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>','<div class="page-tags">',u.getNameList(a.variableData),"</div>","</div>",'<div class="editor-box js-editor"></div>',"</div>","</div>","</div>"].join(""))}function f(){var a=this;a.editor=new v({renderTo:a.getEl("div.js-editor"),noCodeSelect:!0,noToolbarFixed:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,link,|,table,subscript,superscript,removeformat".split(",")},listeners:{draftChange:function(){a.fire("fixVariableInfo")}}})}function g(){var a=this,b=s.find(a.templateData,function(a){return a.isDefault});if(b){var c=s.json(b.templateContent,{}).value||{};a.val({title:c.emailSubject,val:c.emailContent})}}function h(a){var b=this;b.getEl("div.js-mail").html(p.trim(a))}function i(a){var b=this,c=b.getEl("input.js-title");if(0===arguments.length){var d=p.trim(c.val()),e=p.trim(b.editor?b.editor.text():""),f="";return e&&(f=b.editor&&b.editor.val(),f=u.html2val(b.variableData,f)),{title:d,val:f}}var f=u.tpl2html(b.variableData,a.val);b.editor.val(f),c.val(p.trim(a.title)),window.setTimeout(function(){b.editor.autoHeight()},1e3)}function j(){var a=this,b=a.getEl("input.js-title"),c=p.trim(b.val()),d=p.trim(a.editor?a.editor.text():""),e="";return d&&(e=a.editor&&a.editor.val(),e=u.html2tpl(a.variableData,e)),{title:c,val:e}}function k(a,b){var c=this;w.getEmailVariables({query:{},call:function(b){a&&a(b.data||[])},error:function(a){s.isFunction(b)?b(a.msg):"popup"===b?t.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}function l(a,b){var c=this;x.getTemplates({query:{type:2002},call:function(b){a&&a(b.data||[])},error:function(a){s.isFunction(b)?b(a.msg):"popup"===b?t.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}function m(){var a=this,b=[],c=a.variableData,d=a.val().val;return s.forEach(c,function(a){new RegExp("#"+a.name+"#").test(d)&&b.push(a)}),b}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Component,r=n.Clazz,s=n.Base,t=o.Popup,u=a("./util"),v=a("../../../../../component/editorSub/hEditor/index"),w=a("../../../../../action/dailyNotice"),x=a("../../../../../action/common"),y=c.exports=r.create();r.mix(y,q,{_template:['<div class="module-box"></div>'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.renderPage()}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=p(a.currentTarget),d=p.trim(c.attr("data-name")),e=u.name2img(b.variableData,d);e&&b.editor.waitCreated(function(){b.editor.getEditor().exec("insertimage",e)})}},{name:"click .js-save",handler:function(){var a=this,b=(a.rawConfig,a.valTpl());u.saveTpl({title:b.title,content:b.val})}},{name:"click .js-load",handler:function(){{var a=this;a.rawConfig}u.getTpl({variable:(a.variableData||[]).slice(0),call:function(b){var c=s.json(b.templateContent).value;a.val({title:c.emailSubject||"",val:c.emailContent||""})}})}}]},{renderPage:d,renderContainer:e,initEditor:f,renderDefault:g,valSender:h,val:i,valTpl:j,getEmailVariables:k,getTemplate:l,getVariableData:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/email/util",["nc","cpn","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a,b){var c=o.find(a,function(a){return a.title===b});return(c||{}).picUrl}function e(a,b){var c=this;return b=b.replace(/\[\$\#\#\$\](.*?)\[\$\#\#\$\]/gi,function(b,d){var e=c.name2img(a,d);return e?'<img src="'+e+'" />':""})}function f(a,b){var c=this;return b=b.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(b,d,e,f){if("img"!==(f||"").toLowerCase())return b;var g=c.getAttrList(b),h=n.trim(g.src);if(!h)return b;var i=o.find(a,function(a){return h.indexOf(a.picUrl)>=0});return i?"[$##$]"+i.title+"[$##$]":b})}function g(a,b){var c=this;return b=b.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(b,d,e,f){if("img"!==(f||"").toLowerCase())return b;var g=c.getAttrList(b),h=n.trim(g.src);if(!h)return b;var i=o.find(a,function(a){return h.indexOf(a.picUrl)>=0});return i?"#"+i.name+"#":b})}function h(a){var b="";return o.forEach(a,function(a){b+='<a class="tag-label js-tag-info" data-name="'+a.title+'" href="javascript:void(0);">'+a.title+"</a>"}),b}function i(a){for(var b,c={},d=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g;b=d.exec(a);){var e=(b[1]||b[2]||b[4]||b[6]).toLowerCase();c[e]=(b[2]?b[3]:b[4]?b[5]:b[7])||""}return c}function j(b){var c=b.title,d=b.content;return c?d?void a.async("../../../../../component/popupSub/tpl/popupTplName",function(a){a.show({title:"保存邮件模板",ok:function(a){var b={type:2002,isDefault:a.isDefault?1:0,content:{name:a.name,value:{}}};b.content.value.emailSubject=c,b.content.value.emailContent=d,b.content=JSON.stringify(b.content),p.addTemplate({type:"POST",body:b,call:function(){q.tips("操作成功")},error:function(a){q.alert(a.msg)}})}})}):q.alert("邮件正文不能为空"):q.alert("邮件标题不能为空")}function k(b){a.async("../../../../../component/popupSub/tpl/popupTplList",function(c){c.show({reqType:"2002",edit:function(c){a.async("./popupTplEdit",function(a){a.show({variable:b.variable,data:c.data,ok:c.ok})})},ok:b.call})})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=a("../../../../../action/common"),q=m.Popup;c.exports={name2img:d,tpl2html:e,html2tpl:f,html2val:g,getNameList:h,getAttrList:i,saveTpl:j,getTpl:k}});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","./message/index","./message/notice","../../../../component/table","../../../../component/selectAll","./message/popupEditTemplate","../../../../action/common","../../../../util/ajax","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../action/dailyNotice","./message/template","./email/index","./email/notice","./email/template","./email/util","../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../component/editorSub/hEditor/plugin/autoLink","../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../component/editorSub/hEditor/plugin/imageBar","../../../../component/editorSub/hEditor/plugin/toolbar","../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../util/uploadRemote","../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../component/popupSub/popupUploadImage","./log/index","./log/overview","./log/detail","../../../../component/dateSelect","../../../../component/selectBtn"],function(a,b,c){function d(){}function e(a){var b=this,c=b.module,d=b.getEl(),e={0:k,1:l,2:m};a=e[a]?h.id(a):"0",d.find(".js-option").removeClass("selected"),d.find('.js-option[data-id="'+a+'"]').addClass("selected"),d.find(".js-notice-content").hide();var f=b.getEl(".js-content-"+a);if(f.show(),b.addParam({type:a}),!c[a]){var g=e[a];c[a]=new g({renderTo:f,module:b,listeners:{change:function(){"2"===a&&c[a]&&c[a].refresh()}}})}}var f=a("nc"),g=(a("cpn"),f.$),h=f.Base,i=f.Clazz,j=(f.Component,f.Node,f.Time,a("../../../../core/module")),k=a("./message/index"),l=a("./email/index"),m=a("./log/index"),n=c.exports=i.create();i.mix(n,j,{style:"/stylesheets/styles/system/notice.css",title:"日常通知",_template:['<div class="notice-mod clearfix">','<div class="notice-menu js-left-nav">',"<h2>通知类型</h2>",'<ul class="notice-menu-list">','<li class="js-option" data-id="0">短信通知</li>','<li class="js-option" data-id="1">邮件通知</li>','<li class="js-option" data-id="2">通知情况</li>',"</ul>","</div>",'<div class="notice-page">','<div class="js-notice-content js-content-0"></div>','<div class="js-notice-content js-content-1"></div>','<div class="js-notice-content js-content-2"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam();a.initLeftNav(),a.module={},a.selectOption(b.type||"0")}},{name:"click .js-option",handler:function(a){var b=this,c=g(a.currentTarget);b.selectOption(c.attr("data-id"))}}]},{initLeftNav:d,selectOption:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/log/detail",["nc","cpn","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/selectBtn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../action/dailyNotice","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(){var a=this;a.dateSelect=new t({renderTo:a.getEl(".js-time-select"),renderBy:"replaceWith",startDate:a.getBeforeN(999),endDate:a.getBeforeN()}),a.dateCheck=new u({renderTo:a.getEl(".js-date-check"),renderBy:"replaceWith",title:"最近",btnData:[{value:"3",name:"3天"},{value:"7",name:"7天"},{value:"30",name:"30天"},{value:"1000",name:"全部"}],change:function(b){b&&(a.dateSelect.val({startDate:a.getBeforeN(b-1),endDate:a.getBeforeN(),startTime:"00:00:00",endTime:"23:59:59"}),a.search())}})}function e(){var a=this;a.getDetailData(function(b){a.renderTable(b)})}function f(a){function b(){var a=c.tipHome=c.tipHome||[];l.forEach(a,function(a){a&&a.destroy()}),c.tipHome=[];var b=c.module.getWin();l.forEach(c.getEl(".js-fail-tip"),function(a){var d=k(a),e=d.closest("tr").attr("data-id"),f=new r({content:'<a href="javascript:void(0);" class="font-green js-download-fail">点击下载发送失败名单</a>',target:d,hidden:!0});c.tipHome.push(f),f.theme(!0),f.getEl(".js-download-fail").on("click",function(){w.listErrorRecord({query:{dailyRecordId:e},call:function(a){var c=2,d="";b.addTask({title:"[下载] 发送失败名单_"+o.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(b){return 2!==c?b&&b(c):void x.getTaskProgress(!1,a.data,function(a){var e=a.end,f=a.content,g=a.error,h=a.progress;g?(c=1,b&&b(c,h)):e?(c=0,d=f,b&&b(c,h)):b&&b(c,h)})},getResult:function(){return{type:3,data:d}}})},error:function(a){s.alert(a.msg)}})}),p.hoverToggle({el:[f.getEl(),d],enter:function(){f.show(),f.fixPosition()},leave:function(){f.hide()}})})}var c=this,d={head:[{text:"发送时间",style:{"min-width":"140px"}},{text:"通知渠道"},{text:"通知类型"},{text:"通知内容",width:"30%"},{text:"通知数量"},{text:"通知对象"},{text:"发送成功"},{text:"发送失败"},{text:"发送者"}],list:[]};l.forEach(a.data,function(a){var b=[o.form(new Date(a.createTime)),{0:"短信",1:"邮件"}[a.channel],{2001:"日常",2002:"日常",1004:"笔试",1005:"笔试",1e3:"面试",1001:"面试",1002:"面试",1003:"面试"}[a.type],a.content||a.noticeContent,a.feeCount,a.noticeCount,a.successCount,a.failCount?'<span class="js-fail-tip">'+a.failCount+"</span>":a.failCount,a.creatorUserName];d.list.push({items:b,attr:{"data-id":a.id}})}),c.getEl(".js-main").html('<span style="font-size:14px;">共有记录<span class="font-green">'+a.totalCount+"</span>条</span>"+v.getHtml(d)),new q({renderTo:c.getEl(".js-main"),current:c.page,total:a.totalPage,pageChange:function(a){c.page=a,c.search()}}),b()}function g(a){var b=this,c=b.dateSelect.val();w.listRecord({query:{beginTime:[c.startDate,!c.startDate||c.startTime?c.startTime:"00:00:00"].join(" "),endTime:[c.endDate,!c.endDate||c.endTime?c.endTime:"23:59:59"].join(" "),page:b.page,pageSize:5},call:function(b){a&&a(b.data||{})},error:function(a){b.module.renderNone(b.getEl(".js-main"),a.msg)}})}function h(a){a=+a||0;var b=(new Date).getTime()-24*a*3600*1e3,c=o.form(new Date(b),"yyyy-MM-dd");return c}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Base,m=i.Clazz,n=i.Component,o=i.Time,p=i.Dom,q=j.Pager,r=j.Tips,s=j.Popup,t=a("../../../../../component/dateSelect"),u=a("../../../../../component/selectBtn"),v=a("../../../../../component/table"),w=a("../../../../../action/dailyNotice"),x=a("../../../extend/bll/task"),y=c.exports=m.create();m.mix(y,n,{_template:['<div class="module-box">','<div class="module-head clearfix">',"<h1>通知发送记录</h1>","</div>",'<div class="module-body">','<div class="notice-filter-box">','<div class="inline-block">','<label class="notice-filter-label">发送时间</label>','<div class="js-time-select"></div>',"</div>",'<div class="inline-block">','<div class="js-date-check"></div>',"</div>",'<div class="inline-block">','<a href="javascript:void(0);" class="btn btn-primary js-search">查询</a>',"</div>","</div>",'<div class="js-main"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.page=1,a.initCpns(),a.search()}},{name:"click .js-search",handler:function(){var a=this;a.search()}}]},{initCpns:d,search:e,renderTable:f,getDetailData:g,getBeforeN:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/log/index",["nc","cpn","./overview","../../../../../action/dailyNotice","../../../../../util/ajax","./detail","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/selectBtn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(){var a=this;a.overviewCpn=new i({renderTo:a.getEl(),module:a.module,listeners:{showNotice:function(){a.noticeCpn.showCpn()},hideNotice:function(){a.noticeCpn.hideCpn()}}}),a.detailCpn=new j({renderTo:a.getEl(),module:a.module,getTemplateId:function(){return a.templateCpn.getTemplateId()},getMessageCount:function(){return a.templateCpn.getMessageCount()}})}function e(){var a=this;a.overviewCpn.refresh(),a.detailCpn.search()}var f=a("nc"),g=(a("cpn"),f.$,f.Base,f.Clazz),h=f.Component,i=a("./overview"),j=a("./detail"),k=c.exports=g.create();g.mix(k,h,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.initCpns()}}]},{initCpns:d,refresh:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/log/overview",["nc","cpn","../../../../../action/dailyNotice","../../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.getOverviewData(function(b){a.renderData(b)})}function e(a){var b=this;b.getEl(".js-main").html(['<div class="msg-count-box">','<div class="msg-count-item">','<div class="msg-count-icon">','<img src="../../../images/res/notice/1.png" alt="短信">',"</div>",'<div class="msg-count-cont">',"<p>累计发送短信</p>",'<p><span class="font-green">',a.smsNoticeCount,"</span></p>","</div>","</div>",'<div class="msg-count-item">','<div class="msg-count-icon">','<img src="../../../images/res/notice/2.png" alt="邮件">',"</div>",'<div class="msg-count-cont">',"<p>累计发送邮件</p>",'<p><span class="font-green">',a.emailNoticeCount,"</span></p>","</div>","</div>",'<div class="msg-count-item">','<div class="msg-count-icon">','<img src="../../../images/res/notice/3.png" alt="人次">',"</div>",'<div class="msg-count-cont">',"<p>累计发送人次</p>",'<p><span class="font-green">',a.totalNoticeCount,"</span></p>","</div>","</div>"].join(""))}function f(a){var b=this;j.countSummary({query:{},call:function(b){a&&a(b.data)},error:function(a){b.module.renderNone(b.getEl(".js-main"),a.msg)}})}var g=a("nc"),h=(a("cpn"),g.$,g.Base,g.Clazz),i=g.Component,j=a("../../../../../action/dailyNotice"),k=c.exports=h.create();h.mix(k,i,{_template:['<div class="module-box">','<div class="module-head clearfix">',"<h1>通知使用情况</h1>","</div>",'<div class="module-body js-main">'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.refresh()}}]},{refresh:d,renderData:e,getOverviewData:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/message/index",["nc","cpn","./notice","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","./popupEditTemplate","../../../../../action/common","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../action/dailyNotice","./template"],function(a,b,c){function d(){var a=this;a.templateCpn=new i({renderTo:a.getEl(),module:a.module,listeners:{showNotice:function(){a.noticeCpn.showCpn()},hideNotice:function(){a.noticeCpn.hideCpn()}}}),a.noticeCpn=new h({renderTo:a.getEl(),module:a.module,getTemplateId:function(){return a.templateCpn.getTemplateId()},getMessageCount:function(){return a.templateCpn.getMessageCount()},listeners:{change:function(){a.fire("change")}}})}var e=a("nc"),f=(a("cpn"),e.$,e.Base,e.Clazz),g=e.Component,h=a("./notice"),i=a("./template"),j=c.exports=f.create();f.mix(j,g,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.initCpns()}}]},{initCpns:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/message/notice",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","./popupEditTemplate","../../../../../action/common","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../action/dailyNotice"],function(a,b,c){function d(a){var b=this;if(!b["inited_"+a]){var c=n.show({target:b.getEl(a),url:o.getUploadUrl(p.uploadType.file),fileType:"*.xlsx;",call:function(a){var c=a.data;r.sendSms({type:"POST",body:{excel:c,confirm:0},call:function(a){var d=j.json(a.data),e=['<div style="width:100%;text-align:center;font-size:14px;">',"本次共有",d.successCount,"个用户已成功导入",d.errorCount?"<br>共有"+d.errorCount+"条信息格式错误无法导入":"",d.errorFileUrl?'<br><a class="font-green" href="'+d.errorFileUrl+'" target="_blank">点击下载错误名单</a>':"","</div>"].join("");new m({title:"提醒",content:e,okTxt:"我知道了"}),b.noticeCount=d.successCount,b.fixNoticeInfo(),b.excelUrl=c},error:function(a){m.alert(a.msg)}})},error:function(a){m.alert(a.msg)}});b["inited_"+a]=!0,b.pushChild(c)}}function e(){var a=this;a.getEl(".js-notice-count").html(a.noticeCount),a.getEl(".js-notice-info").show(),a.getEl(".js-upload-tpl-btn").hide(),a.initUploadBtn(".js-upload-tpl")}function f(){var a=this;a.getEl().show(),a.initUploadBtn(".js-upload-tpl-btn")}function g(){var a=this;a.getEl().hide()}var h=a("nc"),i=a("cpn"),j=(h.$,h.Base),k=h.Clazz,l=h.Component,m=(h.Time,i.Popup),n=(i.Tips,i.Pager,i.AttachUpload),o=(a("../../../../../component/table"),a("../../../../../util/util")),p=a("../../../../../core/siteConfig"),q=(a("./popupEditTemplate"),a("../../../extend/bll/task")),r=a("../../../../../action/dailyNotice"),s=a("../../../../../action/common"),t=c.exports=k.create();k.mix(t,l,{_template:['<div class="module-box" style="display:none;">','<div class="module-head clearfix"><h1>通知对象</h1></div>','<div class="module-body">','<div class="notice-object-panel">','<div class="notice-object-hd">','请先<a href="javascript:void(0);" class="link-green js-download-default">下载通知名单导入模板</a>，将手机号码填写到模板中的手机一列，然后上传通知名单Excel',"</div>",'<div class="notice-object-bd">','<p class="js-notice-info" style="display:none;">通知对象：<span class="js-notice-count"></span>人，<a href="javascript:void(0);" class="link-green js-upload-tpl">点击替换通知名单</a></p>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-upload-tpl js-upload-tpl-btn">上传通知名单</a>',"</div>","</div>",'<div class="notice-object-btn">','<a href="javascript:void(0);" class="btn btn-primary js-send-message">发送短信通知</a>','<a href="javascript:void(0);" class="btn btn-default js-go-back">暂不发送</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module}},{name:"click .js-download-default",handler:function(){var a=s.downloadExcelTemplateUrl({type:"GET",query:{titleList:["手机号码"],sheetName:"通知名单导入模板"}});window.open(a)}},{name:"click .js-send-message",handler:function(){var a=this,b=a.rawConfig.getTemplateId();if(!b)return m.alert("请先选择本次通知要使用的短信模板");if(!a.excelUrl)return m.alert("请先上传通知名单");var c=a.rawConfig.getMessageCount();new m({title:"发送确认",content:['<div style="font-size:14px;text-align:left">',"本次发送通知的情况：","<br>通知对象：",a.noticeCount,"个","<br>短信：",c*a.noticeCount,"条","<br><br>是否确认发送？","</div>"].join(""),cancelTxt:"取消",ok:function(){r.sendSms({type:"POST",body:{excel:a.excelUrl,confirm:1,ctsTemplateId:b},call:function(b){var c=a.module.getWin(),d=2;c.addTask({title:"发送短信通知",waitTxt:"发送中",getStatus:function(c){return 2!==d?c&&c(d):void q.getTaskProgress(!1,b.data,function(b){var e=b.end,f=(b.content,b.error),g=b.progress;f?(d=1,c&&c(d,g)):e?(d=0,c&&c(d,g),a.fire("change")):c&&c(d,g)})},getResult:function(){return{type:3}}})},error:function(b){if(1101===b.code){var c=j.json(b.msg,{});new m({title:"余额不足",width:600,content:'<span style="font-size:14px;">'+c.msg+"</span>",okTxt:"去充值",cancelTxt:"一会儿再充",listeners:{ok:function(){a.module.nav("purchase",{action:"recharge"})},cancel:function(){}}})}else m.alert(b.msg)}})}})}},{name:"click .js-go-back",handler:function(){var a=this;a.module.getWin().navBack()}}]},{initUploadBtn:d,fixNoticeInfo:e,showCpn:f,hideCpn:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/message/popupEditTemplate",["nc","cpn","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new v(a);return r.wrap(b,{title:a.id?"新增短信模板":"编辑短信模板",content:b.html(),width:700,ok:function(){return b.check()&&b.submit(),!0},cancelTxt:"取消"}),b}function e(a){var b=this;if(0===arguments.length){var c=!!+b.ifCheck.val();return{name:m.trim(b.nameCpn.val()),content:m.trim(b.contentCpn.val()),needNotice:c,noticePhone:c?m.trim(b.noticePhoneCpn.val()):""}}a=a||{},b.nameCpn.val(a.name),b.contentCpn.val(a.content),b.ifCheck.val(a.noticePhone?"1":"0"),b.noticePhoneCpn.val(a.noticePhone)}function f(){var a=this;a.nameCpn=new s({renderTo:a.getEl(".js-name"),renderBy:"replaceWith",placeholder:"不能为空且不可超过20个字符"}),a.contentCpn=new s({renderTo:a.getEl(".js-content"),type:"textarea",renderBy:"replaceWith",listeners:{change:n.bind(a.fixMessageCount,a)}}),a.contentCpn.getEl().css({"float":"none"}),a.contentCpn.getEl("textarea").css("resize","none"),a.contentCpn.getEl(".input-tip").css("bottom",1),a.ifCheck=t.mix({el:a.getEl(".js-if-check label.radio"),listeners:{change:n.bind(a.fixNoticePhone,a)}}),a.noticePhoneCpn=new s({renderTo:a.getEl(".js-notice-phone"),placeholder:"请输入接收提醒的手机号",renderBy:"replaceWith"}),a.noticePhoneCpn.getEl().css({"float":"none",display:"inline-block"}),a.fixMessageCount(),a.fixNoticePhone()}function g(){var a=this,b=a.val(),c=!0;return b.name||(c=!1,a.nameCpn.errorTips("请输入模板名称")),b.name.length>20&&(c=!1,a.nameCpn.errorTips("不可超过20个字符")),b.content||(c=!1,a.contentCpn.errorTips("请输入短信内容")),b.needNotice&&!b.noticePhone&&(c=!1,a.noticePhoneCpn.errorTips("请输入接收提醒的手机号")),b.needNotice&&!q.isPhone(b.noticePhone)&&(c=!1,a.noticePhoneCpn.errorTips("手机号格式不正确")),c}function h(){var a=this,b=a.rawConfig,c=a.val();return b.id?u.updateTemplate({type:"POST",params:{templateId:b.id},body:{type:2001,content:c.content,name:c.name,noticePhone:c.noticePhone},call:function(){a.fire("submited"),a.popup.close()},error:function(a){r.alert(a.msg)}}):void u.addTemplate({type:"POST",body:{type:2001,content:c.content,name:c.name,noticePhone:c.noticePhone},call:function(){a.fire("submited"),a.popup.close()},error:function(a){r.alert(a.msg)}})}function i(){var a=this,b=m.trim(a.contentCpn.val()).length;a.getEl(".js-content-num").html(b),a.getEl(".js-message-num").html(Math.ceil(b/67))}function j(){var a=this,b=!!+a.ifCheck.val();a.noticePhoneCpn.getEl()[b?"show":"hide"]()}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Base,o=k.Clazz,p=k.Component,q=k.Str,r=l.Popup,s=l.Input,t=l.CheckGroup,u=(l.Tips,a("../../../../../action/common")),v=c.exports=o.create();o.mix(v,p,{_template:['<div class="pop-notice-edit">','<div class="pop-info-tips">重要提示：短信模板需要运营商人工审核，结果会在30分钟后反馈，审核人员工作时间：9:00-23:00，如果长时间没有反馈，请联系客服：010-84873384</div>',"<form>",'<div class="form-group">','<label class="control-label">模板名称</label>','<div class="js-name"></div>',"</div>",'<div class="form-group">','<label class="control-label">短信签名</label>','<div class="control-group">牛客网</div>',"</div>",'<div class="form-group">','<label class="control-label">短信内容</label>','<div class="control-group pop-notice-editbox">','<div class="js-content"></div>','<div class="pop-editbox-tips">','<span>共<span class="font-green js-content-num">0</span>个字，<span class="font-green js-message-num">0</span>条短信</span>','<a href="javascript:void(0);" class="help-wrapper link-gray tips-fade-left">','<i class="icon-question-sign js-tips" title="每条短信不超过67字，如果超过67字，系统将分多条发送" data-theme="white"></i>',"</a>","</div>","</div>","</div>",'<div class="form-group">','<label class="control-label">审核结果短信提醒</label>','<div class="control-group js-if-check">','<label class="radio checked" style="margin-right:10px;"><input value="0">不提醒</label>','<label class="radio" style="margin-right:20px;"><input value="1">提醒</label>','<div class="js-notice-phone"></div>',"</div>","</div>","</form>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initCpns(),b.id&&a.val(b.val)}}],show:d},{val:e,initCpns:f,check:g,submit:h,fixMessageCount:i,fixNoticePhone:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/notice/message/template",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","./popupEditTemplate","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.getTemplate(function(b){return 0===b.length?(a.module.renderNone(a.getEl(),'你还没有短信模板，<a href="javascript:void(0);" class="font-green js-add-template">点此新增短信模板</a>'),void a.fire("hideNotice")):(a.tableData=b,a.renderContainer(),a.renderTable(),void a.fire("showNotice"))},function(b){a.module.renderNone(a.getEl(),b),a.fire("hideNotice")})}function e(){var a=this;a.getEl().html(['<div class="module-box">','<div class="module-head clearfix">',"<h1>选择短信模板</h1>",'<div class="module-head-oprt">','<a href="javascript:void(0);" class="btn btn-primary btn-sm js-add-template">+新增模板</a>',"</div>","</div>",'<div class="module-body js-table"></div>',"</div>"].join(""))}function f(){function a(a){var b='<a href="javascript:void(0);" class="btn btn-default btn-xxs btn-auto js-use">使用中</a>',d='<a href="javascript:void(0);" class="btn btn-primary btn-xxs btn-auto js-use">使用模板</a>',e='<a href="javascript:void(0);" class="link-green js-edit">修改</a>',f='<a href="javascript:void(0);" class="icon-trash link-green js-del"></a>';return 2===a.status&&o.id(a.id)===o.id(c.usingMsgTplId)?b:2===a.status?f+d:3===a.status?f:4===a.status?f+e:void 0}function b(a,b){0===b&&(c.map={});var d=c.map=c.map||{};d[a.id]=a}var c=this,d=10,e=c.tableData.slice((c.page-1)*d,c.page*d),f={head:[{text:"模板名称",width:"20%"},{text:"模板内容",width:"30%"},{text:"创建时间",style:{"min-width":"150px"}},{text:"审核状态"},{text:"操作"}],list:[]};o.forEach(e,function(c,d){b(c,d);var e=o.json(c.checkResult,{}),g=[c.name,'<span class="hide-txt">'+c.templateContent+"</span>",r.form(new Date(c.createTime)),{2:'<span class="font-green icon-ok-sign">审核成功</span>',3:'<span class="font-gray icon-minus-sign">审核中</span>',4:'<span class="font-orange icon-remove-sign js-tips" data-theme="white" title="'+e.reason+'">审核失败</span>'}[c.status],a(c)];f.list.push({items:g,attr:{"data-id":c.id}})}),c.getEl(".js-table").html(u.getHtml(f)),new t({renderTo:c.getEl(".js-table"),current:c.page,total:Math.ceil(c.tableData.length/d),pageChange:function(a){c.page=a,c.renderTable()}})}function g(){var a=this;v.show({listeners:{submited:o.bind(a.renderPage,a)}})}function h(a,b){var c=this;w.getTemplates({query:{type:2001},call:function(b){a&&a(b.data||[])},error:function(a){o.isFunction(b)?b(a.msg):"popup"===b?s.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}function i(a){var b=this,c=n(a.currentTarget).closest("tr").attr("data-id");return b.map[c]}function j(){var a=this;return a.usingMsgTplId}function k(){var a=this,b=a.map[a.usingMsgTplId];if(!b)return 0;var c=b.templateContent.length;return 70>=c?1:Math.ceil(1*c/67)}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=l.Component,r=l.Time,s=m.Popup,t=(m.Tips,m.Pager),u=a("../../../../../component/table"),v=a("./popupEditTemplate"),w=a("../../../../../action/common"),x=c.exports=p.create();p.mix(x,q,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.page=1,a.renderPage()}},{name:"click .js-add-template",handler:function(){var a=this;a.addTemplate()}},{name:"click .js-edit",handler:function(a){var b=this,c=b.getLineItem(a);v.show({id:c.id,val:{name:c.name,content:c.templateContent,noticePhone:c.noticePhone},listeners:{submited:o.bind(b.renderPage,b)}})}},{name:"click .js-del",handler:function(a){var b=this,c=b.getLineItem(a);s.confirm("删除模板后将无法找回该模板，已经审核通过的模板需要重新提交申请，是否删除？",function(){w.deleteTemplate({type:"DELETE",params:{templateId:c.id},call:function(){s.tips("操作成功",o.bind(b.renderPage,b))},error:function(a){s.alert(a.msg)}})})}},{name:"click .js-use",handler:function(a){var b=this,c=b.getLineItem(a);return b.usingMsgTplId===c.id?(b.usingMsgTplId=-1,void b.renderTable()):void s.confirm("每次发送只能使用一个短信模板，确定使用该模板作为本次发送的内容？",function(){b.usingMsgTplId=c.id,b.renderTable()})}}]},{renderPage:d,renderContainer:e,renderTable:f,addTemplate:g,getTemplate:h,getLineItem:i,getTemplateId:j,getMessageCount:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/account/util",["nc","cpn","../../../action/user","../../../util/ajax","../../../util/util","../../../core/siteConfig","../../../util/switch"],function(a,b,c){function d(a,b){function c(a){var b=d.getRoleAuthority();return i.map((a||"").split(","),function(a){return b[a]})}var d=this;k.getAllSelfDefinedRoles({query:{},call:function(b){var d="101,102,103,110,111,112,113,114,115,116,120,121,122,123,124,125,130,131,132,200,300,400",e="200",f="400";a&&a([{name:"HR",id:0,official:!0,permission:d,permissionNameList:c(d)},{name:"判题官",id:1,official:!0,permission:e,permissionNameList:c(e)},{name:"出题官",id:2,official:!0,permission:f,permissionNameList:c(f)}].concat(b.data||[]))},error:function(a){var c=a.msg||"出现错误";return i.isFunction(b)?b(c):void 0===b?j.alert(c):void l.renderNone({el:h(b),text:c})}})}function e(){var a={101:{name:"设置招聘主页",module:"简历库",moduleId:100,area:"职位管理"},102:{name:"管理招聘项目（新增/修改/删除）",module:"简历库",moduleId:100,area:"职位管理"},103:{name:"管理招聘职位（新增/修改/删除）",module:"简历库",moduleId:100,area:"职位管理"},110:{name:"内推-简历初选",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},111:{name:"内推-笔试",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},112:{name:"内推-面试",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},113:{name:"简历初选",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},114:{name:"笔试",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},115:{name:"面试",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},116:{name:"待发offer",module:"简历库",moduleId:100,area:"应聘管理-管理阶段"},120:{name:"查看简历",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},121:{name:"下载简历",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},122:{name:"转移阶段和状态",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},123:{name:"标签",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},124:{name:"安排笔试（关联/查看试卷）",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},125:{name:"安排面试（关联项目/查看面试详情）",module:"简历库",moduleId:100,area:"应聘管理-管理操作"},130:{name:"简历统计",module:"简历库",moduleId:100,area:"其他"},131:{name:"找简历",module:"简历库",moduleId:100,area:"其他"},132:{name:"做题简历",module:"简历库",moduleId:100,area:"其他"},200:{name:"笔试",module:"笔试",moduleId:200},300:{name:"面试",module:"面试",moduleId:300},400:{name:"题库管理",module:"题库管理",moduleId:400}},b={};return i.forEach(a,function(a,c){m.has(c)&&(b[c]=a)}),b}var f=a("nc"),g=a("cpn"),h=f.$,i=f.Base,j=(f.Clazz,f.Component,g.Popup),k=a("../../../action/user"),l=a("../../../util/util"),m=a("../../../util/switch");c.exports={getRoles:d,getRoleAuthority:e}});
define("company/nowcoder/1.0.740/javascripts/site/main/demo/index",["nc","cpn","../../../core/module","../../../util/util","../../../core/siteConfig"],function(a,b,c){function d(){}var e=a("nc"),f=(a("cpn"),e.$,e.Clazz),g=(e.Base,a("../../../core/module")),h=c.exports=f.create();f.mix(h,g,{style:"",title:"示例模块",_template:['<div class="module-box">','<div class="module-head clearfix">',"<h1>这是标题</h1>","</div>",'<div class="module-body">这是内容</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){}}]},{initialize:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/base",[],function(a,b,c){function d(){var a=this;return a.win}function e(){var a=this,b=a.getWin();return b.user.id}c.exports={win:null,getWin:d,getUserId:e}});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/interview",["nc","cpn","./base","./money","../../../../action/purchase","../../../../util/ajax","../../../../action/price","../../../../core/siteConfig","../../../../action/interview","../../../../action/interviewV2","../../../../action/interviewProject"],function(a,b,c){function d(a){var b=this,c=r.id(a.id),d=a.call,e=b.getWin();if(c&&"0"!==c)b.setCacheProjectId(c),d&&d(c);else{var f=!!a.noForce;c=b.getCacheProjectId()||"0","0"!==c&&e.addParam({projectId:c}),f&&d&&d(c),!f&&u.alert("你还没有选择面试项目，请前往选择",function(){e.nav("interview",{action:"project/index"})})}}function e(a){var b=this,c=r.id(a.id);b.getSimpleProject(function(d){if(!d||0===d.length)return u.alert("你没有创建任何项目");var e=t.execTpl('<a v-for="item in items" :class="cls(item)" href="javascript:void(0);" :data-id="item.id">#{item.name}</a>',{items:d,cls:function(a){return["tag-label",r.id(a.id)===c?"selected":""]}});new u({width:600,title:"选择切换的项目",hasNoFooter:!0,content:e,listeners:{"click a.tag-label":{handler:function(d){this.close();var e=q(d.currentTarget),f=e.attr("data-id");c!==f&&(b.setCacheProjectId(f),a.call&&a.call(f))}}}})})}function f(a){var b=this;A.getProjects({type:"GET",params:{userId:b.getUserId()},call:function(b){a&&a(b.data)},error:function(){a&&a([])}})}function g(a){var b=this;A.getAllSimpleProjects({type:"GET",params:{userId:b.getUserId()},call:function(b){a&&a(b.data)},error:function(){a&&a([])}})}function h(a){var b=this,c=b.getWin();w.getInterviewPrice(function(b){w.hasEnoughMoney(b,function(b,d,e){return b?(u.alert(b.msg),a&&a(!1)):d?void(a&&a(!0,e)):(u.alert("你账户余额不足，请先充值",function(){c.nav("purchase",{action:"recharge"})}),a&&a(!1,e))})})}function i(a){var b=this,c=b.getWin();if(a.id){var d=+c.getUserByKey("interviewValidTimeSecond")||14400,e=+a.validTime||d,f=((e+d)/3600).toFixed(1);u.confirm("该任务面试总时长将扩展为"+f+"小时，是否确认延长？",function(){b.canCreateInterview(function(b){b&&y.extendInterview({type:"PUT",params:{roomId:a.id},call:function(){u.tips("操作成功"),w.refreshMoney(),a.call&&a.call()},error:function(a){u.alert(a.msg)}})})})}}function j(a){return r.map(a,function(a){return r.id(a)})||[]}function k(){var a=new s(x.appDb.interviewProject);return a.get("DB_PROJECT_CHOOSE")}function l(a){var a=r.id(a),b=new s(x.appDb.interviewProject);b.set("DB_PROJECT_CHOOSE",a)}function m(a){var b=1===+a.apiRole?"该候选人通过API创建，建议从自己的简历系统中取消该面试任务，是否继续删除？":1===+a.round?"取消后,面试房间将会被取消,面试费用将会退还到您的账户中,是否确定取消?":"取消后,候选人本轮及以后的几轮面试都将被取消,是否确定取消?";u.confirm(b,function(){y.cancelRound({type:"DELETE",params:{roomId:a.roomId,roundId:a.roundId},call:function(){u.tips("取消成功"),a.call&&a.call()},error:function(b){a.error?a.error(b.msg):u.alert(b.msg)}})})}function n(a){function b(){z.batchCancel({type:"DELETE",params:{projectId:a.projectId},body:a.cond,call:function(b){a.call&&a.call(b)},error:function(a){u.alert(a.msg)}})}return a.cond.confirm&&a.needApiAlert?void z.getApiUserCount({type:"POST",params:{projectId:a.projectId},body:a.cond,call:function(c){c.data?u.confirm("你选择的"+a.totalCount+"个面试任务中，有"+c.data+"个通过API创建，建议从自己的简历系统中取消这些面试任务，是否继续删除",b):b()},error:function(b){a.error?a.error(b.msg):u.alert(b.msg)}}):b()}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Base,s=(o.Str,o.Db),t=o.Node,u=p.Popup,v=a("./base"),w=a("./money"),x=a("../../../../core/siteConfig"),y=a("../../../../action/interview"),z=a("../../../../action/interviewV2"),A=a("../../../../action/interviewProject");c.exports=r.extend({checkProject:d,changePorject:e,getAllProject:f,getSimpleProject:g,canCreateInterview:h,addInterviewTime:i,getAllId:j,getCacheProjectId:k,setCacheProjectId:l,cancelInterview:m,batchCancelInterview:n},v)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/money",["nc","./base","../../../../action/purchase","../../../../util/ajax","cpn","../../../../action/price"],function(a,b,c){function d(a){var b=this,c=b.getUserId();k.getAccount({type:"GET",params:{userId:c},call:function(b){var c=b.data||{};a&&a(null,+c.money||0)},error:function(b){a&&a(b,0)}})}function e(a,b){{var c=this;c.getUserId()}return a=+a||0,0>=a?b&&b(null,!0):void c.getUserMoney(function(c,d){b&&b(c,d>=a,d)})}function f(){var a=this,b=a.getWin();a.getUserMoney(function(a,c){a||(b.updateUser("companyAccount.money",c),b.initAppearance())})}function g(a){l.getRealPrice({type:"GET",query:{serviceType:1},call:function(b){a&&a(b.data)},error:function(){a&&a(0)}})}var h=a("nc"),i=h.Base,j=a("./base"),k=a("../../../../action/purchase"),l=a("../../../../action/price");c.exports=i.extend({getUserMoney:d,hasEnoughMoney:e,refreshMoney:f,getInterviewPrice:g},j)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/monitor",["nc","cpn","../event","./base","../../../../action/testMonit","../../../../util/ajax","./task","../../../../action/api"],function(a,b,c){function d(a,b){var c=this;c._download({downConf:h.extend({},b,{cond:a,isDownload:!0}),isExcel:!0,title:"[下载]考试数据(Excel)_"+j.form(new Date,"yyyyMMddHHmmss")})}function e(a){function b(b){d.addTask({title:a.title||"[下载]考试数据_"+j.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return b||(e=1),2!==e?a&&a(e):void l.getTaskProgress(!0,b,function(b){var c=b.end,d=b.content,g=b.error,h=b.progress;g?(e=1,a&&a(e,h)):c?(e=0,f=d,a&&a(e,h)):a&&a(e,h)})},getResult:function(){return{type:3,data:f}}})}var c=this,d=c.getWin(),e=(c.getUserId(),2),f="",g=a.downConf.cond;g.operation="downExcel",k.downPaperTestDataExcel({body:g,type:"POST",call:function(a){return b(a.data)},error:function(){e=1}})}var f=a("nc"),g=a("cpn"),h=f.Base,i=(f.Event,a("../event"),a("./base")),j=f.Time,k=(g.Popup,a("../../../../action/testMonit")),l=a("./task");c.exports=h.extend({downloadExcel:d,_download:e},i)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/notice",["cpn","../../../../core/siteConfig"],function(a,b,c){function d(a){var b={2:"接收失败",0:"未发送",1:"接收中",3:"接收成功",4:"接收失败",100:"手机号码不存在",101:"手机号码在黑名单中",102:"信息包含敏感词",200:"邮箱不存在",201:"用户拒收",202:"用户拒收",203:"邮箱在黑名单中"};return b[a+""]}function e(a){return h.ctsStatusError[a+""]||h.ctsStatusError[2]}function f(a){var b=this,c=b.getReason(a);new i({title:"通知错误",content:['<div class="pop-recovery-content">','<p class="pop-tip">错误原因：'+c.desc+"<br/>解决办法："+c.solution,"</p>","</div>"].join(""),ok:function(){}})}var g=a("cpn"),h=a("../../../../core/siteConfig"),i=g.Popup;c.exports={getName:d,getReason:e,showReason:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/paper",["nc","cpn","./base","./task","../../../../action/api","../../../../util/ajax","./serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper"],function(a,b,c){function d(a){function b(b){c(b)&&d.setCacheProjectId(b),g&&!i&&g(b),g&&i&&d[j?"getSimpleProject":"getAllProject"]({status:a.status,isJudge:!!a.isJudge,call:function(a){g(b,a)}})}function c(a){return a&&"0"!==E.id(a)}var d=this,e=d.getWin(),f=E.id(a.id)||e.getParam().projectId;f=f&&"0"!==f?f:d.getCacheProjectId()||"0";var g=a.call,h=!!a.force,i=!!a.all,j=!!a.simple,k=c(f);k&&e.addParam({projectId:f}),k?(e.addParam({projectId:f}),b(f)):(!h&&b(f),h&&d.changePorject({call:function(a){return a?(e.addParam({projectId:a}),b(a)):void J.alert("你还没有选择面试项目，请前往选择",function(){e.nav("paper",{action:"project/index"})})},simple:j}))}function e(a){var b=this,c=a.id,d=a.call,e=!!a.simple,f=!!a.canClose;c=E.id(c),b[e?"getSimpleProject":"getAllProject"]({status:a.status,call:function(a){if(!a||0===a.length)return d();var e=H.execTpl('<a v-for="item in items" :class="cls(item)" href="javascript:void(0);" :data-id="item.id">#{item.name}</a>',{items:a,cls:function(a){return["tag-label",c&&E.id(a.id)===c?"selected":""]}});new J({width:600,title:"请先选择项目",hasNoFooter:!0,content:e,listeners:{render:function(){!f&&this.getEl().find(".pop-close").remove()},"click a.tag-label":{handler:function(a){var c=D(a.currentTarget).attr("data-id");b.setCacheProjectId(c),window.setTimeout(function(){d&&d(c)},0),this.close()}}}})}})}function f(a){P.getAllProject({type:"GET",query:{isJudge:a.isJudge||void 0},call:function(b){var c=b.data||[];E.id(a.status)&&(c=E.filter(c,function(b){return b.status===a.status})),E.isFunction(a.call)&&a.call(c)},error:function(){E.isFunction(a.call)&&a.call([])}})}function g(a){P.getAllProjectSimple({type:"GET",query:{isJudge:a.isJudge||void 0},call:function(b){var c=b.data||[];E.isFunction(a.call)&&a.call(c)},error:function(){E.isFunction(a.call)&&a.call([])}})}function h(){var a=new G(N.appDb.paperProject);return a.get("DB_PROJECT_CHOOSE")}function i(a){var b=new G(N.appDb.paperProject);b.set("DB_PROJECT_CHOOSE",E.id(a))}function j(a){var b=this,c=a.id,d=a.call;c=E.isArray(c)?c:[c];var e=b.getUserId();O.getSimplePapers({type:"GET",params:{userId:e},query:E.extend({projectIdList:c?E.without(c,0,"0"):void 0},a.ext),call:function(a){d&&d(a.data||[])},error:function(){d&&d([])}})}function k(a,b){function c(b,d){b=+b||1,O.getPapers({params:{userId:e},query:{page:b,filter:a,pageCount:100},call:function(a){var e=a.data||{};f=f.concat(e.datas||[]);var g=+e.currentPage||0,h=+e.totalPage||0;h>g?c(b+1,d):d&&d()}})}var d=this,e=d.getUserId(),f=[];c(1,function(){f.sort(function(a,b){return(b.createTime||0)-(a.createTime||0)}),b&&b(f)})}function l(a,b){var c=this;P.getSignUpFields({params:{paperId:a},query:{},call:function(a){var d=a.data||[],e=[],f={};E.forEach(d,function(a){var b=c._fieldVal(a);f[b]=f[b]||[],f[b].push(a)}),E.forEach([100,50,10,0],function(a){f[a]&&(e=e.concat(f[a]))}),b&&b(e)},error:function(a){b&&b([],a)}})}function m(a,b,c){var d=this;b=b||{},c=c||{},a=a.slice(0).sort(function(a,b){return d._fieldVal(b)-d._fieldVal(a)});var e=[];return E.forEach(a,function(a){var d=a.name,f="key"===d||"name"===d,g=D.trim(f?b[d]:c[d]||b[d]);e.push({title:a.title,val:g||""})}),e}function n(a){var b=this,c=b.getWin(),d=(b.getUserId(),2),e="",f="";O.downloadTestExcelV2({type:"POST",body:a,call:function(b){e=b.data,e&&0!==e.length||(d=1),c.addTask({title:"[下载] 成绩报表_"+(a.paperName||"")+"_"+F.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return 2!==d?a&&a(d):void L.getTaskProgress(!1,e,function(b){var c=b.end,e=b.content,g=b.error,h=b.progress;g?(d=1,a&&a(d,h)):c?(d=0,f=e,a&&a(d,h)):a&&a(d,h)})},getResult:function(){return{type:3,data:f}}})},error:function(e){if(d=1,1101===e.code){var f=JSON.parse(e.msg),g='<div style="font-size:14px;padding:20px 0;">本次导出的成绩中，有<span class="font-red">'+f.needBuyCount+'</span>名考生未在邀请名单中，需支付考试费用<span class="font-red">'+f.price+"</span>元。您账户内余额不足，无法导出该批考生成绩。现在去充值吗？</div>",h=+f.totalCount,i=+f.needBuyCount;new J({title:"余额不足",width:600,content:g,okTxt:"去充值",cancelTxt:h>i?"导出其他的":"一会儿再充",listeners:{ok:function(){c.nav("purchase",{action:"recharge"})},cancel:function(){if(h>i){var c=E.clone(a);c.confirm=1,b.downloadTestNew(c)}}}})}else J.alert(e.msg)}})}function o(a){{var b=this,c=b.getWin();b.getUserId()}O.downloadTestPDF({type:"POST",body:a,call:function(a){var b=a.data;return b&&0!==b.length?void E.forEach(b,function(a){var b=2,d="";c.addTask({title:a.fileName||"[下载] 成绩报告PDF_"+a.paperName+"_"+F.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(c){return 2!==b?c&&c(b):void L.getTaskProgress(!1,a.jobId,function(a){var e=a.end,f=a.content,g=a.error,h=a.progress;g?b=1:e&&(b=0,d=f),c&&c(b,h)})},getResult:function(){return{type:3,data:d}}})}):J.alert("提交下载任务失败")},error:function(d){if(1101===d.code){var e=JSON.parse(d.msg),f='<div style="font-size:14px;padding:20px 0;">本次导出的成绩中，有<span class="font-red">'+e.needBuyCount+'</span>名考生未在邀请名单中，需支付考试费用<span class="font-red">'+e.price+"</span>元。您账户内余额不足，无法导出该批考生成绩。现在去充值吗？</div>",g=+e.totalCount,h=+e.needBuyCount;new J({title:"余额不足",width:600,content:f,okTxt:"去充值",cancelTxt:g>h?"导出其他的":"一会儿再充",listeners:{ok:function(){c.nav("purchase",{action:"recharge"})},cancel:function(){if(g>h){var c=E.clone(a);c.confirm=1,b.downloadTestPDF(c)}}}})}else if(1006===d.code){var e=JSON.parse(d.msg),g=+e.totalCount,i=+e.noPdfCount,f='<div style="font-size:14px;padding:20px 0;">本次导出的成绩报告中，有<span class="font-red">'+i+"</span>名考生成绩报告PDF还未生成，是否导出剩余已经生成了的考生成绩报告？</div>";new J({title:"提醒",width:600,content:f,okTxt:"确认",cancelTxt:"取消",listeners:{ok:function(){var c=E.clone(a);c.pdfConfirm=1,b.downloadTestPDF(c)}}})}else J.alert(d.msg)}})}function p(a,b){var c=this,d=c.getWin(),e=P.getPaperPdfUrl({params:{paperId:a}});d.addTask({title:"[下载]"+((b||"试卷")+" pdf"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){a&&a(0)},getResult:function(){return{type:3,data:e}}})}function q(a){var b=a.type||"test",c=E.isArray(a.paperId)?a.paperId:[a.paperId];P["test"===b?"getTestUserCount":"getTestSignCount"]({params:{paperId:c[0]},body:E.extend({},a.cond,{paperIds:c}),call:function(b){a.call&&a.call(b.data)},error:a.error})}function r(a){var b=a.ids,c=a.call,d={},e=E.isArray(b);b=E.filter(e?b:[b],function(a){return!!E.id(a)});var f=b.length;if(0===f)return c&&c(d);var g=50,h=I.page(f,g);E.forCount(h,function(){var a=b.splice(0,g);P.getQuestions({query:{ids:a},call:function(a){E.forEach(a.data.datas,function(a){var b=E.id(a.id);d[b]=a})},always:function(){h--,0>=h&&c&&c(d)}})})}function s(a){function b(){P.getSubQuestion({query:{ids:d},call:function(a){E.forEach(a.data,function(a){var b=E.id(a.parentId);if(b){var c=g[b]=g[b]||{},d=c.sub=c.sub||[];d.push(a)}})},always:function(){e&&e(g)}})}var c=this,d=a.ids,e=a.call,f=E.isArray(d);if(d=E.filter(f?d:[d],function(a){return!!E.id(a)}),0===d.length)return e({});var g={};a.needQuestion?c.getQuestions({ids:d,call:function(a){E.forEach(d,function(b){var c=g[b]=g[b]||{};c.question=a[b]}),b()}}):b()}function t(a){return E.map(a,function(a){return E.id(a)})||[]}function u(a){var b=E.isArray(a.paperId)?a.paperId:[a.paperId];return b.length<=1?a.call&&a.call(!0):void P.checkSameSignUpField({query:{paperIds:b},call:function(b){a.call&&a.call(!!b.data)},error:a.error})}function v(a,b){function c(c){e.getUserCount({type:"sign",paperId:a,cond:b,call:function(a){var e=+a.totalCount||0,f=+a.agreeCount||0,g=+a.giveUpCount||0,h=f+g;if(0===h)c&&c();else if(e>h){var i=new J({content:'<div style="font-size:16px;text-align:center;">您本次共勾选了'+e+"名考生，其中"+h+"名考生已确认（"+f+"名考生确认考试，"+g+"名考生拒绝邀请，为不打扰考生，建议不要给这部分考生发送通知），是否只给其他"+(e-h)+"名未确认考生发送通知？</div>",title:"提示",cancelTxt:"通知所有考生",okTxt:"通知未确认考生",listeners:{ok:function(){b.signStatus=0,c&&c()},cancel:function(){delete b.signStatus,c&&c()}}});i.okBtn.css("width","auto").css("padding-left",5).css("padding-right",5),i.cancelBtn.css("width","auto").css("padding-left",5).css("padding-right",5)}else d({content:"您本次共勾选了"+e+"名考生均已确认（"+f+"名考生确认考试，"+g+"名考生拒绝邀请，为不打扰用户，不建议给这部分考生发送通知），是否继续发送通知？",okTxt:"继续",ok:function(){delete b.signStatus,c&&c()}})},error:function(a){J.alert(a.msg)}})}function d(a){return J.show({noUnique:!0,content:a.content,clickToHide:!1,cancelTxt:a.cancelTxt,okTxt:a.okTxt,ok:a.ok,cancel:a.cancel||function(){}})}var e=this,f=e.getWin();b=b||{},c(function(){e.getUserCount({paperId:a,cond:b,call:function(c){var e={action:"notice/send/index",paperId:a,oversea:!1,cond:b},g=+c.totalCount||0,h=+c.beganCount||0,i=+c.nativeCount||0,j=+c.overseaCount||0,k=!!c.overseaAllow;if(0===j)return f.nav("paper",e);if(0===i)return k?J.confirm("你选择的 "+j+" 名考生均使用国外号码，确定发送国际短信？",function(){e.oversea=!0,f.nav("paper",e)}):d({content:"你选择的 "+j+' 名考生均使用国外号码，需要发送国际短信，<span style="color:#fe5000">您未开通发送国际短信权限</span>(如需开通请联系客服，电话：010-60728802)，您也可以选择只给这些考生发送邮件',okTxt:"只发送邮件",ok:function(){e.onlyEmail=!0,e.oversea=!0,f.nav("paper",e)}});var l="你选择了选择"+g+"名考生"+(h>0?"("+h+"名已经进行考试)，":"，");return k?J.confirm(l+"其中 "+i+" 名使用国内号码，"+j+" 名使用国外号码，需分别发送国内、国际短信，将先为 "+i+" 名考生发送国内短信和邮件，然后为 "+j+" 名考生发送国际短信和邮件，确定先发送国内短信?",function(){e.order=!0,f.nav("paper",e)}):void d({content:l+"其中 "+i+" 名使用国内号码，"+j+" 名使用国外号码，需要给 "+j+' 名考生发送国际短信，<span style="color:#fe5000">您未开通发送国际短信权限</span>(如需开通请联系客服，电话：010-60728802)，系统将只给国际考生发送邮件，国内考生发送短信和邮件，确定发送？',ok:function(){e.mix=!0,f.nav("paper",e)}})},error:function(a){J.alert(a.msg)}})})}function w(a){function b(){var b=c.getWin();b.nav("paper",{action:"notice/addUser/index",paperId:a.id})}var c=this;a&&M.getTime(function(c){var d=Math.floor((a.beginTime-c)/864e5);if(d>=15){var e=J.confirm((0===d?"已经临近考试开始":"距离考试开始还有"+d+"天")+"，是否现在添加考生？",b);e.okBtn.html("添加考生"),e.cancelBtn.html("暂不添加")}else b()})}function x(a){function b(a){O.delPaper({type:"delete",params:{paperId:f},call:function(){J.tips("删除成功",a)},error:function(a){g(a.msg)}})}function c(a,b){J.show({noUnique:!0,content:"该试卷的部分考生已经发送过通知，是否删除试卷并发送笔试取消通知给已经通知过的考生？",type:"confirm",okTxt:"删除并通知考生",cancelTxt:"只删除试卷",ok:a,cancel:b}).getEl(".pop-footer .btn").addClass("btn-auto")}function d(a){e.getUserCount({paperId:f,call:function(b){a&&a((b||{}).noticedCount)},error:function(a){g(a.msg)}})}var e=this;a=a||{};var f=a.paperId,g=a.error||E.bind(J.alert,J);d(function(d){d>0?c(function(){J.tips("准备发送通知...",function(){e.noticeUser(E.extend({},a,{call:function(){b(a.call)}}))})},function(){b(a.call)}):b(a.call)})}function y(a){function b(){return a.needCancelNotice?g(function(b){m&&b>0?e("本次共勾选"+a.selectCount+"名考生，其中"+b+"名已经发送过笔试通知，是否发送笔试取消通知给已经通知过的考生并删除所有考生？",function(){J.tips("准备发送通知...",function(){j.noticeUser(E.extend({},a,{call:function(){c(a.call)}}))})},function(){c(a.call)}):m?c(a.call):b>0?e("该考生已经发送过笔试通知，是否发送笔试取消通知并删除考生？",function(){J.tips("准备发送通知...",function(){j.noticeUser(E.extend({},a,{call:function(){d(a.call)}}))})},function(){d(a.call)}):d(a.call)}):void(m?c(a.call):d(a.call))}function c(a){var b=J.mask("删除中，请稍等...");P.batchDeleteUsers({type:"DELETE",params:{paperId:l[0]},body:E.extend({},k,{paperIds:l}),call:function(c){L.getTaskProgress(!0,c.data,function(c){var d=c.content;if(c.error)b.close(),o(d);else if(c.end){var e=E.json(d)||{},f=["删除考生成功",e.refund?"，考试费用"+e.refund+"元已退回您的账户":""].join("");b.close(),J.tips(f,a)}})},error:function(a){b.close(),o(a.msg)}})}function d(a){var b=E.isArray(k.ids)?k.ids[0]:k.ids;P.delUser({type:"DELETE",params:{id:b,paperId:l[0]},body:{userType:0},call:function(b){J.tips(b.data||"删除成功",a)},error:function(a){o(a.msg)}})}function e(a,b,c){J.show({noUnique:!0,content:a,type:"confirm",okTxt:"删除并通知考生",cancelTxt:"只删除考生",ok:b,cancel:c}).getEl(".pop-footer .btn").addClass("btn-auto")}function f(b){var c="确定将该考生从本场考试的计划名单中删除吗？",d="该考生通过API创建，建议从自己的简历系统中删除该考生，是否继续删除？";if(!m){if(!n)return b&&b(c);if(void 0!==a.apiRole)return b&&b(1===a.apiRole?d:c);h(function(a){return b&&b(a?d:c)})}i(function(c){return b&&b(c?"你选择的"+a.selectCount+"名考生中，有"+c+"名通过API创建，建议从自己的简历系统删除这些考生，是否继续删除？":"确定将"+(a.alertPaperName||"多张试卷")+"的"+a.selectCount+"名考生删除？")})}function g(a){j.getUserCount({paperId:l,cond:k,call:function(b){a&&a((b||{}).noticedCount)},error:function(a){o(a.msg)}})}function h(a){var b=E.isArray(k.ids)?k.ids[0]:k.ids;P.ifApiUser({type:"GET",params:{paperId:l[0],userId:b},call:function(b){a&&a(!!b.data)},error:function(a){o(a.msg)}})}function i(a){P.getApiUserCount({type:"POST",params:{paperId:l[0]},body:E.extend({},k,{paperIds:l}),call:function(b){a&&a(b.data)},error:function(a){o(a.msg)}})}var j=this;a=a||{};var k=a.cond||{},l=a.paperId,m=+a.selectCount>1,n=!!a.needApiAlert,o=a.error||E.bind(J.alert,J);l=l?E.isArray(l)?l:[l]:[],f(function(a){a?J.confirm(a,b):b()})}function z(a){var b=this,c=b.getWin(),d=a.paperId,e=a.cond,f=a.paperName,g=a.error||E.bind(J.alert,J);d=d?E.isArray(d)?d:[d]:[],P.batchNoticeCancel({type:"POST",params:{paperId:d[0]},body:E.extend({},e,{paperIds:d}),call:function(b){var d=2;c.addTask({title:"[取消笔试通知]"+f,waitTxt:"发送中",okTxt:"已发送",getStatus:function(c){return 2!==d?c&&c(d):void L.getTaskProgress(!1,b.data,function(b){var e=b.content;b.error?(d=1,g(e)):b.end&&(d=0,c&&c(d),a.call&&a.call())})},getResult:function(){return{type:2}}})},error:function(a){g(a.msg)}})}function A(a){var b=a.name;return"name"===b?100:"key"===b?50:"true"===a.need||a.need===!0?10:0}var B=a("nc"),C=a("cpn"),D=B.$,E=B.Base,F=(B.Uri,B.Time),G=B.Db,H=B.Node,I=B.Num,J=C.Popup,K=a("./base"),L=a("./task"),M=a("./serverTime"),N=a("../../../../core/siteConfig"),O=a("../../../../action/api"),P=a("../../../../action/paper");c.exports=E.extend({checkProject:d,changePorject:e,getAllProject:f,getSimpleProject:g,getCacheProjectId:h,setCacheProjectId:i,getAllPaper:j,getAllFullPaper:k,getSignUpFields:l,getUserInfo:m,downloadTestNew:n,downloadTestPDF:o,downloadPdf:p,getUserCount:q,getQuestions:r,getSubQuestions:s,getAllId:t,isSameField:u,navNotice:v,navAddUser:w,delPaper:x,delPaperUser:y,noticeUser:z,_fieldVal:A},K)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/resume",["nc","cpn","../event","./base","./money","../../../../action/purchase","../../../../util/ajax","../../../../action/price","./task","../../../../action/api","../../../../action/resume","../../../../action/position","../../../../action/common"],function(a,b,c){function d(a,b){return n.filter(a,function(a){return(a||{}).status===b})}function e(a,b){var c=this;a=n.isArray(a)?a:[a],c.isBuy({cond:{ids:a,isAll:2},count:a.length,call:b})}function f(a){function b(b){v.judgeIsAllBought({body:a.cond,call:function(){a.call&&a.call()},error:function(a){return 88!==a.code?q.alert(a.msg):void(b&&b(a.data))},always:function(){f.close()}})}function c(b){var c=p.execTpl('<div style="font-size:14px;padding:20px 0;">本批简历中您有<span class="font-red">#{unBuyingCount}</span>封未解锁，是否付费后继续#{action}（需支付<span class="font-red">#{needPayMoney}</span>元）？</div>',b),d=(+b.unBuyingCount||0)+(+b.count||0)===1;c=d?p.execTpl('<div style="font-size:14px;padding:20px 0;">解锁本封邮件简历需支付<span class="font-red">#{needPayMoney}</span>元，是否付费后继续#{action}？</div>',b):c,new q({title:"付费提示",width:600,content:c,okTxt:"支付并下载",cancelTxt:d?"取消":"部分下载",render:function(){!a.isDownload||0===(+b.count||0)},listeners:{ok:function(){var c=e.showLoading("请稍等"),d=b.ids||[];v.buyResume({body:{resumeIds:d},call:function(){o.fire(r.RESUME_UPDATE),t.refreshMoney(),q.tips("支付成功",function(){a.call&&a.call()})},error:function(a){1101===a.code?q.show({content:"余额不足，操作失败",okTxt:"去充值",cancel:function(){},ok:function(){e.nav("purchase",{action:"recharge"})}}):q.alert(a.msg)},always:function(){c.close()}})},cancel:function(){!d&&a.call&&a.call({onlyBuy:!0})}}})}var d=this,e=d.getWin(),f=(d.getUserId(),e.showLoading("请稍等"));b(c)}function g(a,b){var c=this;c._download({buyConf:n.extend({},b,{cond:a,isDownload:!0}),isExcel:!0,title:(b||{}).taskTitle||"导出简历(excel)"})}function h(a,b){var c=this;c._download({buyConf:n.extend({},b,{cond:a,isDownload:!0}),title:(b||{}).taskTitle||"简历(pdf)"})}function i(a){var b=this,c=(b.getWin(),b.getUserId()),d=b.getCondById(a);b.isBuy({cond:d,count:1,action:"查看联系方式",call:function(){v.getContact({params:{resumeId:a},query:{hrId:c},call:function(a){var b=a.data||{},c=[];b.userName&&c.push("<p>姓名："+b.userName+"</p>"),b.phone&&c.push("<p>手机："+b.phone+"</p>"),b.email&&c.push("<p>邮箱："+b.email+"</p>"),new q({title:"联系方式",width:600,content:'<div style="font-size:14px;padding:20px 0;">'+c.join("<br />")+"</div>",ok:function(){}})},error:function(a){q.alert(a.msg)}})}})}function j(a){var b=n.isArray(a)?a:[a];return{isAll:2,ids:b}}function k(a){function b(b){var d=a.buyConf.cond;(b||{}).onlyBuy&&(d.isBuy=1),v[a.isExcel?"downloadExcel":"downloadResumesJob"]({body:d,type:"POST",call:function(a){var b=n.isArray(a.data)?a.data:[a.data];return b&&0!==b.length?void n.forEach(b,function(a){a&&c(a)}):q.alert("提交下载任务失败")},error:function(a){q.alert(a.msg)}})}function c(b){var c=2,d="";e.addTask({title:a.title||"[下载]简历",waitTxt:"生成中",okTxt:"点击下载",getStatus:function(e){return b||(c=1),2!==c?e&&e(c):void(a.isExcel?w.checkPrivateOssFile({query:{ossKey:b},call:function(a){var b=a.data;0===b.status&&(c=0,d=b.url),e&&e(c)},error:function(){c=1,e&&e(c)}}):u.getTaskProgress(!1,b,function(a){var b=a.end,c=a.content,f=a.error,g=a.progress,h=b?f?1:0:2;d=0===h?c:d,e&&e(h,g)}))},getResult:function(){return{type:3,data:d}}})}{var d=this,e=d.getWin();d.getUserId()}d.isBuy(n.extend({},a.buyConf,{action:"下载",call:b}))}var l=a("nc"),m=a("cpn"),n=l.Base,o=l.Event,p=l.Str,q=m.Popup,r=a("../event"),s=a("./base"),t=a("./money"),u=a("./task"),v=a("../../../../action/resume"),w=(a("../../../../action/position"),a("../../../../action/common"));c.exports=n.extend({filterStatus:d,isBuyByIds:e,isBuy:f,downloadExcel:g,download:h,showContact:i,getCondById:j,_download:k},s)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/resumeDeliver",["nc","cpn","../event","./base","./money","../../../../action/purchase","../../../../util/ajax","../../../../action/price","./task","../../../../action/api","../../../../action/resumeDeliver","../../../../action/common"],function(a,b,c){function d(a,b){var c=this;c._download({downConf:j.extend({},b,{cond:a,isDownload:!0}),isExcel:!0,title:(b||{}).taskTitle||"导出简历(excel)"})}function e(a,b){var c=this;c._download({downConf:j.extend({},b,{cond:a,isDownload:!0}),title:(b||{}).taskTitle||"简历(pdf)"})}function f(a,b,c){var d={};return j.forEach(a,function(a){return j.id(a.stage)===j.id(b)?(d.stageName=a.name,j.forEach(a.subStageList,function(a){return j.id(a.subStage)===j.id(c)?(d.subStageName=a.subName,j.BREAK):void 0}),j.BREAK):void 0}),d}function g(a){function b(b){var c=2,e="";d.addTask({title:a.title||"[下载]简历",waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return b||(c=1),2!==c?a&&a(c):void l.getTaskProgress(!1,b,function(b){var c=b.end,d=b.content,f=b.error,g=b.progress,h=c?f?1:0:2;e=0===h?d:e,a&&a(h,g)})},getResult:function(){return{type:3,data:e}}})}var c=this,d=c.getWin(),e=(c.getUserId(),a.downConf.cond);n[a.isExcel?"downloadExcelJob":"downloadResumesJob"]({body:e,type:"POST",call:function(a){var c=j.isArray(a.data)?a.data:[a.data];return c&&0!==c.length?void j.forEach(c,function(a){a&&b(a)}):void m.alert("提交下载任务失败")},error:function(a){m.alert(a.msg)}})}{var h=a("nc"),i=a("cpn"),j=h.Base,k=(h.Event,a("../event"),a("./base")),l=(a("./money"),a("./task")),m=i.Popup,n=a("../../../../action/resumeDeliver");a("../../../../action/common")}c.exports=j.extend({downloadExcel:d,download:e,getStageName:f,_download:g},k)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/resumeDoneTest",["nc","cpn","../event","./base","../../../../action/resumeDoneTest","../../../../util/ajax","./task","../../../../action/api"],function(a,b,c){function d(a,b){var c=this;c._download({downConf:i.extend({},b,{cond:a,isDownload:!0}),isExcel:!0,title:(b||{}).taskTitle||"导出做题简历(excel)"})}function e(a,b){var c=this;c._download({downConf:i.extend({},b,{cond:a,isDownload:!0}),title:(b||{}).taskTitle||"导出做题简历(pdf)"})}function f(a){function b(b){d.addTask({title:a.title||"[下载]简历",waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return b||(e=1),2!==e?a&&a(e):void l.getTaskProgress(!0,b,function(b){var c=b.end,d=b.content,g=b.error,h=b.progress;g?(e=1,a&&a(e,h)):c?(e=0,f=d,a&&a(e,h)):a&&a(e,h)})},getResult:function(){return{type:3,data:f}}})}var c=this,d=c.getWin(),e=(c.getUserId(),2),f="",g=a.downConf.cond;g.operation=a.isExcel?"downExcel":"downResume",k.asyncDo({body:g,type:"POST",call:function(a){return b(a.data)},error:function(){e=1}})}var g=a("nc"),h=a("cpn"),i=g.Base,j=(g.Event,a("../event"),a("./base")),k=(h.Popup,a("../../../../action/resumeDoneTest")),l=a("./task");c.exports=i.extend({downloadExcel:d,download:e,_download:f},j)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/serverTime",["nc","cpn","../../../../action/common","../../../../util/ajax"],function(a,b,c){function d(){var a=this;a._tickerIndex=0,a._canStart=!1,a._isFetching=!1,a.serverTime=(new Date).getTime();var b=l.frequency(1e3);b(function(c,d){a.serverTime+=c,a._ticker(),b(d)})}function e(a){var b=this;b._canStart&&a&&a(b.serverTime),!b._canStart&&b._fetchTime(a)}function f(a){var b=this;b._isFetching=!0,m.getServerTime({type:"GET",call:function(c){b._canStart=!0,b.serverTime=c.data,b._ticker(),a&&a(b.serverTime)},error:function(){a&&a(b.serverTime)}})}function g(){var a=this;return 0!==a._tickerIndex||a._canStart?(a._tickerIndex++,a._tickerIndex%o===0&&a._fetchTime(),void a.fire("nextTick",a.serverTime)):!a._isFetching&&a._fetchTime()}var h=a("nc"),i=(a("cpn"),h.$,h.Base),j=h.Clazz,k=h.Event,l=h.Time,m=a("../../../../action/common"),n=j.create(),o=60;i.extend(n.prototype,k,{initialize:d,getTime:e,_fetchTime:f,_ticker:g}),c.exports=new n});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/bll/task",["nc","./base","../../../../action/api","../../../../util/ajax","cpn"],function(a,b,c){function d(a,b,c){var d=this;h.getTaskProgress({params:{id:b},query:{},call:function(e){var f=e.data,g=!!f.end,h=!!f.error;c&&c({end:g,error:h,content:f.content,type:f.type,progress:f.progress}),!g&&a&&window.setTimeout(function(){d.getTaskProgress(a,b,c)},1e3)},error:function(){a&&window.setTimeout(function(){d.getTaskProgress(a,b,c)},1e3)}})}var e=a("nc"),f=e.Base,g=a("./base"),h=a("../../../../action/api");c.exports=f.extend({getTaskProgress:d},g)});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/conf",["nc","../../../util/switch","../../../util/util","../../../core/siteConfig"],function(a,b,c){function d(a){function b(a){var b=arguments.callee;return i.forReverse(a,function(c,d){return j.can(c.permission,c.ext)?void((c.options||[]).length>0&&b(c.options)):a.splice(d,1)}),a}var c=this,d=c._getNav(a);return b(d)}function e(){var a=[{title:"笔试",type:"written",permission:"paper",options:[{title:"笔试项目",type:"paper.project/index",cls:"sub-test-paper",permission:"paperCommon"},{title:"成绩管理",type:"paper.candidate/index/index",cls:"sub-test-score",permission:"paperCommon"},{title:"判题管理",type:"paper.judge/allocation",cls:"sub-test-judge",permission:"paperJudger"},{title:"数据报表",type:"paper.monit/index",cls:"sub-test-data",permission:"paperCommon"},{title:"新增试卷",type:"paper.addStep1",cls:"sub-test-add",permission:"paperCommon"},{title:"通知考生",type:"paper.notice/index",cls:"sub-face-add",permission:"paperCommon"}]},{title:"面试",type:"interview",permission:"interview",options:[{title:"面试项目",type:"interview.project/index",cls:"sub-face-list",permission:"interview"},{title:"通知候选人",type:"interview.notice/index",cls:"sub-face-add",permission:"interview"},{title:"面试日程表",type:"interview.calendar/index",cls:"sub-face-date",permission:"interview"}]},{title:"简历库",type:"resume",permission:"resume",options:[{title:"应聘管理",type:"resume.deliver/index/index",cls:"sub-apply-manage",permission:["resumeReferralInit","resumeReferralCts","resumeReferralInterview","resumeInit","resumeCts","resumeInterview","resumeOffer"]},{title:"职位管理",type:"resume.position/project/index",cls:"sub-job",permission:["resumeSetHomePage","resumeManageProject","resumeManageJob"]},{title:"简历统计",type:"resume.analyze/index",cls:"sub-test-data",permission:"resumeStatistics"},{title:"找简历",type:"resume.browse/index/index",cls:"sub-find-resume",permission:"resumeFind"},{title:"做题简历",type:"resume.donetest/index/index",cls:"sub-candidate",permission:"resumeDoneTest"}]},{title:"题库管理",type:"question",permission:"question",options:[{title:"我的题库",type:"question.list/index",cls:"sub-test-paper",permission:"question"},{title:"试题录入",type:"question.add/index",cls:"sub-test-add",permission:"question"}]},{title:"财务",type:"purchase",permission:"finance",options:[{title:"账户详情",type:"purchase.index",cls:"sub-finance-ctrl",permission:"finance"},{title:"充值",type:"purchase.recharge",cls:"sub-finance-add",permission:"finance"}]},{title:"设置",type:"setting",permission:"setting",options:[{title:"账户设置",type:"account.index/index",cls:"sub-set-account",permission:"setting"},{title:"笔试判题设置",type:"account.judgingSetting",cls:"sub-set-system",permission:"setting"},{title:"账号权限管理",type:"account.authority/index/index",cls:"sub-set-authority",permission:"setting"},{title:"日常通知",type:"account.notice/index",cls:"set-msg",permission:"settingDailyNotice"}]},{title:"仅测试环境可见",type:"testonly",hidden:!k,permission:k?"white":void 0,options:[{title:"测试",type:"test.index",cls:"sub-test-add",permission:k?"white":void 0},{title:"测试San模块",type:"test.san",cls:"sub-test-add",permission:k?"white":void 0},{title:"字体图标",type:"test.fonticon",cls:"sub-test-add",permission:k?"white":void 0}]}],b=[],c=(window.pageInfo||{}).menus||[],d=i.toMap(a,function(a,b){return{key:a.type,value:b}});return i.forEach(c,function(c){var e=c in d?d[c]:-1;-1!==e&&b.push(a[e]),-1!==e&&(a[e]=null)}),a=i.filter(a,function(a){return null!==a}),b=b.concat(a)}function f(a,b){var c=this,d=c._getOriginHighLight();return a&&0!==a.length?(b=b||c.getMenuTreeOption(),i.forEach(b,function(a){i.forEach(a.options,function(a){var b=d[a.type];i.forReverse(b,function(a,c){j.can(a.permission,a.ext)||b.splice(c,1)})})}),d):d}function g(){return{"paper.project/index":[{type:"paper.project/paperList",permission:"paperCommon"},{type:"paper.edit",permission:"paperCommon"},{type:"paper.editStep1",permission:"paperCommon"},{type:"paper.editStep2",permission:"paperCommon"},{type:"paper.editStep3",permission:"paperCommon"},{type:"paper.editStep4",permission:"paperCommon"},{type:"paper.editStep5",permission:"paperCommon"},{type:"paper.edit/tested/step1",permission:"paperCommon"},{type:"paper.testAccount/list/index",permission:"paperCommon"},{type:"paper.testAccount/add/index",permission:"paperCommon"},{type:"paper.testAccount/edit/index",permission:"paperCommon"},{type:"paper.copy/edit/index",permission:"paperCommon"},{type:"paper.preview/index",permission:"paperCommon"},{type:"paper.preview/menu",permission:"paperCommon"},{type:"paper.preview/detail",permission:"paperCommon"}],"paper.addStep1":[{type:"paper.addStep2",permission:"paperCommon"},{type:"paper.addStep3",permission:"paperCommon"},{type:"paper.addStep4",permission:"paperCommon"},{type:"paper.addStep5",permission:"paperCommon"}],"paper.notice/index":[{type:"paper.notice/send/index",permission:"paperCommon"},{type:"paper.notice/detail/index",permission:"paperCommon"},{type:"paper.notice/addUser/index",permission:"paperCommon"},{type:"paper.notice/editUser/index",permission:"paperCommon"},{type:"paper.notice/editUser/batch",permission:"paperCommon"}],"paper.candidate/index/index":[{type:"paper.candidate/result/index",permission:"paperCommon"}],"paper.judge/allocation":[{type:"paper.judge/index",permission:"paperCommon"},{type:"paper.judge/detail",permission:"paperJudger"},{type:"paper.judge/myWork",permission:"paperMyWork"},{type:"paper.judge/score/index",permission:"paperJudger"},{type:"paper.judge/allocate/step1/index",permission:"paperCommon"},{type:"paper.judge/allocate/step2/index",permission:"paperCommon"}],"paper.monit/index":[{type:"paper.monit/scene",permission:"paperCommon"},{type:"paper.monit/pics",permission:"paperCommon"}],"question.add/index":[{type:"question.add/step2_1/index",permission:"question"},{type:"question.add/step2_2/index",permission:"question"},{type:"question.add/step2_3/index",permission:"question"},{type:"question.add/step2_4/index",permission:"question"},{type:"question.add/step3/index",permission:"question"},{type:"question.add/step4/index",permission:"question"}],"question.list/index":[{type:"question.edit/index",permission:"question"},{type:"question.verify/index",permission:"question"}],"interview.notice/index":[{type:"interview.send/index",permission:"interview"}],"interview.project/index":[{type:"interview.group/index",permission:"interview"},{type:"interview.schedule/user/index",permission:"interview"},{type:"interview.group/setting",permission:"interview"},{type:"interview.group/uploadExcel",permission:"interview"},{type:"interview.schedule/index",permission:"interview"},{type:"interview.schedule/list/index",permission:"interview"},{type:"interview.schedule/step1/index",permission:"interview"},{type:"interview.schedule/step2/index",permission:"interview"},{type:"interview.schedule/waitList",permission:"interview"},{type:"interview.schedule/interviewingList",permission:"interview"},{type:"interview.schedule/interviewerList",permission:"interview"},{type:"interview.schedule/search/index",permission:"interview"},{type:"interview.systemSet/index",permission:"interview"}],"resume.browse/index/index":[{type:"resume.browse/preview/index",permission:"resumeFind"}],"resume.deliver/index/index":[{type:"resume.deliver/preview/index",permission:"resumeInit"},{type:"resume.deliver/checkAll/index",permission:["resumeInit","resumeCts","resumeInterview","resumeOffer"]},{type:"resume.deliver/batchInterview/index",permission:"resumeArrangeInterview"}],"resume.position/project/index":[{type:"resume.position/companyPage/index",permission:"resumeSetHomePage"},{type:"resume.position/editProject/index",permission:"resumeManageProject"},{type:"resume.position/list/index",permission:"resumeManageJob"},{type:"resume.position/editPosition/index",permission:"resumeManageJob"}],"resume.donetest/index/index":[{type:"resume.donetest/preview/index",permission:"resumeDoneTest"}],"account.index/index":[{type:"account.helper/index",permission:"setting"}],"account.authority/index/index":[{type:"account.authority/operation/index",permission:"setting"}]}}var h=a("nc"),i=h.Base,j=a("../../../util/switch"),k=(((seajs||{}).data||{}).base||"").indexOf("javascripts")>=0;c.exports={getMenuTreeOption:d,getNavHighLightAlias:f,_getNav:e,_getOriginHighLight:g,routeMap:{"paper.addStep1":"../../paper/add/step1/index","paper.addStep2":"../../paper/add/step2/index","paper.addStep3":"../../paper/add/step3/index","paper.addStep4":"../../paper/add/step4/index","paper.addStep5":"../../paper/add/step5/index","paper.edit":"../../paper/edit/index","paper.editStep1":"../../paper/add/step1/index","paper.editStep2":"../../paper/add/step2/index","paper.editStep3":"../../paper/add/step3/index","paper.editStep4":"../../paper/add/step4/index","paper.editStep5":"../../paper/add/step5/index"}}});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/event",[],function(a,b,c){c.exports={RESUME_UPDATE:"RESUME_UPDATE"}});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/partial/task",["nc","cpn"],function(a,b,c){function d(){var a=this;a.tasks=[]}function e(){var a=this,b=a.getEl();o(document).on("click",function(c){var d=c.target;a.isOpen()&&d!==b.get(0)&&!o.contains(b.get(0),d)&&a.open(!1)}),b.find("div.oprt-hd").on("click",function(){a.open(!a.isOpen())})}function f(a){var b=this;a.title=o.trim(a.title)||"未命名任务",s.isFunction(a.getStatus)&&s.isFunction(a.getResult)&&(a.okTxt=a.okTxt||"已完成",b.tasks.push(a),b.refreshList(),b.run(),window.setTimeout(s.bind(b.show,b),0))}function g(){var a=this,b="";s.forEach(a.tasks,function(a){var c=s.id(a.status)||z,d=a.result||"",e=o.trim(a.resultType||"");b+=r.execTpl(["<li>",'<a class="com-exam-title" href="javascript:void(0);">#{title}</a>',c===z?'<span class="float-right font-gray">'+(a.waitTxt||"下载中")+(a.progress?"("+a.progress+"%)":"")+"</span>":"",c===y?'<span class="float-right font-red">失败</span>':"",c!==x||"1"!==e&&"3"!==e?"":'<a href="'+d+'" class="float-right link-green" '+(!d||d.indexOf("javascript")>=0?"":'target="_blank"')+">"+a.okTxt+"</a>",c===x&&"2"===e?'<a href="javascript:void(0);" class="float-right link-green">'+a.okTxt+"</a>":"","</li>"].join(""),{title:a.title})}),a.listEl.html(b),a.fixTitle()}function h(){var a=this;if(0===a.tasks.length)a.titleEl.html("任务管理");else{var b=0,c=0,d=0;s.forEach(a.tasks,function(a){var e=s.id(a.status)||z;e===z&&b++,e===y&&c++,e===x&&d++});var e=[];b>0&&e.push("进行中:"+b),d>0&&e.push("完成:"+d),c>0&&e.push("失败:"+c),a.titleEl.html(a.tasks.length+"项任务("+e.join(",")+")")}}function i(){var a=this,b=a.getEl();b[0===a.tasks.length?"hide":"show"]()}function j(a){var b=this,c=b.getEl();b.openFrequency=b.openFrequency||u.frequency(100),b._opening||(b._opening=!0,b.openFrequency(function(){a!==!1&&c.show();var d=c.find("div.oprt-bd");d[a===!1?"hide":"show"](100,function(){c[a===!1?"removeClass":"addClass"]("open"),a!==!1&&t.scrollToElBottom(b.listEl.parent()),b._opening=!1})}))}function k(){var a=this,b=a.getEl();return b.hasClass("open")}function l(){var a=this,b=a.rawConfig;if(!a.runTimer){var c=0;window.clearTimeout(a.runTimer),a.runTimer=window.setTimeout(function(){s.forEach(a.tasks,function(d){var e=s.id(d.status)||z;e===z&&(c++,d.getStatus(function(c,f){if(e=s.id(c),d.status=e,d.progress=s.id(f),e===x){var g=d.getResult()||{};d.result=g.data,d.resultType=g.type,"3"===s.id(d.resultType)&&b.win&&b.win.getIframe().attr("src",d.result)}a.refreshList()},d))}),a.runTimer=null,c>0&&a.run()},5e3)}}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Component,q=m.Clazz,r=m.Str,s=m.Base,t=m.Dom,u=m.Time,v=n.Popup,w=c.exports=q.create(),x="0",y="1",z="2";q.mix(w,p,{_template:['<div class="subject-oprt-wrap download-wrap" style="bottom:0;top:auto;z-index:999;display:none;">','<div class="oprt-hd">','<div class="s-pannel-oprt"><a class="icon-remove" href="javascript:void(0);"></a></div>','<span class="s-pannel-title"></span>',"</div>",'<div class="oprt-bd" style="max-height:258px;overflow-y:auto;"><ul></ul></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.titleEl=b.find("span.s-pannel-title"),a.listEl=b.find("ul"),a.initClickHide(),a.fixTitle()}},{name:"click.stop a.icon-remove",handler:function(){var a=this;v.confirm("请检查所有任务是否都已完成，如有未完成任务，请勿关闭。确定现在关闭吗？",function(){a.tasks.length=0,a.refreshList(),window.clearTimeout(a.runTimer),a.runTimer=null,a.hide()})}}]},{initialize:d,initClickHide:e,add:f,refreshList:g,fixTitle:h,show:i,open:j,isOpen:k,run:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/win/attachDiscount",["nc","cpn"],function(a,b,c){function d(a){function b(){var b=d.getEl(),e=c.getEl(),f=e.outerWidth(),g=a.target.outerWidth(),h=parseInt(b.css("left"),10);h-=(f-g)/2,b.css("left",h)}a=a||{};var c=new n(a),d=m.wrap(c,{target:a.target,content:c.html(),listeners:{attachShow:b}});return c}function e(){var a=this;return a.validInfo.invalid}function f(){var a=this;return a.getEl().outerWidth()}function g(a){function b(a,b){return'<a href="javascript:void(0);" class="font-'+(b?"green":"red")+' js-nav-purchase">'+(a||0)+"</a>"}function c(){var a=d.validInfo={};return(2===f||4===f)&&(a.count=e.discountCount>0),(3===f||4===f)&&(a.time=e.validEndTime>(new Date).getTime()),a.invalid=a.count===!1||a.time===!1,a}var d=this,e=a.coupon,f=e.type,g=c(),h=["<p>折扣值：",b((e.price||0).toFixed(1),!0),"</p>",2===f||4===f?"<p>剩余折扣次数："+b(e.discountCount,g.count)+"</p>":"",3===f||4===f?"<p>有效期截止时间："+b(l.form(new Date(e.validEndTime)),g.time)+"</p>":""].join("");return{content:h}}var h=a("nc"),i=a("cpn"),j=(h.$,h.Base,h.Clazz),k=h.Component,l=h.Time,m=i.Attach,n=c.exports=j.create();j.mix(n,k,{_template:['<div class="tooltip fade bottom in">','<div class="tooltip-arrow"></div>','<div class="tooltip-inner" style="text-align:left;white-space:nowrap">#{content}</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl("a.font-red"),c=b.css("color");b.hover(function(){b.css("color",c)})}}],show:d},{isInvalid:e,getWidth:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/extend/win/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../core/moduleSan","../partial/task","./attachDiscount","../conf","../../../../util/switch","../../../../action/login","../../../../util/ajax","../../../../action/purchase"],function(a,b,c){function d(a){var b=this;return!b._win&&(b._win=new $(a)),b._win}function e(a){var b=this;b.initData(),b.initDomEvent(),b.initAppearance(),b.initTask(),b.initHelp(),b.modules=[],b.isTinyTheme=!!a.isTinyTheme,b.stylePath=window.stylePath,b.rawConfig=a,b.router=b.initRoute(),b.history=R.history,b.leftMenu=a.leftMenu,b.cloudServer=P.id(window.host||{}.cloudServer)||"0",b.isExistUser&&!b.isSubUser()&&b.initDiscount()}function f(){var a=this;a.user=P.clone(window.user)||{},a.isExistUser=!!P.id(a.user.id),W.user=a.user,X.user=a.user,a.data={authToken:window.accessToken}}function g(){var a=this,b=O("div.nowcoder-header"),c=a.user,d=c.headUrl,e=c.companyName,f=(+(c.companyAccount||{}).money||0).toFixed(2);d&&b.find("span.header-user-photo img").attr("src",d),e&&b.find("span.header-user-name").html(e),b.find("span.header-surplus span").html(f),a.isSubUser()&&(b.find(".header-surplus").hide(),b.find(".header-add-money").hide(),b.find(".js-discount").hide())}function h(){function a(a,b){return'<li class="tag-discount js-discount-'+a+'"><span class="discount-txt">'+b+"</span></li>"}var b=this,c=O("div.nowcoder-header");ab.getAccount({type:"GET",params:{userId:b.user.id},call:function(b){var d=P.isObject(b.data)?b.data:{},e=[{name:"笔试",key:"contestCoupon"},{name:"面试",key:"interviewCoupon"},{name:"简历",key:"resumeCoupon"},{name:"短信",key:"smsCoupon"},{name:"邮件",key:"emailCoupon"}],f=c.find(".js-discount"),g=!1;P.forEach(e,function(b){var e=b.name,h=b.key,i=d[h];if(P.isObject(i)){f.append(a(h,e)),g=!0;var j=c.find(".js-discount-"+h),k=Z.show({target:j,coupon:i});k.isInvalid()&&j.addClass("tag-discount-disabled")}}),g&&f.show()}})}function i(){var a=this,b=O(document.body);a.resize(),b.on("click","a",function(a){var b=O(a.currentTarget),c=b.attr("href");/^javascript:/gi.test(c)&&a.preventDefault()}),b.on("click","a.js-url",function(b){var c=O(b.currentTarget),d=c.attr("href");if(/^javascript:/gi.test(d)){var e=O.trim(c.attr("data-module")),f=O.trim(c.attr("data-param")),g=O.trim(c.attr("data-action")),h=P.json(f,{});e&&a.leftMenu&&a.leftMenu.hasPath([e,g||h.action].join("."))&&(g&&(h.action=g),a.nav(e,h))}}),b.on("click","a.js-nav-purchase",function(){a.nav("purchase")})}function j(){var a=this,b=R.Router.extend({routes:{"":"navModule","/":"navModule",":module":"navModule",":module/:param":"navModule","*error":"navError"},navModule:function(b,c){if(b=O.trim(b),!b)return a.navDefault();c=c?window.decodeURIComponent(O.trim(c)):"";var d=P.json(c,{});a.entryModule(b,d)},navError:function(){a.entryError()}});return new b}function k(){var a=this;a.taskModule=new Y({renderTo:document.body,win:a})}function l(){var a=this;U.add("help",function(){var b=window.localStorage,c=a.getUserByKey("id");delete b["HR"+c+"_ncDb_schoolData"],delete b["HR"+c+"_ncDb_ADD_PAPER"],delete b["HR"+c+"_ncDb_EDIT_PAPER"],new V({title:"问题求助",width:560,content:['<div style="font-size:14px;">','<div style="margin-bottom:20px;">如果遇到问题，请复制以下内容发送邮件到admin@nowcoder.com，方便追踪问题，谢谢！</div>',"<div>注意：以下内容包含当前账号信息，请勿随便转发</div>",'<textarea style="width:500px;height:200px;resize:none;">',JSON.stringify(b),"</textarea>","</div>"].join(""),ok:function(){},cancel:function(){}})})}function m(){R.history.start()}function n(a,b,c){var d=this;if(a=O.trim(a)){P.isString(b)&&(b={action:b}),b=b||{},b.action=b.action||"index";var e=window.encodeURIComponent(JSON.stringify(b));if(c&&c.trigger===!1)return d.router.navigate(a+(e?"/"+e:""),P.extend({trigger:!1},c));var f=d.getCurrentModule();f&&f.fire("beforeLeave");var g=f&&f.beforeLeave(a,b);g!==!0&&d.router.navigate(a+(e?"/"+e:""),P.extend({trigger:!0},c))}}function o(){var a=this,b=a.leftMenu.getOptions(),c=(((b[0]||{}).options||[])[0]||{}).type||"",d=c.split(".");a.nav(d[0],d[1])}function p(){var a=this,b=a.getLastModuleInfo();b&&a.nav(b.moduleName,b.moduleParam),!b&&a.navDefault()}function q(b,c){function d(a){document.title=a.title||"企业管理",e.resize();var d=null;if(a.isSan){d=new a({win:e,router:e.router,module:b,param:c}),e.pushModule({module:d,moduleName:b,moduleParam:c});var f=document.createElement("div");O(h)[a.renderBy||"html"](f),d.attach(f),O(f).replaceWith(d.el)}else d=new a({noRender:!0,win:e,renderTo:h,renderBy:a.renderBy||"html",router:e.router,module:b,param:c}),e.pushModule({module:d,moduleName:b,moduleParam:c}),d.render();d.goTop();var g=e.getLastModule();g&&g.destroy()}var e=this,f=c.action||"index",g=e.rawConfig,h=g.sysEl.module,i=[b||"",f].join(".");if(!e.isLogin())return e.exit();var j=e.getCurrentModule();j&&j.fire("beforeLeave"),j&&j.beforeLeave(b,c),e.showLoading(),window._hmt&&window._hmt.push&&window._hmt.push(["_trackEvent","hr","load",b,f]),e.initAppearance();var k=(g.routeMap||{})[i]||"../../"+b+"/"+f;e.taskModule&&e.taskModule.hide(),a.async(k,function(a){if(!a)return e.entryError();if(!(b&&(e.leftMenu&&e.leftMenu.hasPath(i)||e.isExistUser||a.canTempVisit)))return e.navDefault();var c=T.getParam("theme");if(a.hideLeft&&"tiny"!==c&&"tinyLeft"!==c)return void(window.location.href=T.addParam({theme:"tinyLeft"}));if(!a.hideLeft&&("tiny"===c||"tinyLeft"===c))return void(window.location.href=T.removeParam("theme"));if(a.showTask&&e.taskModule&&e.taskModule.show(),a.style||a.extStyle){var f=O("link"),g=e.joinPath(e.stylePath,a.style),h=P.map(a.extStyle,function(a){return seajs.resolve(a)});h.push(g),P.forEachAsync(h,function(a,b){seajs.request(a,b,"utf-8")},function(){P.forEach(f,function(a){a=O(a),!/ncfontcustom\.css/gi.test(a.attr("href"))&&a.remove()}),e.showLoading(!1),d(a)})}else e.showLoading(!1),d(a)})}function r(){var a=this;a.nav("status","404")}function s(){var a=this,b=a.getCurrentModuleInfo();b&&(a.router.navigate("",{trigger:!1}),a.nav(b.moduleName,b.moduleParam))}function t(a){var b=this,c=b.getCurrentModuleInfo();c&&a&&(a===c.moduleParam&&(a=P.clone(a)),delete a.action,P.extend(c.moduleParam,a),P.forEach(c.moduleParam,function(a,b){(void 0===a||null===a)&&delete c.moduleParam[b]}),b.nav(c.moduleName,c.moduleParam,{trigger:!1,replace:!0}))}function u(){var a=this,b=a.getCurrentModuleInfo();return(b||{}).moduleParam||{}}function v(a){var b=this;b.leftMenu&&b.leftMenu.openTabWithSubType(a)}function w(){return O("#jsCommonIframe")}function x(a){var b=this;a&&(b.modules.unshift(a),b.modules.length=Math.min(2,b.modules.length))}function y(){var a=this;return a.modules[0]}function z(){var a=this;return a.modules.length>1?a.modules[1]:null}function A(){var a=this,b=a.getCurrentModuleInfo();return b?b.module:null}function B(){var a=this,b=a.getLastModuleInfo();return b?b.module:null}function C(){var a=this;return a.data.authToken}function D(a,b){var c=this,d=c.user;if(a=O.trim(a)){var e=a.split("."),f=e.length;P.forEach(e,function(a,c){a=O.trim(a),a&&(c+1===f?d[a]=b:d=d[a]||{})}),c.user[a]=b}}function E(a){var b=this;a=O.trim(a);var c=b.user[a];return c||0===c?c:""}function F(){var a=this;return!(!a.user||!a.data.authToken)}function G(){var a=this;return!!a.user.subUser}function H(){var a=this;a.data=null,a.user=null,_.logout({always:function(){window.location.href="/login?logout"}})}function I(){var a="";return P.forEach(arguments,function(b,c){0===c?a=b:(!/\/$/.test(a)&&(a+="/"),/^\//.test(b)&&(b=b.replace(/^\/+/g,"")),a+=b)}),a}function J(a){var b=this;if(b.loadingMask&&b.loadingMask.close(),a!==!1){var c=a||"加载中...",d=new V({hasNoTitle:!0,hasNoMove:!0,hasNoFooter:!0,content:['<div class="confirm-content">','<div class="poptip-word">','<span class="warning-word">',c,"</span>","</div>","</div>"].join(""),width:500,clickToHide:!1});return b.loadingMask=d,d}}function K(a){var b=this;b.taskModule&&b.taskModule.add(a),b.taskModule.show()}function L(){var a=this;a.fire("resize")}var M=a("nc"),N=a("cpn"),O=M.$,P=M.Base,Q=M.Event,R=M.Nav,S=M.Clazz,P=M.Base,T=M.Uri,U=(M.Time,M.Dom,M.ShortCut),V=N.Popup,W=a("../../../../core/module"),X=a("../../../../core/moduleSan"),Y=a("../partial/task"),Z=a("./attachDiscount"),$=(a("../../../../util/util"),a("../conf"),c.exports=S.create()),_=a("../../../../action/login"),ab=a("../../../../action/purchase");P.extend($,{create:d}),P.extend($.prototype,Q,{initialize:e,initData:f,initAppearance:g,initDiscount:h,initDomEvent:i,initRoute:j,initTask:k,initHelp:l,launch:m,nav:n,navDefault:o,navBack:p,entryModule:q,entryError:r,refresh:s,addParam:t,getParam:u,selectSysMenu:v,getIframe:w,pushModule:x,getCurrentModuleInfo:y,getLastModuleInfo:z,getCurrentModule:A,getLastModule:B,getToken:C,updateUser:D,getUserByKey:E,isLogin:F,isSubUser:G,exit:H,showLoading:J,addTask:K,resize:L,joinPath:I})});
define("company/nowcoder/1.0.740/javascripts/site/main/init",["nc","cpn","../../core/module","../../util/util","../../core/siteConfig","../../component/menuTree","../../component/crumb","../../action/paper","../../util/ajax","../../util/switch","../../util/permission","./extend/conf","./extend/win/index","../../core/moduleSan","./extend/partial/task","./extend/win/attachDiscount","../../action/login","../../action/purchase","./extend/bll/base"],function(a){function b(){var a=this;if(!a.initNoSupport()){window._ncAuthToken=window.accessToken;var b=a.user=window.user||{};a.initDb(),a.initData(),b&&(B.register(b.id,u.split(b.rolePermission||"",",")),C.register(b.id,u.split(b.specialConfig||"",","))),a.initMain(),a.initResize(),a.initTips(),F.win=a.win,a.win.launch()}}function c(){function a(a){var c=['<div style="padding:20px;font-size:16px;text-align:center">','<p style="margin:0 0 10px;">',a||"您的浏览器不支持使用该功能，请升级您的浏览器","</p>",'<a href="http://www.google.cn/chrome/browser/desktop/index.html" target="_blank">Chrome</a>、','<a href="http://www.firefox.com.cn/download/" target="_blank">Firefox</a>、','<a href="http://www.apple.com/cn/safari/" target="_blank">Safari</a>',"</div>"].join("");return b.renderNone(document.body,c),!0}var b=this;if(!x.chrome()&&!x.firefox()&&!x.safari())return a();var c=window.localStorage,d="ncLocalStorageTest_"+p.id((new Date).getTime());return c[d]=d,c[d]!==d?(c.removeItem(d),a("您的浏览器无法使用本地缓存，为避免操作过程中数据丢失，请升级您的浏览器")):void c.removeItem(d)}function d(){var a=p.id((window.user||{}).id)||"",b="HR"+a+"_";r.prefix=b;try{var c=p.keys(window.localStorage);p.forEach(c,function(a){0===a.indexOf("HR")&&0!==a.indexOf(b)&&window.localStorage.removeItem(a)})}catch(d){}}function e(){{var a=this,b=t.getParam("theme");a.user}a.isExistUser=!!p.id(a.user.id),a.isTinyTheme="tiny"===b,a.hasThemeTop="tiny"!==b,a.hasThemeLeft="tiny"!==b&&"tinyLeft"!==b,a.isSubUser=!!(window.user||{}).subUser,a.isSubUser&&(a.subUserRole=(window.user||{}).roleList,a.rolePermission=((window.user||{}).rolePermission||"").split(","))}function f(){var a=this,b=(a.user||{},v.execTpl(['<div class="nk-container">','<div class="nowcoder-header" :style="headerStyle">','<div class="header-main clearfix">','<a class="nowcoder-logo" href="javascript:void(0);" title="牛客网"></a>','<div v-if="isExistUser" class="header-user-info">','<span v-if="!isSubUser" class="header-surplus">账户余额：<span></span></span>','<a v-if="!isSubUser" href="javascript:void(0);" class="header-add-money js-url" data-module="purchase" data-action="recharge">充值</a>','<ul v-if="!isSubUser" class="nowcoder-navbar nowcoder-other-nav js-discount" style="display:none;margin:0;"></ul>','<span class="header-user-name-box js-url">','<a href="javascript:void(0);" class="js-url" data-module="account" data-action="index/index">','<span class="header-user-photo"><img src="//uploadfiles.nowcoder.com/images/20151225/56_1451011385985_4A301072DEC6B6A49050E5B294CD7983"></span> ','<span class="header-user-name"></span>',"</a>",'<ul class="sub-nav">','<li><a href="//www.nowcoder.com" target="_blank" class="icon-home">牛客网首页</a></li>','<li><a :href="helperUrl" target="_blank" class="icon-question-sign">帮助中心</a></li>','<li><a href="javascript:void(0);" class="icon-power-off js-logout">退出登录</a></li>',"</ul>","</span>","</div>","</div>","</div>",'<div class="sys-container" :style="mainStyle">','<div class="sys-main">','<div class="sys-sidebar" :style="sidebarStyle"><div class="js-sys-sidebar" style="overflow-y:auto;"></div></div>','<div class="sys-content" :style="contentStyle">','<div class="js-full-content"><div class="js-sys-content"></div></div>',"</div>","</div>","</div>",'<iframe src="about:blank;" style="display:none;width:0;height:0;overflow:hidden;postion:absolute;" id="jsCommonIframe"></iframe>',"</div>"],{headerStyle:a.hasThemeTop?"":"display:none;",mainStyle:a.hasThemeTop?"":"padding-top:0;",sidebarStyle:a.hasThemeLeft?"":"display:none;",contentStyle:a.hasThemeLeft?"overflow:auto;":"overflow:auto;margin-left:0;",isExistUser:a.isExistUser,isSubUser:a.isSubUser,helperUrl:t.addParam({theme:"tinyLeft"},window.location.href.split("#")[0]+"#account/"+window.encodeURIComponent(JSON.stringify({action:"helper/index"})))}));o(document.body).append(b),a.containerDv=o("div.sys-container"),a.mainDv=a.containerDv.find("div.sys-main"),a.slideDv=a.mainDv.find("div.js-sys-sidebar");var c=a.contentDv=o("div.sys-content");a.initLeftMenu(),a.crumb=new A({renderTo:c.find("div.js-full-content"),renderBy:"prepend",render:function(){this.hide()}});var d=a.win=E.create({isTinyTheme:a.isTinyTheme,sysEl:{container:a.containerDv,main:a.mainDv,slide:a.slideDv,contentWin:a.contentDv,content:c.find("div.js-full-content"),module:c.find("div.js-sys-content")},crumb:a.crumb,leftMenu:a.menuTree,routeTempMap:D.routeTempMap,routeMap:D.routeMap});d.listen("resize",p.bind(a.resize,a)),window.win=d}function g(){var a=this,b=D.getMenuTreeOption(a.subUserRole);a.menuTree=new z({renderTo:a.slideDv,cls:"sys-sidebar-list",options:b,alias:D.getNavHighLightAlias(a.subUserRole,b),listeners:{select:function(b){var c=o.trim(b).split("."),d=o.trim(c[0]),e=o.trim(c[1]);d&&e&&a.win&&a.win.nav(d,e)}}})}function h(){var a=this,b=o(window),c=w.frequency(250);b.on("resize",function(){c(function(){a.resize();try{q.fire("winResize",b)}catch(c){s.out("winResize error:"),s.out(c)}})})}function i(){var a=w.frequency(1e3);o(document).on("mousemove",function(){a(function(){y.title(".js-tips")})})}function j(){var a=this,b=o(window),c=a.slideDv,d=a.contentDv,e=a.containerDv,f=a.mainDv;o(document.body).outerWidth(b.width()).outerHeight(b.height()).css("overflow","hidden"),e.outerWidth(b.width()).outerHeight(b.height());var g=e.height(),h=e.width();f.outerHeight(g),f.outerWidth(h),g=f.height(),h=f.width(),c.outerHeight(g),d.outerHeight(g),d.outerWidth(h-c.outerWidth())}function k(){var a=this;a.win.exit()}function l(a,b){var c='<div style="padding:20px;font-size:16px;text-align:center">'+(b||"")+"</div>";o(a).html(c)}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Base,q=m.Event,r=m.Db,s=m.Sys,t=m.Uri,u=m.Str,v=m.Node,w=m.Time,x=m.Browser,y=n.Tips,z=(a("../../core/module"),a("../../component/menuTree")),A=a("../../component/crumb"),B=(a("../../action/paper"),a("../../util/switch")),C=a("../../util/permission"),D=a("./extend/conf"),E=a("./extend/win/index"),F=a("./extend/bll/base");s.ready({initialize:b,events:{"click .js-logout":k},initNoSupport:c,initDb:d,initData:e,initMain:f,initLeftMenu:g,initResize:h,initTips:i,resize:j,renderNone:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/interviewProject","../../../../util/ajax","../../../../component/popupSub/popupIvInfo","../../../../util/interview","../../../../action/interview","../../../../component/popupSub/popupIvEdit","../../../../util/switch","../../../../component/popupSub/popupIvSucc","../../../../component/popupSub/popupJoinSession","../../../../action/interviewSchedule","../cpn/interviewSceneForm","../../../../component/dateSelect","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../component/department","../../../../action/user","../../../../action/interviewV2","../../../../action/resumeDeliver","../../../../component/popupSub/popupIvScore","../../../../component/navProject","../../../../action/calendar","../../extend/bll/interview","../../extend/bll/money","../../../../action/purchase","../../../../action/price","./rightList","./tool","./listDay","./util","./listWeek","./listMonth"],function(a,b,c){function d(){var a=this;a._cache={},a.listModule={},a.currentList=[],a.currentModule=null}function e(a){var b=this,c=b.getEl(),d=new A({renderTo:c.find(".js-project"),renderBy:"replaceWith",cls:"js-module-head",items:a,current:b.projectId,change:function(a){C.setCacheProjectId(a),b.nav("interview",{action:"calendar/index",projectId:a})}});d.getEl().css("margin",0),u.forEach(a,function(a){b.projectId===u.id(a.id)&&c.find(".js-project-remark").html(a.remark)}),"0"===b.projectId&&c.find(".js-project-remark").html("所有创建的面试项目")}function f(){var a=this,b=a.getEl(),c=a.getParam();a.toolModule=new E({renderTo:b.find(".js-calendar"),type:c.type,start:c.start,change:function(b){a.addParam({start:b.start?v.form(new Date(b.start),"yyyy-MM-dd"):null}),window.setTimeout(function(){var c=b.type,d=a.initList(c);a.addParam({type:c}),d&&(a.currentModule=d,d.val(b),a.getList(),a.resize())},0)}})}function g(a){var b=this,c=b.getEl(),d=b.listModule;a=s.trim(a);var e={day:F,week:G,month:H}[a];if(a&&e){if(u.forEach(["day","week","month"],function(a){d[a]&&d[a].hide()}),!d[a]){var f=b.getCrumb().getEl().outerHeight()+b.toolModule.getEl().outerHeight()+40;d[a]=new e({renderTo:c.find(".js-calendar"),extHeight:f,goDay:function(a){b.nav("interview",{action:"calendar/index",start:a})}})}return d[a].show(),b.resize(),d[a]}}function h(){var a=this,b=a.getWin(),c=a.getParam();a.rightModule=new D({renderTo:a.getSysEl().main,tiny:b.isTinyTheme,userId:a.getUserId(),type:c.rightType,projectId:c.projectId,projectData:a.projectData,change:function(){var b=this.val();a.addParam({rightType:b.type}),a.refreshList()}})}function i(){var a=this,b=a.getWin(),c=a.getSysEl();c.main.css("paddingRight",a.rightModule.getEl().outerWidth()),c.contentWin.css("overflow","hidden"),a.listen("beforeLeave",function(){c.main.css("paddingRight",0),c.contentWin.css("overflow","auto"),a.rightModule&&a.rightModule.destroy()}),b.resize(),a.resize()}function j(){var a=this;a.bindWinResize(function(){a.rightModule&&a.resize()})}function k(){var a=this,b=a.getParam(),c=a.toolModule.val();a.currentList=[];var d=[c.start,c.end,b.key||""].join("|");if(a._cache[d])return a.currentList=a._cache[d],void a.refreshList();var e=u.id(b.projectId)||"0";B.getInterview({params:{userId:a.getUserId()},query:{projectIdList:"0"===e?C.getAllId(a.projectData):e,beginTime:c.start,endTime:c.end,keyword:b.key||void 0},call:function(b){a._cache[d]=b.data,b.isOrder&&(a.currentList=b.data,a.refreshList())}})}function l(){var a=this,b=a.getParam(),c=a.currentModule,d=a.rightModule;if(c&&d){var e=d.val(),f=I.filterItems(a.currentList,e);c&&(c.list(f),f.length>0&&b.key&&c.goItem&&c.goItem(f[0]))}}function m(){var a=this,b=a.toolModule,c=a.getSysEl(),d=a.getCrumb().getEl(),e=a.getEl(),f=c.contentWin.height();e.outerHeight(f-d.outerHeight());var g=e.width(),h=e.height()-e.find(".js-module-head").outerHeight()-b.getEl().outerHeight(),i=b.val(),j=a.listModule[i.type];j&&j.resize&&j.resize(g,h),a.rightModule.resize()}function n(){var a=this,b=a.getParam();return{ext:[{input:{value:s.trim(b.key),placeholder:"输入名字/手机号/邮箱，回车搜索"},listeners:{ok:function(b){var c=s.trim(b.val()),d=a.getParam();b.val(c);var e=c===s.trim(d.key);e||(a.addParam({key:c||null}),a.getList())}}}]}}function o(a,b){{var c=this;c.getParam()}y.getProject({params:{projectId:a},query:{},call:function(a){var c=a.data;b&&b(c)},error:function(a){w.alert(a.msg)}})}function p(a){{var b=this;b.rawConfig}C.getSimpleProject(a)}var q=a("nc"),r=a("cpn"),s=q.$,t=(q.Event,q.Clazz),u=q.Base,v=q.Time,w=r.Popup,x=(r.Select,r.Tips,a("../../../../core/module")),y=a("../../../../action/interviewProject"),z=a("../../../../component/popupSub/popupIvInfo"),A=a("../../../../component/navProject"),B=a("../../../../action/calendar"),C=(a("../../../../action/user"),a("../../extend/bll/interview")),D=a("./rightList"),E=a("./tool"),F=a("./listDay"),G=a("./listWeek"),H=a("./listMonth"),I=a("./util"),J=c.exports=t.create();t.mix(J,x,{style:"/stylesheets/styles/system/interviewCalendar.css",title:"面试日程表",_template:['<div class="module-box" style="padding:0;">','<div class="js-project"></div>','<div class="hr-calendar js-calendar" ></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=(a.getEl(),a.getParam());C.checkProject({id:b.projectId,noForce:!0,call:function(b){a.projectId=b,a.getProjects(function(b){a.projectData=b,a.initCpn(b),a.initTool(),a.initRightList(),a.initResize(),a.initAppearance()})}})}},{name:"click .js-interview-item",handler:function(a){var b=this,c=s(a.currentTarget),d=s.trim(c.attr("data-id"));d&&z.show({id:d,projectId:b.getParam().projectId,userId:b.getUserId(),change:function(){var a=b.getParam(),c=b.toolModule.val(),d=[c.start,c.end,a.key||""].join("|");b._cache[d]=null,b.getList(),b.rightModule&&b.rightModule.refresh()}})}}]},{initialize:d,initTool:f,initList:g,initCpn:e,initRightList:h,initAppearance:i,initResize:j,getList:k,refreshList:l,resize:m,getProject:o,getProjects:p,getCrumbConf:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/listDay",["nc","cpn","../../../../util/util","../../../../core/siteConfig","./util"],function(a,b,c){function d(){for(var a=this,b=a.getEl(),c=b.find("ul.calendar-list"),d="",e=0;24>e;e++)d+=p.execTpl(['<li data-val="#{val}">','<span class="date-time">#{time}:00<br>#{desc}</span>','<div class="hr-items clearfix" data-val="#{val}"></div>',"</li>"].join(""),{val:e,time:12===e?12:e%12,desc:12>e?"上午":e>12?"下午":"中午"});c.html(d),a.hrListItems=c.find("div.hr-items"),b.on("click","li .fold-bar",function(a){var b=m(a.currentTarget),c=b.closest("li");c[c.hasClass("fold-items")?"removeClass":"addClass"]("fold-items")})}function e(){var a=this;q.forEach(a.hrListItems,function(a){m(a).html("")}),a.fixPos()}function f(a){var b=this,c=b.getEl(),d={},e={};q.forEach(a,function(a){if(a.bookTime){var b=new Date(a.bookTime),c=q.id(b.getHours());d[c]=(d[c]||"")+s.getItemStr(a),e[c]=(e[c]||0)+1}}),c.find(".fold-bar").remove(),q.forEach(b.hrListItems,function(a){a=m(a);var b=m.trim(a.attr("data-val"));a.html(d[b]||""),(+e[b]||0)>4&&(a.after('<div class="fold-bar"><a href="javascript:void(0);" class="icon-sort-down"></a><a href="javascript:void(0);" class="icon-sort-up"></a></div>'),a.parent().addClass("fold-items"))}),b.fixPos()}function g(a){var b=this,c=b.getEl();if(a&&a.bookTime){var d=new Date(a.bookTime),e=c.find("li[data-val="+d.getHours()+"]");b.scroll2li(e)}}function h(){var a=this,b=a.getEl(),c=b.find("li[data-val=8]");a.scroll2li(c)}function i(a,b){var c=this,d=c.getEl();d.outerWidth(a),d.outerHeight(b)}function j(a){var b=this,c=(b.rawConfig,b.getEl());r.scrollToEl({scrollEl:c,el:a})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Component,o=k.Clazz,p=k.Str,q=k.Base,r=k.Dom,s=(l.Popup,a("../../../../util/util"),a("./util")),t=c.exports=o.create();o.mix(t,n,{_template:['<div class="calendar-bd" style="overflow-y:scroll;">','<ul class="calendar-list"></ul>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initBase()}}]},{initBase:d,val:e,list:f,goItem:g,fixPos:h,resize:i,scroll2li:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/listMonth",["nc","cpn","./util"],function(a,b,c){function d(){for(var a=this,b=a.rawConfig,c=a.getEl(),d="",e="一二三四五六日".split(""),f=0;7>f;f++)d+='<li class="week-item"><span>'+e[f]+"</span></li>";c.find("ul.date-list").html(d),c.on("click","div.show-all-item",function(a){var c=j(a.currentTarget),d=j.trim(c.attr("data-val"));d&&b.goDay&&b.goDay(d)})}function e(a){var b=this,c=b.getEl(),d=new Date(a.start),e=d.getFullYear(),f=d.getMonth()+1,g=o.getDateItem(e,f,1),h="";n.forEach(g,function(a){h+='<li><div class="mask-box" style="margin:0"><div class="day-items">',n.forEach(a,function(a){h+=m.execTpl(['<div class="day-wrap" data-val="#{date}">',a?'<div class="hr-item day-cell">'+a+"</div>":"","</div>"].join(""),{date:a?[e,f,a].join("-"):""})}),h+="</div></div></li>"}),c.find("ul.calendar-list").html(h)}function f(a){var b=this,c=b.getEl(),d={},e={};n.forEach(a,function(a){if(a.bookTime){var b=new Date(a.bookTime),c=o.form(b,"yyyy-M-d"),f=e[c]=(e[c]||0)+1;4===f&&(d[c]+='<div class="hr-item show-all-item" data-val="'+o.form(b,"yyyy-MM-dd")+'"><a href="javascript:void(0);">+ 查看全部</a></div>'),f>3||(d[c]=(d[c]||"")+p.getItemStr(a))}}),n.forEach(c.find("ul.calendar-list div.day-wrap"),function(a){a=j(a);var b=a.find("div.hr-item.day-cell");a.html(b);var c=j.trim(a.attr("data-val"));c&&d[c]&&a.append(d[c])})}function g(a,b){var c=this,d=c.getEl();d.outerWidth(a),d.outerHeight(b),a=d.width(),b=d.height(),c.bodyEl.outerHeight(b-c.headEl.outerHeight()-10);var e=d.find("ul.date-list"),f=e.parent(),g=d.find("ul.calendar-list");f.outerWidth(a),e.outerWidth(f.width()),g.find("li div.mask-box").outerWidth(f.width());var h=Math.floor(e.width()/7);e.find("li").outerWidth(h),g.find("li div.day-wrap").outerWidth(h)}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Component,l=h.Clazz,m=h.Str,n=h.Base,o=h.Time,p=(i.Popup,a("./util")),q=c.exports=l.create();l.mix(q,k,{_template:['<div class="calendar-bd" style="overflow:hidden;">','<div class="date-week clearfix">','<div class="date-hd">','<ul class="date-list clearfix" style="margin:0;"></ul>',"</div>","</div>",'<div class="day-wrap" style="overflow:hidden;overflow-y:scroll;">','<ul class="calendar-list"></ul>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.headEl=b.find("div.date-week"),a.bodyEl=b.find("div.day-wrap"),a.initBase()}}]},{initBase:d,val:e,list:f,resize:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/listWeek",["nc","cpn","../../../../util/util","../../../../core/siteConfig","./util"],function(a,b,c){function d(){for(var a=this,b=a.getEl(),c=a.rawConfig,d="",e=0;7>e;e++)d+=p.execTpl(['<div class="day-wrap" data-val="#{val}"></div>'].join(""),{val:e});for(var f="",e=0;24>e;e++)f+=p.execTpl(['<li data-val="#{val}">','<span class="date-time">#{time}:00<br>#{desc}</span>','<div class="mask-box">','<div class="day-items">#{dayItem}</div>',"</div>","</li>"].join(""),{val:e,time:12===e?12:e%12,desc:12>e?"上午":e>12?"下午":"中午",dayItem:d});var g=b.find("ul.calendar-list");g.html(f),a.hrListLi=g.find("li"),b.on("click","div.show-all-item",function(a){var b=m(a.currentTarget),d=m.trim(b.attr("data-val"));d&&c.goDay&&c.goDay(d)})}function e(a){for(var b=this,c=b.getEl(),d=new Date(a.start),e="",f=0;7>f;f++){var g=new Date(d.getFullYear(),d.getMonth(),d.getDate()+f);e+=p.execTpl('<li class="week-item">#{date}<span>#{week}</span></li>',{date:r.form(g,"MM-dd"),week:r.getWeek(g)})}c.find("ul.date-list").html(e),b.fixPos()}function f(a){var b=this,c=(b.getEl(),{}),d={};q.forEach(a,function(a){if(a.bookTime){var b=new Date(a.bookTime),e=q.id((b.getDay()+6)%7),f=q.id(b.getHours()),g=r.form(b,"yyyy-MM-dd HH"),h=d[g]=(d[g]||0)+1;4===h&&(c[f][e]+='<div class="hr-item show-all-item" data-val="'+r.form(b,"yyyy-MM-dd")+'"><a href="javascript:void(0);">+ 查看全部</a></div>'),h>3||(c[f]=c[f]||{},c[f][e]=(c[f][e]||"")+t.getItemStr(a))}}),q.forEach(b.hrListLi,function(a){a=m(a);var b=m.trim(a.attr("data-val"));q.forEach(a.find("div.day-wrap"),function(a){a=m(a);var d=m.trim(a.attr("data-val"));a.html((c[b]||{})[d]||"")})}),b.fixPos()}function g(a){var b=this,c=b.getEl();if(a&&a.bookTime){var d=new Date(a.bookTime),e=c.find("li[data-val="+d.getHours()+"]");b.scroll2li(e)}}function h(){var a=this,b=a.getEl(),c=b.find("li[data-val=8]");a.scroll2li(c)}function i(a,b){var c=this,d=c.getEl();d.outerWidth(a),d.outerHeight(b),a=d.width(),b=d.height(),c.bodyEl.outerHeight(b-c.headEl.outerHeight()-10);var e=d.find("ul.date-list"),f=e.parent(),g=d.find("ul.calendar-list");f.css("paddingLeft","4%").outerWidth(a),e.outerWidth(f.width());var h=.96*g.width();g.find("li div.mask-box").outerWidth(Math.floor(h));var i=Math.floor(h/7);e.find("li").outerWidth(i),g.find("li div.day-wrap").outerWidth(i)}function j(a){{var b=this;b.rawConfig}s.scrollToEl({scrollEl:b.bodyEl,el:a})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Component,o=k.Clazz,p=k.Str,q=k.Base,r=k.Time,s=k.Dom,t=(l.Popup,a("../../../../util/util"),a("./util")),u=c.exports=o.create();o.mix(u,n,{_template:['<div class="calendar-bd" style="overflow:hidden;">','<div class="date-week clearfix">','<div class="date-hd">','<ul class="date-list clearfix" style="margin:0;"></ul>',"</div>","</div>",'<div class="day-wrap" style="overflow:hidden;overflow-y:scroll;">','<ul class="calendar-list"></ul>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.headEl=b.find("div.date-week"),a.bodyEl=b.find("div.day-wrap"),a.initBase()}}]},{initBase:d,val:e,list:f,goItem:g,fixPos:h,resize:i,scroll2li:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/rightList",["nc","cpn","../../../../action/calendar","../../../../util/ajax","../../extend/bll/interview","../../extend/bll/base","../../extend/bll/money","../../../../action/purchase","../../../../action/price","../../../../core/siteConfig","../../../../action/interview","../../../../action/interviewV2","../../../../action/interviewProject"],function(a,b,c){function d(a){var b=this;b.selected=[],a.renderTo=a.renderTo||p(document.body)}function e(){var a=this,b=a.getEl(),c=a.rawConfig;b.find("div.oprt-hd a").on("click",function(b){var c=p(b.currentTarget),d=p.trim(c.attr("data-type"));a.showTab(d)}),b.on("click","li.js-list-item",function(d){var e=p(d.currentTarget),f=e.find("span.icon-ok"),g=p.trim(e.attr("data-val"));if(g){var h=f.hasClass("checked");f[h?"removeClass":"addClass"]("checked"),a.selected=t.without(a.selected,g),!h&&a.selected.push(g),b.find(".js-select-all").html(a.isSelectedAll()?"取消全选":"全选"),c.change&&c.change.call(a)}}),b.on("click",".js-select-all",function(d){var e=p(d.currentTarget),f=a.isSelectedAll(),g=b.find("li.js-list-item");if(e.html(f?"全选":"取消全选"),g.find("span.icon-ok")[f?"removeClass":"addClass"]("checked"),f)a.selected.length=0;else for(var h=0,i=g.length;i>h;h++){var j=p.trim(p(g[h]).attr("data-val"));j&&a.selected.push(j)}c.change&&c.change.call(a)})}function f(a,b){var c=this,d=c.rawConfig;if(c.currentType!==a){c.currentType=a;var e=c.getEl(),f=e.find("div.oprt-hd"),g=f.find("a[data-type="+a+"]");g.length>0&&(f.find("a").removeClass("active"),g.addClass("active")),b!==!1&&(c.selected.length=0,c.getListData(a),d.change&&d.change.call(c))}}function g(a,b){var c=this,d=c.emptyEl;d[a===!1?"hide":"show"](),c.contentEl[a===!1?"show":"hide"](),a!==!1&&d.find("div.empty-tips-font").html(b||"暂无内容")}function h(a,b){var c=this,d=c.rawConfig,e=c.listCache=c.listCache||{},b=b||1,f=a+b;if(e[f])return c.renderList(e[f],a);var g={interviewer:"getInterviewer",interviewee:"getInterviewee",job:"getJob"}[a],h=t.id(d.projectId)||"0";g&&v[g]({params:{userId:d.userId},query:{page:b,projectIdList:"0"===h?w.getAllId(d.projectData):h},call:function(b){b.isOrder&&(c.renderList(b.data,a),e[f]=b.data,c.fire("renderList"))},error:function(d){d.isOrder&&(c.showNone(!0,'出现错误，<a href="javascript:void(0);" class="js-try">点击重试</a>'),c.emptyEl.find("a.js-try").one("click",function(){c.getListData(a,b)}))}})}function i(a,b){var c=this,d=c.getEl(),e=a.datas,f=b===y,g=b===z,h=b===A,i=['<div class="filter-result">',"<span>共",a.totalCount,h?"个":"人","</span>",'<a href="javascript:void(0);" class="float-right link-green js-select-all">全选</a>',"</div>",'<ul class="name-list">'].join("");f||g?(t.forEach(e,function(a){var b=f?a.interviewerName:a.intervieweeName,d=f?a.interviewerPhone:a.intervieweePhone;i+=s.execTpl(['<li class="js-list-item" data-val="#{name}">','<span class="item-name" title="#{name}">#{name}</span>','<span class="icon-ok #{chkCls}"></span>',"</li>"].join(""),{name:b,phone:d,chkCls:t.contains(c.selected,b)?"checked":""})}),i+="</ul>"):h&&t.forEach(e,function(a){i+=s.execTpl(['<li class="js-list-item" data-val="#{name}">','<span class="item-tel" title="#{name}" style="width:150px;">#{name}</span>','<span class="icon-ok #{chkCls}"></span>',"</li>"].join(""),{name:a,chkCls:t.contains(c.selected,a)?"checked":""})}),c.contentEl.html(i),c.showNone(0===e.length);var j=d.find("div.oprt-ft");j[a.totalPage>1?"show":"hide"](),e.length>0&&a.totalPage>1?new u({renderTo:j,renderBy:"html",cls:"mini-pager",noExt:!0,current:a.currentPage,total:a.totalPage||0,interval:3,render:function(){var a=this.getEl();a.css({margin:0,padding:"10px 0"}),c.resize()},pageChange:function(a){c.getListData(b,a)}}):(j.html(""),c.resize())}function j(){var a=this;return{type:a.currentType,selected:a.selected}}function k(){for(var a=this,b=a.getEl(),c=b.find("li.js-list-item"),d=0,e=c.length;e>d;d++)if(0===p(c[d]).find("span.icon-ok.checked").length)return!1;return!0}function l(){var a=this,b=(a.getEl(),a.val()),c=b.selected.slice(0);a.listCache={},a.currentType=null,a.showTab(b.type),a.selected=c}function m(){var a=this,b=a.rawConfig,c=a.getEl(),d=p(b.renderTo).height();c.outerHeight(d),d=c.height(),c.find("div.oprt-bd").outerHeight(d-c.find("div.oprt-hd").outerHeight()-c.find("div.oprt-ft").outerHeight())}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Component,r=n.Clazz,s=n.Str,t=n.Base,u=(o.Popup,o.Pager),v=a("../../../../action/calendar"),w=a("../../extend/bll/interview"),x=c.exports=r.create(),y="interviewer",z="interviewee",A="job";r.mix(x,q,{_template:['<div class="hr-filter-wrapper">','<div class="oprt-hd">','<a href="javascript:void(0);" data-type="',y,'" class="tabs-item">面试官</a>','<a href="javascript:void(0);" data-type="',z,'" class="tabs-item">候选人</a>','<a href="javascript:void(0);" data-type="',A,'" class="tabs-item">职位</a>',"</div>",'<div class="oprt-bd">','<div class="empty-tips js-none" style="padding:20px 0;text-align:center;">','<img src="//uploadfiles.nowcoder.com/images/20160713/56_1468422650883_2FFFB588E7310CB65C09FD2E21A0E834">','<p class="empty-tips-font" style="padding:10px 0;">暂无内容</p>',"</div>",'<div class="js-content"></div>',"</div>",'<div class="oprt-ft" style="position:absolute;bottom:0;padding:0;width:100%;background:#e5e5e5;display:none;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.emptyEl=c.find("div.js-none"),a.contentEl=c.find("div.js-content"),b.tiny&&c.css("top",0),a.initTab(),a.showNone(),a.resize(),a.showTab(b.type||y)}}]},{initialize:d,initTab:e,showTab:f,showNone:g,getListData:h,renderList:i,val:j,isSelectedAll:k,refresh:l,resize:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/tool",["nc","cpn"],function(a,b,c){function d(a){var b=this;b.data={type:null},b.currentDate=n.checkDate(a.start)?new Date(a.start):new Date}function e(){var a=this,b=a.data,c=a.rawConfig,d=a.getEl();d.find("span.js-tab span").on("click",function(b){var c=k(b.currentTarget),d=k.trim(c.attr("data-type")),e=a.val();a.currentDate=new Date(e.start),a.changeType(d)}),d.find("a.js-date-pre").on("click",function(){a.typeExt--,a.fixDate(b.type,a.typeExt),c.change&&c.change(a.data)}),d.find("a.js-date-next").on("click",function(){a.typeExt++,a.fixDate(b.type,a.typeExt),c.change&&c.change(a.data)}),d.find("a.js-date-now").on("click",function(){a.currentDate=new Date,a.typeExt=0,a.fixDate(b.type,a.typeExt),c.change&&c.change(a.data)})}function f(a){var b=this,c=b.rawConfig,d=b.data,e=d.type,f=b.getEl(),g=f.find("span.js-tab"),h=f.find("span[data-type="+a+"]");if(0!==h.length&&d.type!==a){if(d.type=a,b.typeExt=0,g.find("span").removeClass("active"),h.addClass("active"),a===r&&e===q){var i=b.currentDate;b.currentDate=new Date(i.getTime()+6*s)}b.fixDate(a,b.typeExt),c.change&&c.change(b.data)}}function g(a,b){var c=this;b=+b||0;var d=c.currentDate,e=c.data,f=d.getTime();if(a===p){var g=new Date(f+b*s),h=n.form(g,"yyyy-MM-dd");e.start=h+" 00:00:00",e.end=h+" 23:59:00",c.dateContentEl.html(h)}else if(a===q){var i=d.getDay(),j=new Date(f-(i+6)%7*s+7*b*s);j=new Date(j.getFullYear(),j.getMonth(),j.getDate(),8,0,0);var k=new Date(j.getTime()+6*s),h=n.form(j,"yyyy-MM-dd"),l=n.form(k,"yyyy-MM-dd");e.start=h+" 00:00:00",e.end=l+" 23:59:00",c.dateContentEl.html(h+" ~ "+l)}else if(a===r){var m=12*d.getFullYear()+d.getMonth()+b,o=m%12,t=(m-o)/12,j=new Date(t,o,1,8,0,0),k=new Date(t,o,n.getDayCount(t,o+1)),h=n.form(j,"yyyy-MM-dd"),l=n.form(k,"yyyy-MM-dd");e.start=h+" 00:00:00",e.end=l+" 23:59:00",c.dateContentEl.html(h+" ~ "+l)}}function h(){var a=this;return a.data}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=(i.Base,i.Time),o=(j.Popup,c.exports=m.create()),p="day",q="week",r="month",s=864e5;m.mix(o,l,{_template:['<div class="calendar-hd">','<span class="checked-tab js-tab">','<span data-type="day">日</span>','<span data-type="week">周</span>','<span data-type="month">月</span>',"</span>",'<span class="calendar-range">','<a href="javascript:void(0);" class="icon-angle-left js-date-pre"></a>','<span class="date js-date-content"></span>','<a href="javascript:void(0);" class="icon-angle-right js-date-next"></a>','<a href="javascript:void(0);" class="js-date-now" style="font-size:14px;margin:0 0 0 10px;">现在</a>',"</span>",'<span class="interview-tag">','<span class="i-unstart-tag">未开始</span>','<span class="i-ing-tag">进行中</span>','<span class="i-pass-tag">已结束(通过或者未评价)</span>','<span class="i-unpass-tag">已淘汰</span>','<span class="i-cancel-tag">已取消</span>',"</span>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.dateContentEl=c.find(".js-date-content"),a.initTab(),a.changeType(b.type||p)}}]},{initialize:d,initTab:e,changeType:f,fixDate:g,val:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/calendar/util",["nc"],function(a,b,c){function d(a){var b=[];a.intervieweeName&&b.push(a.intervieweeName),a.interviewerName&&b.push(a.interviewerName),a.job&&b.push(a.job);var c="";i.forEach(b,function(a){c+='<span class="txt-cell">'+a+"</span>"});var d=a.roundStatus,e=a.result,f=a.interviewStatus,g=e===p?"已淘汰":d===k&&1!=f?"未开始":d===l||d===o?"进行中":d===n||1==f?"已取消":d===m?"已结束":"",q=[],r=new Date(a.bookTime);q.push("时间: "+j.form(r)),q.push("候选人: "+(a.intervieweeName||"没有信息")),q.push("面试官: "+(a.interviewerName||"没有信息")),q.push("职位: "+(a.job||"没有信息")),g&&q.push("进度: "+g);var s="未开始"===g?"unstart-item":"进行中"===g?"ing-item":"已结束"===g?"pass-item":"已取消"===g?"cancel-item":"已淘汰"===g?"unpass-item":"";return h.execTpl(['<div class="hr-item js-tips js-interview-item #{cls}" data-id="#{id}" title="#{tips}">',"#{info}","</div>"].join(""),{id:a.interviewId,cls:s,tips:q.join("\n"),info:c})}function e(a,b){var c=g.trim(b.type),d=b.selected;if(!c||!d||0===d.length)return a;var e={};i.forEach(d,function(a){e[a]=1});var f="interviewer"===c?"interviewerName":"interviewee"===c?"intervieweeName":"job",h=i.filter(a,function(a){return!!e[a[f]]});return h}var f=a("nc"),g=f.$,h=(f.Clazz,f.Str),i=f.Base,j=f.Time,k=0,l=1,m=3,n=4,o=5,p=4;c.exports={getItemStr:d,filterItems:e}});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/interviewSceneForm",["nc","cpn","../../../../component/dateSelect","../../../../core/siteConfig"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.rawConfig,d=a.cpn={};d.nameIpt=s.transform(b.find(".js-cpn-name")),d.nameIpt.inputEl.on("keyup",function(){n.isFunction(c.getSceneByName)&&c.getSceneByName(this.value,function(b){var c=b&&n.id(b.id)!==n.id(a.sceneId)?"名字已经存在":"";a.hasSameName=!!c,d.nameIpt.setErrorTips(c)})}),d.offlineRadio=t.mix({el:b.find(".js-offline label.radio")}),d.dateSelect=new v({renderTo:a.getEl(".js-date-select"),renderBy:"html",noTime:!0,startDate:q.form(new Date,"yyyy-MM-dd"),change:function(){a.fixDate()},render:function(){var a=this;n.forEach(["startDate","startTime","endDate","endTime"],function(b){a[b]&&a[b].getEl().css("float","none")})}}),d.roundChk=n.map(b.find(".js-round-cnt label.checkbox"),function(a){return r.transform(a)}),d.strageResumeChk=r.transform(b.find(".js-interview-strategy-resume")),d.strageInitiativeChk=r.transform(b.find(".js-interview-strategy-initiative")),d.updateScoreChk=r.transform(b.find(".js-interview-update-score"));var e=b.find(".js-arrange");d.arrange=t.mix({el:e.find("label.radio")}),d.interviewerRoundCntIpt=s.transform(b.find(".js-cpn-interviewer-round-cnt"),{size:"small",placeholder:"多个编号以空格分开"}),d.interviewerRoundCntIpt.inputEl.on("keyup",function(){var a=this.value,b=a&&!n.id(a)?"只能输入整数":"";d.interviewerRoundCntIpt.setErrorTips(b)}),a.fixDate()}function e(a){var b=this,c=b.cpn;if(0===arguments.length){var d=[];n.forEach(c.roundChk,function(a,b){a.isChecked()&&d.push(b+1)});var e=c.dateSelect.val();return{sceneBegin:e.startDate?e.startDate+" 00:00:00":void 0,sceneEnd:e.endDate?e.endDate+" 23:59:59":void 0,roundListStr:b.wrapVal(d),avgInterviewRound:c.interviewerRoundCntIpt.val(),name:l.trim(c.nameIpt.val()),type:c.arrange.val(),offline:c.offlineRadio.val()||0,seeResume:c.strageResumeChk.isChecked()?!0:!1,chooseInterview:c.strageInitiativeChk.isChecked()?!0:!1,modifyEvaluation:c.updateScoreChk.isChecked()?!0:!1}}c.dateSelect.val({startDate:a.sceneBegin,endDate:a.sceneEnd}),c.interviewerRoundCntIpt.val(+a.avgInterviewRound>0?a.avgInterviewRound:""),c.nameIpt.val(a.name);var f=p.split(a.roundListStr,"_");n.forEach(f,function(a){b.cpn.roundChk[a-1].checked(!0)}),n.forEach(c.offlineRadio.option,function(b,c){b.checked(+a.offline===c)}),n.forEach(c.arrange.option,function(b,c){b.checked(+a.type==c)}),c.strageResumeChk.checked(a.seeResume),c.strageInitiativeChk.checked(a.chooseInterview),c.updateScoreChk.checked(a.modifyEvaluation),b.fixDate()}function f(){var a=this,b=a.val();if(!b.name)return u.alert("名字不能为空"),!1;if(a.hasSameName)return u.alert("名字已经存在"),!1;if(!b.sceneBegin)return u.alert("开始日期不能为空"),!1;if(!b.sceneEnd)return u.alert("结束日期不能为空"),!1;var c=[],d=!0;return n.forEach((b.roundListStr||"").split("_"),function(a){a&&c.push(a)}),0===c.length?(u.alert("请选择要面试的轮次"),!1):(n.forEach(c,function(a,b){b&&a-c[b-1]!==1&&(d=!1)}),d?!0:(u.alert("面试的轮次必须是连续的"),!1))}function g(a){var b=this;b.cpn.nameIpt.setErrorTips(a)}function h(){var a=this,b=a.cpn.dateSelect.val();return b.startDate===a.today&&b.endDate===a.today?(a.getEl(".js-fast-0").addClass("selected"),void a.getEl(".js-fast-1").removeClass("selected")):b.startDate===a.tomorrow&&b.endDate===a.tomorrow?(a.getEl(".js-fast-1").addClass("selected"),void a.getEl(".js-fast-0").removeClass("selected")):b.startDate===a.today&&b.endDate===a.tomorrow?(a.getEl(".js-fast-0").addClass("selected"),void a.getEl(".js-fast-1").addClass("selected")):(a.getEl(".js-fast-0").removeClass("selected"),void a.getEl(".js-fast-1").removeClass("selected"))}function i(a,b){return n.isArray(a)?a.length>0?a.join("_"):b:n.isString(a)?l.trim(a)||b:a}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=j.Base,o=j.Component,p=j.Str,q=j.Time,r=(k.Select,k.SelectMult,k.CheckBox),s=k.Input,t=k.CheckGroup,u=(k.AttachDate,k.Tips,k.Popup),v=a("../../../../component/dateSelect"),w=c.exports=m.create();m.mix(w,o,{_template:['<div class="set-input-wrap">','<div class="form-group">','<label class="control-label">面试场次</label>','<div class="js-cpn-name"><input type="text"></div>',"</div>",'<div class="form-group">','<label class="control-label">面试方式</label>','<div class="control-group js-offline">','<label class="radio"><input type="radio" value="0">线上视频面试</label>','<label class="radio"><input type="radio" value="1">线下现场面试</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">面试日期</label>','<div class="js-date-select" style="display:inline-block;margin-right:20px;"></div>','<a href="javascript:void(0);" class="tag-label js-fast-date js-fast-0" data-value="0">今天</a>','<a href="javascript:void(0);" class="tag-label js-fast-date js-fast-1" data-value="1">明天</a>',"</div>",'<div class="form-group interview-round-set">','<label class="control-label">面试轮次</label>','<div class="control-group js-round-cnt">','<label class="checkbox">第1轮</label>','<label class="checkbox">第2轮</label>','<label class="checkbox">第3轮</label>','<label class="checkbox">第4轮</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">面试官安排</label>','<div class="control-group js-arrange">','<label class="radio"><input type="radio" value="0" checked>面试官各轮交叉面</label>','<label class="radio"><input type="radio" value="1">面试官负责指定轮次</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">面试官权限</label>','<div class="control-group">','<label class="checkbox js-interview-strategy-resume">提前查看简历<i class="icon-question-sign js-tips" data-title="面试官可以在等待队列中查看候选人简历" data-theme="white" style="margin-left:5px;"></i></label>','<label class="checkbox js-interview-strategy-initiative">主动选择候选人<i class="icon-question-sign js-tips" data-title="面试官可以在等待队列中制定候选人提前面试" data-theme="white" style="margin-left:5px;"></i></label>','<label class="checkbox js-interview-update-score">修改评分评价<i class="icon-question-sign js-tips" data-title="面试结束后5分钟内，面试官可以修改评分评价，候选人的面试结果也将在5分钟后推送" data-theme="white" style="margin-left:5px;"></i></label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">面试官人均面试数量</label>','<div class="js-cpn-interviewer-round-cnt"><input type="text" placeholder="非必填，用于面试官任务安排"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.today=q.form(new Date,"yyyy-MM-dd"),a.tomorrow=q.form(new Date((new Date).getTime()+864e5),"yyyy-MM-dd"),a.initCpn(),a.val(a.rawConfig.data?a.rawConfig.data:{offline:"0",type:"0"})}},{name:"click .js-fast-date",handler:function(a){var b=this,c=l(a.currentTarget);c[c.hasClass("selected")?"removeClass":"addClass"]("selected");var d=b.getEl(".js-fast-date"),e=[];n.forEach(d,function(a){a=l(a),a.hasClass("selected")&&e.push(a.attr("data-value"))});var f=b.today,g=b.tomorrow;if(1===e.length){var h={0:{startDate:f,endDate:f},1:{startDate:g,endDate:g}};b.cpn.dateSelect.val(h[e[0]])}2===e.length&&b.cpn.dateSelect.val({startDate:f,endDate:g})}}]},{initCpn:d,val:e,check:f,setNameError:g,fixDate:h,wrapVal:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/popupBookedList",["nc","cpn","../../../../action/interviewSchedule","../../../../util/ajax","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new t(a),c=q.wrap(b,{content:b.html(),title:a.interviewerName+"-预约详情",width:1050,okTxt:"确定",hasScroll:!0,hasNoFooter:!0});return c.popupContent.addClass("clearfix"),b}function e(){}function f(a){var b=this,c=b.rawConfig;r.getInterviewerBookedList({params:{projectId:c.projectId,sceneId:c.sceneId},query:{page:a||1,pageSize:10,interviewerId:c.interviewerId},call:function(c){b.getEl().html(b.getStr(c.data.data)),new p({renderTo:b.getEl(),current:a,total:c.data.totalPage,pageChange:function(a){b.getInterviewerBookedList(a)}}),b.popup.fixPosition()},error:function(a){b.popup.close(),q.alert(a.msg)}})}function g(a){if(a&&a.length>0){var b={head:[{text:"姓名",width:"10%"},{text:"手机",width:"10%"},{text:"邮箱",width:"20%"},{text:"职位",width:"5%"},{text:"轮次",width:"10%"},{text:"预约时间",width:"15%"},{text:"面试开始时间",width:"15%"}],list:[]},c="---";return n.forEach(a,function(a){var d=[a.intervieweeName||c,a.intervieweePhone||c,a.intervieweeEmail||c,a.job||c,"第"+a.round+"轮",a.bookTime?o.form(new Date(a.bookTime)):c,a.beginTime?o.form(new Date(a.beginTime)):c];b.list.push({items:d})}),s.getHtml(b)}return'<div style="text-align:center;font-size:14px;">没有预约的信息</div>'}function h(a){var b="";return a>3600&&(b+=Math.floor(a/3600)+"小时",a%=3600),a>60&&(b+=Math.floor(a/60)+"分钟",a%=60),a>0&&(b+=a+"秒"),b}function i(){var a=this;return{content:a.getInterviewerBookedList(1)}}var j=a("nc"),k=a("cpn"),l=(j.$,j.Component),m=j.Clazz,n=j.Base,o=(j.Limit,j.Time),p=(j.Str,k.Pager),q=k.Popup,r=a("../../../../action/interviewSchedule"),s=a("../../../../component/table"),t=c.exports=m.create();m.mix(t,l,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){}}],show:d},{initialize:e,getStr:g,getInterviewerBookedList:f,getTimeStr:h,_getData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/popupInterviewedList",["nc","cpn","../../../../action/interviewSchedule","../../../../util/ajax","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new t(a),c=q.wrap(b,{content:b.html(),title:a.interviewerName+"-已面试详情",width:1050,okTxt:"确定",hasScroll:!0,hasNoFooter:!0});return c.popupContent.addClass("clearfix"),b}function e(){}function f(a){var b=this,c=b.rawConfig;r.getInterviewerInterviewedList({params:{projectId:c.projectId,sceneId:c.sceneId},query:{page:a||1,pageSize:10,interviewerId:c.interviewerId},call:function(c){b.getEl().html(b.getStr(c.data.data)),new p({renderTo:b.getEl(),current:a,total:c.data.totalPage,pageChange:function(a){b.getInterviewedList(a)}}),b.popup.fixPosition()},error:function(a){b.popup.close(),q.alert(a.msg)}})}function g(a){if(a&&a.length>0){var b={head:[{text:"姓名",width:"5%",style:{"min-width":"60px"}},{text:"手机",width:"10%",style:{"min-width":"90px"}},{text:"邮箱",width:"15%",style:{"min-width":"90px"}},{text:"职位",width:"30%"},{text:"轮次",width:"5%"},{text:"面试开始时间",width:"15%",style:{"min-width":"130px"}},{text:"面试结束时间",width:"15%",style:{"min-width":"130px"}},{text:"评分",width:"5%"}],list:[]},c="---";return n.forEach(a,function(a){var d=[a.intervieweeName||c,a.intervieweePhone||c,a.intervieweeEmail||c,a.job||c,"第"+a.round+"轮",a.beginTime?o.form(new Date(a.beginTime)):c,a.endTime?o.form(new Date(a.endTime)):c,a.score?a.score+"分":"未评分"];b.list.push({items:d})}),s.getHtml(b)}return'<div style="text-align:center;font-size:14px;">没有已经面试的信息</div>'}function h(a){var b="";return a>3600&&(b+=Math.floor(a/3600)+"小时",a%=3600),a>60&&(b+=Math.floor(a/60)+"分钟",a%=60),a>0&&(b+=a+"秒"),b}function i(){var a=this;return{content:a.getInterviewedList(1)}}var j=a("nc"),k=a("cpn"),l=(j.$,j.Component),m=j.Clazz,n=j.Base,o=(j.Limit,j.Time),p=(j.Str,k.Pager),q=k.Popup,r=a("../../../../action/interviewSchedule"),s=a("../../../../component/table"),t=c.exports=m.create();m.mix(t,l,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){}}],show:d},{initialize:e,getStr:g,getInterviewedList:f,getTimeStr:h,_getData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/popupJobInterviewer",["nc","cpn","../../../../action/interviewSchedule","../../../../util/ajax","../../../../action/interviewProject"],function(a,b,c){function d(a){a=a||{};var b=new u(a),c=s.wrap(b,{content:b.html(),title:a.job+"-提前面试",width:850,okTxt:"确定",hasScroll:!0,hasNoFooter:!0});return c.popupContent.addClass("clearfix"),c.fixPosition(),b}function e(){}function f(){var a=this,b=a.rawConfig,c=a.getEl();c.on("click",".js-advance-queue",function(c){var d=m(c.currentTarget),e=d.attr("data-register-id");t.advanceInterview({type:"PUT",params:{projectId:b.projectId},body:{checkId:b.checkId,registerId:e},call:function(){a.popup.close(),s.tips("已经插入到改面试官的等待队列队首",function(){b.call&&b.call()})},error:function(a){s.alert(a.msg)}})})}function g(a){var b=this,c=b.rawConfig;t.getSceneInterviewer({params:{projectId:c.projectId},query:{page:a||1,job:c.job,status:4,sceneId:c.sceneId,round:c.round},call:function(c){b.getEl().html(b.getStr(c.data.data)),new r({renderTo:b.getEl(),current:a,total:c.data.totalPage,pageChange:function(a){b.getInterviewer(a)}})},error:function(a){b.popup.close(),s.alert(a.msg)}})}function h(a){var b=this;if(a&&a.length>0){var c="<table><tbody>";return c+=["<tr>",'<th width="80">面试官姓名</th>','<th width="50">面试官邮箱</th>','<th width="50">状态</th>','<th width="170">时长</th>','<th width="60">已面人次</th>','<th width="60">待面人次</th>','<th width="60">选择</th>',"</tr>"].join(""),p.forEach(a,function(a){c+=q.execTpl(["<tr>",'<th width="170">#{name}</th>','<th width="50">#{email}</th>','<th width="50">#{status}</th>','<th width="170">#{currentInterviewDurationSecond}</th>','<th width="50">#{interviewedCount}</th>','<th width="50">#{waitInterviewCount}</th>','<th width="50"><a href="javascript:void(0);" class="btn btn-primary js-advance-queue" data-register-id="#{id}">放到队首</a></th>',"</tr>"].join(""),{id:a.id,name:a.name,email:a.email,status:"1"===p.id(a.status)?"面试中":"空闲",currentInterviewDurationSecond:a.currentInterviewDurationSecond?b.getTimeStr(a.currentInterviewDurationSecond):"-",interviewedCount:a.interviewedCount,waitInterviewCount:a.waitInterviewCount})}),c+="</table></tbody>"}return'<div style="text-align:center;font-size:14px;">没有在线的面试官</div>'}function i(a){var b="";return a>3600&&(b+=Math.floor(a/3600)+"小时",a%=3600),a>60&&(b+=Math.floor(a/60)+"分钟",a%=60),a>0&&(b+=a+"秒"),b}function j(){var a=this;return{content:a.getInterviewer(1)}}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Component,o=k.Clazz,p=k.Base,q=(k.Limit,k.Str),r=l.Pager,s=l.Popup,t=(l.Input,a("../../../../action/interviewSchedule")),u=(a("../../../../action/interviewProject"),c.exports=o.create());o.mix(u,n,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}}],show:d},{initialize:e,getStr:h,getInterviewer:g,initCpn:f,getTimeStr:i,_getData:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/round",["nc","cpn"],function(a,b,c){function d(){var a=this;a.items=[]}function e(a){var b=this,c=b.items;if(0===arguments.length)return n.map(c,function(a,b){return{round:b+1,value:a.cpn.val()}});for(;c.length<a.length;)b.createItem();for(;c.length>a.length;){var d=c.pop();d.cpn.destroy(),d.dv.remove()}n.forEach(a,function(a,b){c[b]&&c[b].cpn.val(a.value)}),b.fixItem(),b.fire("change")}function f(){var a=this,b=a.items;return n.map(b,function(a,b){return{round:b+1,text:a.cpn.text()}})}function g(){var a=this,b=k(['<div class="filter-item">','<span class="item-space js-name"></span>','<div class="js-temp"></div>','<a href="javascript:void(0);" class="icon-trash js-delete"></a>',"</div>"].join(""));a.addEl.before(b);var c=new o({renderTo:b.find(".js-temp"),renderBy:"replaceWith",size:"small",needSearch:!0,options:[{text:"未预约",value:"1"},{text:"未面试",value:"2"},{text:"进行中",value:"3"},{text:"已暂停",value:"4"},{text:"已通过",value:"5"},{text:"已淘汰",value:"6"}],listeners:{change:function(){a.fire("change")}}});a.items.push({dv:b,cpn:c})}function h(){var a=this,b=a.items,c=b.length;n.forEach(b,function(a,b){{var d=a.dv;a.cpn}d.find(".js-name").html("第"+(b+1)+"轮"),d.find(".js-delete")[c>1?"show":"hide"]()}),a.addEl[10>c?"show":"hide"]()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Str,j.SelectMult),p=(j.Input,c.exports=m.create());m.mix(p,l,{_template:['<div class="filter-cont">','<div class="filter-item js-add"><a href="javascript:void(0);" class="add-item-icon"><i class="icon-plus-sign"></i> 添加状态</a></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.addEl=b.find(".js-add"),n.forCount(3,function(){a.createItem()}),a.fixItem()}},{name:"click .js-add",handler:function(){var a=this;a.createItem(),a.fixItem(),a.fire("change")}},{name:"click .js-delete",handler:function(a){var b=this,c=b.items;if(!(c.length<=1)){var d=k(a.currentTarget),e=d.closest("div.filter-item"),f=-1;n.find(c,function(a,b){a.dv.get(0)===e.get(0)&&(f=b)});var g=c[f];g.cpn.destroy(),g.dv.remove(),c.splice(f,1),b.fixItem(),b.fire("change")}}}]},{initialize:d,val:e,valText:f,createItem:g,fixItem:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/cpn/roundOffline",["nc","cpn"],function(a,b,c){function d(){var a=this;a.items=[]}function e(a){var b=this,c=b.items;if(0===arguments.length)return n.map(c,function(a,b){return{round:b+1,value:a.cpn.val()}});for(;c.length<a.length;)b.createItem();for(;c.length>a.length;){var d=c.pop();d.cpn.destroy(),d.dv.remove()}n.forEach(a,function(a,b){c[b]&&c[b].cpn.val(a.value)}),b.fixItem(),b.fire("change")}function f(){var a=this,b=a.items;return n.map(b,function(a,b){return{round:b+1,text:a.cpn.text()}})}function g(){var a=this,b=k(['<div class="filter-item">','<span class="item-space js-name"></span>','<div class="js-temp"></div>','<a href="javascript:void(0);" class="icon-trash js-delete"></a>',"</div>"].join(""));a.addEl.before(b);var c=new o({renderTo:b.find(".js-temp"),renderBy:"replaceWith",size:"small",options:[{text:"不限",value:"0",checked:!0},{text:"视频",value:"1"},{text:"线下",value:"2"}],listeners:{change:function(){a.fire("change")}}});a.items.push({dv:b,cpn:c})}function h(){var a=this,b=a.items,c=b.length;n.forEach(b,function(a,b){{var d=a.dv;a.cpn}d.find(".js-name").html("第"+(b+1)+"轮"),d.find(".js-delete")[c>1?"show":"hide"]()}),a.addEl[10>c?"show":"hide"]()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Str,j.Select),p=(j.Input,c.exports=m.create());m.mix(p,l,{_template:['<div class="filter-cont">','<div class="filter-item js-add"><a href="javascript:void(0);" class="add-item-icon"><i class="icon-plus-sign"></i> 添加方式</a></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.addEl=b.find(".js-add"),n.forCount(3,function(){a.createItem()}),a.fixItem()}},{name:"click .js-add",handler:function(){var a=this;a.createItem(),a.fixItem(),a.fire("change")}},{name:"click .js-delete",handler:function(a){var b=this,c=b.items;if(!(c.length<=1)){var d=k(a.currentTarget),e=d.closest("div.filter-item"),f=-1;n.find(c,function(a,b){a.dv.get(0)===e.get(0)&&(f=b)});var g=c[f];g.cpn.destroy(),g.dv.remove(),c.splice(f,1),b.fixItem(),b.fire("change")}}}]},{initialize:d,val:e,valText:f,createItem:g,fixItem:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/cpn/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../cpn/round","../../cpn/roundOffline","../../../../../action/interviewProject","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this;b.isFailure="1"===v.id(a.status),b.hasOfflinePermission=B.can("interviewOffline")}function e(){var a=this,b=!!a.isFailure,c=a.rawConfig,d=a.getEl().html(""),e=c.data,f=c.field||{},g=v.toMap(e.builtInFields,function(a){return{key:a.id,value:a}}),h={id:"job",title:"职位",type:"selectMult",conf:{options:v.map(e.jobList,function(a){return{text:a,value:a}})}},i=[];v.forEach(e.sceneList,function(a){var b=v.id(a.id);i.push({text:a.name,value:b})}),i.unshift({text:"不限",value:"0",checked:!0});var j={id:"scene",title:"场次",type:"select",conf:{options:i}},k={id:"disableReason",title:"失效原因",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"过期未面试",value:"2"},{text:"人工取消面试",value:"1"}]}},l={id:"noticed",title:"是否通知",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"已通知",value:"1"},{text:"未通知",value:"2"}]}},m=[];v.forEach([{id:"create",title:"面试创建日期"},b?null:{id:"book",title:"预约日期"},b?null:{id:"start",title:"实际面试日期"}],function(a){a&&m.push({id:a.id,title:a.title,type:"duration",ext:{today:!0}})});var n={id:"round",type:"diy",create:v.bind(a.createRoundList,a),condTitle:"面试状态",condVal:function(a){return v.map(a.valText(),function(a){return"第"+a.round+"轮: "+a.text})}},o={id:"roundOffline",type:"diy",create:v.bind(a.createRoundOfflineList,a),condTitle:"面试方式",condVal:function(a){return v.map(a.valText(),function(a){return"第"+a.round+"轮: "+a.text})}},p=[],q=[{name:"work_location",id:"workLocation"},{name:"interview_location",id:"interviewLocation"},{name:"job_majar",id:"jobMajar"}];v.forEach(q,function(a){{var b=a.name;a.id}if(g[b]&&f[b]){var c=[];v.forEach(f[b],function(a){a=s.trim(a),a&&c.push({text:a,value:a})}),p.push({id:a.id,title:g[b].name,type:"selectMult",conf:{needSearch:!0,options:c}})}}),g.city&&p.push({id:"city",title:"城市",type:"selectMult",conf:{needSearch:!0,options:v.map("北京,上海,广州,深圳,杭州,南京,西安,武汉,哈尔滨,长春,成都,长沙,合肥,其他".split(","),function(a){return{text:a,value:a}})}}),g.school&&p.push({id:"school",title:"学校",type:"school"}),g.resume_id&&p.push({id:"resumeId",title:"简历编号",type:"input"});var r={id:"search",title:"关键词",type:"search",conf:{placeholder:"输入关键词搜索，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的面试，多个关键词用空格分割"}};a.filter=new x({renderTo:d,submitTxt:"查询",line:[{border:!0,items:[h,j,b?k:null,b?l:null]},{border:!0,fold:!0,items:m},b?null:{border:!0,fold:!0,items:[n]},b||!a.hasOfflinePermission?null:{border:!0,fold:!0,items:[o]},{border:!0,fold:!0,items:p},{fold:!0,items:[r]}],clearAll:function(){a.val({})},listeners:{submit:v.bind(a.submit,a)}})}function f(){var a=this,b=a.val();a.check()&&a.fire("submit",b)}function g(a){var b=this,c=b.isFailure,d=b.filter,e=d.getItem("job"),f=d.getItem("scene"),g=d.getItem("disableReason"),h=d.getItem("noticed"),i=d.getItem("create"),j=d.getItem("book"),k=d.getItem("start"),l=d.getItem("round"),m=d.getItem("workLocation"),n=d.getItem("interviewLocation"),o=d.getItem("jobMajar"),q=d.getItem("city"),r=d.getItem("school"),s=d.getItem("resumeId"),t=d.getItem("search"),u=d.getItem("roundOffline");if(0===arguments.length){var a={jobList:b.wrapVal(e.val()),sceneId:b.wrapVal(f.val()),disableReason:c?b.wrapVal(g.val()):p,noticed:c?b.wrapVal(h.val()):p,begin:c?p:b.wrapDuration(k.startIpt,!0),end:c?p:b.wrapDuration(k.endIpt),bookBegin:c?p:b.wrapDuration(j.startIpt,!0),bookEnd:c?p:b.wrapDuration(j.endIpt),createBegin:b.wrapDuration(i.startIpt,!0),createEnd:b.wrapDuration(i.endIpt),keywordUnion:t.chk.isChecked()?1:p,keywordList:b.wrapVal(b.split(t.ipt.val())),roundJson:c?p:JSON.stringify(l.val()),offlineJson:c||!b.hasOfflinePermission?p:JSON.stringify(u.val()),workLocationListStr:m?b.wrapVal(m.val()):p,interviewLocationListStr:n?b.wrapVal(n.val()):p,jobMajarListStr:o?b.wrapVal(o.val()):p,cityListStr:q?b.wrapVal(q.val()):p,schoolListStr:r?b.wrapVal(r.val().split(",")):p,resumeKeyList:s?b.wrapVal(b.split(s.val())):p};return a}if(e.val((a.jobList||"").split("_")),f.val(a.sceneId||"0"),c&&g.val(a.disableReason||"0"),c&&h.val(a.noticed||"0"),v.forEach([c?p:{cpn:k,begin:"begin",end:"end"},c?p:{cpn:j,begin:"bookBegin",end:"bookEnd"},{cpn:i,begin:"createBegin",end:"createEnd"}],function(b){if(b){var c=b.cpn;c.todayChk.checked(!1),c.todayChk.fire("change"),c.startIpt.val(a[b.begin]||""),c.endIpt.val(a[b.end]||"")}}),t.chk.checked(!!a.keywordUnion),t.ipt.val((a.keywordList||"").split("_").join(" ")),!c&&l.val(v.json(a.roundJson)||[{value:"0"},{value:"0"},{value:"0"}]),!c&&b.hasOfflinePermission&&u.val(v.json(a.offlineJson)||[{value:"0"},{value:"0"},{value:"0"}]),q&&q.val((a.cityListStr||"").split("_")),r){var w=(a.schoolListStr||"").split("_").join(",");r.val(w).getEl().attr("title",w)}s&&s.val((a.resumeKeyList||"").split("_").join(" ")),b.submit()}function h(){return!0}function i(a,b,c){a.removeClass().prepend('<label class="filter-label-left">面试状态</label>'),c.cpn=new y({renderTo:a})}function j(a,b,c){a.removeClass().prepend('<label class="filter-label-left">面试方式</label>'),c.cpn=new z({renderTo:a})}function k(a){var b=(a||"").split(/\s+/),c=v.without(b,"");return c}function l(a,b){return v.isArray(a)?(a=v.without(a,""),a.length>0?a.join("_"):b):v.isString(a)?s.trim(a)||b:a}function m(a){return s.trim(a).replace(/[^\d]+/g,"")}function n(a,b){return a.val()?a.val()+(b?" 00:00:00":" 23:59:59"):p}function o(){var a=this,b=a.filter.getItem("scene"),c=b.val(),d=a.rawConfig.projectId;A.getCondition({params:{projectId:d},query:{},call:function(a){var d=a.data.sceneList,e=[];v.forEach(d,function(a){var b=v.id(a.id);e.push({text:a.name,value:b})}),e.unshift({text:"不限",value:"0"}),b.replaceOptions(e),b.val(c)},error:function(a){w.alert(a.msg)}})}var p,q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Component,v=q.Base,w=(q.Str,r.Popup),x=a("../../../../../component/filter/filter"),y=a("../../cpn/round"),z=a("../../cpn/roundOffline"),A=a("../../../../../action/interviewProject"),B=a("../../../../../util/switch"),C=c.exports=t.create();t.mix(C,u,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter()}}]},{initialize:d,initFilter:e,submit:f,val:g,check:h,createRoundList:i,createRoundOfflineList:j,split:k,wrapVal:l,wrapNum:m,wrapDuration:n,updateScene:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/cpn/list",["nc","cpn","../../../../../util/util","../../../../../core/siteConfig","../../../../../util/interview","../../../../../component/selectAll","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../util/ajax","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interview","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../../../component/popupSub/popupIvScore","../../../../../action/common","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/interview","./popupTransfer"],function(a,b,c){function d(a){var b=this;b.parent=a.parent,b.listData={}}function e(){var a=this,b=a.getEl();a.selectAll=new V({dealId:function(a){return a},change:function(b){a.listEl.find(".js-td-checkbox")[b?"addClass":"removeClass"]("checked")},toggle:function(b,c){a.listEl.find(".js-td-checkbox-"+b)[c?"addClass":"removeClass"]("checked")}}),b.on("click",".js-td-checkbox",function(b){var c=a.getLineId(b.currentTarget);c&&a.selectAll.toggle(c)})}function f(){var a=this,b=a.rawConfig,c=a.getEl();a.pageSelect=new R({renderTo:c.find(".js-tmp-page"),renderBy:"replaceWith",size:"xsmall",options:[{text:"20",value:20,checked:!0},{text:"50",value:50},{text:"100",value:100}],change:H.bind(a.load,a)});var d=H.id(b.status)||"0",e='<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchExcel">导出面试记录</a></li>';"0"===d&&(e=['<li><a href="javascript:void(0);" class="js-goto-notice">群发通知</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchExcel">导出面试记录</a></li>',"0"===a.getProjectId()?"":['<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchEdit">批量修改</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchNewRound">批量预约下一轮</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchJoinSession">加入到场次</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchTransfer">转移项目</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-action" data-method="actionBatchCancel">批量取消</a></li>'].join("")].join("")),c.find(".js-menu").html(e)}function g(a){var b=this;a=a||{},b.selectAll.clear(),b.load(a.data,a.refreshPage?null:b.page,a.call)}function h(a,b,c){var d=this;d.condition=a||d.condition,d.renderWait(),d.page=b||1,Y.search({params:{projectId:d.getProjectId()},body:d.getCond(d.page),call:function(b){var e=b.data||{};return 0!==e.totalPage&&e.currentPage>e.totalPage?(d.page=e.totalPage,d.load(a,d.page,c)):(d.renderList(e),void(c&&c()))},error:function(a){a.isOrder&&d.renderWait(a.msg)}})}function i(a){var b=this,c=b.getEl(),d='共<span class="font-green js-count">'+a.totalCount+"</span>份";c.find("span.js-count").html(d)}function j(a){{var b=this;b.parent.getParam()}a=a||{};var c="";if(a.totalCount<=0)return c=['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip">暂无面试信息</div>',"</div>"].join(""),void b.listEl.html(c);b.renderTotal(a);var c='<div class=" js-select-tips" role="alert"></div>';H.forEach(a.data,function(a){b.listData[a.id]=a,c+=b.getItemHtml(a)}),b.listEl.html(c),b.actionEl.show(),T.copy(b.listEl.find(".js-copy"),function(){M.tips("复制成功")});var d=H.map(a.data,function(a){return L.str(a.id)}),e=b.selectAll;b.getEl().find("div.with-checkbox-select").append(e.getEl()),e.refreshEl(),e.render(),e.tipsEl=b.listEl.find("div.js-select-tips"),e.loadPage(d,!0),e.changePageCount(a.totalPage),e.changeTotalCount(a.totalCount),new N({renderTo:b.listEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.load(null,a,function(){P.scrollToEl({scrollEl:b.parent.getSysWinEl(),el:b.listEl})})}}),b.initUpload()}function k(){var a=this;a.actionEl.hide(),a.listEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">没有符合条件的面试</div>',"</div>"].join(""))}function l(a){var b=this,c=b.rawConfig,d=H.map(U.getIntervieweeInfo(a),function(a){return"<span>"+L.encodeHTML(a)+"</span>"}),e=a.rounds,f=U.getRoundHtml(a);return Q.execTpl(['<div class="panel js-list-item" :data-id="item.id" :data-interviewerPwd="item.interviewerPwd">','<div class="panel-hd">','<div class="panel-oprt">','<a v-if="item.resumeUrl" :href="resumeUrl" target="_blank" class="link-green">查看简历</a>','<span v-else-if="itemStatus.normal" style="display:inline-block;position:relative;" class="js-upload" data-type="resume"><a class="link-green" href="javascript:void(0);">上传简历</a></span>','<a v-if="item.testResultUrl" :href="testResultUrl" target="_blank" class="link-green">查看笔试报告</a>','<span v-else-if="itemStatus.normal" style="display:inline-block;position:relative;" class="js-upload"><a class="link-green" href="javascript:void(0);">上传笔试报告</a></span>',"</div>",'<h3 class="panel-title">','<label :class="getChkCls(item)"><span class="icons"></span></label>',"<span class=\"jobhunter\">#{item.intervieweeName || '面试候选人'}</span>",'<span class="jobhunter-info">#{infoHtml}</span>','<span v-if="isSelfInterview" class="jobhunter-info"><span>#{item.roundNote}</span></span>',"</h3>","</div>",'<div class="panel-bd interview-detail">','<div class="interview-btn-wrapper exem-over">','<a v-if="itemStatus.cancel" href="javascript:void(0);" class="btn btn-primary btn-disabled">已取消</a>','<span v-else-if="itemStatus.timeout">','<a href="javascript:void(0);" class="invalid-time"><i class="icon-time"></i>已超时</a>','<a v-if="itemStatus.canAddTime" href="javascript:void(0);" class="invalid-time link-green js-action-add-time">重新开启</a>',"</span>",'<a v-else-if="itemStatus.overdue" href="javascript:void(0);" class="invalid-time"><i class="icon-time"></i>已失效</a>','<a v-else-if="itemStatus.expired" href="javascript:void(0);" class="invalid-time"><i class="icon-time"></i>已结束</a>','<span v-else-if="itemStatus.fail">','<a href="javascript:void(0);" class="invalid-time"><i class="icon-obsolete"></i>已淘汰</a>','<a href="javascript:void(0);" class="invalid-time link-green js-action-edit">继续预约</a>',"</span>","</div>",'<ul class="interview-add">','<li v-if="showType != \'1\'">面试官地址：<a :href="itemUrl.hr" target="_blank">#{itemUrl.hr}</a> <a href="javascript:void(0);" :data-clipboard-text="itemUrl.hr" class="link-green js-copy">复制</a></li>','<li v-if="showType != \'1\'">候选人地址：<a :href="itemUrl.user" target="_blank">#{itemUrl.user}</a> <a href="javascript:void(0);" :data-clipboard-text="itemUrl.user" class="link-green js-copy" >复制</a></li>','<li v-if="showType != \'0\'">面试官线下地址：<a :href="itemUrl.hrOffline" target="_blank">#{itemUrl.hrOffline}</a> <a href="javascript:void(0);" :data-clipboard-text="itemUrl.hrOffline" class="link-green js-copy" >复制</a></li>',"</ul>","#{roundHtml}","</div>","</div>"],{item:a,itemStatus:U.getStatus(a),itemUrl:U.getUrl(a.id,a.interviewerPwd,a.intervieweePwd),isSelfInterview:"2"===H.id(c.projectType),showType:U.isAllOnLine(e)?"0":U.isAllOffline(e)?"1":"2",getChkCls:function(a){return["checkbox","js-td-checkbox","js-td-checkbox-"+a.id]},resumeUrl:T.getPdfOnlineUrl("查看简历",a.resumeUrl),testResultUrl:T.getPdfOnlineUrl("查看笔试报告",a.testResultUrl),infoHtml:d.join("<span>|</span>"),roundHtml:f})}function m(){var a=this;H.forEach(a.listEl.find("span.js-upload"),function(b){b=G(b);var c=b.closest("div.panel"),d=c.attr("data-id"),e=c.attr("data-interviewerPwd"),f="resume"===b.attr("data-type");if(d&&e){var g=S.show({target:b,url:T.getUploadUrl(5),fileType:"*.doc;*.docx;*.pdf;",call:function(a){var c=G.trim(a.data);if(c){var g=T.getPdfOnlineUrl("查看"+(f?"简历":"笔试报告"),c);b.replaceWith('<a href="'+g+'" target="_blank" class="link-green">查看'+(f?"简历":"笔试报告")+"</a>"),Z[f?"saveResumeUrl":"saveTestResultUrl"]({type:"PUT",params:{roomId:d},body:H.extend({code:e},f?{saveResumeUrl:c}:{saveTestResultUrl:c})})}}});a.pushChild(g)}})}function n(a){var b=this;b.actionEl.hide(),b.listEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(a||"加载中...")+"</div>","</div>"].join(""))}function o(){var a=this;return a.parent.getProjectId()}function p(a){var b=this,c=b.rawConfig,d=b.getProjectId(),e=H.extend({},b.condition,{currentPage:a||1,pageSize:b.pageSelect.val()});return e.projectIdList="0"===d?bb.getAllId(c.projectData):d,e}function q(){var a=this,b=a.rawConfig,c=a.selectAll,d=a.getProjectId(),e=H.extend({},a.condition,{projectId:a.getProjectId(),isAll:c.isSelectAll?1:2,ids:c.selectIds.join("_")});return e.projectIdList="0"===d?bb.getAllId(b.projectData):d,e}function r(a){var b=G(a).closest("div.js-list-item");return G.trim(b.attr("data-id"))}function s(a){var b=this,c=G(a).closest("div.js-round"),d=b.getLineId(a);return{room:d,id:c.attr("data-id"),round:c.attr("data-round")}}function t(a){var b=this,c=b.rawConfig;a&&W.show({id:a,projectId:b.getProjectId(),departmentData:c.departmentData,call:function(){b.reload({call:function(){b.scroll2interview(a)}})}})}function u(a){var b=this,c=b.listData[a]||{};bb.addInterviewTime({id:a,validTime:c.validTime||0,call:function(){b.reload()}})}function v(a){var b=this,c=b.listData[a.room],d=(c||{}).rounds||[],e=H.find(d,function(b){return b.id===+a.id});e&&X.show({room:a.room,id:a.id,round:a.round,score:e.score,desc:e.evaluation,interviewerName:e.interviewerName,interviewerPwd:c.interviewerPwd,needAll:!0,call:function(f){var g=H.id(d.length)===a.round;b.reload({call:function(){b.scroll2interview(c.id)}});var h=g&&(+e.score||0)<=2&&(+f.score||0)>2;h&&new M({title:"修改评分成功",content:['<div class="pop-content">','<div class="pop-interview"><div class="ico-success"><i class="fui-check-inverted"></i></div></div>','<div style="padding-top:20px;font-size:14px;text-align:center;">已将候选人修改为第'+a.round+"轮通过状态，可以为候选人预约下一轮</div>",'<div class="pop-btn-wrapper">','<a href="javascript:void(0);" class="btn btn-primary confirm-btn">预约下一轮</a>','<a href="javascript:void(0);" class="btn btn-primary js-close-popup">返回列表</a>',"</div>","</div>"].join(""),listeners:{ok:function(){b.actionEditItem(c.id)}}})}})}function w(a){var b=this;if(a.room&&a.id){var c=b.listData[a.room];bb.cancelInterview({apiRole:c.apiRole,round:a.round,roomId:a.room,roundId:a.id,call:function(){ab.refreshMoney(),b.reload()}})}}function x(a){function b(a){var b=c.parent.getProject()||{};d.addTask({title:"[下载]面试记录_"+(b.name||"")+"_"+O.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(b){return a||(e=1),2!==e?b&&b(e):void $.checkPrivateOssFile({query:{ossKey:a},call:function(a){var c=a.data;0===c.status&&(e=0,f=c.url),b&&b(e)},error:function(){e=1,b&&b(e)}})},getResult:function(){return{type:3,data:f}}})}var c=this,d=c.parent.getWin(),e=2,f="";Y.downloadExcel({params:{projectId:c.getProjectId()},body:a,type:"POST",call:function(a){var c=H.isArray(a.data)?a.data:[a.data];return c&&0!==c.length?void H.forEach(c,function(a){a&&b(a)}):(e=1,b())},error:function(){e=1}})}function y(a){var b=this;if(K.set("interviewV2FilterCond",a),!a)return M.alert("请检查选择参数");var c=b.parent.getWin();Y.checkBatchUpdateCondition({type:"POST",params:{projectId:b.getProjectId()},body:a,call:function(a){var d=c.showLoading("检查中...");_.getTaskProgress(!0,a.data,function(a){var c=a.end,e=a.content,f=a.error;if(f){d.close();var g=JSON.parse(e);if("1"===H.id(g.code))M.alert(g.msg);else if("2"===H.id(g.code)){var h=+g.totalCount,i=+g.illegalCount;M.confirm("很抱歉，在您选中的"+h+"条面试中有"+i+"条可能正在进行中或已经结束，无法修改。是否确定修改其他的"+(h-i)+"条？",function(){b.parent.nav("interview",{action:"group/uploadExcel",projectId:b.getProjectId(),type:2})})}}else c&&(d.close(),b.parent.nav("interview",{action:"group/uploadExcel",projectId:b.getProjectId(),type:2}))})},error:function(a){M.alert(a.msg)}})}function z(a,b){var c=this;if(!a)return M.alert("请检查选择参数");var d=c.selectAll,e=d.isSelectAll?d.totalCount-d.selectIds.length:d.selectIds.length;a.confirm=b,bb.batchCancelInterview({projectId:c.getProjectId(),cond:a,totalCount:e,call:function(d){var e=M.mask(b?"取消中...":"检查中...");_.getTaskProgress(!0,d.data,function(b){var d=b.end,f=b.content,g=b.error;if(g){e.close();var h=JSON.parse(f);return void("1"===H.id(h.code)?M.alert(h.msg):"2"===H.id(h.code)&&M.confirm(h.msg,function(){c.actionBatchCancel(a,1)}))}d&&(e.close(),ab.refreshMoney(),c.reload())})}})}function A(a){var b=this;K.set("interviewV2FilterCond",a),b.parent.nav("interview",{action:"group/uploadExcel",projectId:b.getProjectId(),type:3})}function B(a){var b=this;db.show({cond:a,projectId:b.getProjectId(),module:b.parent,ok:function(){var a=b.rawConfig;a.updateFilterScene&&a.updateFilterScene()}})}function C(a){var b=this,c=b.selectAll,d=c.isSelectAll?c.totalCount-c.selectIds.length:c.selectIds.length;cb.show({cond:a,curProjectId:b.getProjectId(),totalCount:d,module:b.parent,refresh:function(){b.reload()},getPopup:function(){}})}function D(a){var b=this,c=b.getEl(".js-list-item[data-id="+a+"]");P.scrollToEl({scrollEl:b.parent.getSysWinEl(),el:c,animation:!0})}var E=a("nc"),F=a("cpn"),G=E.$,H=E.Base,I=E.Component,J=E.Clazz,K=E.Db,L=E.Str,M=F.Popup,N=F.Pager,O=E.Time,P=E.Dom,Q=E.Node,R=F.Select,S=(F.CheckBox,F.AttachUpload),T=a("../../../../../util/util"),U=a("../../../../../util/interview"),V=a("../../../../../component/selectAll"),W=a("../../../../../component/popupSub/popupIvEdit"),X=a("../../../../../component/popupSub/popupIvScore"),Y=(a("../../../../../action/interviewProject"),a("../../../../../action/interviewV2")),Z=a("../../../../../action/interview"),$=a("../../../../../action/common"),_=a("../../../extend/bll/task"),ab=a("../../../extend/bll/money"),bb=a("../../../extend/bll/interview"),cb=a("./popupTransfer"),db=a("../../../../../component/popupSub/popupJoinSession"),eb=c.exports=J.create();J.mix(eb,I,{_template:["<div>",'<div class="interview-oprt clearfix">','<div class="menu-txt-box js-action">','<ul class="menu-txt clearfix js-menu"></ul>',"</div>",'<div class="result-info js-action">','<div class="with-checkbox-select"></div>','<span class="result-num js-count"></span>','<span>每页显示 <div class="js-tmp-page"></div></span>',"</div>","</div>",'<div class="manage-bd js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.actionEl=b.find("div.js-action"),a.listEl=b.find("div.js-list"),a.initSelectAll(),a.initCpn(),a.renderNone()}},{name:"click .js-action-edit",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);b.actionEditItem(c)}},{name:"click .js-action-score",handler:function(a){var b=this,c=b.getLineRoundId(a.currentTarget);b.actionScoreRound(c)}},{name:"click .js-action-cancel",handler:function(a){var b=this,c=b.getLineRoundId(a.currentTarget);b.actionCancelRound(c)}},{name:"click .js-action-add-time",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);b.actionAddTimeItem(c)}},{name:"click .js-batch-action",handler:function(a){var b=this,c=b.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return M.alert("请先勾选想要操作的名单，你可通过全选按钮快速选中全部名单。");var d=G(a.currentTarget),e=G.trim(d.attr("data-method")),f=b.getBatchCond();e&&b[e]&&b[e](f)}},{name:"click .js-goto-notice",handler:function(){var a=this;a.parent.nav("interview",{action:"notice/index",projectId:a.getProjectId()})}}]},{initialize:d,initSelectAll:e,initCpn:f,reload:g,load:h,renderTotal:i,renderList:j,renderNone:k,renderWait:n,initUpload:m,getProjectId:o,getCond:p,getBatchCond:q,getLineId:r,getLineRoundId:s,getItemHtml:l,actionEditItem:t,actionAddTimeItem:u,actionScoreRound:v,actionCancelRound:w,actionBatchExcel:x,actionBatchEdit:y,actionBatchCancel:z,actionBatchNewRound:A,actionBatchJoinSession:B,actionBatchTransfer:C,scroll2interview:D})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/cpn/popupTransfer",["nc","cpn","../../../../../action/interviewProject","../../../../../util/ajax","../../../../../action/interviewV2","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){var b=this;a=b.rawConfig=a||{},b.getProjectData()}function e(){var a=this;t.getAllSimpleProjects({type:"GET",call:function(b){a.projectData=b.data,a.cookData()},error:function(a){r.alert(a.msg)}})}function f(){var a=this,b=a.projectData,c=a.projectMap={},d=a.projectOption=[],e=a.rawConfig.curProjectId;q.forEach(b,function(a){c[a.id]=a,a.id!==e&&d.push({value:a.id,text:a.name})}),a.initPopup()}function g(){var a=this,b=a.projectOption;if(0===b.length)return void r.alert("没有可供转移的其他项目！");var c=a.rawConfig;q.extend(c,{_aProjectData:a.projectData,_oProjectMap:a.projectMap,_aProjectOption:a.projectOption});{var d=a.main=new w(c);r.wrap(d,{title:"面试转移至",width:750,cancelTxt:"取消",content:d.html(),ok:function(){a.clickOk()},cancel:function(){}})}c.getPopup&&c.getPopup(d)}function h(){var a=this,b=a.main.selectedId,c=a.projectMap[b].name,d=a.rawConfig.totalCount,e=["本次将有",d,'条面试转移至项目"',c,'"确定转移吗？'].join("");r.confirm(e,function(){a.batchTransfer()})}function i(){var a=this,b=a.rawConfig,c=q.extend(b.cond,{targetProjectId:a.main.selectedId});u.batchTransferProject({type:"PUT",params:{projectId:b.curProjectId},body:c,call:function(b){a.taskData=b.data,a.showTask()},error:function(a){r.alert(a.msg)}})}function j(){var a=this,b=a.rawConfig,c=b.module.getWin(),d=c.showLoading("检查中...");v.getTaskProgress(!0,a.taskData,function(a){var c=a.end,e=a.content,f=a.error;if(f){d.close();var g=JSON.parse(e);return r.alert(g.msg),void b.refresh()}c&&(d.close(),r.tips("转移成功"),b.refresh())})}function k(){var a=this,b=a.rawConfig;a.projectSelectCpn=new s({renderTo:a.getEl(),autoWidth:!0,needSearch:!0,options:b._aProjectOption,change:function(){var b=this.val();a.selectedId=b}})}function l(){var a=this,b=a.rawConfig,c=(b._aProjectOption[0]||{}).value;a.projectSelectCpn.val(c),a.selectedId=c}var m=a("nc"),n=a("cpn"),o=(m.$,m.Component),p=m.Clazz,q=m.Base,r=(n.Input,n.CheckBox,n.Popup),s=n.Select,t=(n.Switch,a("../../../../../action/interviewProject")),u=a("../../../../../action/interviewV2"),v=a("../../../extend/bll/task"),w=c.exports=p.create();p.mix(w,o,{_template:'<div style="width:100%;text-align:center;"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initSelectCpn(),a.initSelectVal()}}],show:d,getProjectData:e,cookData:f,initPopup:g,clickOk:h,batchTransfer:i,showTask:j},{initSelectCpn:k,initSelectVal:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","./cpn/filter","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../action/common","../../../../util/ajax","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","../cpn/round","../cpn/roundOffline","../../../../action/interviewProject","../../../../util/switch","./cpn/list","../../../../util/interview","../../../../component/selectAll","../../../../component/popupSub/popupIvEdit","../../../../component/popupSub/popupIvSucc","../../../../component/popupSub/popupJoinSession","../../../../action/interviewSchedule","../cpn/interviewSceneForm","../../../../component/dateSelect","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../component/department","../../../../action/user","../../../../action/interview","../../../../action/interviewV2","../../../../action/resumeDeliver","../../../../component/popupSub/popupIvScore","../../extend/bll/money","../../../../action/purchase","../../../../action/price","../../extend/bll/interview","./cpn/popupTransfer","../../../../component/navProject"],function(a,b,c){function d(){var a=this;a.page=0,a.pageCount=20}function e(){{var a=this,b=a.getEl();a.getProjectId()}a.recycle(),a.renderWait(b),a.getCond(function(b){a.getCondField(b,function(c){a.initContainer(),a.initCpn(b,c),a.initVal()})})}function f(){var a=this,b=a.getEl(),c=a.getParam(),d=a.status=x.id(c.status)||"0";b.html(['<div class="module-box interview-list">','<div class="js-project-nav"></div>','<div class="menu-box menu-line-box" style="margin:10px 20px 0;">','<ul class="menu clearfix" style="margin-left:20px">','<li class="'+("0"===d?"selected":"")+'"><a href="javascript:void(0);" class="js-tab-action js-select-btn" data-status="0">有效</a></li>','<li class="'+("1"===d?"selected":"")+'"><a href="javascript:void(0);" class="js-tab-action js-select-btn" data-status="1">已失效</a></li>',"</ul>","0"===a.getProjectId()?"":['<div class="menu-oprtbar">','<a href="javascript:void(0);" class="btn btn-primary btn-xs js-tab-action" data-method="actionCreateItem" style="padding:5px;width:auto;">新建面试</a>','<a href="javascript:void(0);" class="btn btn-primary btn-xs js-tab-action" data-method="actionCreateBatch" style="padding:5px;width:auto;">名单批量导入</a>','<a href="javascript:void(0);" class="interview-field-manage js-tab-action" data-method="actionScene">现场管理</a>','<div class="filter-setting">','<a href="javascript:void(0);" class="link-green"><i class="icon-cog"></i> 设置</a>','<div class="tooltip bottom tooltip-info">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">','<ul><li class="js-tab-action" data-method="actionCandidate">候选人信息</li></ul>',"</div>","</div>","</div>","</div>"].join(""),"</div>",'<div class="module-body">','<div class="js-filter"></div>','<div class="js-list"></div>',"</div>","</div>"].join(""))}function g(a,b){var c=this,d=c.getEl(),e=c.getProjectId(),f=c.getProject();new F({renderTo:d.find(".js-project-nav"),renderBy:"replaceWith",items:c.projects,current:e,change:function(a){H.setCacheProjectId(a),c.addParam({projectId:a}),c.initProject()}}),c.listModule=new B({renderTo:d.find("div.js-list"),renderBy:"html",data:a,parent:c,status:c.status,projectType:f.type,projectData:c.projects,departmentData:c.departmentData,updateFilterScene:function(){c.filterModule.updateScene&&c.filterModule.updateScene()}}),c.filterModule=new A({renderTo:d.find("div.js-filter"),data:a,field:b,projectId:e,status:c.status,listeners:{submit:function(a){a.status=c.status,c.listModule.reload({data:a,refreshPage:!0})}}})}function h(){var a=this,b=a.getParam();a.filterModule.val({jobList:b.jobList,sceneId:b.sceneId,roundJson:b.roundJson})}function i(){var a=this;a.getDepartment(function(b){E.show({projectId:a.getProjectId(),departmentData:b,call:function(){G.refreshMoney(),a.listModule.reload()}})},function(a){y.alert(a)})}function j(){var a=this;a.nav("interview",{action:"group/uploadExcel",projectId:a.getProjectId(),type:1})}function k(){var a=this;a.nav("interview",{action:"schedule/index",projectId:a.getProjectId()})}function l(){var a=this;a.nav("interview",{action:"group/setting",projectId:a.getProjectId()})}function m(a){var b=this,c=b.getProjectId();return"0"===c?a&&a({}):void C.getCondition({params:{projectId:c},query:{},call:function(b){a&&a(b.data)},error:function(a){y.alert(a.msg)}})}function n(a,b){var c=this,d=c.getProjectId(),e=[],f=x.toMap(a.builtInFields,function(a){return{key:a.id,value:!0}});return f.work_location&&e.push("work_location"),f.interview_location&&e.push("interview_location"),f.job_majar&&e.push("job_majar"),0===e.length?b&&b({}):void C.getConditionFiled({params:{projectId:d},query:{builtInFieldNames:e},call:function(a){return b&&b(a.data)},error:function(a){y.alert(a.msg)}})}function o(){var a=this,b=a.getProjectId();return"0"===b?{id:b,name:"全部项目",type:0}:x.find(a.projects,function(a){return x.id(a.id)===b})}function p(a){var b=this;H.getSimpleProject(function(c){b.projects=c,a&&a()})}function q(){var a=this,b=a.getParam();return x.id(b.projectId)||"0"}function r(a,b){var c=this;return c.departmentData?x.isFunction(a)&&a(c.departmentData):void D.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getParam().projectId,entityType:32},call:function(b){var d=b.data||[];c.departmentData=d,x.isFunction(a)&&a(d)},error:function(a){x.isFunction(b)&&b(a.msg)}})}function s(){var a=this,b=a.getParam(),c=x.extend({action:"project/index"});return c.projectId=b.projectId,{crumb:[{title:"面试项目",module:"interview",param:c}]}}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Clazz,x=t.Base,y=u.Popup,z=a("../../../../core/module"),A=a("./cpn/filter"),B=a("./cpn/list"),C=a("../../../../action/interviewProject"),D=(a("../../../../action/price"),a("../../../../action/user")),E=a("../../../../component/popupSub/popupIvEdit"),F=a("../../../../component/navProject"),G=a("../../extend/bll/money"),H=a("../../extend/bll/interview"),I=c.exports=w.create();w.mix(I,z,{style:"/stylesheets/styles/system/interview.css",title:"面试清单",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();a.renderWait(b),H.checkProject({id:c.projectId,noForce:!0,call:function(b){H.setCacheProjectId(b),a.getProjects(function(){a.getDepartment(function(){b!==c.projectId&&a.addParam({projectId:b}),a.initProject()})})}})}},{name:"click .js-tab-action",handler:function(a){var b=this,c=v(a.currentTarget),d=v.trim(c.attr("data-method"));d&&b[d]&&b[d](c)}},{name:"click a.js-select-btn",handler:function(a){var b=this,c=v(a.currentTarget),d=c.attr("data-status");b.addParam({status:d}),b.initProject()}}]},{initialize:d,initProject:e,initContainer:f,initCpn:g,initVal:h,actionCreateItem:i,actionCreateBatch:j,actionScene:k,actionCandidate:l,getCond:m,getCondField:n,getProject:o,getProjects:p,getProjectId:q,getDepartment:r,getCrumbConf:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/setting",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../component/popupSub/popupCommon","../../extend/bll/interview","../../extend/bll/base","../../extend/bll/money","../../../../action/purchase","../../../../util/ajax","../../../../action/price","../../../../action/interview","../../../../action/interviewV2","../../../../action/interviewProject"],function(a,b,c){function d(){var a=this;a.fetchData(function(b){var c=[{id:"name",name:"姓名"},{id:"job",name:"职位"},{id:"phone",name:"手机"},{id:"email",name:"邮箱"},{id:"deliverId",name:"投递编号"}];a.itemData={all:[],map:{},chkMap:{}},a.initTpl(b),a.initList(c,b.builtInFieldList,b.selfDefinedFieldList)})}function e(a){var b=this,c=p.execTpl(['<div class="module-head clearfix">',"<h2>","#{projectName}",'<a href="javascript:void(0);" class="exchange-project link-green js-change-project"><i class="icon-random"></i> 切换项目</a>',"</h2>","</div>",'<div class="module-body">','<div class="info-setting-pannel">',"<p>本设置应用于创建在线面试时需录入的候选人信息，方便导出成绩时进行数据处理。</p>",'<div class="setting-pannel-wrapper js-chk-group"></div>','<a href="javascript:void(0);" class="set-add-btn js-add-btn"><i class="icon-plus-sign"></i>自定义内容</a>',"</div>",'<div class="btn-set-wrapper"><a href="javascript:void(0);" class="btn btn-primary js-save-btn">保存</a></div>',"</div>"].join(""),{projectName:a.projectName});b.getEl().html(c)}function f(a,b,c){var d=this;q.forEach(a,function(a){a.isSys=!0;var b=d._createChk(a);b.disabled()}),q.forEach(b,function(a){a.isBuild=!0,d._createChk(a)}),q.forEach(c,function(a){a.id=q.ascId(),d._createChk(a)})}function g(a){var b=this,c=b.itemData,d=b._getItemByName(a);return d?(s.alert("该内容已经存在，无需添加",function(){var a=d.id,b=c.chkMap[a];b.checked(!0)}),!1):void b._createChk({id:q.ascId(),name:a,select:!0})}function h(a){var b=this,c=b.getParam();w.getTemplate({type:"GET",params:{projectId:c.projectId},call:function(b){a&&a(b.data)},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function i(a){var b=this;return q.find(b.itemData.all,function(b){return b.name===a})}function j(a){var b=this,c=b.itemData,d=b.getEl(),e=a.id,f=a.isSys,g=f||a.select,h=n(p.execTpl('<label class="checkbox #{cls}" title="#{title}" data-id="#{id}" style="display:inline-block;"><span class="icons"></span><span class="menu-label">#{name}</span></label>',{cls:(f?" js-tips ":"")+(g?" checked ":""),id:e,title:f?"系统设定不可取消":"",name:a.name+(a.must?' <span class="font-gray">(必选)</span>':"")})),i=n("<div></div>");i.append(h),d.find(".js-chk-group").append(i);var j=r.transform(h);return c.all.push(a),c.map[e]=a,c.chkMap[e]=j,j}function k(){var a=this,b=a.getParam(),c=q.extend({action:"group/index"});return c.projectId=b.projectId,{crumb:[{title:"面试清单",module:"interview",param:c}]}}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=l.Str,q=l.Base,r=(l.Time,l.Uri,l.Dom,m.Input,m.Tips,m.CheckBox),s=m.Popup,t=a("../../../../core/module"),u=a("../../../../component/popupSub/popupCommon"),v=a("../../extend/bll/interview"),w=a("../../../../action/interviewProject"),x=c.exports=o.create();o.mix(x,t,{style:"/stylesheets/styles/system/infoSetting.css",title:"候选人信息设置",_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getParam();a.getEl()}v.checkProject({id:b.projectId,call:function(){a.renderWait(),a.initData()}})}},{name:"click a.js-add-btn",handler:function(a){{var b=this;n(a.currentTarget)}u.ipt("增加选填信息","名称","输入名称，不能超过20个字符",function(a){var c=a?a.length>20?"名称长度不能超过20个字符":"":"名称不能为空";c&&s.alert(c),!c&&b.addItem(a)},function(a,b){var c=b?b.length>20?"名称长度不能超过20个字符":"":"名称不能为空";return a[c?"setErrorTips":"setNone"](c),!c})}},{name:"click a.js-change-project",handler:function(){var a=this,b=a.getParam();v.changePorject({id:b.projectId,call:function(b){a.nav("interview",{action:"group/setting",projectId:b})}})}},{name:"click a.js-save-btn",handler:function(){var a=this,b=a.getParam(),c=a.itemData,d=[],e=c.map;q.forEach(c.chkMap,function(a,b){var c=e[b];!c.isSys&&a.isChecked()&&d.push({name:c.isBuild?c.id:c.name})}),w.addOrUpdateTemplateToProject({type:"PUT",params:{projectId:b.projectId},body:{ext:JSON.stringify(d)},call:function(){var c=b.back;return c&&c.module&&c.param?a.nav(c.module,c.param):void s.tips("保存成功",function(){a.nav("interview",{action:"group/index",projectId:b.projectId})})},error:function(b){a.renderWait(a.getEl(),b.msg)}})}}]},{initData:d,initTpl:e,initList:f,addItem:g,fetchData:h,_getItemByName:i,_createChk:j,getCrumbConf:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/group/uploadExcel",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../util/popupInterviewArrange","../../../../component/popupSub/popupIvSucc","../../../../util/interview","../../../../component/popupSub/popupJoinSession","../../../../action/interviewProject","../../../../util/ajax","../../../../action/interviewSchedule","../cpn/interviewSceneForm","../../../../component/dateSelect","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../component/department","../../../../util/switch","../../../../action/user","../../../../action/interviewV2","../../../../action/common","../../extend/bll/money","../../../../action/purchase","../../../../action/price"],function(a,b,c){function d(){var a=this;a.page=0,a.pageCount=20}function e(){var a=this,b=a.getParam(),c=u.id(b.type),d={download:'<p>请先<a href="javascript:void(0)" class="link-green js-download-template">点击下载数据模板</a>，按模板填写面试信息上传。</p>',uploadExcel:'<a href="javascript:void(0)" class="btn btn-info btn-lg js-upload-excel" data-type="excel">Excel上传</a>',uploadResume:'<a href="javascript:void(0)" class="btn btn-info btn-lg js-upload-resume" data-type="zip">简历打包上传（可选，不超过100MB）</a>',uploadResult:'<a href="javascript:void(0)" class="btn btn-info btn-lg js-upload-result" data-type="zip">成绩单打包上传（可选，不超过100MB）</a>',importIn:'<div class="js-department"></div><a href="javascript:void(0)" class="btn btn-primary btn-lg js-import">批量导入</a>',edit:'<a href="javascript:void(0)" class="btn btn-primary btn-lg js-import">批量修改</a>',book:'<a href="javascript:void(0)" class="btn btn-primary btn-lg js-import">批量预约</a>'},e={1:[d.download,d.uploadExcel,d.uploadResume,d.uploadResult,d.importIn].join(""),2:[d.download,d.uploadExcel,d.uploadResume,d.uploadResult,d.edit].join(""),3:[d.download,d.uploadExcel,d.book].join("")}[c];a.getEl().find(".js-btn-group").html(e||"")}function f(){var a=this,b=a.getParam(),c=a.getEl(".js-field-tips"),d=u.id(b.type);"1"===d&&F.getTemplate({type:"GET",params:{projectId:a.projectId},call:function(a){var b=["姓名","职位","手机","邮箱","投递编号"];u.forEach(a.data.builtInFieldList,function(a){a&&a.select&&b.push(a.name)}),u.forEach(a.data.selfDefinedFieldList,function(a){a&&a.select&&b.push(a.name)});var d="该面试项目需要录入的面试信息："+b.join("、");d+='&nbsp;&nbsp;<a href="javascript:void(0);" class="link-green js-edit-field">修改</a>',c.html(d).show()}})}function g(){var a=this,b=a.getEl(),c=a.getParam(),d=u.id(c.type),e=w.show({target:b.find(".js-upload-excel"),url:z.getUploadUrl(A.uploadType.file),fileType:"*.xlsx;xls;",call:function(c){b.find(".js-upload-excel").html("excel上传【已上传】"),a.excelUrl=c.data}});if(a.pushChild(e),"1"===d||"2"===d){var f=w.show({target:b.find(".js-upload-resume"),url:z.getUploadUrl(A.uploadType.file),fileType:"*.zip;",getFileTypeTips:function(){return'文件类型不正确，支持的类型：zip  ，建议使用<a href="https://sparanoid.com/lab/7z/" class="link-green" target="_blank">7-Zip</a>压缩成zip格式'},call:function(c){b.find(".js-upload-resume").html("简历打包上传（可选）【已上传】"),a.resumeUrl=c.data},error:function(a){u.out(a.msg)}});a.pushChild(f);var g=w.show({target:b.find(".js-upload-result"),url:z.getUploadUrl(A.uploadType.file),fileType:"*.zip;",getFileTypeTips:function(){return'文件类型不正确，支持的类型：zip  ，建议使用<a href="https://sparanoid.com/lab/7z/" class="link-green" target="_blank">7-Zip</a>压缩成zip格式'},call:function(c){b.find(".js-upload-result").html("成绩单打包上传（可选）【已上传】"),a.testResultUrl=c.data}});a.pushChild(g)}}function h(){var a=this,b=a.getEl(".js-department");if(0!==b.length){var c=a.department=new D({renderTo:b,renderBy:"replaceWith",departmentData:a.departmentData,needCache:!0,userId:a.getUserId(),tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理这些候选人"});c.getEl().width(450).css("margin","auto"),c.getEl(".control-label").width(135),a.department.getEl(".dropdown-toggle").css("margin","0px"),a.department.getEl(".js-choice-form").css("position","relative").css("right","70px")}}function i(){var a=this,b=a.getWin();E.batchAdd({type:"POST",params:{projectId:a.projectId},body:{excel:a.excelUrl,resumeUrl:a.resumeUrl,testResultUrl:a.testResultUrl,departmentId:a.department&&a.department.val()},call:function(c){var d=b.showLoading("导入中...");J.getTaskProgress(!0,c.data,function(b){var c=b.end,e=b.content,f=b.error;if(f){d.close();var g=u.json(e);g&&a.popupDownload(g.msg,g.errorFileUrl),!g&&x.alert(e)}else if(c){d.close(),I.refreshMoney();var h=(u.json(e)||{}).ids||[],i={isAll:2,ids:h.join("_")},j=C.show({hasToSessionDoor:!0,projectId:a.projectId,cond:i,module:a});j.listen("goList",function(){a.nav("interview",{action:"group/index",projectId:a.projectId})})}else e&&"暂无进度"!==e&&d.getEl(".warning-word").html(e)})},error:function(a){x.alert(a.msg)}})}function j(){return v.get("interviewV2FilterCond")}function k(a){function b(a){E["2"===i?"downloadBatchUpdateTemplate":"downloadBatchBookNextRoundTemplate"]({params:{projectId:a.projectId},body:a,type:"POST",call:function(a){var b=u.isArray(a.data)?a.data:[a.data];return b&&0!==b.length?void u.forEach(b,function(a){a&&c(a)}):(f=1,c())},error:function(){f=1}})}function c(a){e.addTask({title:"2"===i?"[下载]批量修改面试模板":"[下载]批量预约下一轮次面试模板",waitTxt:"生成中",okTxt:"点击下载",getStatus:function(b){return f=a?f:1,2!==f?b&&b(f):void G.checkPrivateOssFile({query:{ossKey:a},call:function(a){var c=a.data;0===c.status&&(f=0,g=c.url),b&&b(f)},error:function(){f=1,b&&b(f)}})},getResult:function(){return{type:3,data:g}}})}var d=this,e=d.getWin(),f=2,g="",h=d.getParam(),i=u.id(h.type);b(a)}function l(){var a=this,b=a.getWin(),c=a.getParam();E.batchChange({type:"PUT",params:{projectId:a.projectId},body:{excel:a.excelUrl,resumeUrl:a.resumeUrl,testResultUrl:a.testResultUrl},call:function(d){var e=b.showLoading("修改中...");J.getTaskProgress(!0,d.data,function(b){var d=b.end,f=b.content,g=b.error;if(g){e.close();var h=u.json(f);h&&a.popupDownload(h.msg,h.errorFileUrl),!h&&x.alert(f)}else d?(e.close(),I.refreshMoney(),x.tips("修改成功",function(){a.nav("interview",c.backParam?c.backParam:{action:"group/index",projectId:a.projectId})})):f&&"暂无进度"!==f&&e.getEl(".warning-word").html(f)})},error:function(a){x.alert(a.msg)}})}function m(a){var b=this,c=b.getWin();E.batchBookNextRound({type:"PUT",params:{projectId:b.projectId},body:{excel:b.excelUrl,confirm:a},call:function(a){var d=c.showLoading("解析中...");J.getTaskProgress(!0,a.data,function(a){var c=a.end,e=a.content,f=a.error;if(f){d.close();var g=JSON.parse(e,{}),h=u.id(g.code);if("1"===h)x.alert(g.msg);else if("2"===h){var i=+g.totalCount,j=+g.illegalCount;x.confirm("很抱歉，在您选中的"+i+"条面试中有"+j+"条可能已经结束，无法预约下一轮。是否确定预约其他的"+(i-j)+"条？",function(){b.batchBookNextRound(1)})}else"1308"===h&&b.popupDownload(g.msg,g.errorFileUrl)}else c&&(d.close(),x.tips("预约成功",function(){b.nav("interview",{action:"group/index",projectId:b.projectId})}))})},error:function(a){x.alert(a.msg)}})}function n(){var a=this,b=a.getParam(),c=u.extend({action:"group/index"});return c.projectId=b.projectId,{crumb:[{title:"面试清单",module:"interview",param:c}]}}function o(a,b){new x({title:"提醒",content:['<div style="font-size:14px;padding:20px 0;text-align:center;line-height:2;">',"<div>"+(a?a.replace(/\n+/g,"<br />"):"出现错误")+"</div>","<div>"+(b?'<a class="link-green" href="'+b+'" target="_blank">点击下载错误名单</a>':"")+"</div>","</div>"].join(""),okTxt:"我知道了"})}function p(a,b){var c=this;H.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getParam().projectId,entityType:32},call:function(b){var d=b.data||[];c.departmentData=d,u.isFunction(a)&&a(d)},error:function(a){u.isFunction(b)&&b(a.msg)}})}function q(){var a=this,b=a.getParam(),c=u.id(b.type),d={1:{title:"批量导入",tip:["<dt>重要提醒</dt>","<dd>1、请先下载模板，并严格按照预设模板进行名单录入，保证所有单元格均为本文格式；</dd>","<dd>2、如需导入简历和成绩报告，请保证简历名和报告名和excel的对应字段完全一致（只输入名字即可），压缩包大小不超过100MB，否则将会导入出错。</dd>",'<dd>3、你可使用<a href="javascript:void(0)" class="js-arrange-btn link-green">排期小助手</a>估算每日需安排的面试时长和间隔。</dd>'].join("")},2:{title:"批量修改",tip:["<dt>重要提醒</dt>","<dd>1、请先下载模板，并严格按照预设模板进行名单录入，保证所有单元格均为本文格式；</dd>","<dd>2、仅修改你需要修改的内容，不需要修改的内容请维持不变，不要清空，否则可能会覆盖之前的数据。</dd>","<dd>3、灰色单元格表示不可修改的内容，为防止上传出错，请不要修改灰色单元格内容。</dd>"].join("")},3:{title:"批量预约",tip:["<dt>重要提醒</dt>","<dd>1、请先下载模板，并严格按照预设模板进行预约信息录入，保证所有单元格均为本文格式；</dd>","<dd>2、仅修改预约下一轮的内容，不需要修改的内容请维持不变，不要清空，否则可能会覆盖之前的数据。</dd>","<dd>3、灰色单元格表示不可修改的内容，为防止上传出错，请不要修改灰色单元格内容。</dd>"].join("")}}[c];return d||{title:"",tip:""}}var r=a("nc"),s=a("cpn"),t=(r.$,r.Clazz),u=r.Base,v=(r.Uri,r.Db),w=s.AttachUpload,x=s.Popup,y=a("../../../../core/module"),z=a("../../../../util/util"),A=a("../../../../core/siteConfig"),B=a("../util/popupInterviewArrange"),C=a("../../../../component/popupSub/popupIvSucc"),D=a("../../../../component/department"),E=a("../../../../action/interviewV2"),F=a("../../../../action/interviewProject"),G=a("../../../../action/common"),H=a("../../../../action/user"),I=a("../../extend/bll/money"),J=a("../../extend/bll/task"),K=c.exports=t.create();t.mix(K,y,{style:"/stylesheets/styles/system/interview.css",title:"批量操作",showTask:!0,_template:['<div class="module-box interview-list">','<div class="module-head clearfix"><h1>#{title}</h1></div>','<div class="module-body">','<dl class="interview-tips">#{tip}</dl>','<div class="js-field-tips info-tips" style="display:none;"></div>','<div class="interview-upload-wrap js-btn-group"></div>',"</div>","<div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;window.setTimeout(function(){a.getDepartment(function(){var b=a.getParam();a.projectId=u.id(b.projectId)||"0",a.initBtnGroup(),a.initFieldTips(),a.initUpload(),a.initDepartment()},function(b){a.renderNone(a.getEl(),b)})},250)}},{name:"click a.js-download-template",handler:function(){var a=this,b=a.getParam(),c=u.id(b.projectId)||"0",d=u.id(b.type);if("0"!==c)if("1"===d){var e=E.downImportExcelTemplateUrl({params:{projectId:c}});window.open(e,"_blank")}else if("2"===d||"3"===d){var f=a.getCond();a.downloadExcelTemplate(f)}}},{name:"click a.js-import",handler:function(){var a=this,b=a.getParam(),c=(u.id(b.projectId)||"0",u.id(b.type));if(!a.excelUrl)return void x.alert("请先上传excel文件");var d={1:"batchAdd",2:"batchChange",3:"batchBookNextRound"}[c];d&&a[d]()}},{name:"click a.js-arrange-btn",handler:function(){B.show({call:function(){}})}},{name:"click a.js-edit-field",handler:function(){var a=this,b=a.getParam();a.nav("interview",{action:"group/setting",projectId:a.projectId,back:{module:"interview",param:b}})}}]},{initialize:d,initBtnGroup:e,initFieldTips:f,initUpload:g,initDepartment:h,getCrumbConf:n,batchAdd:i,getCond:j,downloadExcelTemplate:k,batchChange:l,batchBookNextRound:m,popupDownload:o,getDepartment:p,_getData:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/notice/cpn/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(){var a=this;a.hasOfflinePermission=r.can("interviewOffline")}function e(){var a=this,b=a.rawConfig,c=b.cond||{},d=a.getEl().html(""),e={id:"job",title:"职位",type:"selectMult",conf:{options:p.map(c.jobList,function(a){return{text:a,value:a}}),render:function(){}}},f={id:"date",title:"面试日期",type:"duration",ext:{today:!0}},g={id:"round",title:"面试轮次",type:"select",conf:{options:[{text:"全部",value:"0",checked:!0},{text:"第1轮",value:"1"},{text:"第2轮",value:"2"},{text:"第3轮",value:"3"},{text:"第4轮",value:"4"},{text:"第5轮",value:"5"},{text:"第6轮",value:"6"},{text:"第7轮",value:"7"},{text:"第8轮",value:"8"},{text:"第9轮",value:"9"},{text:"第10轮",value:"10"}]}},h={id:"status",title:"面试状态",type:"select",conf:{options:[{text:"未开始",value:"0",checked:!0},{text:"进行中",value:"1"},{text:"已结束",value:"3"},{text:"已取消",value:"4"},{text:"已暂停",value:"5"}]}},i={id:"offline",title:"面试方式",type:"select",conf:{options:[{text:"视频",value:"0",checked:!0},{text:"线下",value:"1"}]}},j={id:"mail",title:"邮件通知",type:"select",conf:{options:[{text:"不限",value:"-2"},{text:"接收中",value:"1"},{text:"接收成功",value:"3"},{text:"接收失败",value:"4"},{text:"未发送",value:"0",checked:!0}]}},k={id:"sms",title:"短信通知",type:"select",conf:{options:[{text:"不限",value:"-2"},{text:"接收中",value:"1"},{text:"接收成功",value:"3"},{text:"接收失败",value:"4"},{text:"未发送",value:"0",checked:!0}]}},l={id:"confirm",title:"确认状态",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"待确认",value:"4"},{text:"待定",value:"1"},{text:"拒绝",value:"2"},{text:"确定参加",value:"3"}]}},m={id:"search",title:"关键词",type:"search",conf:{placeholder:"输入关键词搜索，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的面试，多个关键词用空格分割"}};a.filter=new q({renderTo:d,submitTxt:"查询",line:[{border:!0,items:[e]},{border:!0,fold:!0,items:[f]},{border:!0,fold:!0,items:[g,h,a.hasOfflinePermission?i:null,j,k,l]},{fold:!0,items:[m]}],clearAll:function(){a.val({})},listeners:{submit:p.bind(a.submit,a)}})}function f(){var a=this;if(a.check()){var b=a.val();a.fire("submit",b);var c=a.getParent();b=p.clone(b),b.startDate=(b.startDate||"").split(" ")[0],b.endDate=(b.endDate||"").split(" ")[0],c.addParam(b)}}function g(a){var b=this,c=b.hasOfflinePermission,d=b.filter,e=d.getItem("job"),f=d.getItem("date"),g=d.getItem("round"),h=d.getItem("status"),i=d.getItem("offline"),j=d.getItem("mail"),k=d.getItem("sms"),l=d.getItem("confirm"),n=d.getItem("search");if(0===arguments.length){var o=e.val(),p=m.trim(f.startIpt.val()),q=m.trim(f.endIpt.val()),r=m.trim(g.val()),s=m.trim(h.val()),t=c?m.trim(i.val()):"-1",u=m.trim(j.val()),v=m.trim(k.val()),w=m.trim(l.val());return{jobList:o,startDate:p?p+" 00:00:00":p,endDate:q?q+" 23:59:59":q,round:r,roundStatus:s,offline:"-1"===t?void 0:t,confirmStatus:w,emailStatus:"-2"===u?void 0:u,smsStatus:"-2"===v?void 0:v,keywordUnion:n.chk.isChecked()?1:void 0,keywordList:b.wrapVal(b.split(n.ipt.val()))}}e.val(a.jobList),f.todayChk.checked(!1),f.todayChk.fire("change"),f.startIpt.val(a.startDate||""),f.endIpt.val(a.endDate||""),g.val(a.round||"0"),h.val(a.roundStatus||"0"),c&&i.val(a.offline||"0"),l.val(a.confirmStatus||"0"),j.val(a.emailStatus||"0"),k.val(a.smsStatus||"0"),n.chk.checked(1===a.keywordUnion),n.ipt.val((a.keywordList||"").split("_").join(" "))}function h(){var a=this,b=a.filter,c=b.getItem("date"),d=a.val();return d.startDate&&!d.endDate?(c.endIpt.errorTips("请选择结束日期"),!1):!d.startDate&&d.endDate?(c.startIpt.errorTips("请选择开始日期"),!1):!0}function i(){var a=this,b=a.rawConfig;return b.parent}function j(a){var b=(a||"").split(/[\s_]+/),c=[];return p.forEach(b,function(a){a=m.trim(a),a&&c.push(a)}),c}function k(a,b){return p.isArray(a)?(a=p.without(a,""),a.length>0?a.join("_"):b):p.isString(a)?m.trim(a)||b:a}var l=a("nc"),m=(a("cpn"),l.$),n=l.Clazz,o=l.Component,p=l.Base,q=(l.Str,a("../../../../../component/filter/filter")),r=a("../../../../../util/switch"),s=c.exports=n.create();n.mix(s,o,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter();var b=a.getParent(),c=b.getParam();a.val({jobList:c.jobList,startDate:c.startDate,endDate:c.endDate,round:c.round,roundStatus:c.roundStatus,confirmStatus:c.confirmStatus,emailStatus:c.emailStatus,smsStatus:c.smsStatus,keywordUnion:c.keywordUnion,keywordList:c.keywordList})}}]},{initialize:d,initFilter:e,submit:f,val:g,check:h,split:j,wrapVal:k,getParent:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/notice/cpn/list",["nc","cpn","../../../extend/bll/interview","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../../../core/siteConfig","../../../../../action/interview","../../../../../action/interviewV2","../../../../../action/interviewProject","../../../extend/bll/notice","../../../../../component/selectAll","../../../../../component/table","../../../../../util/util","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../util/interview","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/resumeDeliver"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.getParent(),d=c.getParam(),e=+d.pageSize||20;e=s.contains([20,50,100],e)?e:20,a.pageSelect=new w({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:[{text:20,value:20,checked:20===e},{text:50,value:50,checked:50===e},{text:100,value:100,checked:100===e}],listeners:{change:function(){c.addParam({pageSize:this.val(),page:null}),a.load()}}}),a.tableCpn=new C({renderTo:a.contentEl,needSelect:!0,needFixHeader:!0,pageChange:function(b){c.addParam({page:b}),a.load(null,b)}})}function e(a){var b=this;b.tableCpn.selectAll.clear(),b.load(a)}function f(a,b){var c=this,d=c.rawConfig,e=c.tableCpn;if(a&&(c.condition=a),0===s.size(c.condition))return e.renderNone("暂无面试需要通知");var f=c.getCond(b);e.renderWait();var g=f.roundStatus,h=f.emailStatus,i=f.smsStatus,j="014".split("");c.sendAllEl["0"!==g||h&&i&&!s.contains(j,h)&&!s.contains(j,i)?"hide":"show"](),B.getNoticeList({params:{userId:d.uid},query:f,call:function(a){var b=a.data;c.currentData=b,c.renderList(b)},error:function(a){e.renderNone(a.msg)}})}function g(){var a=this,b=a.tableCpn.selectAll;return a.condition&&(b.isSelectAll||b.selectIds.length>0)}function h(a){function b(a){var b=c.dataMap=c.dataMap||{};b[a.interviewId]=a}var c=this,d=c.getParent(),e=(d.getParam(),c.tableCpn);if(c.updateTotal(a.totalCount),0===(a.datas||[]).length)return e.renderNone("暂无面试需要通知");var f={head:["候选人",{text:"手机",width:"12%"},{text:"邮箱",width:"12%"},"轮次",{text:"预约时间",width:"12%"},"面试官","面试方式","邮件通知","短信通知","是否参加","备注理由",{text:"操作",width:"15%"}],list:[]},g="---",h={1:"待定",2:"拒绝",3:"确定参加"};s.forEach(a.datas,function(a){b(a);var c=s.id(a.status),d=s.id(a.emailSentStatus),e=s.id(a.smsSentStatus),i=s.id(a.noticeConfirmStatus),j=s.id(a.interviewId),k=s.id(a.roundId),l=s.id(a.round),m={4:"已取消",1:"进行中",3:"已结束"}[c];m||"0"!==c||(s.contains("014".split(""),d)||s.contains("014".split(""),e)?m='<a class="btn btn-auto btn-primary js-send-one btn-xs" href="javascript:void(0);">通知</a>':("3"===d||"3"===e)&&(m=t.execTpl(['<a class="btn btn-auto btn-primary js-edit btn-xs" style="margin-right: 10px;" href="javascript:void(0);">修改</a>','<a class="btn btn-auto btn-default js-cancel btn-xs" href="javascript:void(0);">取消</a>'].join(""),{interviewId:j,roundId:k,round:l})));var n='<a href="javascript:void(0);" class="js-tips js-solution" data-code="#{code}" title="点击查看失败原因" style="color: red;">接收失败</a>',o=A.getName(d);(2===+d||4===+d||+d>=100)&&(o=t.execTpl(n,{code:d}));var p=A.getName(e);(2===+e||4===+e||+e>=100)&&(p=t.execTpl(n,{code:e}));var q=[a.intervieweeName||g,a.phone||g,a.email||g,"第"+l+"轮",a.bookTime?u.form(new Date(a.bookTime)):g,a.interviewerName||g,1===a.offline?"线下":"视频",o,p,h[i]||g,a.remark,m||g];f.list.push({items:q,attr:{"data-id":k,"data-room-id":j,"data-round":l}})}),e.updateHtml(f,{totalPage:a.totalPage,currentPage:a.currentPage,totalCount:a.totalCount})}function i(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function j(){var a=this;return a.rawConfig.parent}function k(a){var b=this,c=b.getParent(),d=c.getParam(),e=c.getProjectId(),f=b.rawConfig,g=s.extend({},b.condition,{source:1,page:a||d.page||1,pageSize:b.pageSelect.val(),needExtInfo:1,sortBy:d.orderBy,order:d.order,projectIdList:"0"===e?y.getAllId(f.projectData):e});return g}function l(a){var b=p(a).closest("tr");return p.trim(b.attr("data-id"))}function m(a){var b=p(a).closest("tr");return{roundId:p.trim(b.attr("data-id")),roomId:p.trim(b.attr("data-room-id")),round:p.trim(b.attr("data-round"))}}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Clazz,r=n.Component,s=n.Base,t=n.Str,u=n.Time,v=n.Uri,w=o.Select,x=(o.Pager,o.Popup),y=(o.Tips,a("../../../extend/bll/interview")),z=a("../../../extend/bll/money"),A=a("../../../extend/bll/notice"),B=(a("../../../../../component/selectAll"),a("../../../../../action/interview")),C=a("../../../../../component/table"),D=a("../../../../../component/popupSub/popupIvEdit"),E=c.exports=q.create();q.mix(E,r,{_template:["<div>",'<div class="import-tool clearfix" style="padding:15px;">','<div class="import-census">','<div class="census-num">共<span class="font-green js-total">0</span>条</div>','<div class="form-group">','<label class="control-label">每页显示</label>','<div class="control-group"><div class="control-group js-page-select"></div></div>',"</div>","</div>",'<div class="import-tool-bar">','<a class="link-green js-send-all" href="javascript:void(0)"><i class="icon-envelope-alt"></i>群发通知</a>','<a class="link-green js-excel-all" href="javascript:void(0)"><i class="icon-cloud-upload"></i>导出数据</a>',"</div>","</div>",'<div class="js-content" style="padding-bottom:60px;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentEl=b.find(".js-content"),a.sendAllEl=b.find(".js-send-all"),a.initCpn(),a.tableCpn.renderWait()}},{name:"click a.js-excel-all",handler:function(){var a=this;if(!a.isSelect())return x.alert("请先选择数据");var b=a.tableCpn.selectAll,c=a.getParent(),d=c.getProjectId(),e=c.getUserId(),f=B.getNoticeExcelUrl({params:{userId:e}}),g={access_token:c.getToken(),projectId:d};g.isAll=b.isSelectAll?1:2,g.roundIdList=b.selectIds.join(","),b.isSelectAll&&(g=s.extend({},g,a.condition)),f=v.addParam(g,f),window.open(f,"_blank")}},{name:"click a.js-send-all",handler:function(){var a=this;if(!a.isSelect())return x.alert("请先选择数据");var b=a.tableCpn.selectAll,c=a.getParent(),d=a.condition,e={action:"send/index",phone1:1,phone2:1,email1:1,email2:1,offline:d.offline,projectId:c.getProjectId()};e.isAll=b.isSelectAll?1:2,e.roundIdList=b.selectIds,b.isSelectAll&&(e.cond=d),c.nav("interview",e)}},{name:"click .js-send-one",handler:function(a){var b=this,c=b.getParent(),d=b.getLineId(a.currentTarget),e=b.condition;d&&c.nav("interview",{action:"send/index",phone1:1,phone2:1,email1:1,email2:1,offline:e.offline,projectId:c.getProjectId(),isAll:2,roundIdList:[d]})}},{name:"click .js-edit",handler:function(a){var b=this,c=b.getLineInfo(a.currentTarget);D.show({id:c.roomId,call:function(){b.reload()}})}},{name:"click .js-cancel",handler:function(a){var b=this,c=b.getParent(),d=b.getLineInfo(a.currentTarget),e=d.roomId,f=d.roundId,g=d.round;if(e&&f){var h=b.dataMap[e];y.cancelInterview({apiRole:h.apiRole,round:g,roomId:e,roundId:f,call:function(){z.getUserMoney(function(a,b){if(!a){var d=c.getWin();d.updateUser("companyAccount.money",b),d.initAppearance()}}),b.reload()}})}}},{name:"click .js-solution",handler:function(a){var b=p(a.currentTarget),c=b.attr("data-code");c&&A.showReason(c)}}]},{initCpn:d,reload:e,load:f,isSelect:g,renderList:h,updateTotal:i,getParent:j,getCond:k,getLineId:l,getLineInfo:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/notice/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/interview","../../../../util/ajax","../../../../action/interviewProject","../../extend/bll/money","../../extend/bll/base","../../../../action/purchase","../../../../action/price","../../extend/bll/interview","../../../../action/interviewV2","../../../../component/popupSub/popupIvEdit","../../../../util/switch","../../../../component/popupSub/popupIvSucc","../../../../util/interview","../../../../component/popupSub/popupJoinSession","../../../../action/interviewSchedule","../cpn/interviewSceneForm","../../../../component/dateSelect","../../extend/bll/task","../../../../action/api","../../../../component/department","../../../../action/user","../../../../action/resumeDeliver","../../../../component/navProject","./cpn/filter","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../action/common","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","./cpn/list","../../extend/bll/notice","../../../../component/selectAll","../../../../component/table"],function(a,b,c){function d(){var a=this,b=a.getEl();a.recycle(),a.renderWait(b),a.getCond(function(){b.html(['<div class="module-box interview-list">','<div class="js-project"></div>','<div class="js-filter"></div>','<div class="js-list"></div>',"</div>"].join("")),a.initCpn()})}function e(){var a=this,b=a.getEl(),c=a.getProjectId(),d=a.getUserId();new p({renderTo:b.find(".js-project"),renderBy:"replaceWith",items:a.projects,current:c,change:function(b){a.getParam();o.setCacheProjectId(b),a.resetParam({projectId:b}),a.initProject()}}),a.list=new r({renderTo:b.find(".js-list"),parent:a,uid:d,projectData:a.projects}),a.filter=new q({renderTo:b.find(".js-filter"),parent:a,cond:a.cond,listeners:{render:function(){a.list.reload(this.val())},submit:function(b){a.addParam({page:null}),a.list.reload(b)}}})}function f(a){var b=this,c=b.getProjectId();return"0"===c?(b.cond={},a&&a()):void n.getCondition({type:"GET",params:{projectId:b.getProjectId()},call:function(c){b.cond=c.data,a&&a()},error:function(a){b.renderNone(b.getEl(),a.msg)}})}function g(a){var b=this;o.getSimpleProject(function(c){b.projects=c,a&&a()})}function h(){var a=this,b=a.getParam();return l.id(b.projectId)||"0"}var i=a("nc"),j=a("cpn"),k=(i.$,i.Clazz),l=i.Base,m=(i.Dom,i.Component,j.Select,a("../../../../core/module")),n=(a("../../../../action/interview"),a("../../../../action/interviewProject")),o=(a("../../extend/bll/money"),a("../../extend/bll/interview")),p=(a("../../../../component/popupSub/popupIvEdit"),a("../../../../component/navProject")),q=a("./cpn/filter"),r=a("./cpn/list"),s=c.exports=k.create();k.mix(s,m,{style:"/stylesheets/styles/system/interviewCandidate.css",title:"通知候选人",_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam();a.renderWait(a.getEl()),o.checkProject({id:b.projectId,noForce:!0,call:function(b){o.setCacheProjectId(b),a.getProjects(function(){a.initProject()})}})}}]},{initProject:d,initCpn:e,getCond:f,getProjects:g,getProjectId:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/project/card",["nc","cpn","../util/popupProject","../../../../action/interviewProject","../../../../util/ajax","../../../../component/department","../../../../util/switch","../../../../util/util","../../../../core/siteConfig","../../../../action/user"],function(a,b,c){function d(){var a=this,b=a.rawConfig.data,c=b.id,d=b.star?0:1;A.markProjectStar({type:"PUT",params:{projectId:c},body:{star:d},call:function(){a.fire("refresh")},error:function(a){y.alert(a.msg)}})}function e(){var a=this,b=a.rawConfig.data,c=b.id,d=b.status?0:1;A.closeProject({type:"PUT",params:{projectId:c},body:{status:d},call:function(){a.fire("refresh")},error:function(a){y.alert(a.msg)}})}function f(){var a=this,b=a.rawConfig,c=b.module,d=b.data.id;c.nav("interview",{action:"schedule/index",projectId:d})}function g(){var a=this,b=a.rawConfig,c=b.module,d=b.data,e=c.getUserId();z.show({uid:e,project:{nId:d.id,sName:d.name,sRemark:d.remark,bIsDefault:1===d.isDefault?!0:!1,departmentList:d.departmentList},call:function(){a.fire("refresh")}})}function h(){var a=this,b=a.rawConfig,c=b.module,d=b.data;return d.status?y.confirm("该项目已归档，还原后可查看详情。确定撤销归档，还原至正常项目？",function(){a.clickRetireBtn()}):void c.nav("interview",{action:"group/index",projectId:d.id})}function i(){var a=this,b=a.rawConfig,c=b.module,d=c.getUserId();z.show({uid:d,call:function(){a.fire("refresh")}})}function j(){{var a=this,b=a.rawConfig,c=b.module;b.data}c.nav("interview",{action:"project/index",type:1})}function k(a){var b=this;b.rawConfig=a}function l(a){var b=x.execTpl(['<div :class="itemCls(item)">','<div class="p-item-hd">','<span class="js-tips" data-theme="white" :title="remark(item)">#{item.name}</span>','<a v-if="item.type === 1" href="javascript:void(0);" class="help-wrapper link-gray">','<i class="icon-question-sign"></i>','<div class="tooltip bottom tooltip-info">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">所有历史未归档及API调用创建项目，本项目不做重复判断。</div>',"</div>","</a>","</div>",'<div class="p-item-bd">','<ul class="p-item-info">','<li class="clearfix">','<span class="p-item-label"><i class="icon-user"></i>候选人：</span>','<span class="p-item-num">#{item.studentNums}</span>',"</li>",'<li class="clearfix">','<span class="p-item-label"><i class="icon-suitcase"></i>职位：</span>','<span class="p-item-num">#{item.jobNums}</span>',"</li>",'<li class="clearfix">','<span class="p-item-label"><i class="icon-file-alt"></i>轮次：</span>','<span class="p-item-num">#{item.roundNums}</span>',"</li>","</ul>","</div>",'<div class="p-item-ft clearfix js-foot">','<a v-if="!item.status" href="javascript:void(0);" :class="startCls(item)" :title="item.star ? \'取消置顶\' : \'置顶\'"></a>','<div class="p-item-oprt" >','<a href="javascript:void(0);" :class="statusCls(item)" :title="item.status ? \'取消归档\' : \'项目归档\'"></a>','<a v-if="!item.status" href="javascript:void(0);" class="icon-field js-schedule-btn js-tips" title="现场管理"></a>','<a v-if="!item.status" href="javascript:void(0);" class="icon-edit js-edit-btn js-tips" title="修改面试项目"></a>',"</div>","</div>","</div>"],{item:a,remark:function(a){return t.trim(a.remark)?"备注："+t.trim(a.remark):""},itemCls:function(a){return["js-project-card","p-item",{1:1,2:1}[a.type]?"p-sys-item":""]},startCls:function(a){return["js-star-btn","js-tips","icon-star-empty",a.star?"selected":""]},statusCls:function(a){return["js-retire-btn","js-tips",a.status?"icon-repeat":"icon-inbox"]}});return b}function m(){var a=['<div class="p-item js-add-card">','<div class="add-project-box">','<i class="ico-plus">+</i>','<p class="add-project-font">新建面试项目</p>',"</div>","</div>"].join("");return a}function n(){var a=this,b=(a.rawConfig.projectData,a.getRetireNum()),c=['<div class="p-item file-item js-retire-card">','<div class="file-wrap">','<div class="file-content">已归档项目<span>',b,"</span></div>","</div>","</div>"].join("");return c}function o(){var a=this,b=a.rawConfig.projectData,c=v.find(b,function(a){return a.status},!0);return c.length}function p(){var a=this,b=a.rawConfig.data,c=b.id;return c}function q(a){var b=this,c={project:"getProjectHtml",add:"getAddHtml",retire:"getRetireHtml"},d=a.type,e=c[d];if(e){var f=b[e](a.data);return{card:f}}}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Clazz,v=r.Base,w=r.Component,x=r.Node,y=(s.Tips,s.Popup),z=a("../util/popupProject"),A=a("../../../../action/interviewProject"),B=c.exports=u.create();u.mix(B,w,{_template:'<div style="display:inline-block">#{card}</div>',listeners:[{name:"render",type:"custom",handler:function(){}},{name:"click.stop a.js-star-btn",handler:function(){var a=this;a.clickStarBtn()}},{name:"click.stop a.js-retire-btn",handler:function(){var a=this,b=a.rawConfig.data,c=b.status?"该项目已归档，还原后可查看详情。确定撤销归档，还原至正常项目？":"确定归档本项目吗？确定后项目将转移至归档文件夹中，项目中的面试任务将不再出现在面试相关操作中";y.confirm(c,function(){a.clickRetireBtn()})}},{name:"click.stop a.js-schedule-btn",handler:function(){var a=this;a.clickScheduleBtn()}},{name:"click.stop a.js-edit-btn",handler:function(){var a=this;a.clickEditBtn()}},{name:"click.prevent .js-project-card",handler:function(){var a=this;a.clickProjectCard()}},{name:"click.prevent .js-add-card",handler:function(){var a=this;a.clickAddCard()}},{name:"click.prevent .js-retire-card",handler:function(){var a=this;a.clickRetireCard()}}]},{clickStarBtn:d,clickRetireBtn:e,clickScheduleBtn:f,clickEditBtn:g,clickProjectCard:h,clickAddCard:i,clickRetireCard:j,initialize:k,getProjectHtml:l,getAddHtml:m,getRetireHtml:n,getRetireNum:o,getProjectId:p,_getData:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/project/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","./card","../util/popupProject","../../../../action/interviewProject","../../../../util/ajax","../../../../component/department","../../../../util/switch","../../../../action/user"],function(a,b,c){function d(){var a=this;o.getProjects({query:{},call:function(b){a.projectData=b.data,a.renderCard()},error:function(b){a.renderNone(a.cardHomeEl,b.msg)}})}function e(){var a=this;a.cardHomeEl.html(""),a.cardHome={},a.renderProjectCard(),!a.type&&a.renderAblityCard()}function f(){var a=this,b=!0;k.forEach(a.projectData,function(c){if(c.status===a.type){b=!1;var d=new n({renderTo:a.cardHomeEl,renderBy:"append",type:"project",data:c,module:a,listeners:{refresh:function(){a.getProjects()}}});a.cardHome[c.id]=d}}),b&&a.isClose&&a.renderNone(a.getEl())}function g(){var a=this,b=["add","retire"];k.forEach(b,function(b){var c=new n({renderTo:a.cardHomeEl,renderBy:"append",type:b,projectData:a.projectData,module:a,listeners:{refresh:function(){a.getProjects()}}});a.cardHome[b]=c})}function h(){var a=this;return{crumb:a.isClose?[{title:"面试项目",module:"interview",param:{action:"project/index"}}]:[],ext:[{html:'<a href="javascript:void(0);" class="link-green" style="font-size:14px;"><i class="icon-cog" style="margin-right:5px;"></i>面试系统</a>',listeners:{click:{handler:function(){a.nav("interview",{action:"systemSet/index"})}}}}]}}var i=a("nc"),j=(a("cpn"),i.$,i.Clazz),k=i.Base,l=a("../../../../core/module"),m=a("../../../../util/util"),n=a("./card"),o=a("../../../../action/interviewProject"),p=(a("../../../../action/user"),c.exports=j.create());j.mix(p,l,{style:"/stylesheets/styles/system/addQuestions.css",title:"面试项目",_template:['<div class="module-box">','<div class="module-body">','<div class="project-items js-card-home"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam(),c=b.type||0,d=a.isClose=1===c;a.type=c,a.crumbTitle=d?"已归档项目":"面试项目",a.refreshCrumb();var e=a.cardHomeEl=a.getEl(".js-card-home");m.renderWait(e),a.getProjects()}}]},{getProjects:d,renderCard:e,renderProjectCard:f,renderAblityCard:g,getCrumbConf:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/arrangInterview",["nc","cpn","../../../../../action/interviewV2","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){var b=this;a=a||[];var c=0,d="";h.forEach(a,function(a,e){c+=a.count,b.totalInterviewId=(b.totalInterviewId||[]).concat(a.interviewIdList),d+=["<li>",'<span class="task-address-item"><span class="font-orange">',a.count,"</span>名候选人",a.round,"轮面试待安排</span>",'<a href="javascript:void(0);" class="link-green js-set-item" data-index="',e,'">批量安排</a>',"</li>"].join("")}),b.getEl(".js-total-count").html(c),b.getEl(".js-item-home").html(d)}function e(a){var b=this,c=b.rawConfig.module,d=h.extend({},a);n.checkBatchUpdateCondition({type:"POST",params:{projectId:b.projectId},body:d,call:function(d){var e=m.mask("检查中...");o.getTaskProgress(!0,d.data,function(d){var f=d.end,g=d.content,i=d.error;if(i){e.close();var j=JSON.parse(g);if("1"===h.id(j.code))m.alert(j.msg);else if("2"===h.id(j.code)){var k=+j.totalCount,n=+j.illegalCount;m.confirm("很抱歉，在您选中的"+k+"条面试中有"+n+"条可能正在进行中或已经结束，无法修改。是否确定修改其他的"+(k-n)+"条？",function(){l.set("interviewV2FilterCond",a),c.nav("interview",{action:"group/uploadExcel",projectId:b.projectId,type:2})})}}else f&&(e.close(),l.set("interviewV2FilterCond",a),c.nav("interview",{action:"group/uploadExcel",projectId:b.projectId,type:2,backParam:{action:"schedule/index",projectId:b.projectId,sceneId:b.sceneId}}))})},error:function(a){m.alert(a.msg)}})}var f=a("nc"),g=a("cpn"),h=f.Base,i=f.$,j=f.Clazz,k=f.Component,l=f.Db,m=g.Popup,n=a("../../../../../action/interviewV2"),o=a("../../../extend/bll/task"),p=c.exports=j.create();j.mix(p,k,{_template:["<div>",'<div class="task-address-hd">','<span>今日有<span class="font-orange js-total-count">62</span>名候选人面试安排</span>','<span class="task-address-oprt"><a href="javascript:void(0);" class="link-green js-set-all">安排全部任务</a></span>',"</div>",'<div class="task-address-bd">','<ul class="js-item-home"></ul>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.projectId=b.projectId,a.sceneId=b.sceneId,a.data=b.data||[],a.renderView(a.data)}},{name:"click .js-set-all",handler:function(){var a=this;a.gotoBatchUpdate({projectId:a.projectId,isAll:2,ids:a.totalInterviewId.join("_")})}},{name:"click .js-set-item",handler:function(a){var b=this,c=i(a.currentTarget).attr("data-index");b.gotoBatchUpdate({projectId:b.projectId,isAll:2,ids:((b.data[c]||{}).interviewIdList||[]).join("_")})}}]},{renderView:d,gotoBatchUpdate:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/overview/index",["nc","cpn","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../core/siteConfig","./popupCheckedInterviewee","./popupNotChecked","../../../../../../action/interviewSchedule","../../../../../../util/ajax","../../../../../../action/interviewV2","./popupOverTime","../../../cpn/popupJobInterviewer","../../../../../../action/interviewProject"],function(a,b,c){function d(){var a=this;a.renderWarning(),a.renderWaitInfo(),a.renderInterviewInfo()}function e(){var a=this,b=a.summaryData,c=[];b.moreThanNinetyMinsCount>0&&c.push(b.moreThanNinetyMinsCount+'位候选人等待时间超过90分钟，建议为候选人安排提前面试，点击<a href="javascript:void(0);" class="link-green js-over-time-90">查看详情</a>'),b.moreThanSixtyMinsCount>0&&c.push(b.moreThanSixtyMinsCount+'位候选人等待时间超过60分钟（小于90分钟），建议为候选人安排提前面试，点击<a href="javascript:void(0);" class="link-green js-over-time-60">查看详情</a>'),b.abnormalCheckedCount>0&&c.push(b.abnormalCheckedCount+'位候选人异常签到，建议取消签到后重新签到，点击<a href="javascript:void(0);" class="link-green js-unusual-check">查看详情</a>'),b.allocMoreThanFiveMinsCount>0&&c.push(b.allocMoreThanFiveMinsCount+'位候选人已分配时长超过5分钟，建议查看分配面试官是否正在面试该候选人，点击<a href="javascript:void(0);" class="link-green js-assigned">查看详情</a>');var d=b.waitCheckedStatistics;p.forEach(d,function(a){a.waitCount>3&&a.waitCount>1.5*a.onlineInterviewerCount&&c.push(a.jobName+'等待中候选人数量超过该职位在线面试官数量，请适当增加该职位面试官，点击<a href="javascript:void(0);" class="js-action" data-method="popupCheckedInterviewee">查看详情</a>'),a.waitCount>3&&a.onlineInterviewerCount>1.5*a.waitCount&&c.push(a.jobName+'等待中在线面试官数量超过该职位等待候选人的数量，建议为下一时段的候选人开启签到 ，点击<a href="javascript:void(0);" class="js-action" data-method="popupCheckedInterviewee">查看详情</a>')}),b.notAbleCheckCount>0&&c.push(b.notAbleCheckCount+'位候选人无法签到，建议<a href="javascript:void(0);" class="link-green js-not-check">查看详情</a>，为考生开启签到'),b.notAddToSceneCount>0&&c.push(b.notAddToSceneCount+'位候选人未加入到场次，建议<a href="javascript:void(0);" class="link-green js-no-session">查看详情</a>，将候选人加入到场次'),0!==c.length&&a.getEl(".nk-warning").html(p.map(c,function(a){return'<p><i class="icon-warning-sign"></i>'+a+"</p>"})).show()}function f(){var a=this,b=a.summaryData,c={list:[{items:[a.getItemType1({icon:1,text:"正在等待",value:b.waitIntervieweeCount,cls:"js-waiting"}),a.getItemType1({icon:2,text:"当前等待时长",value:b.avgWaitMins,unit:"min",noPointer:!0})]},{items:[a.getItemType2([{text:"已签到",value:b.checkedNotAllocCount,cls:"js-popup-checked-interviewee",noPointer:0===b.checkedNotAllocCount},{text:"在线未签到",value:b.onlineNotCheckedCount,cls:"js-popup-not-checked",noPointer:0===b.onlineNotCheckedCount},{text:"已分配",value:b.allocCount,cls:"js-assigned"},{text:"异常签到",value:b.abnormalCheckedCount,cls:"js-unusual-check",unusual:!0}]),a.getItemType2([{text:"未签到平均等待时长",value:b.avgNotCheckedMins,unit:"min/人",noPointer:!0},{text:"等待90分钟以上",value:b.moreThanNinetyMinsCount,cls:"js-over-time-90",unusual:!0},{text:"等待60分钟以上",value:b.moreThanSixtyMinsCount,cls:"js-over-time-60",noPointer:0===b.moreThanSixtyMinsCount},{text:"已分配未面试持续5分钟以上",value:b.allocMoreThanFiveMinsCount,unusual:!0,cls:"js-assigned"}])]}]};a.getEl(".js-wait-info").html(t.getHtml(c)),a.getEl(".js-wait-info table").removeClass("no-border-table need-hover ").css("text-align","left")}function g(){function a(){var a=[],b=[],c=0,e=0,f=(d.allJobSummary||{}).interviewScheduleJobRoundList||[];return p.forEach(f,function(d){a.push({text:["0","一","二","三","四"][d.round]+"面",value:d.interviewingCount}),b.push({text:["0","一","二","三","四"][d.round]+"面",value:d.interviewedCount?(d.interviewPassCount/d.interviewedCount*100).toFixed(1)+"%":"0.0%"}),c+=d.interviewedCount,e+=d.interviewPassCount}),{roundInterviewingCount:a,interviewPassRate:b,avgPassRate:c?(e/c*100).toFixed(1)+"%":"0.0%"}}function b(){var a=d.sceneRoundInterviewDataList||[],b=[];return p.forEach(a,function(a){0!==a.round&&b.push({text:["0","一","二","三","四"][a.round]+"面",value:a.onlineInterviewerCount})}),b}var c=this,d=c.summaryData,e=a(),f={list:[{items:[c.getItemType1({icon:1,text:"正在面试",value:d.interviewingCount},e.roundInterviewingCount),c.getItemType1({icon:2,text:"平均面试时长",value:d.avgInterviewedMins,unit:"min/人"},[{text:"面试中的面试官",value:d.onlineInterviewerCount-d.idleInterviewerCount},{text:"闲置的面试官",value:d.idleInterviewerCount}])]},{items:[c.getItemType1({icon:3,text:"面试通过率",value:e.avgPassRate,unit:""},e.interviewPassRate),c.getItemType1({icon:4,text:"在线面试官",value:d.onlineInterviewerCount},b())]}]};c.getEl(".js-interview-info").html(t.getHtml(f)),c.getEl(".js-interview-info table").removeClass("no-border-table need-hover ")}function h(a,b){return s.execTpl(['<div class="test-signup-center">',"<div>",'<i :class="cls(head)"></i>','<a v-if="!head.noPointer" href="javascript:void(0);" :class="head.cls">','#{head.text}   <span>#{head.value}</span>#{head.unit !== undefined ? head.unit : "人"}',"</a>",'<span v-else :class="head.cls">','#{head.text}   <span>#{head.value}</span>#{head.unit !== undefined ? head.unit : "人"}',"</span>","</div>",'<div v-if="body" class="test-signup-item" style="white-space:normal">','<span v-for="item in body" style="display:inline-block;">',"#{item.text}",'<span class="font-green" style="margin-left:2px;">#{item.value}</span>',"</span>","</div>","</div>"],{head:a,body:b,cls:function(a){return"test-signup-icon test-signup-icon"+a.icon}})}function i(a){return s.execTpl(['<ul class="test-signup-list">','<li v-for="item in items" :class="cls(item)" :data-value="item.value" :style="style(item)">','<span class="signup-txt">#{item.text}</span>','<span class="signup-num">','<span :class="fontCls(item)">#{item.value}</span>#{item.unit !== undefined ? item.unit : "人"}',"</span>","</li>","</ul>"],{items:a,cls:function(a){return(a.unusual?"signup-unusual ":" ")+(a.cls?a.cls:"")},fontCls:function(a){return a.unusual?"font-orange":"font-green"},style:function(a){return a.noPointer?{cursor:"text"}:null}})}function j(a){var b=this,c=b.summaryData;return{projectId:b.projectId,sceneId:b.sceneId,count:[c.interviewingCount,c.waitIntervieweeCount,c.onlineInterviewerCount-c.idleInterviewerCount].join("_"),tab:a}}function k(a){var b=this;w.show({module:b.module,projectId:b.projectId,sceneId:b.sceneId,commonParam:b.getCommonParam("1"),type:a})}function l(){var a=this;u.show({module:a.module,checkedIntervieweeData:a.summaryData.waitCheckedStatistics,commonParam:a.getCommonParam("1")})}function m(a){return+o(a.currentTarget).closest("li").attr("data-value")}var n=a("nc"),o=(a("cpn"),n.$),p=n.Base,q=n.Clazz,r=n.Component,s=n.Node,t=a("../../../../../../component/table"),u=a("./popupCheckedInterviewee"),v=a("./popupNotChecked"),w=a("./popupOverTime"),x=c.exports=q.create();q.mix(x,r,{_template:["<div>",'<div class="nk-warning" style="display:none"></div>',"<section>",'<div class="test-signup-mod">','<div class="test-signup-hd"><i class="waiting-icon"></i>等待情况</div>','<div class="js-wait-info"></div>',"</div>",'<div class="test-signup-mod right-mod">','<div class="test-signup-hd"><i class="interview-icon"></i>面试情况</div>','<div class="js-interview-info"></div>',"</div>",'<div style="clear:both"></div>','<div class="test-signup-oprt">','<a href="javascript:void(0);" class="js-go-list link-green" data-tab="0">当前正在面试的候选人 &gt;</a>','<a href="javascript:void(0);" class="js-go-list link-green" data-tab="1">已签到等待中的候选人 &gt;</a>','<a href="javascript:void(0);" class="js-go-list link-green" data-tab="2">当前在线面试官 &gt;</a>',"</div>","</section>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.projectId=b.projectId,a.sceneId=b.sceneId,a.summaryData=b.summaryData,a.renderOverview()}},{name:"click.stop .js-go-list",handler:function(a){var b=this,c=o(a.currentTarget),d=b.getCommonParam(c.attr("data-tab"));b.module.nav("interview",p.extend({action:"schedule/list/index"},d))}},{name:"click .js-waiting",handler:function(){var a=this;window.open(a.module.getNavUrl("interview",p.extend({action:"schedule/list/index"},a.getCommonParam("1"))))}},{name:"click .js-popup-checked-interviewee",handler:function(a){var b=this,c=b.getLiVal(a);0!==c&&b.popupCheckedInterviewee()}},{name:"click .js-popup-not-checked",handler:function(a){var b=this,c=b.getLiVal(a);0!==c&&v.show({module:b.module,projectId:b.projectId,sceneId:b.sceneId,commonParam:b.getCommonParam("1")})}},{name:"click .js-assigned",handler:function(){var a=this;window.open(a.module.getNavUrl("interview",p.extend({action:"schedule/list/index",filterVal:{status:"2",online:"-1"}},a.getCommonParam("1"))))}},{name:"click .js-unusual-check",handler:function(){var a=this;window.open(a.module.getNavUrl("interview",p.extend({action:"schedule/list/index",filterVal:{status:"4",online:"-1"}},a.getCommonParam("1"))))}},{name:"click .js-over-time-90",handler:function(a){var b=this,c=b.getLiVal(a);0!==c&&b.popupOverTime(0)}},{name:"click .js-over-time-60",handler:function(a){var b=this,c=b.getLiVal(a);0!==c&&b.popupOverTime(1)}},{name:"click .js-not-check",handler:function(){var a=this;window.open(a.module.getNavUrl("interview",p.extend({action:"schedule/list/index",filterVal:{checkStatus:"3"}},a.getCommonParam("1"))))}},{name:"click .js-no-session",handler:function(){var a=this;window.open(a.module.getNavUrl("interview",p.extend({action:"schedule/list/index",filterVal:{checkStatus:"4",online:"-1"}},a.getCommonParam("1"))))}}]},{renderOverview:d,renderWarning:e,renderWaitInfo:f,renderInterviewInfo:g,getItemType1:h,getItemType2:i,getCommonParam:j,popupOverTime:k,popupCheckedInterviewee:l,getLiVal:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/overview/popupCheckedInterviewee",["nc","cpn","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new p(a);return n.wrap(b,{title:"已签到候选人",content:b.html(),width:700,okTxt:"确定"}),b}function e(){function a(a){return a.waitCount>3&&a.waitCount>1.5*a.onlineInterviewerCount?c.intervieweeOver.push(a.jobName):a.waitCount>3&&a.onlineInterviewerCount>1.5*a.waitCount?c.interviewerOver.push(a.jobName):void 0}var b=this,c=b.warningInfo={intervieweeOver:[],interviewerOver:[]},d={head:[{text:"职位",width:"30%",style:{"text-align":"center"}},{text:"轮次",width:"15%",style:{"text-align":"center"}},{text:"已签到候选人数量",width:"15%",style:{"text-align":"center"}},{text:"在线面试官数量",width:"15%",style:{"text-align":"center"}},{text:"查看详情",width:"15%",style:{"text-align":"center"}}],list:[]};k.forEach(b.data,function(b,c){a(b);var e=[b.jobName,b.round,b.waitCount,b.onlineInterviewerCount,'<a href="javascript:void(0);" class="link-green js-check-detail">查看详情</a>'];d.list.push({items:e,attr:{"data-index":c}})}),b.getEl(".js-main").html(o.getHtml(d))}function f(){var a=this,b=!1,c=a.warningInfo,d=[{key:"intervieweeOver",text:"已签到等待的候选人数量超过在线面试官数量，该职位面试官可能不足"},{key:"interviewerOver",text:"已签到在线面试官数量超过等待的候选人数量，建议为下一时段的候选人开启签到"}];k.forEach(d,function(d){var e=c[d.key];0!==e.length&&(b=!0,a.getEl(".nk-warning").append('<p><i class="icon-warning-sign"></i>'+e.join("、")+d.text+"</p>"))}),a.getEl(".nk-warning")[b?"show":"hide"]()}function g(a){var b=this,c=j(a.currentTarget).closest("tr").attr("data-index");return b.data[c]}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Base,l=h.Clazz,m=h.Component,n=i.Popup,o=a("../../../../../../component/table"),p=c.exports=l.create();l.mix(p,m,{_template:["<div>",'<div class="nk-warning" style="display:none"></div>','<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.commonParam=b.commonParam,a.data=b.checkedIntervieweeData||[],a.renderMain(),a.renderWarningInfo()}},{name:"click .js-check-detail",handler:function(a){var b=this,c=b.getLineItem(a),d=b.module.getNavUrl("interview",k.extend(b.commonParam,{action:"schedule/list/index",filterVal:{job:c.jobName,online:"-1",status:"1"}}));window.open(d)}}],show:d},{renderMain:e,renderWarningInfo:f,getLineItem:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/overview/popupNotChecked",["nc","cpn","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/interviewSchedule","../../../../../../util/ajax","../../../../../../action/interviewV2"],function(a,b,c){function d(a){a=a||{};var b=new u(a);return q.wrap(b,{title:"未签到候选人",content:b.html(),width:600,okTxt:"确定"}),b}function e(){var a=this;a.getNotCheckedData(function(b){a.data=b,a.renderContainer(),a.renderMain(b),a.popup.fixPosition()})}function f(){var a=this;a.getEl().html(['<div class="nk-warning">候选人可以在预约时间一小时前进行签到，只有签到以后才能被面试官叫号</div>','<div class="js-main"></div>'].join(""))}function g(a){function b(a){return p.execTpl('<a href="javascript:void(0);" class="link-green #{cls}" style="margin-left:#{marginLeft}">#{text}</a>',{cls:a.cls,text:a.text,marginLeft:a.margin?"5px":0})}var c=this,d={head:[{text:"未签到原因",width:"40%",style:{"text-align":"center"}},{text:"未签到人数",width:"30%",style:{"text-align":"center"}},{text:"操作建议",width:"30%",style:{"text-align":"center"}}],list:[]};m.forEach(a,function(a,c){var e=[a.desc,a.count,b({cls:"js-check-detail",text:"查看详情"})+(m.contains([1,2,3],a.status)?b({cls:"js-open-check",text:"开启签到",margin:!0}):"")];d.list.push({items:e,attr:{"data-index":c}})}),c.getEl(".js-main").html(r.getHtml(d))}function h(a){var b=this,c=l(a.currentTarget).closest("tr").attr("data-index");return b.data[c]}function i(a,b){var c=this;s.getNotCheckedWaitStatistics({params:{projectId:c.projectId,sceneId:c.sceneId},query:{},call:function(b){a&&a(b.data)},error:function(a){m.isFunction(b)?b(a.msg):"popup"===b?q.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Base,n=j.Clazz,o=j.Component,p=j.Str,q=k.Popup,r=a("../../../../../../component/table"),s=a("../../../../../../action/interviewSchedule"),t=a("../../../../../../action/interviewV2"),u=c.exports=n.create();n.mix(u,o,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.commonParam=b.commonParam,a.projectId=b.projectId,a.sceneId=b.sceneId,a.refresh()}},{name:"click .js-check-detail",handler:function(a){var b=this,c=b.getLineItem(a),d={0:"2",1:"3",2:"3",3:"3",4:"4"}[c.status],e={4:"-1"}[c.status],f=b.module.getNavUrl("interview",m.extend(b.commonParam,{action:"schedule/list/index",filterVal:{checkStatus:d,online:e}}));window.open(f)}},{name:"click .js-open-check",handler:function(a){var b=this,c=b.getLineItem(a);t.batchResetRoundBookTime({type:"PUT",body:{roundIdList:c.roundIdSet},call:function(){q.tips("操作成功",function(){b.fire("refresh"),b.refresh()})},error:function(a){q.alert(a.msg)}})}}],show:d},{refresh:e,renderContainer:f,renderMain:g,getLineItem:h,getNotCheckedData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/overview/popupOverTime",["nc","cpn","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../core/siteConfig","../../../cpn/popupJobInterviewer","../../../../../../action/interviewSchedule","../../../../../../util/ajax","../../../../../../action/interviewProject","../../../../../../action/interviewV2"],function(a,b,c){function d(a){a=a||{};var b=new v(a);return r.wrap(b,{title:"等待中的候选人",content:b.html(),width:700,okTxt:"确定"}),b}function e(){var a=this;a.getOverTimeData(function(b){return a.data=b,0===b.length?(a.module.renderNone(a.getEl(),"暂无数据"),void(a.popup&&a.popup.fixPosition())):(a.renderContainer(),a.renderMain(b),void(a.popup&&a.popup.fixPosition()))})}function f(){var a=this;a.getEl().html(['<div class="nk-warning">候选人等待时间超过',[90,60][a.type],"分钟，建议为候选人安排提前面试</div>",'<div class="js-main"></div>'].join(""))}function g(a){function b(a,b,c){return p.execTpl('<a href="javascript:void(0);" class="link-green #{cls}" style="margin-left:#{marginLeft}">#{text}</a>',{cls:a,text:b,marginLeft:c?"5px":0})}var c=this,d={head:[{text:"候选人姓名",width:"20%",style:{"text-align":"center"}},{text:"职位",width:"30%",style:{"text-align":"center"}},{text:"轮次",width:"10%",style:{"text-align":"center"}},{text:"等待时长",width:"20%",style:{"text-align":"center"}},{text:"操作",width:"20%",style:{"text-align":"center"}}],list:[]};m.forEach(a,function(a,c){var e=[a.intervieweeName,a.jobName,a.round,q.second(a.waitMills/1e3),b("js-ahead-interview","提前面试")];d.list.push({items:e,attr:{"data-index":c}})}),c.getEl(".js-main").html(s.getHtml(d))}function h(a){var b=this,c=l(a.currentTarget).closest("tr").attr("data-index");return b.data[c]}function i(a,b){var c=this;u.getWaitTimeStatistics({params:{projectId:c.projectId,sceneId:c.sceneId},query:{type:c.type},call:function(b){a&&a(b.data)},error:function(a){m.isFunction(b)?b(a.msg):"popup"===b?r.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Base,n=j.Clazz,o=j.Component,p=j.Str,q=j.Time,r=k.Popup,s=a("../../../../../../component/table"),t=a("../../../cpn/popupJobInterviewer"),u=a("../../../../../../action/interviewSchedule"),v=(a("../../../../../../action/interviewV2"),c.exports=n.create());n.mix(v,o,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.commonParam=b.commonParam,a.projectId=b.projectId,a.sceneId=b.sceneId,a.type=b.type,a.refresh()}},{name:"click .js-ahead-interview",handler:function(a){var b=this,c=b.getLineItem(a);return c.jobName?void t.show({projectId:b.projectId,sceneId:b.sceneId,job:c.jobName,checkId:c.checkId,round:c.round,call:function(){b.fire("refresh"),b.refresh()}}):void r.alert("面试职位不能为空")}}],show:d},{refresh:e,renderContainer:f,renderMain:g,getLineItem:h,getOverTimeData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/popupArrangInterview",["nc","cpn","./arrangInterview","../../../../../action/interviewV2","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){var b=new k(a);return i.wrap(b,{content:b.html(),title:"今日待安排面试任务",width:650,okTxt:"确定",ok:function(){}}),b}var e=a("nc"),f=a("cpn"),g=(e.$,e.Component),h=e.Clazz,i=(e.Base,f.Popup),j=a("./arrangInterview"),k=c.exports=h.create();h.mix(k,g,{_template:['<div class="pop-task-address">','<div class="pop-task-tips">',"<p>说明</p>","<p>1.一轮面试待安排：指一轮预约时间在今天之前的候选人</p>","<p>2.二轮面试待安排：指一轮通过，二轮预约时间在今天之前的候选人</p>","<p>3.三轮、四轮面试待安排：同二轮面试待安排相似</p>","</div>",'<div class="js-arrang-view"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};new j({renderTo:a.getEl(".js-arrang-view"),projectId:b.projectId,sceneId:b.sceneId,data:b.data,module:b.module})}}],show:d},{})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/popupSave",["nc","cpn","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};{var b=new n(a);l.wrap(b,{content:b.html(),title:"下载二维码",width:650,okTxt:"确定",hasScroll:!0,ok:function(){}})}}function e(){var a=[{size:"8cm",distance:"0.5m",value:250},{size:"12cm",distance:"0.8m",value:350},{size:"15cm",distance:"1m",value:450},{size:"30cm",distance:"1.5m",value:850},{size:"50cm",distance:"2.5m",value:1400}],b=k.map(a,function(a){return["<tr>","<td>"+a.size+"</td>","<td>"+a.distance+"</td>",'<td><a href="javascript:void(0);" class="icon-download-alt js-down" style="cursor:pointer;" data-length="'+a.value+'"></a></td>',"</tr>"].join("")});return{list:b.join("")}}var f=a("nc"),g=a("cpn"),h=f.$,i=f.Component,j=f.Clazz,k=f.Base,l=g.Popup,m=a("../../../../../action/common"),n=c.exports=j.create();j.mix(n,i,{_template:['<table class="no-border-table">',"<thead>","<tr>","<th>二维码边长(cm)</th>","<th>建议扫描距离(米)</th>","<th>下载链接</th>","</th>","</thead>","<tbody>#{list}</tbody>","</table>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){}},{name:"click .js-down",handler:function(a){var b=this,c=b.rawConfig.url,d=h(a.currentTarget).attr("data-length"),e=m.downloadQrImageUrl({query:{url:c,width:d,height:d}});window.open(e)}}],show:d},{_getData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/rScene",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","./popupArrangInterview","./arrangInterview","../../../../../action/interviewV2","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../action/interviewSchedule"],function(a,b,c){function d(a){function b(b){var d={head:[{text:"面试日期",width:15,style:{"min-width":"180px"}},{text:"场次",width:20},"面试方式",{text:"面试对象",width:20},"面试人数","今日待安排人数","人均面试人次",{text:"操作",width:25}],list:[]};o.forEach(b.data,function(a,b){var e=JSON.parse(a.setting),f=e?e.roundList:[],g=0!==+a.over,h=['<a href="javascript:void(0);" class="icon-edit js-tips js-edit-scene" title="编辑"></a>','<a href="javascript:void(0);" class="icon-user js-tips js-scene-user" title="候选人更新"></a>'].join("");"0"===o.id(c.sceneId)&&(h=['<a href="javascript:void(0);" class="btn btn-auto btn-xs '+(g?"btn-default":"btn-primary")+' js-manage-scene" title="场次管理">'+(g?"已结束":"场次管理")+"</a>",h,'<a href="javascript:void(0);" class="icon-trash js-delete-scene js-tips" title="删除"></a>'].join(""));var i=[p.form(new Date(a.beginTime),"yyyy-MM-dd")+" 至 "+p.form(new Date(a.endTime),"yyyy-MM-dd"),a.name,"0"===o.id(a.offline)?"视频":"线下",(f.length>0?f.join(",")+"轮":"")+' <a href="javascript:void(0);" class="font-green js-view-scene">查看</a>',a.interviewCount?a.interviewCount:'<a href="javascript:void(0);" class="font-red btn-red js-scene-user">未添加</a>',a.todayBookCount?'<a href="javascript:void(0);" class="font-red js-popup-arrang-interview">'+a.todayBookCount+"</a>":a.todayBookCount,"0"===o.id(a.avgInterviewRound)?"---":a.avgInterviewRound,{text:h,cls:"table-btn"}];d.list.push({items:i,attr:{"data-scene-id":a.id,"data-started":a.started?1:0,"data-index":b}})}),c.contentEl.html(s.getHtml(d)),new r({renderTo:c.contentEl,current:a,total:b.totalPage,pageChange:function(a){c.initSceneList(a)}})}{var c=this;c.getWin(),c.getModule(),c.getEl()}u.getSceneList({params:{projectId:c.projectId},query:{sceneId:c.sceneId,page:a},call:function(a){var d=c.data=a.data;b(d)},error:function(a){q.alert(a.msg)}})}function e(){var a=this;return a.rawConfig.module}function f(){var a=this;return a.getModule().getWin()}function g(){var a=this,b=a.data.data[0]||{};return{beginTime:b.beginTime,endTime:b.endTiime}}function h(a){var b=l(a).closest("tr");return l.trim(b.attr("data-scene-id"))}function i(a){var b=l(a).closest("tr");return"1"===l.trim(b.attr("data-started"))}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=(j.Str,j.Base),p=(j.Limit,j.Time),q=(k.Tips,k.Input,k.Popup),r=k.Pager,s=a("../../../../../component/table"),t=a("./popupArrangInterview"),u=a("../../../../../action/interviewSchedule"),v=c.exports=n.create();n.mix(v,m,{_template:["<div>",'<div class="module-head clearfix">','<div class="module-head-oprt"><a href="javascript:void(0);" class="btn btn-primary btn-sm js-add-scene">新增</a></div>',"<h1>面试流程设置</h1>","</div>",'<div class="module-body js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getModule(),c=a.getEl();a.projectId=b.getParam().projectId,a.sceneId=o.id(b.getParam().sceneId)||"0",a.contentEl=c.find(".js-content"),"0"!==a.sceneId&&c.find(".js-add-scene").remove(),a.initSceneList()}},{name:"click a.js-add-scene",handler:function(){var a=this,b=a.getModule();a.projectId&&b.nav("interview",{action:"schedule/step1/index",projectId:a.projectId})}},{name:"click a.js-edit-scene",handler:function(a){var b=this,c=b.getModule(),d=b.getLineId(a.currentTarget);d&&"0"!==d&&c.nav("interview",{action:"schedule/step1/index",projectId:b.projectId,sceneId:d})}},{name:"click a.js-delete-scene",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);return c&&"0"!==c?b.isLineStarted(a.currentTarget)?void q.alert("很抱歉，该场面试已启动，无法删除。如该场次信息有误，您可修改或新建面试场次安排。"):void q.confirm("确定要删除这个面试场次",function(){u.deleteScene({type:"DELETE",params:{projectId:b.projectId,sceneId:c},call:function(){q.tips("删除成功",function(){b.initSceneList()})},error:function(a){q.alert(a.msg)}})}):void 0}},{name:"click .js-scene-user",handler:function(a){var b=this,c=b.getModule(),d=b.getLineId(a.currentTarget);d&&"0"!==d&&c.nav("interview",{action:"schedule/user/index",edit:!0,projectId:b.projectId,sceneId:d})}},{name:"click a.js-manage-scene",handler:function(a){var b=this,c=b.getModule(),d=b.getLineId(a.currentTarget);d&&"0"!==d&&c.nav("interview",{action:"schedule/index",projectId:b.projectId,sceneId:d,page:1})}},{name:"click a.js-view-scene",handler:function(a){var b=this,c=b.getModule(),d=b.getLineId(a.currentTarget);d&&"0"!==d&&c.nav("interview",{action:"schedule/user/index",projectId:b.projectId,sceneId:d,page:1})}},{name:"click .js-popup-arrang-interview",handler:function(a){var b=this,c=l(a.currentTarget).closest("tr").attr("data-index"),d=(b.data.data||[])[c];t.show({projectId:b.projectId,sceneId:b.sceneId,data:d.roundBookCountList,module:b.getModule()})}}]},{initSceneList:d,getModule:e,getWin:f,getSceneTime:g,getLineId:h,isLineStarted:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/cpn/steps",["nc"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.currentStep,d=a.isEdit?["日程安排","设置完成"]:["日程安排","选择面试对象","设置完成"],e="";e+='<div class="steps-wrap">',i.forEach(d,function(a,b){var d=b+1;e+=f.execTpl('<div class="item #{cls}"><div class="step-num-wrap"><div class="step-num">#{step}</div></div><h3 class="steps-tit">#{title}</h3></div>',{cls:c>=d?"done":"",step:d,title:a})}),e+="</div>",b.html(e)}var e=a("nc"),f=(e.$,e.Str),g=e.Component,h=e.Clazz,i=e.Base,j=c.exports=h.create();h.mix(j,g,{_template:"",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.currentStep=b.currentStep||1,a.isEdit=b.isEdit,a.renderList()}}]},{renderList:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/index",["nc","cpn","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../core/siteConfig","../../../../action/interviewSchedule","../../../../util/ajax","../../../../action/common","../../../../core/module","./cpn/arrangInterview","../../../../action/interviewV2","../../extend/bll/task","../../extend/bll/base","../../../../action/api","./cpn/rScene","./cpn/popupArrangInterview","./cpn/popupSave","./cpn/overview/index","./cpn/overview/popupCheckedInterviewee","./cpn/overview/popupNotChecked","./cpn/overview/popupOverTime","../cpn/popupJobInterviewer","../../../../action/interviewProject","./interviewDetail/index","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","./interviewDetail/tableInfo","../../../../util/switch"],function(a,b,c){function d(){}function e(a){var b=this;"0"!==b.sceneId&&a&&a.roundBookCountList&&0!==a.roundBookCountList.length&&(b.getEl(".js-summary").after(['<div class="module-box">','<div class="module-head clearfix"><h1>今日待安排任务</h1></div>','<div class="module-body"><div class="task-address-mod js-arrang-interview"></div></div>',"</div>"].join("")),new D({renderTo:b.getEl(".js-arrang-interview"),projectId:b.projectId,sceneId:b.sceneId,data:a.roundBookCountList,module:b}))}function f(){var a=this,b={};t.forEach([{module:E,name:"scene"}],function(c){var d=c.module,e=c.name;b[e]=new d({renderTo:a.sceneListEl,module:a})})}function g(a,b){var c=this;A.getSummary({params:{projectId:c.projectId},query:{sceneId:c.sceneId,dayList:b},call:function(b){var c=b.data;a&&a(c)},error:function(a){w.alert(a.msg)}})}function h(a){var b=this,c=u.execTpl(['<div class="module-head clearfix">',"<h1>#{projectName}</h1>","</div>",'<div class="module-body">','<div class="search-input-wrap">','<div class="js-search-input"></div>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-search-btn">搜索</a>',"</div>",'<div class="js-overview"></div>',"</div>"].join(""),{numClass:"0"!==b.sceneId?"":"with-two-item",projectName:a.sceneId?a.sceneName:a.projectName,count:[a.interviewingCount,a.waitIntervieweeCount,a.onlineInterviewerCount].join("_"),interviewingCount:a.interviewingCount,waitIntervieweeCount:a.waitIntervieweeCount,onlineInterviewerCount:a.onlineInterviewerCount,waitInterviewName:"0"===b.sceneId?"当前正在等待的候选人":"已签到等待中的候选人",onlineInterviewerName:"0"===b.sceneId?"当前正在面试的面试官":"当前在线面试官"});b.summaryEl.html(c);var d=b.searchCpn=new y({renderTo:b.getEl(".js-search-input"),renderBy:"replaceWith",placeholder:"0"===b.sceneId?"输入本项目中的候选人姓名／投递编号／手机／邮箱 查询候选人的面试详情":"输入本场次中的候选人姓名／投递编号／手机／邮箱 查询候选人的面试详情"});if(b.overviewCpn=new G({renderTo:b.getEl(".js-overview"),renderBy:"replaceWith",module:b,projectId:b.projectId,sceneId:b.sceneId,summaryData:a}),d.getEl().width("100%"),d.getEl().prepend('<label class="ico-search"></label>'),d.listen("pressEnter",t.bind(b.search,b)),b.sceneManagerEl.html(b.getSceneManageHtml(a)),"0"===b.sceneId)return new H({renderTo:b.jobListEl,renderBy:"html",projectId:b.project.id,parent:b});if(0!==a.interviewScheduleJobSummaryList.length&&(b.jobListEl.html(['<div class="module-box">','<div class="module-head clearfix"><h1 style="line-height:34px;">面试情况概况','<span class="js-time-select" style="margin:0 10px 0 30px;"></span>','<a href="javascript:void(0);" class="tag-label js-time-btn js-time-btn-0" data-value="0">今天</a>','<a href="javascript:void(0);" class="tag-label js-time-btn js-time-btn-1 selected" data-value="1">全部</a>',"</h1></div>",'<div class="module-body"></div>',"</div>"].join("")),!(a.sceneBeginTime>a.sceneEndTime))){var e,f=0,g=864e5,h=b.timeOption=[],i=a.sceneBeginTime-g,j=v.form(new Date(a.sceneEndTime),"yyyy-MM-dd");do i+=g,e=v.form(new Date(i),"yyyy-MM-dd"),h.push({text:e,value:e,checked:!0}),f++;while(e!==j&&100>f);b.interviewTimeSelect=new x({renderTo:b.jobListEl.find(".js-time-select"),size:"small",options:h,change:function(){var a=this.val();return b.renderInterviewInfo(),a.length===h.length?b.clickTimeBtn("1"):1===a.length&&a[0]===h[0].text?b.clickTimeBtn("0"):void b.clickTimeBtn("-1")}}),b.interviewTimeSelect.getEl().css("position","static"),b.renderInterviewInfo(a)}}function i(a,b,c,d){return'<a href="javascript:void(0);" class="link-green js-go-group" data-job="'+a.join("_")+'" data-round="'+b+'" data-type="'+c+'">'+d+"</a>"}function j(a){var b=this;if("0"===b.sceneId)return"";var c="1"===t.id(b.scene.offline),d="";if(c){var e="https://www.nowcoder.com/interview/scene-window/"+a.publicEncryptId;d=['<div class="item">','<p class="address-tit">候选人现场面试签到地址</p>','<div class="address-detail"><image src="',b.getQrImage(a.mpCheckUrl),'" width="138px" height="138px"></div>','<p><a href="javascript:void(0);" class="js-save link-green" data-url="',a.mpCheckUrl,'">下载二维码</a></p>','<p class="font-green">（仅限现场面试适用）</p>',"</div>",'<div class="item">','<p class="address-tit">叫号大屏幕</p>','<div class="address-detail"><image src="',b.getQrImage(e),'" width="138px" height="138px"></div>','<a href="',e,'" class="link-green" target="_blank">查看大屏幕</a>',"</div>"].join("")}var f="https://m.nowcoder.com/interview/scene/"+a.sceneEncryptId,g="https://www.nowcoder.com/interview/scene/"+a.sceneEncryptId,h=u.execTpl(['<div class="module-box">','<div class="module-head clearfix"><h1>任务管理地址</h1></div>','<div class="module-body">','<div class="address-items">','<div class="item">','<p class="address-tit">面试官任务管理地址</p>','<div class="address-detail"><image src="#{hrQr}" width="138px" height="138px"></div>',"<p>",c?'<a href="javascript:void(0);" class="js-save link-green" data-url="#{hrMUrl}">下载二维码</a>&nbsp;&nbsp;':"",'<a href="#{interviewerScenePcUrl}" class="link-green" target="_blank">查看链接</a>',"</p>","</div>",d,"</div>","</div>","</div>"].join(""),{hrMUrl:f,hrQr:b.getQrImage(f),interviewerScenePcUrl:g});return h}function k(a){function b(a){if(!a.interviewScheduleJobSummaryList||0===a.interviewScheduleJobSummaryList.length)return c.jobListEl.find(".module-body").html("暂无数据");var b={head:[],list:[],footer:[]},d=[];b.head.push({text:"职位",width:"18%"}),b.footer.push({text:"合计",cls:"data-consult"}),t.forEach(a.interviewScheduleJobSummaryList,function(e){var f=e.job,g=[{text:f}],h=t.toMap(e.interviewScheduleJobRoundList,function(a){return{key:a.round,value:a}});d.push(f),t.forEach(a.allJobSummary.interviewScheduleJobRoundList,function(a){{var b=a.round,d=h[b];c.getNavUrl("interview",{action:"group/index",projectId:c.projectId,jobList:e.job,sceneId:c.sceneId})}g.push(d?c.getLinkBtn([f],b,1,d.planCount):0),g.push(d?c.getLinkBtn([f],b,2,d.interviewedCount):0),g.push(d?c.getLinkBtn([f],b,3,d.interviewPassCount):0)}),b.list.push({items:g})}),t.forEach(a.allJobSummary.interviewScheduleJobRoundList,function(a){var e=a.round;b.head.push(e+"面计划人数"),b.head.push(e+"面实面人数"),b.head.push(e+"面通过人数"),b.footer.push(c.getLinkBtn(d,e,1,a.planCount)),b.footer.push(c.getLinkBtn(d,e,2,a.interviewedCount)),b.footer.push(c.getLinkBtn(d,e,3,a.interviewPassCount))}),c.jobListEl.find(".module-body").html(z.getHtml(b))}var c=this;return a?b(a):void c.getSummary(function(a){b(a)},c.interviewTimeSelect.val())}function l(a){return a?B.getQrImageUrl({query:{url:a}}):""}function m(a,b){var c=this,d="";return a=+a,t.forEach(c.jobListEl.find(".js-time-btn"),function(b){return b=r(b),+b.attr("data-value")!==a?void b.removeClass("selected"):b.hasClass("selected")?void b.removeClass("selected"):(b.addClass("selected"),void(d=0===a?v.form(new Date,"yyyy-MM-dd"):void 0))}),b?void 0===d?(c.interviewTimeSelect.replaceOptions(t.map(c.timeOption,function(a){return a.checked=!0,a})),void c.renderInterviewInfo()):void(d&&(c.interviewTimeSelect.val([d]),c.renderInterviewInfo())):void 0}function n(){var a=this,b=r.trim(a.searchCpn.val());a.nav("interview",{action:"schedule/search/index",keyword:b,projectId:a.projectId,sceneId:a.sceneId,projectName:a.project&&a.project.projectName,sceneName:a.scene&&a.scene.name})}function o(){var a=this,b=(a.getParam(),a.project),c=a.scene,d=[{title:"项目列表",module:"interview",action:"project/index"}];return b&&d.push({title:"项目("+b.projectName+")",module:"interview",param:{action:"group/index",projectId:b.id}}),c&&d.push({title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:b.id}}),{crumb:d}}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Clazz,t=p.Base,u=p.Str,v=p.Time,w=q.Popup,x=q.SelectMult,y=q.Input,z=a("../../../../component/table"),A=a("../../../../action/interviewSchedule"),B=a("../../../../action/common"),C=a("../../../../core/module"),D=a("./cpn/arrangInterview"),E=a("./cpn/rScene"),F=a("./cpn/popupSave"),G=a("./cpn/overview/index"),H=a("./interviewDetail/index"),I=(a("../../../../util/switch"),c.exports=s.create());s.mix(I,C,{style:"/stylesheets/styles/system/interview.css",title:"现场管理",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();return a.projectId=t.id(c.projectId)||"0","0"===a.projectId?void a.renderWait(b,"参数错误，没有项目id字段"):(a.sceneId=t.id(c.sceneId)||"0",a.renderWait(b),void a.getSummary(function(c){b.html(['<div class="module-box js-summary test-mod"></div>','<div class="module-box js-scene-list"></div>','<div class="module-box js-scene-manager"></div>','<div class="module-box js-job-list"></div>'].join("")),a.summaryEl=b.find(".js-summary"),a.sceneListEl=b.find(".js-scene-list"),a.sceneManagerEl=b.find(".js-scene-manager"),a.jobListEl=b.find(".js-job-list"),a.project={},a.project.id=c.projectId,a.project.projectName=c.projectName,"0"!==a.sceneId&&(a.scene={},a.scene.id=c.sceneId,a.scene.name=c.sceneName,a.scene.type=c.type,a.scene.offline=c.offline),I.title="0"===a.sceneId?"现场管理":"场次("+c.sceneName+")",a.refreshCrumb(),a.renderData(c),a.initArrangInterview(c),a.initSceneData()}))}},{name:"click a.js-go-list",handler:function(a){var b=this,c=r(a.currentTarget);b.nav("interview",{action:"schedule/list/index",projectId:b.projectId,sceneId:b.sceneId,tab:c.attr("data-tab"),count:c.closest(".js-item-count").attr("data-count")})}},{name:"click a.js-save",handler:function(a){var b=r(a.currentTarget).attr("data-url");b&&F.show({url:b}),!b&&w.alert("二维码暂时没有生成，请刷新页面重试")}},{name:"click a.js-go-group",handler:function(a){var b=this,c=r(a.currentTarget),d=c.attr("data-job"),e=c.attr("data-round"),f=c.attr("data-type"),g={1:["2","3","4","5","6"],2:["4","5","6"],3:["5"]},h=[];t.forCount(e,function(a){var b=a===e-1;h.push({round:a+1,value:b?g[f]:void 0})});var i=JSON.stringify(h),j=b.getNavUrl("interview",{action:"group/index",projectId:b.projectId,sceneId:b.sceneId,jobList:d,roundJson:i});window.open(j,"_blank")}},{name:"click .js-time-btn",handler:function(a){var b=this;b.clickTimeBtn(r(a.currentTarget).attr("data-value"),!0)}},{name:"click .js-search-btn",handler:function(){var a=this;a.search()}}]},{initialize:d,initArrangInterview:e,initSceneData:f,getSummary:g,renderData:h,getLinkBtn:i,getSceneManageHtml:j,renderInterviewInfo:k,getQrImage:l,clickTimeBtn:m,search:n,getCrumbConf:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/interviewDetail/index",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","./tableInfo","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../action/interviewProject","../../../../../util/switch"],function(a,b,c){function d(){}function e(){var a=this,b=a.rawConfig.projectId;a.setData("projectId",b),a.setData("hasOfflinePermission",L.can("interviewOffline"))}function f(){var a=this,b=[{id:"create",title:"面试创建日期"},{id:"book",title:"预约日期"},{id:"interview",title:"实际面试日期"}],c=E.map(b,function(a){return{id:a.id,title:a.title,type:"duration",ext:{today:!0}}});a.getData("hasOfflinePermission")&&c.push({id:"offline",title:"面试方式",type:"select",conf:{options:[{text:"不限",value:void 0,checked:!0},{text:"视频",value:0},{text:"线下",value:1}]}}),a.filter=new I({renderTo:a.getEl(".js-filter"),renderBy:"html",submitTxt:"查询",line:[{items:c}],listeners:{submit:E.bind(a.search,a)}})}function g(){var a=this;a.cookFilterData();var b={begin:a.getData("interview").start,end:a.getData("interview").end,bookBegin:a.getData("book").start,bookEnd:a.getData("book").end,createBegin:a.getData("create").start,createEnd:a.getData("create").end,offline:a.getData("offline")};a.getData("hasOfflinePermission")||delete b.offline,K.getInterviewSummaryData({type:"GET",params:{projectId:a.getData("projectId")},query:b,call:function(b){a.setData("back",b.data),a.cookBack(),a.renderData()},error:function(a){F.alert(a.msg)}})}function h(){var a=this,b=a.filter,c=["create","book","interview"],d={startIpt:{time:"00:00:00",dataKey:"start"},endIpt:{time:"23:59:59",dataKey:"end"}};if(E.forEach(c,function(c){var e=b.getItem(c),f={};E.forEach(d,function(a,b){var c=e[b].val(),d=c?[c,a.time].join(" "):void 0;f[a.dataKey]=d}),a.setData(c,f)}),a.getData("hasOfflinePermission")){var e=["offline"];E.forEach(e,function(c){var d=b.getItem(c);a.setData(c,d.val())})}}function i(){var a=this;a.cookOverview(),a.cookDetail()}function j(){var a=this,b=a.getData("back"),c={"计划面试":(b.planCount||0)+"人","实际面试":(b.interviewedCount||0)+"人","参加率":J.getPercent(b.interviewedCount,b.planCount),"面试职位":(b.jobCount||0)+"个","面试官人数":(b.interviewerCount||0)+"人","单轮平均时长":J.getAvgTime(b.sumFinishedElapseSecond,b.finishedCount)};a.setData("overview",c)}function k(){var a=this,b=["job","date","interviewer","score"],c=10;E.forEach(b,function(b){var d=J.getConf(b);if(d){var e=a.getData("back")[d.dataName]||[];if(0===e.length)return void a.setData(b,"");var f=a.getData(["page",b].join("-"))||1,g=e.slice((f-1)*c,f*c),h=a.getItemTableConf(d,g);a.setData(b,h),a.setData(["totalPage",b].join("-"),Math.ceil(e.length/c))}})}function l(a,b){var c=a.getTableConf(b);return c}function m(){var a=this;a.renderOverview(),a.renderTable(),a.renderPager()}function n(){var a=this,b=a.getData("overview"),c=[];E.forEach(b,function(b,d){c.push(a.getItemOverviewHtml(d,b))}),a.getEl(".js-overview").html(c.join(""))}function o(a,b){var c=['<div class="review-project-item">',"<p>",a,"</p>",'<div class="review-project-num" style="text-align:center;">',b,"</div>","</div>"].join("");return c}function p(){var a=this,b=["job","date","interviewer","score"],c=[];E.forEach(b,function(b){var d=a.getData(b);if(d){var e=J.getConf(b).title,f=H.getHtml(d),g=a.getItemModuleHtml(f,e,b);c.push(g)}}),a.getEl(".js-table-home").html(c.join(""))}function q(a,b,c){var d=['<div class="module-body js-module-',c,'">','<div class="review-project-mod">','<div class="module-head-oprt">','<a href="javascript:void(0);" class="font-green icon-download-alt js-download-table" data-type="',c,'">下载报表</a>',"</div>","<h3>",b,"</h3>",'<div style="overflow-x:auto"><div>',a,"</div></div>",'<div class="js-pager-',c,'"></div>',"</div>","</div>"].join("");return d}function r(){var a=this,b=["job","date","interviewer","score"];E.forEach(b,function(b){var c=a.getData(["page",b].join("-"))||1,d=a.getData(["totalPage",b].join("-")),e=[".js-pager-",b].join("");new G({renderTo:a.getEl(e),current:c,total:d,pageChange:function(c){a.setData(["page",b].join("-"),c),a.cookBack(),a.renderData(),a.scroll(b)}})})}function s(a){var b=this,c=K.downloadInterviewSummaryDataExcelUrl({params:{projectId:b.getData("projectId")},query:{begin:b.getData("interview").start,end:b.getData("interview").end,bookBegin:b.getData("book").start,bookEnd:b.getData("book").end,createBegin:b.getData("create").start,createEnd:b.getData("create").end,operation:a}});b.addTask(a,c)}function t(a,b){var c=this,d={job:"(按职位汇总)",date:"(按日期汇总)",interviewer:"(按面试官汇总)",score:"(各轮分值占比)"},e=c.getParent().getWin();e.addTask({title:"下载报表"+d[a],waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){a&&a(0)},getResult:function(){return{type:3,data:b}}})}function u(a){var b=this,c={job:".js-module-job",date:".js-module-date",interviewer:".js-module-interviewer",score:".js-module-score"},d=b.getEl(c[a]);D.scrollToEl({scrollEl:D.getScrollParent(d),el:d,animation:!0})}function v(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function w(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function x(){var a=this;return a.rawConfig.parent}var y=a("nc"),z=a("cpn"),A=y.$,B=y.Component,C=y.Clazz,D=(y.Uri,y.Dom),E=y.Base,F=(y.Time,z.Popup),G=z.Pager,H=a("../../../../../component/table"),I=a("../../../../../component/filter/filter"),J=a("./tableInfo"),K=(a("../../../extend/bll/task"),a("../../../../../action/interviewProject")),L=a("../../../../../util/switch"),M=c.exports=C.create();C.mix(M,B,{_template:['<div class="module-box">','<div class="module-head clearfix">',"<h1>面试情况概况</h1>","</div>",'<div class="module-body">','<div class="js-filter"></div>',"</div>",'<div class="module-body">','<div class="review-project-mod">',"<h3>项目概览</h3>",'<div class="js-overview"></div>',"</div>","</div>",'<div class="js-table-home"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initFilter(),a.search()}},{name:"click .js-table-home",handler:function(a){var b=this,c=A(a.target);if(c.hasClass("js-download-table")){var d=c.attr("data-type");b.downloadTable(d)}}}]},{initialize:d,initData:e,initFilter:f,search:g,cookFilterData:h,cookBack:i,cookOverview:j,cookDetail:k,getItemTableConf:l,renderData:m,renderOverview:n,getItemOverviewHtml:o,renderTable:p,getItemModuleHtml:q,renderPager:r,downloadTable:s,addTask:t,scroll:u,getData:v,setData:w,getParent:x})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/interviewDetail/tableInfo",["nc","cpn"],function(a,b,c){function d(a){var b=this,c={job:b.getJobConf(),date:b.getDateConf(),interviewer:b.getInterviewerConf(),score:b.getScoreConf()};return 0===arguments.length?c:c[a]}function e(){var a=this,b={title:"按职位汇总",dataName:"jobSummaryDataList",getTableConf:function(b){var c=a.getMaxRound(b),d=a.getJobHead(b,c),e=a.getJobList(b,c),f=a.getJobFooter(b,c);return{head:d,list:e,footer:f}}};return b}function f(a,b){var c=[{text:"职位",style:{"min-width":"150px"}},{text:"综合到场率"},{text:"综合通过率"},{text:"平均面试时长"}],d=[{text:"面计划人数"},{text:"面完成面试"},{text:"面正在面试"},{text:"面到场率"},{text:"面通过人数"},{text:"面通过率"},{text:"面平均时长"}];return x.forCount(b,function(a){x.forEach(d,function(b){c.push({text:a+1+b.text,style:b.style})})}),c}function g(a,b){var c=this,d=[],e=7;return x.forEach(a,function(a){var f=[a.job,c.getPercent(a.interviewedCount,a.planCount),c.getPercent(a.interviewPassCount,a.finishedCount),c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount)],g=1;x.forEach(a.apiInterviewRoundSummaryDataList,function(a){var b=a.round-g;f=c.addGap(f,b,e);var d=[a.planCount,a.finishedCount,a.interviewedCount-a.finishedCount,c.getPercent(a.interviewedCount,a.planCount),a.interviewPassCount,c.getPercent(a.interviewPassCount,a.finishedCount),c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount)];f=f.concat(d),g=a.round+1});var h=b-g+1;f=c.addGap(f,h,e),d.push({items:f})}),d}function h(a,b){var c=this,d=[],e={},f={},g=["interviewedCount","planCount","interviewPassCount","finishedCount","sumFinishedElapseSecond"];return x.forCount(b,function(a){f[a+1]={}}),x.forEach(a,function(a){x.forEach(g,function(b){e[b]=(e[b]||0)+a[b]}),x.forEach(a.apiInterviewRoundSummaryDataList,function(a){x.forEach(g,function(b){f[a.round][b]=(f[a.round][b]||0)+a[b]})})}),d=d.concat(["合计",c.getPercent(e.interviewedCount,e.planCount),c.getPercent(e.interviewPassCount,e.finishedCount),c.getAvgTime(e.sumFinishedElapseSecond,e.finishedCount)]),x.forEach(f,function(a){d=d.concat([a.planCount,a.finishedCount,a.interviewedCount-a.finishedCount,c.getPercent(a.interviewedCount,a.planCount),a.interviewPassCount,c.getPercent(a.interviewPassCount,a.finishedCount),c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount)])}),d}function i(){var a=this,b={title:"按日期汇总",dataName:"dateSummaryDataList",getTableConf:function(b){var c=a.getMaxRound(b),d=a.getDateHead(b,c),e=a.getDateList(b,c);return{head:d,list:e}}};return b}function j(a,b){var c=[{text:"日期",style:{"min-width":"150px"}},{text:"综合到场率"},{text:"综合通过率"},{text:"平均面试时长"}],d=[{text:"面计划人数"},{text:"面完成面试"},{text:"面正在面试"},{text:"面到场率"},{text:"面通过人数"},{text:"面通过率"},{text:"面平均时长"}];return x.forCount(b,function(a){x.forEach(d,function(b){c.push({text:a+1+b.text,style:b.style})})}),c}function k(a,b){var c=this,d=[],e=7;return x.forEach(a,function(a){var f=[c.getDate(a.date),c.getPercent(a.interviewedCount,a.planCount),c.getPercent(a.interviewPassCount,a.interviewedCount),c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount)],g=1;x.forEach(a.apiInterviewRoundSummaryDataList,function(a){var b=a.round-g;f=c.addGap(f,b,e);var d=[a.planCount,a.finishedCount,a.interviewedCount-a.finishedCount,c.getPercent(a.interviewedCount,a.planCount),a.interviewPassCount,c.getPercent(a.interviewPassCount,a.interviewedCount),c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount)];f=f.concat(d),g=a.round+1});var h=b-g+1;f=c.addGap(f,h,e),d.push({items:f})}),d}function l(){var a=this,b={title:"按面试官汇总",dataName:"interviewerSummaryDataList",getTableConf:function(b){var c=a.getMaxRound(b),d=a.getInterviewerHead(b,c),e=a.getInterviewerList(b,c);return{head:d,list:e}}};return b}function m(a,b){var c=[{text:"面试官",style:{"min-width":"100px"}},{text:"手机",style:{"min-width":"100px"}},{text:"邮箱",style:{"min-width":"100px"}},{text:"职位",style:{"min-width":"150px"}},{text:"面试总人数"},{text:"平均时长"},{text:"总时长"}],d=[{text:"面人数"},{text:"面平均时长"},{text:"面总时长"}];return x.forCount(b,function(a){x.forEach(d,function(b){c.push({text:a+1+b.text,style:b.style})})}),c}function n(a,b){var c=this,d=[];return x.forEach(a,function(a){var e=[a.name,a.phone,a.email,(a.jobList||[]).join("、"),a.finishedCount,c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount),c.getAvgTime(a.sumFinishedElapseSecond)],f=1;x.forEach(a.apiInterviewRoundSummaryDataList,function(a){var b=a.round-f;e=c.addGap(e,b,3);var d=[a.finishedCount,c.getAvgTime(a.sumFinishedElapseSecond,a.finishedCount),c.getAvgTime(a.sumFinishedElapseSecond)];e=e.concat(d),f=a.round+1});var g=b-f+1;e=c.addGap(e,g,3),d.push({items:e})}),d}function o(){var a=this,b={title:"各轮分值占比",dataName:"roundScoreDataList",getTableConf:function(b){var c=a.getMaxRound(b),d=a.getScoreHead(b,c),e=a.getScoreList(b,c);return{head:d,list:e}}};return b}function p(){return[{text:"轮次"},{text:"1分比例"},{text:"2分比例"},{text:"3分比例"},{text:"4分比例"},{text:"5分比例"}]}function q(a){var b=this,c=[];return x.forEach(a,function(a){var d=[a.round,b.getPercent(a.oneCount,a.totalCount),b.getPercent(a.twoCount,a.totalCount),b.getPercent(a.threeCount,a.totalCount),b.getPercent(a.fourCount,a.totalCount),b.getPercent(a.fiveCount,a.totalCount)];c.push({items:d})}),c}function r(a){var b=0;return x.forEach(a,function(a){x.forEach(a.apiInterviewRoundSummaryDataList,function(a){b=Math.max(a.round,b)})}),b}function s(a,b,c){return x.forCount(b*c,function(){a.push("")}),a}function t(a,b){var c=1===arguments.length?a:a/b;return[(100*c||0).toFixed(1),"%"].join("")}function u(a,b){var c=1===arguments.length?a:a/b;return[Math.ceil(c/60||0),"分钟"].join("")}function v(a){return y.form(new Date(a),"yyyy-MM-dd")}var w=a("nc"),x=(a("cpn"),w.$,w.Base),y=w.Time,z=c.exports={};x.extend(z,{getConf:d,getJobConf:e,getJobHead:f,getJobList:g,getJobFooter:h,getDateConf:i,getDateHead:j,getDateList:k,getInterviewerConf:l,getInterviewerHead:m,getInterviewerList:n,getScoreConf:o,getScoreHead:p,getScoreList:q,getPercent:t,getAvgTime:u,getMaxRound:r,addGap:s,getDate:v})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/list/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./waitList","../../../../../action/interviewSchedule","../../../../../util/ajax","../../../../../action/interviewV2","../../../../../action/interviewProject","../../cpn/popupJobInterviewer","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/popupSub/popupJoinSession","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","./interviewerList","../../cpn/popupInterviewedList","../../../../../component/table","../../../../../component/selectAll","../../cpn/popupBookedList","../cpn/rScene","../cpn/popupArrangInterview","../cpn/arrangInterview","./interviewingList"],function(a,b,c){function d(a){var b=this;b.project={},b.project.id=a.projectId,b.project.projectName=a.name,"0"!==b.sceneId&&(b.scene={},j.forEach(a.sceneList,function(a){j.id(a.id)===j.id(b.sceneId)&&(b.scene.name=a.name,b.scene.id=a.id,b.scene.type=a.type,b.scene.offline=a.offline,b.scene.rounds=a.roundIds.split(","))})),b.refreshCrumb()}function e(a){var b=this,c=b.showTab=a;j.forEach(["0","1","2"],function(a){b.getEl(".js-tab-"+a).removeClass("selected"),b.getEl(".js-content-"+a).hide()}),b.getEl(".js-tab-"+c).addClass("selected"),b.getEl(".js-content-"+a).show();var d=b.cpnHome={},e=[{key:"interviewingList",cpn:n},{key:"waitList",cpn:l},{key:"interviewerList",cpn:m}][a];!b["rendered_"+a]&&e&&(d[e.key]=new e.cpn({renderTo:b.getEl(".js-content-"+a),renderBy:"html",module:b,condData:b.condData,projectId:b.projectId,sceneId:b.sceneId,filterVal:b.filterVal}),b["rendered_"+a]=!0)}function f(){var a=this,b=a.project,c=a.scene,d=[{title:"项目列表",module:"interview",action:"project/index"}];return b&&d.push({title:"项目("+b.projectName+")",module:"interview",param:{action:"group/index",projectId:a.projectId}}),d.push({title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:a.projectId}}),c&&d.push({title:"场次("+c.name+")",module:"interview",param:{action:"schedule/index",projectId:a.projectId,sceneId:c.id}}),{crumb:d}}var g=a("nc"),h=(a("cpn"),g.$),i=g.Clazz,j=g.Base,k=a("../../../../../core/module"),l=a("./waitList"),m=a("./interviewerList"),n=a("./interviewingList"),o=a("../../../../../action/interviewProject"),p=c.exports=i.create();i.mix(p,k,{style:"/stylesheets/styles/system/interview.css",title:"列表详情",showTask:!0,_template:["<div>",'<div class="menu-box">','<ul class="menu clearfix">','<li class="js-tab js-tab-0" data-tab="0">','<a href="javascript:void(0);">当前正在面试的候选人(<span class="js-count-0"></span>)</a>',"</li>",'<li class="js-tab js-tab-1" data-tab="1">','<a href="javascript:void(0);">当前正在等待的候选人(<span class="js-count-1"></span>)</a>',"</li>",'<li class="js-tab js-tab-2" data-tab="2">','<a href="javascript:void(0);">当前正在面试的面试官(<span class="js-count-2"></span>)</a>',"</li>","</ul>","</div>",'<div class="module-body js-content-0" style="display:none;"></div>','<div class="module-body js-content-1" style="display:none;"></div>','<div class="module-body js-content-2" style="display:none;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=(a.getEl(),a.getParam());if(a.projectId=j.id(b.projectId)||"0",a.sceneId=j.id(b.sceneId)||"0",a.filterVal=b.filterVal?j.extend({sceneId:a.sceneId},b.filterVal):null,"0"===a.projectId)return void a.renderNone(a.getEl(),"参数错误，没有项目id字段");var c=(b.count||"").split("_");j.forEach(c,function(b,c){a.getEl(".js-count-"+c).html(b)}),o.getCondition({type:"GET",params:{projectId:a.projectId},call:function(c){var d=a.condData=c.data||{};a.initCrumb(d),a.selectTab(b.tab||"0")},error:function(b){a.renderNone(a.getEl(),b.msg)}})}},{name:"click .js-tab",handler:function(a){var b=this;b.selectTab(h(a.currentTarget).attr("data-tab"))}}]},{initCrumb:d,selectTab:e,getCrumbConf:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/list/interviewerList",["nc","cpn","../../../../../action/interviewSchedule","../../../../../util/ajax","../../../../../action/interviewProject","../../cpn/popupInterviewedList","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../cpn/popupBookedList","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../cpn/rScene","../cpn/popupArrangInterview","../cpn/arrangInterview","../../../../../action/interviewV2","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(){var a=this,b={};u.forEach([{module:F,name:"scene"}],function(c){var d=c.module,e=c.name;b[e]=new d({renderTo:a.oSceneListEl,module:a})})}function e(a){var b=this,b=this,c=b.getEl(),d={id:"scene",title:"场次",type:"select",conf:{options:[{text:"不限",value:"-1",checked:"0"===b.sceneId}].concat(u.map(a.sceneList,function(a){return{text:a.name,value:a.id,checked:b.sceneId===u.id(a.id)}}))}},e={id:"job",title:"职位",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0}].concat(u.map(a.jobList,function(a){return{text:a,value:a}}))}},f=[{text:"不限",value:"-1",checked:!0}],g="12345".split("");u.forEach(g,function(a){f.push({text:"第"+a+"轮",value:a})});var h={id:"round",title:"轮次",type:"select",conf:{options:f}},i={id:"interviewer",title:"面试官状态",type:"select",conf:{options:[{text:"不限",value:"-1"},{text:"未在线",value:"1"},{text:"在线",value:"4",checked:"0"!==b.sceneId},{text:"面试中",value:"2",checked:"0"===b.sceneId},{text:"闲置",value:"3"}]}},j={id:"search",title:"关键词",type:"search",conf:{placeholder:"可输入面试官名字、手机或邮箱，多个关键词用空格分割"}};b.filter=new E({renderTo:c.find(".js-condition"),submitTxt:"查询",line:[{border:!0,items:[d,e,h,i]},{items:[j]}],clearAll:function(){b.valCond({})},listeners:{submit:function(){b.addParam({page:null}),b.load()}}}),b.filterVal&&b.valCond(b.filterVal)}function f(){var a=this,b=a.getEl(),c=a.getParam(),d=+c.pageSize||20;d=u.contains([20,50,100],d)?d:20,a.pageSelect=new z({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:u.map([20,50,100],function(a){return{text:a,value:a,checked:d===a}}),listeners:{change:function(){a.addParam({pageSize:this.val(),page:null}),a.load()}}})}function g(){{var a=this;a.getParam()}a.renderWait(),B.getSceneInterviewer({type:"GET",params:{projectId:a.projectId},query:a.valCond(),call:function(b){a.renderList(b.data)},error:function(a){y.alert(a.msg)}})}function h(a){var b=this;if(b.updateTotal(a.totalCount),0===a.totalCount)return void b.renderNone();var c="";u.forEach(a.data,function(a){var d=u.id(a.status),e="";"0"===d?e+="未在线":"1"===d?e+="面试中":"2"===d&&(e+='闲置中<a href="javascript:void(0);" class="link-interview link-green js-offline">标记离开</a>'),c+=w.execTpl(['<tr data-id=#{id} data-name="#{name}" data-scene-id="#{sceneId}">',"<td>#{name}</td>","<td>#{tableNum}</td>","<td>#{email}</td>","<td>#{scene}</td>","<td>#{job}</td>","<td>#{round}</td>","<td>#{checkTime}</td>","<td>#{planCount}</td>","<td>#{interviewedCount}</td>","<td>#{toalInterviewDuration}</td>","<td>#{avgInterviewElapseTimeSecond}</td>",'<td class="js-status-td">#{status}</td>',"<td>#{statusDuration}</td>","</tr>"].join(""),{id:a.id,name:a.name,tableNum:1===a.sceneOffline?a.tableNum+"号桌":"-",email:a.email||"-",scene:a.sceneName||"-",sceneId:a.sceneId||0,job:a.job,checkTime:a.checkTime?x.form(new Date(a.checkTime),"MM-dd HH:mm"):"-",planCount:a.planCount?'<a href="javascript:void(0);" class="link-interview link-green js-booked">'+a.planCount+"</a>":"-",interviewedCount:a.interviewedCount?'<a href="javascript:void(0);" class="link-interview link-green js-interviewed">'+a.interviewedCount+"</a>":"-",toalInterviewDuration:b.getTimeDisplay(a.sumInterviewElapseTimeSecond)||"-",status:e,avgInterviewElapseTimeSecond:b.getTimeDisplay(a.avgInterviewElapseTimeSecond)||"-",sceneName:a.sceneName,round:1===a.sceneType?a.round?"第"+a.round+"轮":"没有指定轮次":"-",statusDuration:b.getTimeDisplay(a.statusDurationSeconds)||"-"})});var d=['<table class="no-border-table table-hover">',"<thead>","<tr>",'<th width="8%">面试官姓名</th>','<th width="5%">桌号</th>','<th width="15%">邮箱</th>','<th width="5%">场次</th>','<th width="10%">面试职位</th>','<th width="5%">轮次</th>','<th width="10%">签到时间</th>','<th width="5%">计划面试</th>','<th width="5%">已经面试','<div class="rank-oprt" data-order-by="1">','<a href="javascript:void(0);" data-order="1" class="js-rank icon-sort-up" title="从短到长"></a>','<a href="javascript:void(0);" data-order="2" class="js-rank icon-sort-down" title="从长到短"></a>',"</div>","</th>",'<th width="10%">共计面试时长','<div class="rank-oprt" data-order-by="2">','<a href="javascript:void(0);" data-order="1" class="js-rank icon-sort-up" title="从短到长"></a>','<a href="javascript:void(0);" data-order="2" class="js-rank icon-sort-down" title="从长到短"></a>',"</div>","</th>",'<th width="10%">平均面试时长</th>','<th width="10%">面试状态</th>','<th width="10%">持续时长</th>',"</tr>","</thead>","<tbody>",c,"</tbody>","</table>"].join("");b.contentEl.html(d),new A({renderTo:b.contentEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.addParam({page:a}),b.load()}}),s("div[data-order-by="+b.getParam().orderBy+"]").find(".js-rank[data-order="+b.getParam().order+"]").addClass("selected")}function i(a){var b=this;b.contentEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(a||"加载中...")+"</div>","</div>"].join(""))}function j(){var a=this;a.contentEl.html(['<div class="empty-wrap">','<img src="//uploadfiles.nowcoder.com/images/20170720/56_1500536277704_4A47A0DB6E60853DEDFCFDF08A5CA249">','<div class="empty-tip"><a href="javascript:void(0);" class="link-gray">当前暂没有符合条件的面试官哦</a></div>',"</div>"].join(""))}function k(a){var b="";return a>3600&&(b+=Math.floor(a/3600)+"小时",a%=3600),a>60&&(b+=Math.floor(a/60)+"分钟",a%=60),a>0&&(b+=a+"秒"),b}function l(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function m(a){var b=this,c=b.getParam(),d=b.filter,e=d.getItem("scene"),f=d.getItem("job"),g=d.getItem("round"),h=d.getItem("interviewer"),i=d.getItem("search");if(0===arguments.length){var j=e.val(),k=f.val(),l=g.val(),m=h.val(),n={job:"-1"===k?void 0:k,sceneId:"-1"===j?void 0:j,status:"-1"===m?void 0:m,keyword:b.split(i.ipt.val()).join("_"),orderBy:c.orderBy,order:c.order,round:"-1"===l?void 0:l,page:c.page||1,pageSize:c.pageSize||20};return n}e.val("0"===u.id(a.sceneId)?"-1":u.id(a.sceneId)||"-1"),f.val(a.job||"-1"),g.val(a.round||"-1"),h.val(a.interviewerStatus||"-1"),i.ipt.val((a.keyWord||"").split("_").join(" "))}function n(a){var b=(a||"").split(/\s+/),c=[];return u.forEach(b,function(a){a=s.trim(a),a&&c.push(a)}),c}function o(){var a=this,b=a.rawConfig.module;return b.getParam().interviewerList||{}}function p(a){var b=this,c=b.rawConfig.module;c.addParam({interviewerList:a})}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Base,v=q.Component,w=q.Str,x=q.Time,y=r.Popup,z=r.Select,A=r.Pager,B=a("../../../../../action/interviewSchedule"),C=(a("../../../../../action/interviewProject"),a("../../cpn/popupInterviewedList")),D=a("../../cpn/popupBookedList"),E=a("../../../../../component/filter/filter"),F=a("../cpn/rScene"),G=c.exports=t.create();t.mix(G,v,{_template:["<div>",'<div class="filter-wrapper js-condition"></div>','<div class="result-info" style="margin-bottom:5px">','<span class="result-num">共 <span class="font-green js-total"></span>份 </span>',"<span>","每页显示 ",'<div class="control-group js-page-select"></div>',"</span>","</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig,d=a.conditionData=c.condData;a.projectId=u.id(c.projectId),a.sceneId=u.id(c.sceneId),a.filterVal=c.filterVal,a.contentEl=b.find(".js-content"),a.initFilter(d),a.initCpn(),a.renderList(d),a.load()}},{name:"click a.js-offline",handler:function(a){var b=this,c=s(a.currentTarget).closest("tr"),d=c.attr("data-id");y.confirm("确定要标记该面试官下线？",function(){B.offLineInterviewer({type:"PUT",params:{projectId:b.projectId},body:{registerId:d},call:function(){y.tips("下线面试官成功",function(){c.find(".js-status-td").html("未在线")})},error:function(a){y.alert(a.msg)}})})}},{name:"click a.js-rank",handler:function(a){var b=this,c=s(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,order:f}),b.load())}},{name:"click a.js-interviewed",handler:function(a){var b=this,c=s(a.currentTarget).closest("tr"),d=c.attr("data-id"),e=c.attr("data-scene-id"),f=c.attr("data-name");C.show({projectId:b.projectId,sceneId:e,interviewerId:d,interviewerName:f})}},{name:"click a.js-booked",handler:function(a){var b=this,c=s(a.currentTarget).closest("tr"),d=c.attr("data-id"),e=c.attr("data-scene-id"),f=c.attr("data-name");D.show({projectId:b.projectId,sceneId:e,interviewerId:d,interviewerName:f})}}]},{initFilter:e,initSceneData:d,initCpn:f,renderList:h,renderWait:i,load:g,renderNone:j,getTimeDisplay:k,updateTotal:l,valCond:m,split:n,getParam:o,addParam:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/list/interviewingList",["nc","cpn","../../../../../action/interviewSchedule","../../../../../util/ajax","../../../../../action/interviewProject","../../../../../action/interviewV2","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond"],function(a,b,c){function d(a){var b=this,c=b.getEl(),d={id:"scene",title:"场次",type:"select",conf:{options:[{text:"不限",value:"-1",checked:"0"===b.sceneId}].concat(s.map(a.sceneList,function(a){return{text:a.name,value:a.id,checked:b.sceneId===s.id(a.id)}}))}},e={id:"job",title:"职位",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0}].concat(s.map(a.jobList,function(a){return{text:a,value:a}}))}},f=[{text:"不限",value:"-1",checked:!0}],g="12345".split("");s.forEach(g,function(a){f.push({text:"第"+a+"轮",value:a})});var h={id:"round",title:"轮次",type:"select",conf:{options:f}},i={id:"type",title:"面试方式",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0},{text:"视频",value:"0"},{text:"线下",value:"1"}]}},j={id:"search",title:"关键词",type:"search",conf:{placeholder:"可输入候选人名字、手机或邮箱，多个关键词用空格分割"}};b.filter=new B({renderTo:c.find(".js-condition"),submitTxt:"查询",line:[{border:!0,items:[d,e,h,i]},{items:[j]}],clearAll:function(){b.valCond({})},listeners:{submit:function(){b.addParam({page:null}),b.load()}}}),b.filterVal&&b.valCond(b.filterVal)}function e(){var a=this,b=a.getEl(),c=a.getParam(),d=+c.pageSize||20;d=s.contains([20,50,100],d)?d:20,a.pageSelect=new x({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:s.map([20,50,100],function(a){return{text:a,value:a,checked:d===a}}),listeners:{change:function(){a.addParam({pageSize:this.val(),page:null}),a.load()}}})}function f(){var a=this;a.renderWait(),z.getInterviewingList({type:"GET",params:{projectId:a.projectId},query:a.valCond(),call:function(b){a.renderList(b.data)},error:function(a){w.alert(a.msg)}})}function g(a){var b=this;if(b.updateTotal(a.totalCount),0===a.totalCount)return void b.renderNone();var c="";s.forEach(a.data,function(a){var b=a.durationSecond,d="";b>3600&&(d+=Math.floor(b/3600)+"小时",b%=3600),b>60&&(d+=Math.floor(b/60)+"分钟",b%=60),b>0&&(d+=b+"秒"),c+=u.execTpl(['<tr data-id="#{id}">',"<td>#{intervieweeName}</td>","<td>#{job}</td>","<td>#{round}</td>","<td>#{scene}</td>","<td>#{interviewerName}</td>","<td>#{bookTime}</td>","<td>#{beginTime}</td>","<td>#{duration}</td>","<td>#{interviewMethod}</td>",'<td><a href="javascript:void(0);" class="link-interview link-green js-over-tip">提示结束</a></td>',"</tr>"].join(""),{id:a.interviewId,intervieweeName:a.intervieweeName||"-",job:a.job||"-",round:"第"+a.round+"轮",scene:a.sceneName||"-",interviewerName:a.interviewerName||"-",bookTime:a.bookTime?v.form(new Date(a.bookTime),"MM-dd HH:mm"):"-",beginTime:a.beginTime?v.form(new Date(a.beginTime),"MM-dd HH:mm"):"-",duration:a.beginTime?d||"0秒":"-",interviewMethod:"1"===s.id(a.offline)?"线下":"视频"})});var d=['<table class="no-border-table table-hover">',"<thead>","<tr>",'<th width="8%">候选人</th>','<th width="10%">面试职位</th>','<th width="5%">轮次</th>','<th width="5%">场次</th>','<th width="10%">面试官</th>','<th width="10%">预约时间</th>','<th width="10%">开始时间</th>','<th width="10%">',"面试时长",'<div class="rank-oprt" data-order-by="0">','<a href="javascript:void(0);" data-order="1" class="js-rank icon-sort-up" title="从短到长"></a>','<a href="javascript:void(0);" data-order="2" class="js-rank icon-sort-down" title="从长到短"></a>',"</div>","</th>",'<th width="10%">面试方式</th>','<th width="10%">操作</th>',"</tr>","</thead>","<tbody>",c,"</tbody>","</table>"].join("");b.contentEl.html(d),new y({renderTo:b.contentEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.addParam({page:a}),b.load()}}),q("div[data-order-by=0]").find(".js-rank[data-order="+b.getParam().order+"]").addClass("selected")}function h(a){var b=this;b.contentEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(a||"加载中...")+"</div>","</div>"].join(""))}function i(){var a=this;a.contentEl.html(['<div class="empty-wrap">','<img src="//uploadfiles.nowcoder.com/images/20170720/56_1500536277704_4A47A0DB6E60853DEDFCFDF08A5CA249">','<div class="empty-tip"><a href="javascript:void(0);" class="link-gray">当前暂没有面试进行哦</a></div>',"</div>"].join(""))}function j(a){var b=this,c=b.getParam(),d=b.filter,e=d.getItem("scene"),f=d.getItem("job"),g=d.getItem("round"),h=d.getItem("type"),i=d.getItem("search");if(0===arguments.length){var j=f.val(),k=e.val(),l=g.val(),m=h.val(),n={sceneId:"-1"===k?void 0:k,job:"-1"===j?void 0:j,round:"-1"===l?void 0:l,interviewType:"-1"===m?void 0:m,offline:"-1"===m?void 0:m,keyWord:b.split(i.ipt.val()).join("_"),order:c.order,page:c.page||1,pageSize:c.pageSize||20};return n}e.val("0"===s.id(a.sceneId)?"-1":s.id(a.sceneId)||"-1"),f.val(a.job||"-1"),g.val(a.round||"-1"),h.val(a.interviewType||"-1"),i.ipt.val((a.keyWord||"").split("_").join(" "))}function k(a){var b=(a||"").split(/\s+/),c=[];return s.forEach(b,function(a){a=q.trim(a),a&&c.push(a)}),c}function l(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function m(){var a=this,b=a.rawConfig.module;return b.getParam().waitList||{}}function n(a){var b=this,c=b.rawConfig.module;c.addParam({waitList:a})}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Clazz,s=o.Base,t=o.Component,u=o.Str,v=o.Time,w=p.Popup,x=p.Select,y=p.Pager,z=a("../../../../../action/interviewSchedule"),A=(a("../../../../../action/interviewProject"),a("../../../../../action/interviewV2")),B=a("../../../../../component/filter/filter"),C=c.exports=r.create();r.mix(C,t,{_template:["<div>",'<div class="js-condition"></div>','<div class="result-info" style="margin-bottom:5px">','<span class="result-num">共 <span class="font-green js-total"></span>份 </span>',"<span>","每页显示 ",'<div class="control-group js-page-select"></div>',"</span>","</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig,d=a.conditionData=c.condData;a.projectId=s.id(c.projectId),a.sceneId=s.id(c.sceneId),a.filterVal=c.filterVal,a.contentEl=b.find(".js-content"),a.initFilter(d),a.initCpn(d),a.renderList(d),a.load()}},{name:"click a.js-rank",handler:function(a){var b=this,c=q(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,order:f}),b.load())}},{name:"click a.js-over-tip",handler:function(a){var b=q(a.currentTarget).closest("tr"),c=b.attr("data-id");w.confirm("确定要提醒该面试官面试时间过长？",function(){A.tipInterviewer({type:"PUT",params:{roomId:c},body:{tip:1},call:function(){w.tips("给面试官发送提醒消息成功")},error:function(a){w.alert(a.msg)}})})}}]},{initFilter:d,initCpn:e,load:f,renderList:g,renderWait:h,updateTotal:l,renderNone:i,valCond:j,split:k,getParam:m,addParam:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/list/waitList",["nc","cpn","../../../../../action/interviewSchedule","../../../../../util/ajax","../../../../../action/interviewV2","../../../../../action/interviewProject","../../cpn/popupJobInterviewer","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/popupSub/popupJoinSession","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/util","../../../../../core/module"],function(a,b,c){function d(a){var b=this,c=b.getEl(),d={id:"scene",title:"场次",type:"select",conf:{options:[{text:"不限",value:"-1",checked:"0"===b.sceneId}].concat(v.map(a.sceneList,function(a){return{text:a.name,value:v.id(a.id),checked:b.sceneId===v.id(a.id)}})),change:function(){b.fixScene()}}},e={id:"job",title:"职位",type:"select",conf:{options:[]}},f={id:"round",title:"轮次",type:"select",conf:{options:[]}},g={id:"type",title:"面试方式",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0},{text:"视频",value:"0"},{text:"线下",value:"1"}]}},h={id:"online",title:"是否在线",type:"select",conf:{options:[{text:"不限",value:"-1",checked:"0"!==b.sceneId},{text:"是",value:"1",checked:"0"===b.sceneId},{text:"否",value:"2"}]}},i={id:"interviewer",title:"面试官状态",type:"select",conf:{options:b.getInterviewerOptions()}},j={id:"checked",title:"是否签到",type:"select",conf:{options:[{text:"不限",value:"-1",checked:"0"===b.sceneId},{text:"已签到",value:"1",checked:"0"!==b.sceneId},{text:"待签到",value:"2"},{text:"不可签到",value:"3"},{text:"无需签到",value:"4"}]}},k={id:"status",title:"面试状态",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0},{text:"等待",value:"1"},{text:"已分配",value:"2"},{text:"已叫号",value:"3"},{text:"异常签到",value:"4"}]}},l={id:"search",title:"关键词",type:"search",conf:{placeholder:"可输入候选人名字、手机或邮箱，多个关键词用空格分割"}};b.filter=new F({renderTo:c.find(".js-condition"),submitTxt:"查询",line:[{border:!0,items:[d,e,f,g,h,i,j,k]},{items:[l]}],clearAll:function(){b.valCond({})},listeners:{submit:function(){b.addParam({page:null}),b.load()}}}),b.fixScene(),b.filterVal&&b.valCond(b.filterVal)}function e(){var a=this,b=a.getEl(),c=a.getParam(),d=+c.pageSize||20;d=v.contains([20,50,100],d)?d:20,a.pageSelect=new A({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:v.map([20,50,100],function(a){return{text:a,value:a,checked:d===a}}),listeners:{change:function(){a.addParam({pageSize:this.val(),page:null}),a.load()}}})}function f(){var a=this;a.renderWait(),C.getWaitingList({type:"GET",params:{projectId:a.projectId},query:a.valCond(),call:function(b){a.renderList(b.data)},error:function(a){z.alert(a.msg)}})}function g(a){var b=this;if(b.updateTotal(a.totalCount),0===a.totalCount)return void b.renderNone();var c="";v.forEach(a.data,function(a){var d=(0!==a.sceneId,v.id(a.interviewerStatus)),e="";"0"===d?e+="(未在线)":"1"===d?e+="（面试中）":"2"===d&&(e+="（闲置中）");var f="";0!==a.checkId&&(0===a.checkStatus?f='<a href="javascript:void(0);" class="link-interview link-green js-advance">提前面试</a><a href="javascript:void(0);" class="link-interview link-green js-dis-check">未到场</a>':3===a.checkStatus?(f='<a href="javascript:void(0);" class="link-interview link-green js-reset-alloc" data-alloc-id="'+a.allocId+'">取消分配('+(a.allocInterviewerName||"未知")+")</a>",a.calledCount>0&&(f+='<a href="javascript:void(0);" class="link-interview link-green js-call" data-table-num="'+a.allocInterviewerTableNum+'" data-alloc-id="'+a.allocId+'">叫号('+a.calledCount+")</a>")):4===a.checkStatus&&(f='<a href="javascript:void(0);" class="link-interview link-green js-dis-check">取消签到</a>'));var g="-",h="";a.checked&&(g=0===a.checkStatus?"等待":4===a.checkStatus?'<span class="font-red">异常签到</span>':a.calledCount>0?"已叫号":"被分配");var i;if(1===a.waitCheckStatus)h=y.form(new Date(a.checkInTime),"MM-dd HH:mm"),i="已签到";else if(2===a.waitCheckStatus)h="-",i="待签到";else if(3===a.waitCheckStatus){if(a.bookTime){var j=new Date,k=new Date(a.bookTime),l=j.getTime()-k.getTime();h=l>0?"超过预约时间12小时":"未到签到时间"}else h="未设置预约时间";i="不可签到",f+=' <a href="javascript:void(0);" class="link-interview link-green js-open-check" data-id="'+a.interviewId+'" data-round="'+a.round+'">开启签到</a>'}else i="无需签到",a.bookTime?(h="未加入到场次",f+='<a href="javascript:void(0);" class="link-interview link-green js-join-scene" data-id="'+a.interviewId+'" data-round="'+a.round+'">加入场次</a>'):h="未设置签到时间";var m;m="1"===v.id(a.offline)?"https://interview.nowcoder.com/interview/"+a.interviewId+"/offline?code="+a.interviewerPwd:"https://interview.nowcoder.com/interview/"+a.interviewId+"/interviewer?code="+a.interviewerPwd,c+=x.execTpl(['<tr data-job="#{job}" data-scene-id="#{sceneId}" data-check-id="#{id}" data-round="#{round}" data-scene-type="#{sceneType}">',"<td>#{intervieweeName}</td>","<td>#{intervieweePhone}</td>","<td>#{intervieweeEmail}</td>","<td>#{bookTime}</td>","<td>#{checked}</td>","<td>#{checkTime}</td>","<td>#{checkStatus}</td>","<td>#{waitDuration}</td>","<td>#{scene}</td>","<td>#{job}</td>","<td>第#{round}轮</td>","<td>#{intervieweeOnline}</td>","<td>#{interviewMethod}</td>","<td>#{interviewerName}</td>","<td>#{interviewerUrl}</td>","</tr>"].join(""),{index:a.index,id:a.checkId,intervieweeName:a.intervieweeName,intervieweePhone:a.intervieweePhone,intervieweeEmail:a.intervieweeEmail,job:a.job||"-",round:a.round,interviewerName:a.interviewerName?a.interviewerName+e:"未知",bookTime:a.bookTime?y.form(new Date(a.bookTime),"MM-dd HH:mm"):"-",checkTime:h,waitDuration:(b.getTimeStr(a.waitTimeSecond)||"-")+f,interviewMethod:"1"===v.id(a.offline)?"线下":"视频",scene:a.sceneName||"-",sceneId:a.sceneId,intervieweeOnline:a.intervieweeOnline?"是":"否",checked:i,checkStatus:g,sceneType:a.sceneType,interviewerUrl:'<a href="javascript:void(0);" data-clipboard-text = "'+m+'" class="link-interview link-green js-copy">复制链接</a>'})});var d=['<table class="no-border-table table-hover">',"<thead>","<tr>",'<th width="5%">候选人</th>','<th width="8%">候选人手机</th>','<th width="8%">候选人邮箱</th>','<th width="10%">预约时间</th>','<th width="10%">是否签到</th>','<th width="10%">签到时间','<div class="rank-oprt" data-order-by="0">','<a href="javascript:void(0);" data-order="1" class="js-rank icon-sort-up" title="从短到长"></a>','<a href="javascript:void(0);" data-order="2" class="js-rank icon-sort-down" title="从长到短"></a>',"</div>","</th>",'<th width="5%">面试状态</th>','<th width="30%">持续时长','<a href="javascript:void(0);" class="help-wrapper link-gray js-time-tip js-tips" data-theme="white" title="考生未签到就显示在线时长，考生已签到就显示签到时长">','<i class="icon-question-sign"></i>',"</a>","</th>",'<th width="8%">场次</th>','<th width="5%">面试职位</th>','<th width="5%">轮次</th>','<th width="5%">在线</th>','<th width="5%">面试方式</th>','<th width="5%">预约面试官</th>','<th width="5%">面试官链接</th>',"</tr>","</thead>","<tbody>",c,"</tbody>","</table>"].join("");b.contentEl.html(d),new B({renderTo:b.contentEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.addParam({page:a}),b.load()}}),t("div[data-order-by=0]").find(".js-rank[data-order="+b.getParam().order+"]").addClass("selected")}function h(a){var b=this;b.contentEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(a||"加载中...")+"</div>","</div>"].join(""))}function i(){var a=this;a.contentEl.html(['<div class="empty-wrap">','<img src="//uploadfiles.nowcoder.com/images/20170720/56_1500536390215_10FB15C77258A991B0028080A64FB42D">','<div class="empty-tip"><a href="javascript:void(0);" class="link-gray">当前暂没有符合条件的面试进行哦</a></div>',"</div>"].join(""))}function j(a){var b="";return a>3600&&(b+=Math.floor(a/3600)+"小时",a%=3600),a>60&&(b+=Math.floor(a/60)+"分钟",a%=60),a>0&&(b+=a+"秒"),b}function k(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function l(a){var b=this,c=b.getParam(),d=b.filter,e=d.getItem("scene"),f=d.getItem("job"),g=d.getItem("online"),h=d.getItem("round"),i=d.getItem("type"),j=d.getItem("status"),k=d.getItem("checked"),l=d.getItem("interviewer"),m=d.getItem("search");if(0===arguments.length){var n=e.val(),o=f.val(),p=h.val(),q=g.val(),r=k.val(),s=i.val(),t=j.val(),u=l.val(),w={sceneId:"-1"===n?void 0:n,job:"-1"===o?void 0:o,round:"-1"===p?void 0:p,online:"-1"===q?void 0:q,checkStatus:"-1"===r?void 0:r,interviewType:"-1"===s?void 0:s,interviewerStatus:"-1"===u?void 0:u,offline:"-1"===s?void 0:s,status:"-1"===t?void 0:t,keyWord:b.split(m.ipt.val()).join("_"),order:b.getParam().order||0,page:c.page||1,pageSize:c.pageSize||20};return w}e.val("0"===v.id(a.sceneId)?"-1":v.id(a.sceneId)||"-1"),f.val(a.job||"-1"),h.val(a.round||"-1"),i.val(a.interviewType||"-1"),j.val(a.status||"-1"),k.val(a.checkStatus||"-1"),l.val(a.interviewerStatus||"-1"),m.ipt.val((a.keyWord||"").split("_").join(" ")),v.id(a.online)&&g.val(v.id(a.online))}function m(){var a=[{text:"不限",value:"-1",checked:!0}];return a.push({text:"未在线",value:"1"}),a.push({text:"面试中",value:"2"}),a.push({text:"闲置",value:"3"}),a}function n(a){var b=(a||"").split(/\s+/),c=[];return v.forEach(b,function(a){a=t.trim(a),a&&c.push(a)}),c}function o(){function a(){var a={job:{},round:{}};return v.forEach(h.sceneList,function(b){a.job[b.id]=b.jobs,a.round[b.id]=b.roundIds.split(",")}),a}var b=this,c=b.filter,d=c.getItem("scene"),e=c.getItem("job"),f=c.getItem("round"),g=d.val(),h=b.conditionData,i=b.sceneMap||a(),j=("-1"===g?h.jobList:i.job[g])||[];e.replaceOptions([{text:"不限",value:"-1",checked:!0}].concat(v.map(j,function(a){return{text:a,value:a}})));var k="-1"===g?["1","2","3","4","5"]:i.round[g]||[];f.replaceOptions([{text:"不限",value:"-1",checked:!0}].concat(v.map(k,function(a){return{text:"第"+a+"轮",value:a}})))}function p(){var a=this,b=a.rawConfig.module;return b.getParam().waitList||{}}function q(a){var b=this,c=b.rawConfig.module;c.addParam({waitList:a})}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Clazz,v=r.Base,w=r.Component,x=r.Str,y=r.Time,z=s.Popup,A=s.Select,B=s.Pager,C=(s.Tips,a("../../../../../action/interviewSchedule")),D=a("../../../../../action/interviewV2"),C=(a("../../../../../action/interviewProject"),a("../../../../../action/interviewSchedule")),E=a("../../cpn/popupJobInterviewer"),F=a("../../../../../component/filter/filter"),G=a("../../../../../component/popupSub/popupJoinSession"),H=a("../../../../../util/util"),I=(a("../../../extend/bll/task"),a("../../../../../core/module"),c.exports=u.create());u.mix(I,w,{title:"面试等待列表",_template:["<div>",'<div class="js-condition"></div>','<div class="result-info" style="margin-bottom:5px">','<span class="result-num">共 <span class="font-green js-total"></span>份 </span>','<span>每页显示 <div class="control-group js-page-select"></div></span>',"</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig,d=a.conditionData=c.condData;a.projectId=v.id(c.projectId),a.sceneId=v.id(c.sceneId),a.filterVal=c.filterVal,a.contentEl=b.find(".js-content"),a.initFilter(d),a.initCpn(d),a.renderList(d),a.load()}},{name:"click a.js-advance",handler:function(a){{var b=this,c=t(a.currentTarget).closest("tr"),d=c.attr("data-check-id"),e=+c.attr("data-scene-id"),f=c.attr("data-scene-type"),g=c.attr("data-job");c.attr("data-round")}return 0===e?void z.alert("不属于任何面试场次"):g?void E.show({projectId:b.projectId,sceneId:e,job:g,checkId:d,round:f,call:function(){b.load()}}):void z.alert("面试职位不能为空")}},{name:"click a.js-dis-check",handler:function(a){var b=this,c=t(a.currentTarget).closest("tr"),d=c.attr("data-check-id");z.confirm("确定取消用户签到",function(){C.delIntervieweeCheck({type:"DELETE",params:{projectId:b.projectId},body:{checkId:d},call:function(){b.load()},error:function(a){z.alert(a.msg)}})})}},{name:"click a.js-rank",handler:function(a){var b=this,c=t(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,order:f}),b.load())}},{name:"click a.js-copy",handler:function(a){var b=t(a.currentTarget);H.copy(b,function(){z.tips("该候选人对应的面试官链接已复制，请粘贴给需要的面试官。",3e3)})}},{name:"click a.js-reset-alloc",handler:function(a){var b=this,c=t(a.currentTarget),d=c.attr("data-alloc-id");return"0"===v.id(d)?void z.alert("分配记录不存在"):void z.confirm("确认面试官已经不准备面试该候选人了?",function(){C.resetAlloc({type:"PUT",params:{projectId:b.projectId},body:{allocId:d},call:function(){b.load()},error:function(a){z.alert(a.msg)}})})}},{name:"click a.js-call",handler:function(a){var b=this,c=t(a.currentTarget),d=c.attr("data-alloc-id"),e=c.attr("data-table-num"),f=t(a.currentTarget).closest("tr"),g=+f.attr("data-scene-id");return"0"===v.id(d)?void z.alert("分配记录不存在"):0===g?void z.alert("场次id不存在"):"0"===v.id(e)?void z.alert("面试官没有登记桌号信息"):void z.confirm("确定叫号该候选人到"+e+"号桌面试?",function(){C.addCall({type:"POST",params:{projectId:b.projectId,sceneId:g},body:{allocId:d},call:function(){b.load()},error:function(a){z.alert(a.msg)}})})}},{name:"click a.js-open-check",handler:function(a){var b=this,c=t(a.currentTarget),d=c.attr("data-id"),e=c.attr("data-round");z.confirm("确定将该候选人预约时间设置为当前时间?",function(){D.resetRoundBookTime({type:"PUT",params:{id:d},body:{round:e},call:function(){b.load()},error:function(a){z.alert(a.msg)}})})}},{name:"click .js-join-scene",handler:function(a){var b=this,c=t(a.currentTarget).attr("data-id");G.show({cond:{isAll:2,ids:c},projectId:b.projectId,module:b,ok:function(){b.load()}})}}]},{initFilter:d,initCpn:e,renderList:g,renderWait:h,renderNone:i,load:f,getTimeStr:j,updateTotal:k,valCond:l,getInterviewerOptions:m,split:n,fixScene:o,getParam:p,addParam:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/search/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./item","../../../../../component/popupSub/popupIvInfo","../../../../../util/interview","../../../../../action/interview","../../../../../util/ajax","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../../../component/popupSub/popupIvScore","../../../../../component/table","../../../../../component/selectAll","../../cpn/popupJobInterviewer","./interviewStatus"],function(a,b,c){function d(a){var b=this;b.rawConfig=a;var c=b.getParam();b.projectId=c.projectId,b.sceneId=c.sceneId||"0",b.projectName=c.projectName,b.sceneName=c.sceneName,b.keyword=c.keyword}function e(){var a=this,b=a.searchCpn=new n({renderTo:a.getEl(".js-search-input"),renderBy:"replaceWith",placeholder:"0"===a.sceneId?"输入本项目中的候选人姓名／投递编号／手机／邮箱 查询候选人的面试详情":"输入本场次中的候选人姓名／投递编号／手机／邮箱 查询候选人的面试详情"});b.getEl().width("100%"),b.getEl().prepend('<label class="ico-search"></label>'),b.val(a.keyword),b.listen("pressEnter",l.bind(a.search,a))}function f(a){var b=this,c=b.getEl(),d=c.find(".js-main"),e=k.trim(b.searchCpn.val());b.renderWait(d),r.search({params:{projectId:b.projectId},query:{sceneId:b.sceneId,keyWord:e},call:function(a){b.getEl(".js-main").html(""),b.renderData(a.data||[]),b.addParam({keyword:e})},error:function(c){l.isFunction(a)?a(c.msg):"popup"===a?o.alert(c.msg):b.renderNone(d,c.msg)}})}function g(a){var b=this;return 0===a.length?b.renderNone(b.getEl(".js-main"),"0"===b.sceneId?"你搜索的候选人不在该面试项目中":'你搜索的候选人不在该场次中，点击在该<a href="javascript:void(0);" class="font-green js-project-search">项目中搜索候选人</a>'):void l.forEach(a,function(a){new q({renderTo:b.getEl(".js-main"),module:b,projectId:b.projectId,sceneId:b.sceneId,data:a,listeners:{refresh:function(){b.search()}}})})}function h(){var a=this,b=[{title:"项目列表",module:"interview",action:"project/index"}];return a.projectName&&b.push({title:"项目("+a.projectName+")",module:"interview",param:{action:"group/index",projectId:a.projectId}}),"0"!==a.sceneId&&(b=b.concat([{title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:a.projectId}},{title:"场次("+a.sceneName+")",module:"interview",param:{action:"schedule/index",projectId:a.projectId,sceneId:a.sceneId}}])),{crumb:b}}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Base,m=i.Clazz,n=(i.Component,j.Input),o=j.Popup,p=a("../../../../../core/module"),q=a("./item"),r=a("../../../../../action/interviewSchedule"),s=c.exports=m.create();m.mix(s,p,{style:"/stylesheets/styles/system/interview.css",title:"查询面试",_template:['<div class="module-box test-mod">','<div class="module-head clearfix">',"<h1>查询面试</h1>",'<div class="module-head-oprt">','<a href="javascript:void(0);" class="link-green js-go-back">&lt; 返回现场管理</a>',"</div>","</div>",'<div class="module-body">','<div class="search-input-wrap">','<div class="js-search-input"></div>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-search-btn">搜索</a>',"</div>",'<div class="js-main"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.search()}},{name:"click .js-go-back",handler:function(){var a=this;a.nav("interview",{action:"schedule/index",projectId:a.projectId})}},{name:"click .js-search-btn",handler:function(){var a=this;a.search()}},{name:"click .js-project-search",handler:function(){var a=this;a.sceneId="0",a.addParam({sceneId:a.sceneId}),a.search()}}]},{initialize:d,initCpns:e,search:f,renderData:g,getCrumbConf:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/search/interviewStatus",["nc"],function(a,b,c){function d(a){var b=this;b.updateConf(a)}function e(a){var b=this,c=b.data=a.data||{};b.round=(c.rounds||[])[c.round-1]||{},b.scene=(c.apiCtsInterviewScenes||[])[0]||{},b.interviewSceneStatuses=c.interviewSceneStatuses||[],b.ifInScene=a.ifInScene,b.curScene=b.ifInScene?b.interviewSceneStatuses[0]||{}:{}}function f(){var a=this;return a.data.intervieweeOnline}function g(a){var b=this;return a?a.checked:b.curScene.checked}function h(){var a=this;return a.interviewSceneStatuses.length>0}function i(){var a=this;return a.round.bookTime}function j(){var a=this;return a.round.bookTime-36e5<(new Date).getTime()}function k(a){var b=this;return(new Date).getTime()-b.round.bookTime>3600*a*1e3}function l(a){var b=this;return a?3===a.checkStatus:3===b.curScene.checkStatus}function m(a){var b=this;return a?a.calledCount:b.curScene.calledCount}function n(a){var b=this;return a?2===a.checkStatus:2===b.curScene.checkStatus}function o(a){var b=this;return a?1===a.interviewStatus:1===b.curScene.interviewStatus}function p(a){var b=this;return a?2===a.interviewStatus:2===b.curScene.interviewStatus}function q(){var a,b=this;return v.forReverse(b.data.rounds,function(b,c){return 3===b.status?(a={round:b,roundIndex:c+1},v.BREAK):void 0}),a}function r(a,b){var c=this;return a?a[b]:c.curScene[b]}function s(){var a=this;return v.map(a.interviewSceneStatuses,function(a){return a.sceneName})}function t(){var a=this,b=!0;return v.forEach(a.data.rounds,function(a){a.bookTime&&x.form(new Date(a.bookTime),"yyyy-MM-dd")!==x.form(new Date,"yyyy-MM-dd")||(b=!1)}),b}var u=a("nc"),v=(u.$,u.Base),w=u.Clazz,x=u.Time,y=c.exports=w.create();v.extend(y.prototype,{initialize:d,updateConf:e,ifOnline:f,ifChecked:g,ifJoinScene:h,ifSetBookTime:i,ifOpenCheck:j,ifMissCheck:k,ifAlloted:l,getCalledCount:m,ifInInterview:n,ifEndTodayInterview:o,ifInSubmiting:p,getLastInterviewRound:q,getSceneData:r,getSceneName:s,ifNoTodayInterview:t})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/search/item",["nc","cpn","../../../../../component/popupSub/popupIvInfo","../../../../../util/interview","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/interview","../../../../../util/ajax","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../../../component/popupSub/popupIvScore","../../../../../component/table","../../../../../component/selectAll","../../cpn/popupJobInterviewer","./interviewStatus"],function(a,b,c){function d(){var a=this;a.interviewStatus=new R({data:a.rawConfig.data,ifInScene:a.ifInScene()})}function e(){var a=this;a.getEl().html(F.execTpl(['<div class="panel">','<div class="panel-hd">','<div class="panel-oprt">#{stateInfo}</div>','<h3 class="panel-title">','<span class="jobhunter">#{data.intervieweeName}</span>','<span class="jobhunter-info">#{profile}</span>',"</h3>","</div>",'<div class="panel-bd interview-detail">','<div v-if="infoTips" class="info-tips">#{infoTips}</div>',"<ul>",'<li v-if="showType !== 1">',"面试官地址：#{data.interviewerUrl}",'<a href="javascript:void(0);" class="link-green js-copy" :data-clipboard-text="data.interviewerUrl">复制</a>',"</li>",'<li v-if="showType !== 1">',"候选人地址：#{data.intervieweeUrl}",'<a href="javascript:void(0);" class="link-green js-copy" :data-clipboard-text="data.intervieweeUrl">复制</a>',"</li>",'<li v-if="showType !== 0">',"面试官线下地址：#{interviewOfflineUrl}",'<a href="javascript:void(0);" class="link-green js-copy" :data-clipboard-text="interviewOfflineUrl">复制</a>',"</li>","</ul>",'<div class="js-table"></div>','<div class="filter-fold-oprt" style="display:none;">','<a href="javascript:void(0);" class="icon-angle-down js-fold-record" data-show="1" style="display:none;">查看更多操作详情</a>','<a href="javascript:void(0);" class="icon-angle-up icon-angle-up-block js-fold-record" data-show="0" style="display:none;">收起</a>',"</div>","</div>","</div>"],{data:a.data,stateInfo:a.getIntervieeStateHtml(),profile:a.getProfileHtml(),infoTips:a.getInfoTips(),showType:T.isAllOnLine(a.data.rounds)?0:T.isAllOffline(a.data.rounds)?1:2,interviewOfflineUrl:a.data.interviewerUrl.replace("interviewer","offline")})),a.renderTable(),S.copy(a.getEl(".js-copy"),function(){K.tips("复制成功")})}function f(){function a(a,c){if(4===a)return b("修改面试信息","arrangeInterview");if(8===a)return e.ifJoinScene()?"":b("加入到场次","joinScene");if(14===a)return e.ifChecked(c)?"":b("恢复签到","recoverCheck");if(16===a)return e.ifAlloted(c)?"":(c.checkId?b("提前面试","aheadInterview",!0):"")+b("预约其他面试官","arrangeInterview");if(19===a){var f=d.rounds[c.round+1],g=!f||!f.beginTime;return b("修改评分评价","updateScore",g)+(g?b("清空面试记录","clearRecord"):"")}}function b(a,b,c){return I.execTpl('<a href="javascript:void(0);" class="js-log-action font-green" data-method="#{method}"#{style}>#{text}</a>',{method:b,style:c?' style="margin-right:10px;"':"",text:a})}var c=this,d=c.data,e=c.interviewStatus,f=d.apiInterviewActionLogs;if(!f||0===f.length)return c.module.renderNone(c.getEl(".js-table"),"暂无操作记录");var g={list:[]};C.forEach(f,function(b,c){var d=[b.actionInfo,b.roundInfo||"--",b.actorInfo,G.form(new Date(b.createTime)),a(b.actionType,b)];g.list.push({items:d,attr:{"data-index":c}})}),c.getEl(".js-table").html(P.getHtml(g)),c.displayOvermuchRecord()}function g(){var a=this,b=C.isArray(a.stateInfo)?a.stateInfo:[a.stateInfo],c=a.timeTipEl=[];C.forEach(b,function(b){if(b.title){var d=a.getEl(".js-state-info"),e=new J({content:b.title,noCenter:!0,target:d,hidden:!0});e.theme(!0),e.getEl(".js-status-action").on("click",function(b){var c=B(b.currentTarget),d=c.attr("data-method"),e=c.attr("data-scene-index"),f=C.id(e)?a.data.interviewSceneStatuses[e]:null;a[d]&&a[d](f)}),c.push(e.getEl(".js-time")),H.hoverToggle({el:[e.getEl(),d],enter:function(){e.show(),e.fixPosition()},leave:function(){e.hide()}})}})}function h(){var a=this;if(a.needCountTime){var b=G.frequency(1e3);b(function(){var c=arguments.callee,d=a.countTime=(a.countTime||0)+1,e=a.getEl(".js-time");C.forEach(e,function(a){a=B(a);var b=+a.attr("data-time")+d;a.html(G.second(b))}),C.forEach(a.timeTipEl,function(a){a=B(a);var b=+a.attr("data-time")+d;a.html(G.second(b))}),b(c)})}}function i(){var a=this,b=a.data,c=[];return C.forEach(["job","intervieweeEmail","intervieweePhone"],function(a){b[a]&&c.push("<span>"+b[a]+"</span>")}),c.join("<span>|</span>")}function j(){function a(a,b){var i="";if(g.ifInSubmiting(a))return{text:"面试结果提交中"};if(g.ifEndTodayInterview(a)){if(e.ifInScene()){var j=g.getLastInterviewRound()||{},k=j.roundIndex||0,l=j.round.score||0,m=l?l>2?"（通过）":"（淘汰）":"";i="今日面试已结束，最后一轮：第"+k+"轮，"+l+"分"+m}return{text:"今日面试已结束",title:i}}if(!g.ifOnline()&&!f.offline&&!a)return{text:"未在线"};if(!g.ifChecked(a))return a&&a.offline?{text:"未签到"}:(g.ifSetBookTime()?g.ifOpenCheck()?g.ifMissCheck(12)&&(i="超过签到时间12小时，无法签到，"+c("点击开启签到","openCheck",b)):i="未到签到时间（"+G.form(new Date(h.bookTime-36e5))+"）无法签到，"+c("点击开启签到","openCheck",b):i="未设置预约时间，无法签到，"+c("点击开启签到","openCheck",b),{text:"已在线（未签到）："+d(g.getSceneData(a,"waitTimeSecond")),title:i});if(g.ifInInterview(a))return{text:"面试中："+d(h.elapsedTime/1e3),title:"面试时间过长，可以"+c("提示结束面试","remindFinishInterview",b)};var n=g.getCalledCount(a);return n?{text:"已叫号（"+g.getSceneData(a,"allocInterviewerName")+"）：第"+n+"次",title:"候选人多次被叫号仍未到场，可以"+c("标记未到场","markUnpresent",b)}:g.ifAlloted(a)?{text:"已分配（"+g.getSceneData(a,"allocInterviewerName")+"）："+d(g.getSceneData(a,"waitTimeSecond")),title:"候选人被分配，请核查候选人是否正在面试，如果未面试可以"+c("取消分配","cancelAllot",b)}:{text:"已签到（第"+f.round+"轮）："+d(g.getSceneData(a,"waitTimeSecond")),title:"如果候选人等待时间过长，可以"+c("提前面试","aheadInterview",b)}}function b(){var b=[],h=[],i=[],j=!1,k=!1;return C.forEach(e.data.interviewSceneStatuses,function(c,d){var e=a(c,d),f=[c.sceneName,"-",e.text,e.title?"，":"",e.title].join("");c.offline?b.push(f):h.push(f)}),C.forEach(e.data.rounds,function(a){k=k||0===a.offline,j=j||1===a.offline}),!g.ifJoinScene()&&g.ifOnline()&&h.push("未加入到场次无法签到，"+c("点击加入到场次","joinScene")),j&&i.push({text:b.length>0?"已加入到现场面试场次":"未加入到现场面试场次",title:b.join("")}),k&&i.push({text:g.ifOnline()?"已在线："+d(((new Date).getTime()-f.checkInTime)/1e3):"未在线",title:g.ifOnline()?h.join(""):""}),i}function c(a,b,c){return'<a href="javascript:void(0);" class="js-status-action font-green" data-method="'+b+(C.id(c)?'" data-scene-index="'+c:"")+'">'+a+"</a>"}function d(a){return e.needCountTime=!0,'<span class="js-time" data-time="'+a+'">'+G.second(a)+"</span>"}var e=this,f=e.data,g=e.interviewStatus,h=g.round,i=e.stateInfo=e.ifInScene()?a():b();return i=C.isArray(i)?i:[i],C.map(i,function(a){return a.title?'<a href="javascript:void(0);" class="panel-oprt-tag js-state-info">'+a.text+"</a>":'<span class="panel-oprt-tag">'+a.text+"</span>"}).join("")}function k(){function a(a,b,c){return a+'<a href="javascript:void(0);" class="js-action font-green" data-method="'+c+'">'+b+"</a>"}var b=this,c=b.interviewStatus;return c.ifNoTodayInterview()?a("候选人今日无面试安排，","点击安排面试","arrangeInterview"):c.ifJoinScene()?a("候选人已加入到场次（"+c.getSceneName().join("/")+"），","点击加入到其他场次","joinScene"):a("候选人未加入场次，","点击加入到场次","joinScene")}function l(){var a=this;M.show({cond:{isAll:2,ids:a.data.interviewId},type:"single",projectId:a.projectId,module:a.module,ok:function(){a.fire("refresh")},listeners:{loaded:function(){this.selectSession(a.interviewStatus.scene.id)}}})}function m(){var a=this;U.resetRoundBookTime({type:"PUT",params:{id:a.data.interviewId},body:{round:a.data.round},call:function(){K.tips("操作成功",function(){a.fire("refresh")})},error:function(a){K.alert(a.msg)}})}function n(a){var b=this,c=b.data;return a=a||{},c.job?void Q.show({projectId:b.projectId,sceneId:a.sceneId,job:c.job,checkId:a.checkId,round:a.sceneType,call:function(){b.fire("refresh")}}):void K.alert("面试职位不能为空")}function o(a,b){var c=this;a=a||{};var d=a.allocId;return"0"===C.id(d)?void K.alert("分配记录不存在"):void V.resetAlloc({type:"PUT",params:{projectId:c.projectId},body:{allocId:d},call:function(){b&&b(),!b&&K.tips("操作成功",function(){c.fire("refresh")})},error:function(a){K.alert(a.msg)}})}function p(a){var b=this;K.confirm("确定候选人未到场？",function(){b.cancelAllot(a,function(){V.delIntervieweeCheck({type:"DELETE",params:{projectId:b.projectId},body:{checkId:a.checkId},call:function(){K.tips("操作成功",function(){b.fire("refresh")})},error:function(a){K.alert(a.msg)}})})})}function q(){var a=this;U.tipInterviewer({type:"PUT",params:{roomId:a.data.interviewId},body:{tip:1},call:function(){K.tips("给面试官发送提醒消息成功")},error:function(a){K.alert(a.msg)}})}function r(a){var b=this;V.recoverCheck({type:"POST",params:{projectId:b.projectId,sceneId:a.sceneId},body:{allocId:a.allocId,checkId:a.checkId},call:function(){K.tips("操作成功",function(){b.fire("refresh")})},error:function(a){K.alert(a.msg)}})}function s(){var a=this;O.show({id:a.data.interviewId,call:function(){a.fire("refresh")}})}function t(){var a=this;L.show({id:a.data.interviewId,projectId:a.projectId,userId:a.module.getUserId(),change:function(){a.fire("refresh")},listeners:{loaded:function(){this.getEl(".panel-hd").css("background-color","#fff"),this.getEl(".panel-bd").css({"background-color":"#fff",padding:"0"}),this.getEl(".panel").css("border","none")}}})}function u(a){var b=this,c=b.data,d=c.rounds[a.round-1];N.show({room:a.interviewId,id:d.id,round:d.round,score:d.score,desc:d.evaluation,interviewerName:d.interviewerName,interviewerPwd:c.interviewerPwd,call:function(a){var e=c.rounds.length===d.round;e&&(+d.score||0)<=2&&(+a.score||0)>2?new K({title:"修改评分成功",noUnique:!0,content:['<div class="pop-content">','<div class="pop-interview"><div class="ico-success"><i class="fui-check-inverted"></i></div></div>','<div style="padding-top:20px;font-size:14px;text-align:center;">已将候选人修改为第'+d.round+"轮通过状态，可以为候选人预约下一轮</div>",'<div class="pop-btn-wrapper">','<a href="javascript:void(0);" class="btn btn-primary confirm-btn">预约下一轮</a>','<a href="javascript:void(0);" class="btn btn-primary js-close-popup">返回列表</a>',"</div>","</div>"].join(""),listeners:{ok:function(){b.arrangeInterview()},cancel:function(){b.fire("refresh")}}}):K.tips("操作成功",function(){b.fire("refresh")})}})}function v(a){var b=this,c=b.data,d=c.rounds[a.round-1];if(d){var e=I.execTpl(['<div style="text-align:left">',"你将清空的内容为：<br/>","#{intervieweeName}的第#{round}轮面试，<br/>","面试状态：#{roundStatus},<br/>","面试官：#{inerviewerName}<br/>","面试评分：#{score}<br/>","实际面试时间：#{beginTime}<br/>","面试用时：#{durtionMins}<br/>","清空后该轮面试记录不可恢复，且原记录使用过的时长不退回。确定清空吗？</div>"].join(""),{intervieweeName:c.intervieweeName||"-",inerviewerName:d.interviewerName||"-",round:d.round,roundStatus:{1:"面试中",3:"已结束",5:"已暂停",0:"未开始"}[d.status]||"",beginTime:C.id(d.beginTime)?G.form(new Date(d.beginTime)):"无",score:(d.score?d.score:"未评")+"分",durtionMins:Math.round((d.elapsedTime||0)/6e4)+"分钟"});K.confirm(e,function(){W.resetRound({type:"PUT",params:{roomId:a.interviewId,roundId:d.id},call:function(){K.tips("该轮记录删除成功"),b.fire("refresh")},error:function(a){K.alert(a.msg)}})})}}function w(a){var b=this,c=B(a.currentTarget).closest("tr").attr("data-index");return b.data.apiInterviewActionLogs[c]}function x(a){var b=this,c=b.getEl("table tr").slice(10),d=c.length>0;c[a?"show":"hide"](),b.getEl('.js-fold-record[data-show="1"]')[d?a?"hide":"show":"hide"](),b.getEl('.js-fold-record[data-show="0"]')[d&&a?"show":"hide"](),b.getEl(".filter-fold-oprt")[d?"show":"hide"]()}function y(){var a=this;return a.sceneId&&"0"!==C.id(a.sceneId)}var z=a("nc"),A=a("cpn"),B=z.$,C=z.Base,D=z.Clazz,E=z.Component,F=z.Node,G=z.Time,H=z.Dom,I=z.Str,J=A.Tips,K=A.Popup,L=a("../../../../../component/popupSub/popupIvInfo"),M=a("../../../../../component/popupSub/popupJoinSession"),N=a("../../../../../component/popupSub/popupIvScore"),O=a("../../../../../component/popupSub/popupIvEdit"),P=a("../../../../../component/table"),Q=a("../../cpn/popupJobInterviewer"),R=a("./interviewStatus"),S=a("../../../../../util/util"),T=a("../../../../../util/interview"),U=a("../../../../../action/interviewV2"),V=a("../../../../../action/interviewSchedule"),W=a("../../../../../action/interview"),X=c.exports=D.create();D.mix(X,E,{_template:['<div style="margin-bottom:20px;"></div>'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.projectId=b.projectId,a.sceneId=b.sceneId,a.data=b.data,a.initStatus(),a.renderItem(),a.renderTips(),a.initCountTime()}},{name:"click .js-status-action",handler:function(a){var b=this,c=B(a.currentTarget),d=c.attr("data-method"),e=c.attr("data-scene-index"),f=C.id(e)?b.data.interviewSceneStatuses[e]:null;b[d]&&b[d](f)}},{name:"click .js-log-action",handler:function(a){var b=this,c=B(a.currentTarget),d=c.attr("data-method");b[d]&&b[d](b.getLineItem(a))}},{name:"click .js-action",handler:function(a){var b=this,c=B(a.currentTarget),d=c.attr("data-method");b[d]&&b[d]()}},{name:"click .js-fold-record",handler:function(a){var b=this,c=!!+B(a.currentTarget).attr("data-show");b.displayOvermuchRecord(c)}}]},{initStatus:d,renderItem:e,renderTable:f,renderTips:g,initCountTime:h,getProfileHtml:i,getIntervieeStateHtml:j,getInfoTips:k,joinScene:l,openCheck:m,aheadInterview:n,cancelAllot:o,markUnpresent:p,remindFinishInterview:q,recoverCheck:r,arrangeDetail:t,arrangeInterview:s,updateScore:u,clearRecord:v,getLineItem:w,displayOvermuchRecord:x,ifInScene:y})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/step1/index",["nc","cpn","../../../../../action/interviewProject","../../../../../util/ajax","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../core/module","../../../../../util/util","../../../../../util/switch"],function(a,b,c){function d(a){var b=this;"0"!==b.sceneId?b.getScene(function(c){b.scene=c,b.addParam({sceneBegin:c.beginTime?s.form(new Date(c.beginTime),"yyyy-MM-dd"):"",sceneEnd:c.endTime?s.form(new Date(c.endTime),"yyyy-MM-dd"):"",roundListStr:b.parseRoundList(c.setting).join("_"),avgInterviewRound:c.avgInterviewRound,name:c.name,offline:c.offline,type:c.type,seeResume:b.parseShowResume(c.setting),chooseInterview:b.parseChooseInterview(c.setting),modifyEvaluation:b.parseUpdateScore(c.setting)}),b.project={},b.project.id=c.projectId,b.project.projectName=c.projectName,b.refreshCrumb(),a&&a()}):b.getProject(b.projectId,function(c){b.project={},b.project.id=c.id,b.project.projectName=c.name,b.refreshCrumb(),a&&a()})}function e(){{var a=this;a.getEl()}a.form=new w({renderTo:a.getEl(".js-form-home"),renderBy:"html",getSceneByName:r.bind(a.getSceneByName,a),data:a.getParam()})}function f(a,b){u.getProject({params:{projectId:a},query:{},call:function(a){var c=a.data;b&&b(c)},error:function(a){t.alert(a.msg)}})}function g(){function a(){var a=c;return b.hasOfflinePermission=y.can("interviewOffline"),"1"!==r.id(a.offline)||b.hasOfflinePermission?void(b.isEdit?(a.sceneBegin=a.sceneBegin+" 00:00:00",a.sceneEnd=a.sceneEnd+" 23:59:59",v.updateSceneSetting({type:"PUT",params:{projectId:b.projectId,sceneId:b.sceneId},body:a,call:function(){t.tips("修改成功",function(){b.nav("interview",{action:"schedule/index",projectId:b.projectId})})},error:function(a){t.alert(a.msg)}})):v.addSceneSetting({type:"POST",params:{projectId:b.projectId},body:{name:a.name,offline:a.offline,sceneBegin:a.sceneBegin+" 00:00:00",sceneEnd:a.sceneEnd+" 23:59:59",roundListStr:a.roundListStr,type:a.type,seeResume:a.seeResume,chooseInterview:a.chooseInterview,modifyEvaluation:a.modifyEvaluation,avgInterviewRound:a.avgInterviewRound},call:function(a){t.confirm("您的场次已建立，是否现在添加该场次的候选人？",function(){b.nav("interview",{action:"schedule/user/index",projectId:b.projectId,edit:!0,sceneId:r.id(a.data)})},function(){b.nav("interview",{action:"schedule/index",projectId:b.projectId})})},error:function(a){t.alert(a.msg)}})):void t.alert("您还未开启线下面试叫号系统权限，如需使用此功能，请联系管理员：010-60728802或contact@nowcoder.com")}var b=this;if(b.form.check()){var c=b.form.val();b.getSceneByName(c.name,function(c){var d=c&&r.id(c.id)!==r.id(b.sceneId)?"名字已经存在":"";b.form.setNameError(d),d||a()})}}function h(a,b){var c=this;a&&v.getScene({params:{projectId:c.projectId},query:{name:a},call:function(a){b&&b(a.data)}})}function i(a){var b=this;"0"!==b.sceneId&&v.getSceneById({params:{projectId:b.projectId,sceneId:b.sceneId},query:{},call:function(b){a&&a(b.data)}})}function j(a){var b=JSON.parse(a);return b?b.roundList:[]}function k(a){var b=JSON.parse(a);return b?b.seeResume:!0}function l(a){var b=JSON.parse(a);return b?b.chooseInterview:!0}function m(a){var b=JSON.parse(a);return b?b.modifyEvaluation:!0}function n(){var a=this,b=(a.getParam(),a.project),c=a.scene,d=[{title:"项目列表",module:"interview",action:"project/index"}];return b&&d.push({title:"项目("+b.projectName+")",module:"interview",param:{action:"group/index",projectId:b.id}}),d.push({title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:a.projectId}}),c&&d.push({title:"场次("+c.name+")",module:"interview",param:{action:"schedule/index",projectId:b.id,sceneId:c.id}}),{crumb:d}}var o=a("nc"),p=a("cpn"),q=(o.$,o.Clazz),r=o.Base,s=o.Time,t=p.Popup,u=(p.Tips,a("../../../../../action/interviewProject")),v=a("../../../../../action/interviewSchedule"),w=a("../../cpn/interviewSceneForm"),x=a("../../../../../core/module"),y=a("../../../../../util/switch"),z=c.exports=q.create();q.mix(z,x,{style:"/stylesheets/styles/system/interview.css",title:"",_template:['<div class="module-box">','<div class="module-body">','<div class="interview-setting" >','<div class="js-content-step"></div>','<div class="interview-setting-main">','<div class="interview-set-cont js-form-home" style="background-color:#fff;"></div>',"</div>",'<div class="interview-setting-oprt">','<a href="javascript:void(0);" class="btn btn-default js-cancel">取消</a>','<a href="javascript:void(0);" class="btn btn-primary js-next" style="margin-left:20px">确定</a>',"</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getParam();a.getEl()}a.projectId=b.projectId,a.sceneId=r.id(b.sceneId)||"0",a.contentEl=a.getEl().find(".js-content"),a.isEdit="0"!==a.sceneId,a.crumbTitle="0"!==a.sceneId?"编辑面试场次":"新增面试场次",a.refreshCrumb(),a.initData(function(){a.initCpn()})}},{name:"click .js-next",handler:function(){var a=this;a.nextStep()}},{name:"click .js-cancel",handler:function(){var a=this,b=a.getParam();a.nav("interview",{action:"schedule/index",projectId:b.projectId,sceneId:b.sceneId})}}]},{initCpn:e,initData:d,parseRoundList:j,parseShowResume:k,parseChooseInterview:l,parseUpdateScore:m,nextStep:g,getSceneByName:h,getScene:i,getProject:f,getCrumbConf:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/step2/candidateGroup",["nc","cpn","../../../../../component/popupSub/popupSchool","../../../../../action/common","../../../../../util/ajax","./formGroup"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.rawConfig,d=y.execTpl(['<div class="module-box interview-panel">','<div class="module-head clearfix">','<h2 class="js-title">候选人类型#{index}</h2>','<a href="javascript:void(0);" class="icon-trash js-delete"></a>',"</div>",'<div class="module-body set-input-wrap">','<div class="form-group">','<label class="control-label">预约时间</label>','<div style="display:inline-block; margin-right:10px">','<div class="control-group js-start" style="width:auto;float:none;display:inline-block;"><input class="w100" type="text" placeholder="起始"></div>','<span class="item-space">—</span>','<div class="control-group js-end" style="width:auto;float:none;display:inline-block;"><input class="w100" type="text" placeholder="结束"></div>',"</div>",'<label class="checkbox label-sm js-today-ck"><span class="icons"></span>今天</label>',"</div>",'<div class="form-group">','<label class="control-label">职位</label>','<div class="filter-item-txt js-cpn-job"></div>',"</div>",'<div class="js-ext-row"></div>','<div class="form-group interview-round-set">','<label class="control-label">面试状态</label>','<div class="control-group">','<div class="interview-round-item js-add">','<a href="javascript:void(0);" class="add-item-icon"><i class="icon-plus-sign"></i> 添加状态</a>',"</div>","</div>","</div>","</div>","</div>"].join(""),{index:c.index});b.html(d)}function e(){var a=this,b=a.rawConfig,c=a.getEl(),d=a.cpn={},e=d.startDateIpt=B.transform(c.find(".js-start")),f=d.endDateIpt=B.transform(c.find(".js-end"));x.forEach([e,f],function(b){var c=C.show({target:b.getEl(),ipt:b.inputEl,type:"date",startDate:C.yearDiff(-1)+"-01-01",endDate:C.yearDiff(1)+"-12-31",canShow:function(){return!d.todayCb.isChecked()},call:function(c,e){b.val(e),a.fire("conditionChagne"),d.todayCb.checked(!1)}});a.pushChild(c)}),d.todayCb=D.transform(c.find(".js-today-ck"),{change:function(){if(this.isChecked()){var a=z.form(new Date,"yyyy-MM-dd");d.startDateIpt.val(a),d.endDateIpt.val(a)}d.startDateIpt.disabled(this.isChecked()),d.endDateIpt.disabled(this.isChecked())}});var g=a.getJobOptions();d.jobSelect=new A({renderTo:c.find(".js-cpn-job"),renderBy:"replaceWith",size:"small",needSearch:!0,options:g}),0===g.length&&d.jobSelect.disabled(),a.createItem(),a.createItem(),a.createItem();var h=c.find(".js-ext-row").html(""),i=x.toMap(a.condition.builtInFields,function(a){return{key:a.id,value:a}}),j=b.condField,k=[{name:"work_location",key:"workLocationSelect"},{name:"interview_location",key:"interviewLocationSelect"},{name:"job_majar",key:"jobMajarSelect"}];if(x.forEach(k,function(b){var e=b.name,f=b.key;if(i[e]){h.append(a.getExtHtml(i[e]));var g=c.find(".js-cpn-ext-"+e),k=[];x.forEach(j[e],function(a){a=u.trim(a),a&&k.push({text:a,value:a})}),d[f]=new A({renderTo:g,renderBy:"replaceWith",needSearch:!0,options:k})}}),i.city&&(h.append(a.getExtHtml(i.city)),d.locationSelect=new A({cls:"filter-item-txt none",renderTo:c.find(".js-cpn-ext-city"),renderBy:"replaceWith",needSearch:!0,options:[{text:"北京",value:"北京"},{text:"上海",value:"上海"},{text:"广州",value:"广州"},{text:"深圳",value:"深圳"},{text:"杭州",value:"杭州"},{text:"南京",value:"南京"},{text:"西安",value:"西安"},{text:"武汉",value:"武汉"},{text:"哈尔滨",value:"哈尔滨"},{text:"长春",value:"长春"},{text:"成都",value:"成都"},{text:"长沙",value:"长沙"},{text:"合肥",value:"合肥"},{text:"其他",value:"其他"}],render:function(){this.getEl("span.caret").replaceWith('<i class="icon-map-marker">')}})),i.school){h.append(a.getExtHtml(i.school));var l=c.find(".js-cpn-ext-school");l.on("click",function(){E.show({selected:a.schools,call:function(b){a.schools=b;var c=a.getSchool().join(",");l.find("input").val(c).attr("title",c)}})})}}function f(a){var b=this,c=(b.rawConfig,b.cpn),d=b.getEl(),e=c.workLocationSelect,f=c.interviewLocationSelect,g=c.jobMajarSelect,h=c.locationSelect;if(0===arguments.length)return{begin:c.startDateIpt.val()?c.startDateIpt.val()+" 00:00:00":void 0,end:c.endDateIpt.val()?c.endDateIpt.val()+" 23:59:59":void 0,jobList:b.wrapVal(c.jobSelect.val()),roundJson:b.getRoundSearchJson(),workLocationListStr:e?b.wrapVal(e.val()):void 0,interviewLocationListStr:f?b.wrapVal(f.val()):void 0,jobMajarListStr:g?b.wrapVal(g.val()):void 0,cityListStr:h?b.wrapVal(h.val()):void 0,schoolListStr:b.wrapVal(b.getSchool())};a.begin&&c.startDateIpt.val(z.form(new Date(a.begin),"yyyy-MM-dd")),a.end&&c.endDateIpt.val(z.form(new Date(a.end),"yyyy-MM-dd")),c.jobSelect.val((a.jobList||"").split("_")),e&&e.val((a.workLocationListStr||"").split("_")),f&&f.val((a.interviewLocationListStr||"").split("_")),g&&g.val((a.jobMajarListStr||"").split("_")),h&&h.val((a.cityListStr||"").split("_")),b.schools=(a.schoolListStr||"").split("_"),d.find(".js-cpn-ext-school input").val(b.schools.join(","));var i=a.roundJson||[],j=b.groups||[];if(i.length>0){for(;i.length<j.length;){var k=j.pop();k.destroy()}for(;i.length>j.length;)b.createItem();b.checkRoundList(),x.forEach(j,function(a,b){a.val({status:i[b].value})})}}function g(){return!0}function h(a){var b=this,c=b.getEl();c.find(".js-title").html(u.trim(a))}function i(a){var b=this,c=b.getEl();c.find(".js-delete")[a===!1?"hide":"show"]()}function j(a){var b=this;b.input.setErrorTips(a)}function k(){var a=this,b=a.getEl(),c=a.groups;if(!(c.length>=10)){var d=new F({renderTo:b.find(".js-add"),renderBy:"before",content:"第"+(c.length+1)+"轮",listeners:{change:function(){a.fire("change")},remove:function(){if(1!==c.length){var b=c.indexOf(this);b>=0&&c.splice(b,1),this.destroy(),a.checkRoundList(),a.fire("change")}}}});return c.push(d),a.checkRoundList(),d}}function l(){var a=this,b=a.getEl(),c=a.groups;b.find(".js-add")[c.length>=10?"hide":"show"](),c[0].showDelete(c.length>1),x.forEach(c,function(a,b){a.title("第"+(b+1)+"轮")})}function m(){var a=this,b=[],c=a.condition.jobList||[];return x.forEach(c,function(a){b.push({text:a,value:a})}),b}function n(a,b){return y.execTpl(['<div class="form-group">','<label class="control-label">#{name}</label>','<div class="js-cpn-ext-#{id}">',b?'<input class="w200" type="text">':'<input class="w200" readonly="" type="text">',"</div>","</div>"].join(""),{name:a.name,id:a.id})}function o(){var a=this,b=x.map(a.schools,function(a){return x.isString(a)?a:a.name});return x.uniq(b)}function p(a){var b=(a||"").split(/\s+/),c=[];return x.forEach(b,function(a){a=u.trim(a),a&&c.push(a)}),c}function q(a,b){return x.isArray(a)?a.length>0?a.join("_"):b:x.isString(a)?u.trim(a)||b:a}function r(){var a=this,b=x.map(a.groups,function(a,b){var c=a.val();return{round:b+1,value:c.status}});return JSON.stringify(b)}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Component,w=s.Clazz,x=s.Base,y=s.Str,z=s.Time,A=(t.Select,t.SelectMult),B=t.Input,C=t.AttachDate,D=t.CheckBox,E=a("../../../../../component/popupSub/popupSchool"),F=a("./formGroup"),G=c.exports=w.create();w.mix(G,v,{_template:'<div class="interview-setting-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=(a.getEl(),a.rawConfig);a.groups=[],a.condition=b.condition,a.condField=b.condField,a.initHtml(),a.initCpn()}},{name:"click .js-delete",handler:function(){{var a=this;a.rawConfig||{}}a.fire("remove")}},{name:"click .js-add",handler:function(){{var a=this;a.groups}a.createItem()}}]},{initHtml:d,initCpn:e,val:f,title:h,showDelete:i,setErrorTips:j,check:g,getSchool:o,createItem:k,checkRoundList:l,getExtHtml:n,split:p,wrapVal:q,getJobOptions:m,getRoundSearchJson:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/step2/formGroup",["nc","cpn"],function(a,b,c){function d(a){var b=this,c=(b.rawConfig,b.roundStatusSelect);return 0===arguments.length?{status:c.val()}:void c.val(a.status)}function e(){return!0}function f(a){var b=this,c=b.getEl();c.find(".js-name").html(k.trim(a))}function g(a){var b=this,c=b.getEl();c.find(".js-delete")[a===!1?"hide":"show"]()}function h(a){var b=this;b.input.setErrorTips(a)}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=(i.Base,i.Str,j.Select),o=(j.Input,c.exports=m.create());m.mix(o,l,{_template:['<div class="interview-round-item">','<span class="item-space js-name"></span>','<div class="btn-group btn-group-sm js-round-status"></div>','<a href="javascript:void(0);" class="icon-trash js-delete" style="margin-left:10px"></a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl();a.rawConfig}a.roundStatusSelect=new n({renderTo:b.find(".js-round-status"),renderBy:"replaceWith",size:"small",autoWidth:!0,options:[{text:"不限",value:"0",checked:!0},{text:"未面",value:"1"},{text:"通过",value:"2"},{text:"淘汰",value:"3"}]}),a.nameSpan=b.find(".js-name")}},{name:"click .js-delete",handler:function(){{var a=this;a.rawConfig||{}}a.fire("remove")}}]},{val:d,title:f,showDelete:g,setErrorTips:h,check:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/step2/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/interviewProject","../../../../../util/ajax","../../../../../action/interviewSchedule","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../util/interview","../../../../../component/popupSub/popupJoinSession","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interview","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../cpn/steps","./candidateGroup","../../../../../component/popupSub/popupSchool","../../../../../action/common","./formGroup"],function(a,b,c){function d(){{var a=this,b=a.getEl(),c=b.find(".js-content-step");a.getParam(),a.steps=new A({renderTo:c,currentStep:2})}if(a.isEdit){var d=u.json((a.scene||{}).interviewCondition,[]);u.forEach(d,function(b){b.roundJson=u.json(b.roundJson||[]);var c=a.createCandidateGroup();c.val(b)}),0===d.length&&a.createCandidateGroup()}else a.createCandidateGroup()}function e(){var a=this,b=a.getParam();if(0===arguments.length){var c=a.candidateGroups,d=[];u.forEach(c,function(a){d.push(a.val())});var e={interviewCondition:JSON.stringify(d)};return u.extend(e,{sceneBegin:b.sceneBegin?b.sceneBegin+" 00:00:00":void 0,sceneEnd:b.sceneEnd?b.sceneEnd+" 23:59:59":void 0,roundListStr:b.roundListStr,name:b.name,avgInterviewRound:b.avgInterviewRound,offline:b.offline||0,type:b.type||0,seeResume:b.seeResume?!0:!1,chooseInterview:b.chooseInterview?!0:!1,modifyEvaluation:b.modifyEvaluation?!0:!1}),e}}function f(){return!0}function g(){var a=this,b=a.getEl(),c=a.candidateGroups;if(!(c.length>=5)){var d=new B({renderTo:b.find(".js-content"),content:"候选人类型"+(c.length+1),condition:a.condition,condField:a.condField,listeners:{change:function(){a.fire("change")},remove:function(){if(1!==c.length){var b=c.indexOf(this);b>=0&&c.splice(b,1),this.destroy(),a.checkGroupList(),a.fire("change")}}}});return c.push(d),a.checkGroupList(),d}}function h(){var a=this,b=a.getEl(),c=a.candidateGroups;b.find(".js-add-cancadidate")[c.length>=5?"hide":"show"](),c[0].showDelete(c.length>1),u.forEach(c,function(a,b){a.title("候选人类型"+(b+1))})}function i(){var a=this,b=[],c=a.condition.jobList||[];return u.forEach(c,function(a){b.push({text:a,value:a})}),b}function j(a){var b=this;x.getCondition({type:"GET",params:{projectId:b.projectId},call:function(b){a&&a(b.data)},error:function(a){v.alert(a.msg)}})}function k(a,b){var c=this,d=[],e=u.toMap(a.builtInFields,function(a){return{key:a.id,value:!0}});return e.work_location&&d.push("work_location"),e.interview_location&&d.push("interview_location"),e.job_majar&&d.push("job_majar"),0===d.length?b&&b({}):void x.getConditionFiled({params:{projectId:c.projectId},query:{builtInFieldNames:d},call:function(a){return b&&b(a.data)},error:function(a){v.alert(a.msg)}})}function l(){function a(){b.getCondition(function(a){b.getCondField(a,function(e){b.condition=a,b.condField=e,d.remove(),c.children().show(),b.initCpn()})})}var b=this,c=b.getEl();c.children().hide();var d=s('<div style="padding:20px 0;font-size:14px;text-align:center;">加载中...</div>');c.append(d),b.isEdit?b.getScene(function(c){b.scene=c,b.project={},b.project.id=c.projectId,b.project.projectName=c.projectName,b.scene={},b.scene.id=c.id,b.scene.name=c.name,b.refreshCrumb(),a()}):(b.getProject(b.projectId,function(a){b.project={},b.project.id=a.id,b.project.projectName=a.name,b.refreshCrumb()}),a())}function m(a,b){x.getProject({params:{projectId:a},query:{},call:function(a){var c=a.data;b&&b(c)},error:function(a){v.alert(a.msg)}})}function n(a){var b=this,c=b.val();c.confirm=a;var d=b.getWin();return b.isEdit?void y.updateScene({type:"PUT",params:{projectId:b.projectId,sceneId:b.sceneId},body:c,call:function(c){var e=d.showLoading("操作中...");C.getTaskProgress(!0,c.data,function(c){var d=c.end,f=c.content,g=c.error;if(g){e.close();var h=JSON.parse(f),i=+h.code;return void(2===i?v.confirm(h.msg+"，点击确定修改？",function(){z.show({id:h.interviewId,call:function(){}})}):v.alert(h.msg))}if(d)if(e.close(),1!==a){var h=JSON.parse(f),j=+h.totalCount;v.confirm("一共有"+j+"个候选人将加入这个面试场景，是否确认新建？",function(){b.nextStep(1)})}else v.tips("修改成功",function(){b.nav("interview",{action:"schedule/index",projectId:b.projectId})})})},error:function(a){v.alert(a.msg)}}):void y.addScene({type:"POST",params:{projectId:b.projectId},body:c,call:function(c){var e=d.showLoading("操作中...");C.getTaskProgress(!0,c.data,function(c){var d=c.end,f=c.content,g=c.error;if(g){e.close();var h=JSON.parse(f),i=+h.code;return void(2===i?v.confirm(h.msg+"，点击确定修改？",function(){z.show({id:h.interviewId,call:function(){}})}):v.alert(h.msg))}if(d)if(e.close(),1!==a){var h=JSON.parse(f),j=+h.totalCount;v.confirm("一共有"+j+"个候选人将加入这个面试场景，是否确认新建？",function(){b.nextStep(1)})}else v.tips("新建成功",function(){b.nav("interview",{action:"schedule/index",projectId:b.projectId})})})},error:function(a){v.alert(a.msg)}})}function o(a){var b=this;b.isEdit&&y.getSceneById({params:{projectId:b.projectId,sceneId:b.sceneId},query:{},call:function(b){a&&a(b.data)}})}function p(){var a=this,b=(a.getParam(),a.project),c=a.scene,d=[{title:"项目列表",module:"interview",action:"project/index"}];return b&&d.push({title:"项目("+b.projectName+")",module:"interview",param:{action:"group/index",projectId:b.id}}),d.push({title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:a.projectId}}),c&&d.push({title:"场次("+c.name+")",module:"interview",param:{action:"schedule/index",projectId:b.id,sceneId:c.id}}),{crumb:d}}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Base,v=(q.Str,q.Time,r.Select,r.SelectMult,r.CheckBox,r.Input,r.Popup),w=(r.CheckGroup,a("../../../../../core/module")),x=a("../../../../../action/interviewProject"),y=a("../../../../../action/interviewSchedule"),z=a("../../../../../component/popupSub/popupIvEdit"),A=a("../cpn/steps"),B=a("./candidateGroup"),C=a("../../../extend/bll/task"),D=c.exports=t.create();t.mix(D,w,{style:"/stylesheets/styles/system/interview.css",title:"新增面试场次",_template:['<div class="module-box">','<div class="module-body">','<div class="interview-setting">','<div class="js-content-step"></div>','<div class="js-content"></div>','<div class="interview-setting-oprt">','<a href="javascript:void(0);" class="add-item-icon js-add-cancadidate"><i class="icon-plus-sign"></i> 添加类型</a>',"</div>","</div>",'<div class="interview-setting-oprt">','<a href="javascript:void(0);" class="btn btn-default js-cancel">上一步</a>','<a href="javascript:void(0);" class="btn btn-primary js-next" style="margin-left:20px">确定</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=(a.getEl(),a.getParam());a.projectId=b.projectId,a.sceneId=u.id(b.sceneId)||"0",a.isEdit="0"!==a.sceneId,a.candidateGroups=[],a.contentEl=a.getEl().find(".js-content"),a.crumbTitle=a.isEdit?"编辑面试场次":"新增面试场次",a.refreshCrumb(),a.initData()}},{name:"click .js-next",handler:function(){{var a=this;a.val(),a.getParam()}a.check()&&a.nextStep()}},{name:"click .js-cancel",handler:function(){var a=this,b=u.clone(a.getParam());a.nav("interview",u.extend(b,{action:"schedule/step1/index"}))}},{name:"click .js-add-cancadidate",handler:function(){var a=this;a.createCandidateGroup()}}]},{initData:l,initCpn:d,val:e,check:f,nextStep:n,getScene:o,getJobOptions:i,checkGroupList:h,getCondition:j,getCondField:k,createCandidateGroup:g,getProject:m,getCrumbConf:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/user/cpn/filter",["nc","cpn","../../../../../../component/filter/filter","../../../../../../component/filter/filterCond","../../../../../../component/filter/condUtil","../../../../../../action/common","../../../../../../util/ajax","../../../../../../component/popupSub/popupCommon","../../../../../../component/filter/popupCustomCond","../../../cpn/round","../../../cpn/roundOffline","../../../../../../util/switch","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(){var a=this;a.hasOfflinePermission=x.can("interviewOffline")}function e(){var a=this,b=a.rawConfig,c=a.getEl().html(""),d=b.cond,e=b.field,f=b.scenes,g=b.sceneId,h=t.toMap(d.builtInFields,function(a){return{key:a.id,value:a}}),i=[],j=!1;t.forEach(f,function(a){var b=t.id(a.id);j=j||b===g,i.push({text:a.name,value:b,checked:b===g})}),i.unshift({text:"不限",value:"0",checked:!j});var k={id:"scene",title:"场次",type:"select",conf:{options:i}},l={id:"job",title:"职位",type:"selectMult",conf:{options:t.map(d.jobList,function(a){return{text:a,value:a}})}},m=t.map([{id:"create",title:"面试创建日期"},{id:"book",title:"预约日期"},{id:"start",title:"实际面试日期"}],function(a){return{id:a.id,title:a.title,type:"duration",ext:{today:!0}}}),n={id:"round",type:"diy",create:t.bind(a.createRoundList,a),condTitle:"面试状态",condVal:function(a){return t.map(a.valText(),function(a){return"第"+a.round+"轮: "+a.text})}},o={id:"roundOffline",type:"diy",create:t.bind(a.createRoundOfflineList,a),condTitle:"面试方式",condVal:function(a){return t.map(a.valText(),function(a){return"第"+a.round+"轮: "+a.text})}},p=[],r=[{name:"work_location",id:"workLocation"},{name:"interview_location",id:"interviewLocation"},{name:"job_majar",id:"jobMajar"}];t.forEach(r,function(a){{var b=a.name;a.id}if(h[b]&&e[b]){var c=[];t.forEach(e[b],function(a){a=q.trim(a),a&&c.push({text:a,value:a})}),p.push({id:a.id,title:h[b].name,type:"selectMult",conf:{needSearch:!0,options:c}})}}),h.city&&p.push({id:"city",title:"城市",type:"selectMult",conf:{needSearch:!0,options:t.map("北京,上海,广州,深圳,杭州,南京,西安,武汉,哈尔滨,长春,成都,长沙,合肥,其他".split(","),function(a){return{text:a,value:a}})}}),h.school&&p.push({id:"school",title:"学校",type:"school"}),h.resume_id&&p.push({id:"resumeId",title:"简历编号",type:"input"});var s={id:"search",title:"关键词",type:"search",conf:{placeholder:"输入关键词搜索，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的面试，多个关键词用空格分割"}};a.filter=new u({renderTo:c,submitTxt:"查询",line:[{border:!0,items:[k,l]},{border:!0,items:m},{border:!0,items:[n]},a.hasOfflinePermission?{border:!0,items:[o]}:null,{border:!0,items:p},{items:[s]}],clearAll:function(){a.val({})},listeners:{submit:t.bind(a.submit,a)}})}function f(){var a=this,b=a.val();a.check()&&a.fire("submit",b)}function g(a){var b=this,c=b.filter,d=c.getItem("scene"),e=c.getItem("job"),f=c.getItem("create"),g=c.getItem("book"),h=c.getItem("start"),i=c.getItem("round"),j=c.getItem("workLocation"),k=c.getItem("interviewLocation"),l=c.getItem("jobMajar"),m=c.getItem("city"),n=c.getItem("school"),o=c.getItem("resumeId"),p=c.getItem("search"),q=c.getItem("roundOffline");if(0===arguments.length){var a={searchSceneId:b.wrapVal(d.val(),"0"),jobList:b.wrapVal(e.val()),begin:b.wrapDuration(h.startIpt,!0),end:b.wrapDuration(h.endIpt),bookBegin:b.wrapDuration(g.startIpt,!0),bookEnd:b.wrapDuration(g.endIpt),createBegin:b.wrapDuration(f.startIpt,!0),createEnd:b.wrapDuration(f.endIpt),keywordUnion:p.chk.isChecked()?1:void 0,keywordList:b.wrapVal(b.split(p.ipt.val())),roundJson:JSON.stringify(i.val()),offlineJson:b.hasOfflinePermission?JSON.stringify(q.val()):void 0,workLocationListStr:j?b.wrapVal(j.val()):void 0,interviewLocationListStr:k?b.wrapVal(k.val()):void 0,jobMajarListStr:l?b.wrapVal(l.val()):void 0,cityListStr:m?b.wrapVal(m.val()):void 0,schoolListStr:n?b.wrapVal(n.val().split(",")):void 0,resumeKeyList:o?b.wrapVal(b.split(o.val())):void 0};return a}if(e.val((a.jobList||"").split("_")),d.val(a.sceneId||"0"),t.forEach([{cpn:h,begin:"begin",end:"end"},{cpn:g,begin:"bookBegin",end:"bookEnd"},{cpn:f,begin:"createBegin",end:"createEnd"}],function(b){var c=b.cpn;c.todayChk.checked(!1),c.todayChk.fire("change"),c.startIpt.val(a[b.begin]||""),c.endIpt.val(a[b.end]||"")}),p.chk.checked(!!a.keywordUnion),p.ipt.val((a.keywordList||"").split("_").join(" ")),i.val(t.json(a.roundJson)||[{value:"0"},{value:"0"},{value:"0"}]),b.hasOfflinePermission&&q.val(t.json(a.offlineJson)||[{value:"0"},{value:"0"},{value:"0"}]),m&&m.val((a.cityListStr||"").split("_")),n){var r=(a.schoolListStr||"").split("_").join(",");n.val(r).getEl().attr("title",r)}o&&o.val((a.resumeKeyList||"").split("_").join(" "))}function h(){return!0}function i(a,b,c){a.removeClass().prepend('<label class="filter-label-left">面试状态</label>'),c.cpn=new v({renderTo:a})}function j(a,b,c){a.removeClass().prepend('<label class="filter-label-left">面试方式</label>'),c.cpn=new w({renderTo:a})}function k(a){var b=(a||"").split(/\s+/),c=[];return t.forEach(b,function(a){a=q.trim(a),a&&c.push(a)}),c}function l(a,b){return t.isArray(a)?(a=t.without(a,""),a.length>0?a.join("_"):b):t.isString(a)?q.trim(a)||b:a}function m(a){return q.trim(a).replace(/[^\d]+/g,"")}function n(a,b){return a.val()?a.val()+(b?" 00:00:00":" 23:59:59"):void 0}function o(){var a=this;a.filter.getItem("scene").val("0"),a.submit()}var p=a("nc"),q=(a("cpn"),p.$),r=p.Clazz,s=p.Component,t=p.Base,u=(p.Str,a("../../../../../../component/filter/filter")),v=a("../../../cpn/round"),w=a("../../../cpn/roundOffline"),x=a("../../../../../../util/switch"),y=c.exports=r.create();r.mix(y,s,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter()}}]},{initialize:d,initFilter:e,submit:f,val:g,check:h,createRoundList:i,createRoundOfflineList:j,split:k,wrapVal:l,wrapNum:m,wrapDuration:n,sceneNoLimit:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/user/cpn/list",["nc","cpn","./selectAll","../../../../../../component/popupSub/popupIvInfo","../../../../../../util/interview","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/interview","../../../../../../util/ajax","../../../../../../component/popupSub/popupIvEdit","../../../../../../util/switch","../../../../../../component/popupSub/popupIvSucc","../../../../../../component/popupSub/popupJoinSession","../../../../../../action/interviewProject","../../../../../../action/interviewSchedule","../../../cpn/interviewSceneForm","../../../../../../component/dateSelect","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","../../../../../../component/department","../../../../../../action/user","../../../../../../action/interviewV2","../../../../../../action/resumeDeliver","../../../../../../component/popupSub/popupIvScore","../../../../../../component/table","../../../../../../component/selectAll","../../../../extend/bll/money","../../../../../../action/purchase","../../../../../../action/price"],function(a,b,c){function d(a){var b=this,c=a.parent;b.allId=(c.selectedId||[]).slice(0),b.conditionAllId=[];var d=b.selectAll=new B({change:function(a,c){v.forEach(b.contentEl.find("td label.checkbox"),function(c){var e=b.getLineId(c);!d.isDisabled(e)&&s(c)[a?"addClass":"removeClass"]("checked")}),c?b.dealSelectAll(a):(a&&(b.allId=v.uniq(b.allId.concat(d.pageIds))),!a&&(b.allId=v.uniq(v.without.apply(v,[b.allId].concat(d.pageIds)))))},disable:function(a,c){c=c!==!1,x.cls(b.contentEl.find("tr[data-id="+a+"] label.checkbox"),{disabled:c})},toggle:function(a,c){x.cls(b.contentEl.find("tr[data-id="+a+"] label.checkbox"),{checked:c}),c&&!v.contains(b.allId,a)&&b.allId.push(a),!c&&(b.allId=v.without(b.allId,a))},listeners:{onlyCurrent:function(){b.allId.length=0}}})}function e(){var a=this,b=a.getEl(),c=a.getParent(),d=c.getParam(),e=+d.pageSize||20;e=v.contains([20,50,100],e)?e:20,a.pageSelect=new y({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:[{text:20,value:20,checked:20===e},{text:50,value:50,checked:50===e},{text:100,value:100,checked:100===e}],listeners:{change:function(){c.addParam({pageSize:this.val(),page:null}),a.load()}}})}function f(a){var b=this;b.selectAll.clear(),b.selectAll.selectIds=b.allId.slice(0),b.conditionAllId.length=0,b.load(a)}function g(a,b){var c=this;if(a=c.condition=a||c.condition,0===v.size(a))return void c.renderNone();c.renderWait();var d=c.getParent();D.searchInterviewList({params:{projectId:d.projectId,sceneId:d.sceneId},body:c.getCond(b),call:function(a){c.renderList(a.data)},error:function(a){c.renderWait(a.msg)}})}function h(){function a(a,b){var f=d.showLoading("操作中...");D.updateInterviewList({type:"PUT",params:{projectId:c.projectId,sceneId:c.sceneId},body:{confirm:a?1:0,isAll:2,ids:e},call:function(a){G.getTaskProgress(!0,a.data,function(a){var c=a.end,d=a.content,e=a.error;if((e||c)&&f.close(),e){var g=v.json(d);A.alert(g.msg||"出现错误，请重试")}else if(c){var g=v.json(d);b&&b(g)}})},error:function(a){A.alert(a.msg)}})}var b=this,c=b.getParent(),d=c.getWin(),e=v.uniq(b.allId).join("_");a(!1,function(b){A.confirm(b.msg,function(){a(!0,function(){A.tips("操作成功",function(){c.nav("interview",{action:"schedule/index",projectId:c.projectId,sceneId:c.sceneId})})})})})}function i(a){{var b=this,c=b.getParent();c.getParam()}if(b.updateTotal(a.totalCount),0===(a.data||[]).length)return void b.renderNone();var d={head:[{text:"",width:"2%",cls:"with-checkbox-select",style:{"text-align":"left"}},{text:"候选人",width:"10%"},{text:"手机",width:"10%"},{text:"邮箱",width:"20%"},{text:"职位",width:"15%"},{text:"轮次",width:"5%"},{text:"预约时间",width:"15%"},{text:"面试官",width:"10%"},{text:"面试记录",width:"10%"},"操作"],list:[]},e="---";v.forEach(a.data,function(a){var b=(a.disable?" disabled js-tips ":" ")+(a.disable&&a.belonging?" checked ":""),c=[{text:'<label class="checkbox #{extCls}" title="#{tips}"><span class="icons"></span></label>',data:{extCls:b,tips:a.tip},cls:"text-left"},a.intervieweeName||e,a.intervieweePhone||e,a.intervieweeEmail||e,a.job||e,"第"+a.round+"轮",a.bookTime?w.form(new Date(a.bookTime)):e,a.interviewerName||e,'<a href="javascript:void(0);" class="js-interview-detail font-green">查看详情</a>','<a href="javascript:void(0);" class="icon-edit js-edit js-tips" data-title="编辑"></a>'];d.list.push({items:c,attr:{"data-id":a.interviewId}})}),b.contentEl.html('<div class="js-select-tips"></div>'+F.getHtml(d));var f=[],g=[],h=[];v.forEach(a.data,function(a){var b=v.id(a.interviewId);f.push(b),(a.disable?g:h).push(b)});var i=b.selectAll;b.contentEl.find("th.with-checkbox-select").append(i.getEl()),i.refreshEl(),i.render(),i.tipsEl=b.contentEl.find("div.js-select-tips"),i.disable(g),i.disable(h,!1),i.loadPage(h,!0),i.changePageCount(a.totalPage),i.changeTotalCount(a.totalCount),new z({renderTo:b.contentEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){c.addParam({page:a}),b.load(null,a)}}),b.contentEl.append(['<div style="text-align:center;padding:50px 0;">','<a href="javascript:void(0)" class="btn btn-primary btn-lg js-submit">确定</a>',"</div>"].join(""))}function j(a){var b=this;b.getParent().renderWait(b.contentEl,a||null)}function k(){var a=this;a.contentEl.html(['<div class="com-empty-wrap">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip">暂无面试信息&nbsp;&nbsp;<a href="javascript:void(0)" class="js-add link-green">点击添加</a></div>',"</div>"].join(""))}function l(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function m(){var a=this;return a.rawConfig.parent}function n(a){var b=this,c=b.getParent(),d=c.getParam(),e=v.extend({},b.condition,{currentPage:a||d.page||1,pageSize:b.pageSelect.val()});return e}function o(a){var b=s(a).closest("tr");return s.trim(b.attr("data-id"))}function p(a){var b=this;if(!a)return void(b.allId=v.uniq(v.without.apply(v,[b.allId].concat(b.conditionAllId))));if(b.conditionAllId.length>0)return void(b.allId=v.uniq(b.allId.concat(b.conditionAllId)));var c=b.getParent(),d=c.getWin(),e=d.showLoading();D.searchAllInterviewIdList({params:{projectId:c.projectId,sceneId:c.sceneId},body:b.condition,call:function(a){b.conditionAllId.length=0,v.forEach(a.data,function(a){a=v.id(a),b.allId.push(a),b.conditionAllId.push(a)}),b.allId=v.uniq(b.allId),e.close()},error:function(){}})}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Component,v=q.Base,w=(q.Str,q.Time),x=q.Dom,y=r.Select,z=r.Pager,A=r.Popup,B=(r.Tips,a("./selectAll")),C=a("../../../../../../component/popupSub/popupIvInfo"),D=a("../../../../../../action/interviewSchedule"),E=a("../../../../../../component/popupSub/popupIvEdit"),F=a("../../../../../../component/table"),G=a("../../../../extend/bll/task"),H=a("../../../../extend/bll/money"),I=c.exports=t.create();t.mix(I,u,{_template:["<div>",'<div class="import-tool clearfix" style="padding:15px;">','<div class="import-census">','<div class="census-num">共<span class="font-green js-total">0</span>条</div>','<span>每页显示<div class="control-group js-page-select"></div></span>',"</div>",'<div class="import-tool-bar">','<a class="link-green js-add" href="javascript:void(0);"><i class="icon-plus-sign"></i>新增面试</a>',"</div>","</div>",'<div class="js-content" style="padding-bottom:60px;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentEl=b.find(".js-content"),a.initCpn(),a.renderWait()}},{name:"click .js-edit",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);E.show({id:c,call:v.bind(b.reload,b)})}},{name:"click .js-add",handler:function(){var a=this,b=a.getParent();E.show({projectId:b.projectId,call:function(){H.refreshMoney(),a.fire("sceneNoLimit"),a.reload()}})}},{name:"click .js-submit",handler:function(){var a=this;a.submit()}},{name:"click td label.checkbox",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);c&&b.selectAll.toggle(c)}},{name:"click .js-interview-detail",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);C.show({id:c,change:function(){}})}}]},{initialize:d,initCpn:e,reload:f,load:g,submit:h,renderList:i,renderWait:j,renderNone:k,updateTotal:l,getParent:m,getCond:n,getLineId:o,dealSelectAll:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/user/cpn/selectAll",["nc"],function(a,b,c){function d(a){var b=this;b.pageCount=a.pageCount||0,b.totalCount=a.totalCount||0,b.tipsEl=v(a.tipsEl),b.isSelectAll=!1,b.selectIds=[],b.disabledIds=[],b.pageIds=[]}function e(){function a(){var a=[{text:"本页",type:"current"},{text:"全部"+(b.pageCount?b.pageCount+"页":""),type:"all"}],c="";w.forEach(a,function(a){c+=z.execTpl('<li data-type="#{type}"><a href="javascript:void(0);">#{text}</a></li>',a)}),b.menuEl.html(c)}var b=this,c=b.getEl(),d=c.find("div.btn-group");a();var e;d.on("mouseenter",function(){window.clearTimeout(e),d.addClass("open")}).on("mouseleave",function(){e=window.setTimeout(function(){d.removeClass("open")},250)}),d.on("click","ul.dropdown-menu li",function(a){var c=v(a.currentTarget),d=v.trim(c.attr("data-type"));d&&b.select(d!==b.selectType,d)}),b.chkEl.on("click",function(){var a=b.chkEl;b.select(!a.hasClass("checked"),"current")})}function f(a,b,c){var d=this,e=d.rawConfig,f=(d.getEl(),"all"===b),g=d.isSelectAll,h=!1;d.changeSelectStyle(),d.selectType="",d.isSelectAll=a&&f;var i=[];if(a)d.selectType=b,d.changeSelectStyle(b),"current"===b&&(g?(h=!0,i=d.pageIds.slice(0)):i=w.uniq(d.selectIds.concat(d.pageIds)));else if("current"===b){var j=[d.selectIds].concat(d.pageIds);i=w.without.apply(w,j)}d.changeSelectIds(i),h&&d.fire("onlyCurrent"),c!==!1&&e.change&&e.change(a,f,b),d.showTips()}function g(a){var b=this,c=b.rawConfig,d=w.isArray(a)?a:[a];w.forEach(d,function(a){if(a){var d=a,e=b.isSelect(a),f=b.isDisabled(a);b.changeSelectIds(w.filter(b.selectIds,function(a){return d!==a})),(b.isSelectAll&&e||!b.isSelectAll&&!e)&&!f&&b.selectIds.push(a),b.isSelectAll&&0===b.selectIds.length?b.select(!0,"all",!0):!b.isSelectAll&&b.isSelectAllId(b.pageIds)&&b.pageIds.length>0?b.select(!0,"current",!0):(!f&&c.toggle&&c.toggle(a,!e),f&&c.disable&&c.disable(a,!0),b.isSelectAll||(b.chkEl.removeClass("checked"),b.selectType="",b.changeSelectStyle()))}}),b.showTips()}function h(a,b){var c=this,d=c.rawConfig,e=w.isArray(a)?a:[a];b=b!==!1,b&&w.forEach(e,function(a){c.disabledIds.push(a),d.disable&&d.disable(a,!0)}),b||(c.disabledIds=w.without.apply(w,[c.disabledIds].concat(e)))}function i(a,b){var c=this,d=c.rawConfig;if(a=a||[],c.pageIds=a.slice(0),b!==!1)if(c.isSelectAll){var e=c.selectIds.slice(0);c.select(!0,"all",!0),c.changeSelectIds(e),w.forEach(e,function(a){d.toggle(a,!1)})}else c.isSelectAllId(a)?(c.removeSelectIds(a),c.select(!0,"current",!0)):(w.forEach(c.selectIds,function(a){d.toggle&&d.toggle(a,!0)}),c.chkEl.removeClass("checked"),c.selectType=""),c.showTips()}function j(a){var b=this,c=w.contains(b.selectIds,a);return b.isSelectAll&&!c||!b.isSelectAll&&c}function k(a){var b=this,c=w.contains(b.disabledIds,a);return c}function l(a,b){var c=this;if(0===c.selectIds.length)return!1;for(var d=b?c.selectIds:c.selectIds.concat(c.disabledIds),e=w.toMap(d,function(a){return{key:a+"",value:!0}}),f=0,g=a.length;g>f;f++)if(!e[a[f]])return!1;return!0}function m(a){var b=this,c=w.isArray(a)?a:[a],d={};w.forEach(c,function(a){d[a]=!0});for(var e=b.selectIds,f=e.length-1;f>=0;f--)d[e[f]]&&e.splice(f,1)}function n(a){var b=this,c=w.toMap(b.disabledIds,function(a){return{key:a,value:!0}}),d=w.filter(a,function(a){return!c[a]});b.selectIds.length=0,b.selectIds=d}function o(a){var b=this;if(a=a?v(a):b.tipsEl,0!==a.length){var c="";b.isSelectAll?c="全部页面本场次共"+(b.totalCount-b.selectIds.length)+'条记录已被选中。 <a href="javascript:void(0)" class="js-select-page link-green">只选择本页的'+b.pageIds.length+"条记录<a>":b.selectIds.length>0&&(c="本场次共"+b.selectIds.length+'条记录已被选中。 <a href="javascript:void(0)" class="js-select-all link-green">选择全部页面共'+b.totalCount+"条记录<a>"),a.html(c?'<div class="alert-warning">'+c+"</div>":""),a.unbind("click"),a.on("click",".js-select-all",function(){b.select(!0,"all")}).on("click",".js-select-page",function(){b.selectIds.length=0,b.fire("onlyCurrent"),b.select(!0,"current")})}}function p(a){var b=this,c=b.menuEl,d=b.chkEl;c.find("i.icon-ok").remove(),d.removeClass("checked"),a&&(d.addClass("checked"),c.find("li[data-type="+a+"] a").append('<i class="icon-ok"></i>'))}function q(a){{var b=this;b.getEl()}b.pageCount=a,b.menuEl.find("li[data-type=all] a").html("全部"+a+"页"+(b.isSelectAll?'<i class="icon-ok"></i>':"")),b.showTips()}function r(a){var b=this;b.totalCount=a,b.showTips()}function s(){var a=this;a.rendered&&a.select(!1,"all",!1)}function t(){var a=this,b=a.getEl();b.html(['<label class="checkbox"><span class="icons"></span></label>','<div class="btn-group btn-group-notext btn-group-sm">','<button class="btn btn-default dropdown-toggle">','<span class="dropdown-value">全部</span>','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu js-menu"></ul>',"</div>"].join("")),a.chkEl=b.find("label.checkbox"),a.menuEl=b.find("ul.js-menu"),a.initSelect()}var u=a("nc"),v=u.$,w=u.Base,x=u.Component,y=u.Clazz,z=u.Str,A=(u.Dom,c.exports=y.create());y.mix(A,x,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.rawConfig;a.getEl()}a.refreshEl(),b.pageCount&&a.changePageCount(b.pageCount)}}]},{initialize:d,allText:"全部",initSelect:e,select:f,toggle:g,disable:h,loadPage:i,isSelect:j,isDisabled:k,isSelectAllId:l,removeSelectIds:m,changeSelectIds:n,showTips:o,changeSelectStyle:p,changePageCount:q,changeTotalCount:r,clear:s,refreshEl:t})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/schedule/user/index",["nc","cpn","./cpn/filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../cpn/round","../../cpn/roundOffline","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig","./cpn/list","./cpn/selectAll","../../../../../component/popupSub/popupIvInfo","../../../../../util/interview","../../../../../action/interview","../../../../../component/popupSub/popupIvEdit","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../../../component/popupSub/popupIvScore","../../../../../component/table","../../../../../component/selectAll","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../../../core/module"],function(a,b,c){function d(){function a(a){a.projectId=d,a.sceneId=e,b.listModule.reload(a)}var b=this,c=b.getEl(),d=o.id(b.projectId),e=o.id(b.sceneId);b.listModule=new r({renderTo:c.find(".js-list"),parent:b,listeners:{sceneNoLimit:function(){b.filterModule.sceneNoLimit()}}}),b.filterModule=new q({renderTo:c.find(".js-filter"),cond:b.cond,field:b.condField,scenes:b.sceneList,sceneId:b.isEdit?null:e,parent:b,listeners:{render:function(){var b=this.val();a(b)},submit:function(c){b.addParam({page:null}),a(c||this.val())}}})}function e(){var a=this,b=a.getEl();a.getInterviewIdList(function(c){a.selectedId=c,a.listModule.destroy(),a.listModule=new r({renderTo:b.find(".js-list"),parent:a}),a.filterModule.fire("submit")})}function f(a){var b=this,c=b.getEl();t.getProject({type:"GET",params:{projectId:b.projectId},call:function(b){a&&a(b.data)},error:function(a){b.renderWait(c,a.msg)}})}function g(a){var b=this,c=b.getEl();t.getCondition({type:"GET",params:{projectId:b.projectId},call:function(b){a&&a(b.data)},error:function(a){b.renderWait(c,a.msg)}})}function h(a,b){var c=this,d=[],e=o.toMap(a.builtInFields,function(a){return{key:a.id,value:!0}});return e.work_location&&d.push("work_location"),e.interview_location&&d.push("interview_location"),e.job_majar&&d.push("job_majar"),0===d.length?b&&b({}):void t.getConditionFiled({params:{projectId:c.projectId},query:{builtInFieldNames:d},call:function(a){return b&&b(a.data)},error:function(a){p.alert(a.msg)}})}function i(a){var b=this,c=b.getEl();u.getInterviewIdList({type:"GET",params:{projectId:b.projectId,sceneId:b.sceneId},call:function(b){var c=o.map(b.data,function(a){return o.id(a)});a&&a(c)},error:function(a){b.renderWait(c,a.msg)}})}function j(a){function b(a,f){u.getSceneList({params:{projectId:c.projectId},query:{sceneId:0,page:a,pageSize:100},call:function(c){var d=c.data||{},g=+d.totalPage||1;return e=e.concat(d.data||[]),a++,g>=a?b(a,f):void(f&&f())},error:function(a){c.renderWait(d,a.msg)}})}var c=this,d=c.getEl(),e=[];b(1,function(){a&&a(e)})}function k(){var a=this,b=a.project,c=a.scene,d=[{title:"项目列表",module:"interview",action:"project/index"}];return b&&d.push({title:"项目("+b.name+")",module:"interview",param:{action:"group/index",projectId:b.id}}),d.push({title:"现场管理",module:"interview",param:{action:"schedule/index",projectId:a.projectId}}),c&&d.push({title:"场次("+c.name+")",module:"interview",param:{action:"schedule/index",projectId:a.projectId,sceneId:c.id}}),{crumb:d}}var l=a("nc"),m=a("cpn"),n=(l.$,l.Clazz),o=l.Base,p=m.Popup,q=a("./cpn/filter"),r=a("./cpn/list"),s=a("../../../../../core/module"),t=a("../../../../../action/interviewProject"),u=a("../../../../../action/interviewSchedule"),v=c.exports=n.create();n.mix(v,s,{style:"/stylesheets/styles/system/questionBank.css",title:"候选人管理",_template:['<div class="module-box" style="padding:0;">','<div class="module-head clearfix"><h2>候选人</h2></div>','<div class="module-body" style="padding:20px 0;">','<div class="js-filter"></div>','<div class="js-list"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam();a.isEdit=!!b.edit,a.projectId=b.projectId;var c=a.sceneId=o.id(b.sceneId);a.getProject(function(b){a.getSceneList(function(d){a.getCondition(function(e){a.getCondField(e,function(f){a.getInterviewIdList(function(g){a.project=b,a.sceneList=d,a.cond=e,a.condField=f,a.selectedId=g,a.scene=o.find(d,function(a){return c===o.id(a.id)}),a.initCpn(),a.refreshCrumb()})})})})})}}]},{initCpn:d,reloadList:e,getProject:f,getCondition:g,getCondField:h,getInterviewIdList:i,getSceneList:j,getCrumbConf:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../component/menuNotice","../../../../component/popupSub/popupTestSender","../../../../action/user","../../../../util/ajax","../../../../action/paper","../../../../action/interview","./msg","./util/util","../../../../action/common","./mail","../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../component/editorSub/hEditor/plugin/autoLink","../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../component/editorSub/hEditor/plugin/imageBar","../../../../component/editorSub/hEditor/plugin/toolbar","../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../util/uploadRemote","../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../component/popupSub/popupUploadImage","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../extend/bll/interview","../../extend/bll/money","../../../../action/purchase","../../../../action/price","../../../../action/interviewV2","../../../../action/interviewProject","./util/tpl"],function(a,b,c){function d(){var a=this;a.moduleCache={}}function e(){var a=this,b=a.getCompanyName()||"",c=a.currentData.ctsInterviewSendTemplate||{};a.defaultVal={1:{phone:{val:c.smsIntervieweeTemplate||G.intervieweeSms},email:{title:c.emailIntervieweeSubjectTemplate||G.intervieweeMailTitle(b),val:c.emailIntervieweeContentTemplate||G.intervieweeMailContent(b)}},2:{phone:{val:c.smsInterviewerTemplate||G.interviewerSms},email:{title:G.interviewerMailTitle(b),val:c.emailInterviewerContentTemplate||G.interviewerMailContent(b)}}}}function f(a){var b=this,c=(b.getParam(),b.getUserId()),d=b.getCondition();A.getMultiNoticeV2({params:{userId:c},query:v.extend({offline:b.isOffline?"1":"0"},d),call:function(c){b.currentData=c.data,b.initDefault(),a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function g(){function a(a,b){g.initModule(a,b)}function b(){g.goBack()}function c(){var a=h.projectId;z.show({type:"2",isOffline:g.isOffline,userId:g.getUserId(),projectId:"0"===a?E.getAllId(g.projectData):a,call:function(a){var b=e({ids:a});b.sendInterviewerPhone=0,delete b.sms2,delete b.emailSubject2,delete b.emailContent2,f(b,"sendMultiTestNoticeV2")}})}function d(){g.checkVal()&&g.confirm(function(){f(e(),"sendMultiNoticeV2",function(){g.goBack()})})}function e(a){var b=g.val(),c=g.getCondition();return v.extend(b,c,a),b}function f(a,b,c){var d=g.getWin(),e=d.showLoading("发送中...");A[b]({type:"PUT",params:{userId:g.getUserId()},body:a,call:function(a){D.getTaskProgress(!0,a.data,function(a){var b=a.end,d=a.content,f=a.error;f?(e.close(),w.alert(d||"出现错误，请重试")):b&&(e.close(),w.tips("发送成功",3e3,c))})},error:function(a){e.close(),w.alert(a.msg)}})}var g=this,h=g.getParam();g.navModule=new y({renderTo:g.getEl(),renderBy:"prepend",items:[{id:K,name:"候选人",items:[{id:I,name:"短信通知",checked:!0,hide:!h.phone1},{id:J,name:"邮件通知",checked:!0,hide:!h.email1}]},{id:L,name:"面试官",hide:g.isOffline,hideTest:!0,items:[{id:I,name:"短信通知",checked:!0,hide:!h.phone2},{id:J,name:"邮件通知",checked:!0,hide:!h.email2}]}],listeners:{edit:a,save:d,back:b,test:c}})}function h(a,b){var c=this,d=c.getEl(),e=(c.getParam(),c.moduleCache),f=c.getKey(a,b);if(a&&(b===J||b===I)){if(!e[f]){var g=b===J?C:B;e[f]=new g({renderTo:d.find(".js-content"),companyName:c.getCompanyName(),defaultVal:c.defaultVal[a][b],uid:c.getUserId(),isHr:a===L,isOffline:c.isOffline}),e[f].valSender(c.getUserData(b,a).join("、"))}v.forEach(e,function(a){a&&a.hide()}),e[f].show()}}function i(){var a=this,b=a.moduleCache,c=a._valNav(),d=a.defaultVal,e={},f=a.getKey(K,I);if(c[f]){var g=b[f];e.sms1=g?g.val():d[K][I].val,e.sendIntervieweePhone=1}else e.sendIntervieweePhone=0;var h=a.getKey(L,I);if(c[h]){var g=b[h];e.sms2=g?g.val():d[L][I].val,e.sendInterviewerPhone=1}else e.sendInterviewerPhone=0;var i=a.getKey(K,J);if(c[i]){var g=b[i],j=g?g.val():d[K][J];e.emailSubject1=j.title,e.emailContent1=j.val}var k=a.getKey(L,J);if(c[k]){var g=b[k],j=g?g.val():d[L][J];e.emailSubject2=j.title,e.emailContent2=j.val}return e.emailContent1&&(e.emailContent1=F.key2name(e.emailContent1)),e.emailContent2&&(e.emailContent2=F.key2name(e.emailContent2)),e}function j(){var a=this,b=a.val(),c=!0,d="";return"emailSubject1"in b&&!b.emailSubject1?(c=!1,d="候选人的邮件标题不能空"):"emailContent1"in b&&!b.emailContent1?(c=!1,d="候选人的邮件内容不能空"):"emailSubject2"in b&&!b.emailSubject2?(c=!1,d="面试官的邮件标题不能空"):"emailContent2"in b&&!b.emailContent2&&(c=!1,d="面试官的邮件内容不能空"),c&&0===b.sendIntervieweePhone&&0===b.sendInterviewerPhone&&v.size(b)<=2&&(c=!1,d="发送选项不能为空"),!c&&d&&w.alert(d),c}function k(a){var b=this,c=b.val(),d='<p style="margin-bottom:10px;">本次将发送的通知数量为：</p>';"sms1"in c&&(d+='<p style="margin-bottom:10px;">候选人短信：'+b.getUserDataCnt(I,K)+"</p>"),"emailSubject1"in c&&(d+='<p style="margin-bottom:10px;">候选人邮箱：'+b.getUserDataCnt(J,K)+"<p>"),"sms2"in c&&(d+='<p style="margin-bottom:10px;">面试官短信：'+b.getUserDataCnt(I,L)+"</p>"),"emailSubject2"in c&&(d+='<p style="margin-bottom:10px;">面试官邮箱：'+b.getUserDataCnt(J,L)+"</p>"),d+='<p style="margin-bottom:10px;">是否确认发送？</p>',new w({title:"发送确认",content:'<div style="font-size:14px;">'+d+"</div>",ok:a,cancel:function(){}})}function l(){var a=this;a.nav("interview",{action:"notice/index"})}function m(a,b){return[a,b].join("_")}function n(a,b){var c=this,d=[];return v.forEach(c.currentData.apiInterviewNoticeList,function(c){var e=a===J,f=a===I,g=b===L,h=e&&!g?"email":f&&!g?"phone":e&&g?"interviewerEmail":f&&g?"interviewerPhone":"",i=h?c[h]:"";if(i){var j=c[b===K?"intervieweeName":"interviewerName"];d.push(i+(j?"("+j+")":""))}}),d}function o(a,b){var c=this,d=0;return v.forEach(c.currentData.apiInterviewNoticeList,function(c){var e=a===J,f=a===I,g=b===L,h=e&&!g?"email":f&&!g?"phone":e&&g?"interviewerEmail":f&&g?"interviewerPhone":"",i=h?c[h]:"";i&&(d+=1)}),d}function p(){var a=this,b=a.getWin();return(b.user||{}).companyName}function q(){var a=this,b=a.getParam(),c=v.id(b.isAll),d=b.projectId;return v.extend({isAll:c||2,projectIdList:"0"===d?E.getAllId(a.projectData):d,roundIdList:b.roundIdList||[]},b.cond)}function r(){var a=this,b=a.navModule.val(),c={};return v.forEach(b,function(b,d){v.forEach(b,function(b,e){var f=a.getKey(d,e);b&&(c[f]=!0)})}),c}var s=a("nc"),t=a("cpn"),u=(s.$,s.Clazz),v=s.Base,w=t.Popup,x=(t.CheckBox,a("../../../../core/module")),y=a("../../../../component/menuNotice"),z=a("../../../../component/popupSub/popupTestSender"),A=a("../../../../action/interview"),B=a("./msg"),C=a("./mail"),D=a("../../extend/bll/task"),E=a("../../extend/bll/interview"),F=a("./util/util"),G=a("./util/tpl"),H=c.exports=u.create(),I="phone",J="email",K="1",L="2";u.mix(H,x,{style:"/stylesheets/styles/system/notice.css",title:"面试通知设置",_template:'<div class="notice-mod clearfix"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();a.isOffline="1"===v.id(c.offline),a.getSysWinEl().css("overflow-y","scroll"),a.renderWait(b,"数据加载中..."),E.getSimpleProject(function(c){a.projectData=c,a.initData(function(){b.html('<div class="notice-page js-content"></div>'),a.contentEl=b.find("div.js-content"),a.initNav()})})}}]},{initialize:d,initDefault:e,initData:f,initNav:g,initModule:h,val:i,checkVal:j,confirm:k,goBack:l,getKey:m,getUserData:n,getUserDataCnt:o,getCompanyName:p,getCondition:q,_valNav:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/mail",["nc","cpn","../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../core/siteConfig","../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../component/editorSub/hEditor/plugin/autoLink","../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../util/util","../../../../component/editorSub/hEditor/plugin/imageBar","../../../../component/editorSub/hEditor/plugin/toolbar","../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../util/uploadRemote","../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../component/popupSub/popupUploadImage","./util/util","../../../../action/common","../../../../util/ajax"],function(a,b,c){function d(){}function e(){var a=this,b=a.rawConfig,c=(b.companyName||"",a.getEl("div.js-editor"));a.editor=new o({width:c.width(),renderTo:c,noCodeSelect:!0,noToolbarFixed:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,link,|,table,subscript,superscript,removeformat".split(",")}})}function f(a){var b=this,c=b.getEl(),d=c.find("div.js-mail");d.html(k.trim(a))}function g(a){var b=this,c=(b.getEl(),b.titleIpt);if(0===arguments.length){var d=k.trim(c.val()),e=k.trim(b.editor?b.editor.text():""),f="";return e&&(f=b.editor&&b.editor.val(),f=p.html2tpl(f)),{title:d,val:f}}var f=p.tpl2html(a.val);b.editor.val(f),c.val(k.trim(a.title)),window.setTimeout(function(){b.editor.autoHeight()},1e3)}function h(a){var b=!!a.isHr;return{title:b?"面试官":"候选人",tags:p.getNameList(b)}}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(j.CheckBox,a("../../../../component/editorSub/hEditor/index")),p=a("./util/util"),q=c.exports=m.create();m.mix(q,l,{_template:['<div class="info-edit-box">','<div class="user-status"><label>#{title}</label></div>','<div class="form-group">','<label class="control-label">收件箱：</label>','<div class="control-group js-mail"></div>',"</div>",'<div class="form-group">','<label class="control-label">邮件标题：</label>','<div class="control-group">','<input class="js-title" type="text" placeholder="请输入邮件标题" value="">',"</div>","</div>",'<div class="notice-editor">','<div class="notice-tool-bar">','<a href="javascript:void(0);" class="js-save"><i class="icon-save"></i>保存为模板</a>','<a href="javascript:void(0);" class="js-load"><i class="icon-download"></i>载入已有模板</a>',"</div>",'<label class="control-label">邮件正文：</label>','<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>','<div class="page-tags">#{tags}</div>',"</div>",'<div class="editor-box js-editor"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.titleIpt=c.find(".js-title"),a.titleIpt.outerWidth(a.titleIpt.parent().width()),a.initEditor(),a.val(b.defaultVal)}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=k(a.currentTarget),d=k.trim(c.attr("data-name")),e=p.name2img(d);e&&b.editor.waitCreated(function(){b.editor.getEditor().exec("insertimage",e)})}},{name:"click .js-save",handler:function(){var a=this,b=a.rawConfig,c=a.val();p.saveTpl({uid:b.uid,msg:!1,offline:b.isOffline,interviewer:!!b.isHr,title:c.title,content:c.val})}},{name:"click .js-load",handler:function(){var a=this,b=a.rawConfig;p.getTpl({uid:b.uid,msg:!1,offline:b.isOffline,interviewer:!!b.isHr,call:function(b){var c=n.json(b.templateContent).value;a.val({title:c.emailSubject||"",val:c.emailContent||""})}})}}]},{initialize:d,initEditor:e,valSender:f,val:g,_getData:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/msg",["nc","cpn","./util/util","../../../../action/common","../../../../util/ajax"],function(a,b,c){function d(){}function e(a){var b=this,c=b.getEl(),d=c.find(".js-phone");d.html(j.trim(a))}function f(){{var a=this,b=(a.getEl(),a.rawConfig);!!b.isHr}return j.trim(a.contentIpt.val())}function g(a){var b=!!a.isHr,c=j.trim(a.companyName),d=b?"面试官":"候选人",e='<span class="font-green">#'+d+"姓名#</span>你好，"+c+'邀请你参加在线视频面试，面试时间：<span class="font-green">#面试时间#</span>，面试链接：<span class="font-green">#面试链接#</span>，确认链接：<span class="font-green">#确认链接#</span>。';return b?e='<span class="font-green">#'+d+"姓名#</span>你好，"+c+'邀请你参加在线视频面试，面试时间：<span class="font-green">#面试时间#</span>，面试链接：<span class="font-green">#面试链接#</span>。':a.isOffline&&!b&&(e='<span class="font-green">#'+d+"姓名#</span>你好，"+c+'邀请参加现场面试，面试时间：<span class="font-green">#面试时间#</span>，面试确认链接：<span class="font-green">#确认链接#</span>。'),{title:b?"面试官":"候选人",defaultStr:e,val:(a.defaultVal||{}).val}}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Component,l=h.Clazz,m=h.Base,n=(i.CheckBox,a("./util/util")),o=c.exports=l.create();l.mix(o,k,{_template:['<div class="info-edit-box">','<div class="user-status"><label>#{title}</label></div>','<div class="form-group">','<label class="control-label">手机号：</label>','<div class="control-group js-phone"></div>',"</div>",'<div class="notice-editor">','<div class="notice-tool-bar">','<a href="javascript:void(0);" class="js-save"><i class="icon-save"></i>保存为模板</a>','<a href="javascript:void(0);" class="js-load"><i class="icon-download"></i>载入已有模板</a>',"</div>",'<label class="control-label">短信内容：</label>','<div class="editor-box">','<div class="msg-example clearfix">','<div class="float-left">#{defaultStr}</div>',"</div>",'<textarea class="msg-textarea js-msg" style="line-height:1.8;">#{val}</textarea>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentIpt=b.find("textarea.js-msg")}},{name:"click .js-save",handler:function(){var a=this,b=a.rawConfig;n.saveTpl({uid:b.uid,msg:!0,interviewer:!!b.isHr,offline:b.isOffline,content:a.val()})}},{name:"click .js-load",handler:function(){var a=this,b=a.rawConfig;n.getTpl({uid:b.uid,msg:!0,offline:b.isOffline,interviewer:!!b.isHr,call:function(b){a.contentIpt.val(m.json(b.templateContent).value.sms)}})}}]},{initialize:d,valSender:e,val:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/util/popupTplEdit",["nc","cpn","./util","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};{var b=new q(a);n.wrap(b,{title:"编辑"+(a.isMsg?"短信":"邮件")+"模板",noUnique:!0,content:b.html(),width:920,ok:function(){return b.check()?void(a.ok&&a.ok(b.val())):!0},cancel:function(){}})}return b}function e(b){var c=this,d=c.rawConfig,e=c.getEl(),f=e.find(".js-content");return c.nameIpt=o.transform(e.find(".js-name")),d.isMsg?(c.contentIpt=j('<textarea style="resize:none;border-radius:3px;height:120px;" placeholder="短信内容"></textarea>'),f.append(c.contentIpt),c.contentIpt.outerWidth(f.width()),c.popup.fixPosition(),void(b&&b())):(f.html(['<div class="form-group">','<label class="control-label">邮件标题</label>','<div class="control-group js-title">','<input type="text" placeholder="邮件标题">',"</div>","</div>",'<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>',p.getNameList(d.isInterviewer),"</div>",'<div class="editor-box js-editor"></div>'].join("")),c.titleIpt=o.transform(f.find(".js-title")),void a.async("../../../../../component/editorSub/hEditor/index",function(a){c.contentIpt=new a({width:f.width(),height:200,renderTo:f,noCodeSelect:!0,noToolbarFixed:!0,noAutoHeight:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,|,table,subscript,superscript,removeformat".split(",")},render:function(){c.contentIpt=c.contentIpt||this,c.popup.fixPosition(),this.waitCreated(b)}})}))}function f(a){var b=this,c=b.rawConfig,d=!!c.isMsg;if(0===arguments.length){var e={templateContent:{name:j.trim(b.nameIpt.val()),value:{}}};return d?e.templateContent.value.sms=j.trim(b.contentIpt.val()):(e.templateContent.value.subject=j.trim(b.titleIpt.val()),e.templateContent.value.content=p.html2tpl(b.contentIpt.val()||"")),e.templateContent=JSON.stringify(e.templateContent),e}a=m.json(a.templateContent,{}),b.nameIpt.val(a.name),d?b.contentIpt.val(a.value.sms):(b.titleIpt.val(a.value.subject),b.contentIpt.val(p.tpl2html(a.value.content||"")))}function g(){var a=this,b=a.rawConfig,c=a.val(),d=a.nameIpt,e=m.json(c.templateContent);if(!e.name)return void d.setErrorTips("名称不能为空");if(e.name.length>20)return void d.setErrorTips("名称最长为20个字符");var f=e.value||{};if(b.isMsg){if(!f.sms)return void n.alert("短信内容不能为空")}else{if(!f.subject)return void a.titleIpt.setErrorTips("邮件标题不能空");if(!f.content||a.contentIpt&&!a.contentIpt.text())return void n.alert("邮件正文不能为空")}return!0}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Component,l=h.Clazz,m=h.Base,n=(h.Limit,i.Popup),o=i.Input,p=a("./util"),q=c.exports=l.create();l.mix(q,k,{_template:['<div class="pop-mod-set" style="max-height:none;">','<div class="form-group">','<label class="control-label">模板名称</label>','<div class="control-group js-name">','<input type="text" placeholder="模板名称">',"</div>","</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initCpn(function(){b.data&&a.val(b.data)})}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=j(a.currentTarget),d=j.trim(c.attr("data-name")),e=p.name2img(d);e&&b.contentIpt&&b.contentIpt.waitCreated(function(){b.contentIpt.getEditor().exec("insertimage",e)})}}],show:d},{initCpn:e,val:f,check:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/util/tpl",[],function(a,b,c){function d(a){return a+"邀请你参加在线面试"}function e(a){return['<table width="700" cellpadding="0" cellspacing="0" style="border:1px solid #C6C6C6; margin:0 auto;table-layout:fixed; font-family: \'Microsoft YaHei\',\'Lato\',Helvetica,Arial,sans-serif;">',"<tbody>",'<tr><td style="background:#3ca0ee;padding:7px;"></td></tr>',"<tr>",'<td style="padding: 60px 60px 30px;">','<h1 style="font-size:18px;">亲爱的<span style="color:#3ca0ee;">#候选人姓名#</span></h1>','<p style="font-size:14px;">很荣幸邀请你参加<span style="color:#3ca0ee;">',a,"</span>在线视频面试。为不影响你的面试安排，请尽快点此确认是否参加：</p>",'<p style="text-align:center;margin-top:50px;"><a target="_blank" href="[$##$]confirmUrl[$##$]" style="border:1px solid #3ca0ee;color:#3ca0ee;font-size:14px;height:30px;line-height:30px;padding:10px;text-decoration:none;">点击确认是否参加面试</a></p>',"</td>","</tr>","<tr>",'<td style="padding:0 60px 50px;line-height:1.5;color:#3d444c;">','<span style="border-top:2px solid #3ca0ee;display:inline-block;font-size:16px;padding-top:5px;margin-bottom:20px;">    面试信息</span>','<p style="font-size:14px;margin: 0 0 10px 0">面试时间：<span style="color:#3ca0ee;">#面试时间#</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试职位：<span style="color:#3ca0ee;">#应聘职位#</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试方式：<span style="color:#3ca0ee;">远程视频</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试链接：<span style="color:#3ca0ee;">#面试链接#</span>（你的专属链接，请勿转发）</p>',"</td>","</tr>","<tr>",'<td style="padding:0 60px 50px;line-height:1.5;color:#3d444c;">','<span style="border-top:2px solid #3ca0ee;display:inline-block;font-size:16px;padding-top:5px;margin-bottom:20px;">面试重要注意事项</span>','<ol style="margin:0;padding:0;padding-left:15px;line-height:1.8">','<li style="margin-bottom:10px;">请使用Chrome最新版浏览器及带有摄像头及麦克风的电脑；</li>','<li style="margin-bottom:10px;">为保证面试顺利进行，请务必提前进入测试页面进行设备调试：<a style="color:#3ca0ee;" href="https://interview.nowcoder.com/test/video/interview" target="_blank">https://interview.nowcoder.com/test/video/interview</a>；</li>','<li style="margin-bottom:10px;">开始前请关闭所有的下载软件，确保网络速度流畅（100KB/S以上）；</li>',"<li>请在面试开始前10分钟登录页面进行面试准备。</li>","<li>此外，你可微信扫码关注服务号“校招小管家”，随时查询面试信息，进行面试签到。</li>",'<div style="width:100%;text-align:center;">','<img src="https://uploadfiles.nowcoder.com/images/20160218/qrcode_for_gj.jpg" style="margin-left:auto;margin-right:auto;width:100px;height:100px;">',"</div>","</ol>","</td>","</tr>",'<tr><td style="padding:0 60px 50px;line-height:1.8;color:#3d444c;">祝你面试顺利！<br>牛客网敬上</td></tr>','<tr><td style="font-size:14px;background:#3ca0ee;padding:2px;color:#fff;text-align:center;">www.nowcoder.com</td></tr>',"</tbody>","</table>"].join("")}function f(){return"面试通知"}function g(a){return['<table width="700" cellpadding="0" cellspacing="0" style="border:1px solid #C6C6C6; margin:0 auto;table-layout:fixed; font-family: \'Microsoft YaHei\',\'Lato\',Helvetica,Arial,sans-serif;">',"<tbody>",'<tr><td style="background:#3ca0ee;padding:7px;"></td></tr>',"<tr>",'<td style="padding: 60px 60px 30px;">','<h1 style="font-size:18px;"><span style="color:#3ca0ee;">#面试官姓名#</span></h1>','<p style="font-size:14px;">你好。 <span style="color:#3ca0ee;">',a,"</span>有一场在线面试请你参加。</p>","</td>","</tr>","<tr>",'<td style="padding:0 60px 50px;line-height:1.5;color:#3d444c;">','<span style="border-top:2px solid #3ca0ee;display:inline-block;font-size:16px;padding-top:5px;margin-bottom:20px;">    面试信息</span>','<p style="font-size:14px;margin: 0 0 10px 0">面试时间：<span style="color:#3ca0ee;">#面试时间#</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试职位：<span style="color:#3ca0ee;">#应聘职位#</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试方式：<span style="color:#3ca0ee;">远程视频</span></p>','<p style="font-size:14px;margin: 0 0 10px 0">面试链接：<span style="color:#3ca0ee;">#面试链接#</span>（你的专属链接，请勿转发）</p>','<p style="font-size:14px;margin: 0 0 10px 0">候选人姓名：<span style="color:#3ca0ee;">#候选人姓名#</span></p>',"</td>","</tr>","<tr>",'<td style="padding:0 60px 50px;line-height:1.5;color:#3d444c;">','<span style="border-top:2px solid #3ca0ee;display:inline-block;font-size:16px;padding-top:5px;margin-bottom:20px;">面试重要注意事项</span>','<ol style="margin:0;padding:0;padding-left:15px;line-height:1.8">','<li style="margin-bottom:10px;">请使用chrome最新版浏览器及带有摄像头及麦克风的电脑；</li>','<li style="margin-bottom:10px;">开始前请关闭所有的下载软件，确保网络速度流畅（100KB/S以上）；</li>','<li style="margin-bottom:10px;">为保证面试顺利进行，请务必提前进入测试页面进行设备调试：<a style="color:#3ca0ee;" href="https://interview.nowcoder.com/test/video/interview" target="_blank">https://interview.nowcoder.com/test/video/interview</a>；</li>',"</ol>","</td>","</tr>",'<tr><td style="padding:0 60px 50px;line-height:1.8;color:#3d444c;">祝你面试顺利！<br>牛客网敬上</td></tr>','<tr><td style="font-size:14px;background:#3ca0ee;padding:2px;color:#fff;text-align:center;">www.nowcoder.com</td></tr>',"</tbody>","</table>"].join("")}c.exports={intervieweeSms:"你的专属面试链接地址及注意事项已发至邮箱，如未收到邮件，可关注微信服务号：校招小管家随时查询。",interviewerSms:"请使用chrome最新版浏览器及带有摄像头及麦克风的电脑，确保网络速度流畅，提前进入面试页面进行设备调试。更多注意事项查看邮件。",intervieweeMailTitle:d,intervieweeMailContent:e,interviewerMailTitle:f,interviewerMailContent:g}});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/send/util/util",["nc","cpn","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;return o.forEach(b.TAG_NAME_LIST,function(c,d){var e="#"+c+"#",f='<img src="//uploadfiles.nowcoder.com/'+b.TAG_IMAGE_LIST[d]+'" />';a=a.replace(new RegExp(e,"gi"),f)}),a}function e(a){var b=this;return a.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(a,c,d,e){if("img"!==(e||"").toLowerCase())return a;var f=b.getAttrList(a),g=n.trim(f.src);if(!g)return a;for(var h=0,i=b.TAG_IMAGE_LIST.length;i>h;h++)if(g.indexOf(b.TAG_IMAGE_LIST[h])>=0)return"#"+b.TAG_NAME_LIST[h]+"#";return a})}function f(a){var b=this;a=n.trim(a);var c=o.indexOf(b.TAG_NAME_LIST,a);return c>=0?"//uploadfiles.nowcoder.com/"+b.TAG_IMAGE_LIST[c]:""}function g(a){var b=this;return o.forEach(b.TAG_KEY_LIST,function(){a=a.replace(/\[\$\#\#\$\](.*?)\[\$\#\#\$\]/gi,function(a,c){var d=o.indexOf(b.TAG_KEY_LIST,c);return d>=0?"#"+b.TAG_NAME_LIST[d]+"#":""})}),a}function h(a){var b=this,c="";return o.forEach(b.TAG_NAME_LIST,function(b){c+=a&&"面试确认链接"===b?"":'<a class="tag-label js-tag-info" data-name="'+b+'" href="javascript:void(0);">'+b+"</a>"}),c}function i(a){for(var b,c={},d=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g;b=d.exec(a);){var e=(b[1]||b[2]||b[4]||b[6]).toLowerCase();c[e]=(b[2]?b[3]:b[4]?b[5]:b[7])||""}return c}function j(b){var c=!!b.msg,d=!!b.interviewer,e=!!b.offline,f=b.title,g=b.content;return c||f?g?void a.async("../../../../../component/popupSub/tpl/popupTplName",function(a){a.show({title:"保存"+(d?"面试官":"候选人")+(c?"短信":"邮件")+"模板",ok:function(a){var b=c?1e3:1002;!d&&(b=e?c?1007:1008:c?1001:1003);var h={type:b,isDefault:a.isDefault?1:0,content:{name:a.name,value:{}}};c?h.content.value.sms=g:(h.content.value.emailSubject=f,h.content.value.emailContent=g),h.content=JSON.stringify(h.content),p.addTemplate({type:"POST",body:h,call:function(){q.tips("操作成功")},error:function(a){q.alert(a.msg)}})}})}):q.alert(c?"短信内容不能为空":"邮件正文不能为空"):q.alert("邮件标题不能为空")}function k(b){var c=!!b.msg,d=!!b.interviewer,e=!!b.offline,f=c?1e3:1002;!d&&(f=e?c?1007:1008:c?1001:1003),a.async("../../../../../component/popupSub/tpl/popupTplList",function(e){e.show({uid:b.uid,reqType:f,isMsg:c,isInterviewer:d,edit:function(b){a.async("./popupTplEdit",function(a){a.show({isMsg:c,isInterviewer:d,data:b.data,ok:b.ok})})},ok:b.call})})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=a("../../../../../action/common"),q=m.Popup;c.exports={TAG_NAME_LIST:["面试时间","面试链接","应聘职位","候选人姓名","面试官姓名","面试确认链接"],TAG_KEY_LIST:["interviewTime","interviewLink","interviewJob","intervieweeName","interviewerName","confirmUrl"],TAG_IMAGE_LIST:["acts/mailTag/4.png","acts/mailTag/8.png","acts/mailTag/17.png","acts/mailTag/13.png","acts/mailTag/14.png","acts/mailTag/3.png"],tpl2html:d,html2tpl:e,name2img:f,key2name:g,getNameList:h,getAttrList:i,saveTpl:j,getTpl:k}});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/systemSet/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(){}function e(){var a=this;a.initUpload(),a.initCheckBox()}function f(){var a=this,b=x.show({target:a.getEl(".js-change-logo"),url:B.getUploadUrl(1),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",call:function(b){a.setData("cpn-val-logo",b.data),a.renderLogo()},error:function(a){z.alert(a.msg)}});a.pushChild(b)}function g(){var a=this,b=y.mix({el:a.getEl(".js-need-filled .checkbox"),change:function(){var b=this.val();a.setData("cpn-val-need-filled",b)}});a.setData("cpn-need-filled",b)}function h(){var a=this;a.setData("cpn-val-logo",""),a.setData("cpn-val-need-filled",[]),a.getInterviewsettings()}function i(){var a=this;C.getInterviewsettings({type:"GET",params:{userId:a.getUserId()},query:{},call:function(b){var c=v.isObject(b.data)?b.data:{};a.setData("interview-settings",c),a.handleInterviewSettings()},error:function(b){a.renderWait(a.getEl(".module-body"),b.msg)}})}function j(){var a=this,b=a.getData("interview-settings");a.setData("cpn-val-logo",b.interviewLogo||""),a.setData("back-need-filled",b),a.updateFrontNeedFilled(),a.renderLogo(),a.renderNeedFilled()}function k(){var a=this,b={needInterviewerName:"0",needScore:"1",needEvaluation:"2"},c=a.getData("back-need-filled"),d=[];v.forEach(b,function(a,b){c[b]&&d.push(a)}),a.setData("cpn-val-need-filled",d)}function l(){var a=this,b=a.getData("cpn-val-logo")||D;a.getEl(".js-img-logo").attr("src",b)}function m(){var a=this,b=a.getData("cpn-val-need-filled"),c=a.getData("cpn-need-filled");v.isFunction(c.val)&&c.val(b)}function n(){var a=this;a.updateBackBody(),C.updateInterviewsettings({type:"PUT",params:{userId:a.getUserId()},body:a.getData("back-body"),call:function(){z.tips("操作成功",function(){a.nav("interview",{action:"project/index"})})},error:function(a){z.alert(a.msg)}})}function o(){var a=this,b=a.getData("cpn-val-logo");a.updateBackNeedFilled();var c=v.extend({userId:a.getUserId(),interviewLogo:b},a.getData("back-need-filled"));a.setData("back-body",c)}function p(){var a=this,b={needInterviewerName:"0",needScore:"1",needEvaluation:"2"},c=a.getData("cpn-val-need-filled"),d={};v.forEach(b,function(a,b){d[b]=v.contains(c,a)}),a.setData("back-need-filled",d)}function q(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function r(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function s(){return{crumb:[{title:"面试项目",module:"interview",param:{action:"project/index"}}]}}var t=a("nc"),u=a("cpn"),v=t.Base,w=(t.$,t.Clazz),x=u.AttachUpload,y=u.CheckGroup,z=u.Popup,A=a("../../../../core/module"),B=a("../../../../util/util"),C=a("../../../../action/user"),D="https://uploadfiles.nowcoder.com/images/20170708/4145441_1499493004495_4B71EABD9BFAB41277D58B10493F6811",E=c.exports=w.create();w.mix(E,A,{style:"/stylesheets/styles/system/interviewSetting.css",title:"面试系统设置",showTask:!1,_template:['<div class="module-box">','<div class="module-head clearfix">',"<h2>面试系统</h2>","</div>",'<div class="module-body">','<div class="interview-sys-setting">','<div class="form-group">','<label class="control-label">面试界面LOGO</label>','<div class="control-group">','<div class="interview-sys-logo"><img class="js-img-logo"></div>','<a href="javascript:void(0)" class="link-green js-change-logo">修改（建议82px*28px）</a>',"</div>","</div>",'<div class="form-group">','<label class="control-label">面试官必填</label>','<div class="control-group js-need-filled">','<label class="checkbox">','<span class="icons"></span>','<input type="checkbox" value="0">',"面试官姓名","</label>",'<label class="checkbox">','<span class="icons"></span>','<input type="checkbox" value="1">',"面试综合评价","</label>",'<label class="checkbox">','<span class="icons"></span>','<input type="checkbox" value="2">',"评语","</label>",'<div class="sys-setting-tip">面试官需填写所有勾选的内容才可以结束面试</div>',"</div>","</div>","</div>",'<div class="btn-set-wrapper">','<a href="javascript:void(0);" class="btn btn-default js-cancel" style="margin-right:40px;">取消</a>','<a href="javascript:void(0);" class="btn btn-primary js-save">保存</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.initData()}},{name:"click .js-save",handler:function(){var a=this;a.updateSet()}},{name:"click .js-cancel",handler:function(){var a=this;a.nav("interview",{action:"project/index"})}}]},{initialize:d,initCpns:e,initUpload:f,initCheckBox:g,initData:h,getInterviewsettings:i,handleInterviewSettings:j,updateFrontNeedFilled:k,renderLogo:l,renderNeedFilled:m,updateSet:n,updateBackBody:o,updateBackNeedFilled:p,getData:q,setData:r,getCrumbConf:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/util/popupInterviewArrange",["nc","cpn"],function(a,b,c){function d(a){a=a||{};{var b=new t(a);s.wrap(b,{title:"排期小助手",width:630,hasNoFooter:!0,content:b.html()})}return b}function e(){var a=this;a.cpn={}}function f(){var a=this,b=a.getEl(),c=a.cpn;c.roundCntIpt=q.transform(b.find(".js-round")),c.durationIpt=q.transform(b.find(".js-duration")),c.passIpt=q.transform(b.find(".js-pass")),c.interviewerCntIpt=q.transform(b.find(".js-interviewer")),c.timeIpt=q.transform(b.find(".js-time")),c.roundCntIpt.inputEl.on("keyup",function(){var b=this.value,d=b&&!a.isDigit(b)?"请输入整数":"";c.roundCntIpt.setErrorTips(d)}),c.durationIpt.inputEl.on("keyup",function(){var b=this.value,d=b&&!a.isDigit(b)?"请输入整数":"";c.durationIpt.setErrorTips(d)}),c.passIpt.inputEl.on("keyup",function(){var b=this.value,d="";if(b)if(a.isDigit(b)){var e=+b;e>100&&(d="通过率不能超过100%")}else d="请输入整数";c.passIpt.setErrorTips(d)}),c.interviewerCntIpt.inputEl.on("keyup",function(){var b=this.value,d=b&&!a.isDigit(b)?"请输入整数":"";c.interviewerCntIpt.setErrorTips(d)}),c.timeIpt.inputEl.on("keyup",function(){var b=this.value,d=b&&!a.isDigit(b)?"请输入整数":"";c.timeIpt.setErrorTips(d)})}function g(){var a=this,b=a.cpn,c=+b.roundCntIpt.val();if(!c)return b.roundCntIpt.setErrorTips("今日面试轮次数量不为空"),!1;var d=+b.durationIpt.val();if(!d)return b.durationIpt.setErrorTips("人均面试时常不为空"),!1;var e=+b.passIpt.val();if(!e)return b.passIpt.setErrorTips("每轮通过比例不为空"),!1;var f=+b.interviewerCntIpt.val();if(!f)return b.interviewerCntIpt.setErrorTips("面试官数量不为空"),!1;var g=+b.timeIpt.val();return g?!0:(b.timeIpt.setErrorTips("有效时长不为空"),!1)}function h(){var a=this,b=a.cpn;return{round:b.roundCntIpt.val(),durationCnt:b.durationIpt.val(),passCnt:b.passIpt.val(),interviewerCnt:b.interviewerCntIpt.val(),timeCnt:b.timeIpt.val()}}function i(a){return a=p.str(a),!!(a&&o.isString(a)&&/^(\d|-|\.)+$/g.test(a)&&a.length>0)}function j(a,b){for(var c=1,d=0;b-1>d;d++)c*=a;return c}var k=a("nc"),l=a("cpn"),m=(k.$,k.Component),n=k.Clazz,o=k.Base,p=k.Str,q=l.Input,r=l.CheckBox,s=l.Popup,t=c.exports=n.create();n.mix(t,m,{_template:['<div class="pop-candidateSetting-main">','<div class="pop-candidateSetting">','<div class="form-group">','<label class="control-label">今日面试轮次</label>','<div class="mod-with-input js-round"><input type="text"><span>面</span></div>',"</div>",'<div class="form-group">','<label class="control-label">人均面试时长(含中途休息)</label>','<div class="mod-with-input js-duration"><input type="text"><span>分钟</span></div>',"</div>",'<div class="form-group">','<label class="control-label">每轮通过比例</label>','<div class="mod-with-input js-pass"><input type="text"><span>%</span></div>',"</div>",'<div class="form-group">','<label class="control-label">面试官数量&nbsp;&nbsp;&nbsp;</label>','<div class="mod-with-input js-interviewer"><input type="text"><span>人</span></div>',"</div>",'<div class="form-group">','<label class="control-label">有效面试时长</label>','<div class="mod-with-input js-time"><input type="text"><span>小时</span></div>',"</div>","</div>",'<div class="btn-wrap">','<a href="javascript:void(0);" class="btn btn-auto btn-primary js-estimate">估算今日面试人数</a> ','<a href="javascript:void(0);" class="btn btn-auto btn-default js-reset">重置</a>',"</div>",'<div class="candidate-set-ft clearfix js-result">',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}},{name:"click .js-reset",handler:function(){var a=this,b=a.getEl(),c=a.cpn;o.forEach(c,function(a){a.constructor===r?a.checked(!1):a.constructor===q&&a.val("")}),b.find(".js-result").html("")}},{name:"click .js-estimate",handler:function(){var a=this,b=a.getEl();if(a.check()){for(var c=a.val(),d=60*c.timeCnt*c.interviewerCnt/c.durationCnt,e=c.passCnt,f=c.round,g=0,h=1;f>=h;h++)g+=a.exop(e/100,h);var i=Math.round(d/g),j=Math.round(1.1*d/g),k=Math.round(60*c.timeCnt/c.durationCnt),l="<span>今日约可面试："+i+"人</span><span>每个面试官："+k+"人次</span><span>建议通知面试："+j+"人</span>";b.find(".js-result").html(l)}}}],show:d},{initialize:e,initCpn:f,isDigit:i,exop:j,check:g,val:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/util/popupProject",["nc","cpn","../../../../action/interviewProject","../../../../util/ajax","../../../../component/department","../../../../util/switch","../../../../util/util","../../../../core/siteConfig","../../../../action/user"],function(a,b,c){function d(a){a=a||{};var b=a.project?a.project.nId:0,c=new s(a),d=(a.uid,p.wrap(c,{title:b?"修改面试项目":"新建面试项目",width:550,cancelTxt:"取消",content:c.html(),ok:function(){return c.checkName(function(){c.addOrUpdateProject(function(){d.close()})}),!0},cancel:function(){}}));return c}function e(a){var b=this,c=b.rawConfig.project||{},d=c.sName||"",e=k.trim(b.nameInput.val());if(!e)return void b.nameInput.setErrorTips("项目名字不能为空");if(d===e)return void(a&&a());if(e.length>20)return void b.nameInput.setErrorTips("项目名字长度不能超过20字符");var f=k.trim(b.remarkInput.val());return f.length>100?void b.remarkInput.setErrorTips("项目备注的长度不能超过100字符"):void q.checkName({query:{projectName:e},call:function(c){"1"===n.id(c.data)?b.nameInput.setErrorTips("名字已经存在"):a&&a()},error:function(){a&&a()}})}function f(){var a=this,b=a.getEl(),c=a.rawConfig.project||{};a.nameInput=new o({placeholder:"输入项目名称，不能超过20字符",renderTo:b.find(".js-project-name"),renderBy:"replaceWith",value:c.sName||""}),a.nameInput.inputEl.on("keyup",function(){var b=k.trim(this.value);b.length>20?a.nameInput.setErrorTips("项目名字长度不能超过20字符"):a.nameInput.setNone("")}),a.remarkInput=new o({placeholder:"输入项目备注，不能超过100字符",renderTo:b.find(".js-project-remark"),renderBy:"replaceWith",value:c.sRemark||""}),a.remarkInput.inputEl.on("keyup",function(){var b=k.trim(this.value);b.length>100?a.remarkInput.setErrorTips("项目备注的长度不能超过100字符"):a.remarkInput.setNone()})}function g(){var a=this,b=a.rawConfig,c=a.rawConfig.project||{},d=a.departmentCpn=new r({renderTo:a.getEl(".js-department"),renderBy:"replaceWith",type:"selectMult",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以看见并管理该面试项目",userId:b.uid,value:c.nId?n.map(c.departmentList,function(a){return n.id(a.id)}):void 0,marginLeft:"-55px"});d.getEl(".control-label").width(135)}function h(a){var b=this,c={projectName:k.trim(b.nameInput.val()),projectRemark:k.trim(b.remarkInput.val()),departmentIdList:b.departmentCpn.val()||[]},d=b.rawConfig,e=d.project?n.id(d.project.nId):"0";"0"===e?q.addProject({type:"POST",body:c,call:function(){p.tips("创建成功"),a&&a(),d.call&&d.call()},error:function(a){p.alert(a.msg)}}):q.updateProject({type:"PUT",params:{projectId:e},body:c,call:function(){p.tips("修改成功"),a&&a(),d.call&&d.call()},error:function(a){p.alert(a.msg)}})}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=j.Input,p=j.Popup,q=(j.SelectMult,a("../../../../action/interviewProject")),r=a("../../../../component/department"),s=c.exports=m.create();m.mix(s,l,{_template:['<div class="pop-box">','<div class="pop-content clearfix">','<div class="form-group">','<label class="control-label">项目名称</label>','<span class="js-project-name"></span>',"</div>",'<div class="form-group">','<label class="control-label">项目备注</label>','<span class="js-project-remark"></span>',"</div>",'<div class="js-department"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initIpt(),a.initDepartment(),a.getEl().css("margin-left",30),a.popup.fixPosition()}}],show:d},{initIpt:f,initDepartment:g,checkName:e,addOrUpdateProject:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/interview/util/util",["nc","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b._db=b._db||new i(j.appDb.interviewProject);return h.trim(a)?c.get(a)||"0":c}function e(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function f(a){var b=this,c=b.getDb();b._db.refresh(),c.remove(a)}var g=a("nc"),h=(g.Base,g.$),i=g.Db,j=a("../../../../core/siteConfig");c.exports={SCHEDULE_ADD:"ADD_SCHEDULE",getDb:d,setDb:e,removeDb:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/cpn/popupPaperList",["nc","cpn","../../../../../action/paper","../../../../../util/ajax","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new s(a);return p.wrap(b,{title:"加载试卷配置",hasNoFooter:!1,content:b.html(),width:500,cancel:function(){},ok:function(){return b.submit(),!0}}),b}function e(){var a=this;r.checkProject({all:!0,simple:!0,call:function(b,c){b=r.getAllId(c),r.getAllPaper({id:b,call:function(b){a.renderList(b),a.popup.fixPosition()}})}})}function f(a,b){function c(e){q.getPaperQuestion({type:"GET",params:{paperId:a},query:{page:e,pageSize:200},call:function(a){var f=a.data;d=d.concat(f.datas||[]),f.currentPage<f.totalPage?c(e+1):b&&b(d)},error:function(){p.alert("数据加载出错，请重试")}})}var d=[];c(1)}function g(a){var b=this,c=b.getEl();b.select=new o({renderTo:c.find(".js-content"),renderBy:"replaceWith",needSearch:(a||[]).length>5,options:n.map(a,function(a,b){return{text:a.paperName,value:a.id,checked:0===b}})})}function h(){var a=this,b=a.select.val();q.getPaper({type:"GET",params:{paperId:b},call:function(c){var d=a.result=c.data,e=(d||{}).setting=(d||{}).setting||{},f=!!e.randomQuestion,g=e.customCategory;g&&!f?a.fetchQuestion(b,function(b){e.extQuestions=b,a.fire("ok",c.data),a.popup.close()}):(a.fire("ok",c.data),a.popup.close())},error:function(a){p.alert(a.msg)}})}function i(){var a=this;return a.result}var j=a("nc"),k=a("cpn"),l=(j.$,j.Component),m=j.Clazz,n=j.Base,o=k.Select,p=k.Popup,q=a("../../../../../action/paper"),r=a("../../../extend/bll/paper"),s=c.exports=m.create();m.mix(s,l,{_template:'<div><div style="text-align:center;font-size:14px;"><div  class="js-content">加载中...</div></div></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchList()}}],show:d},{fetchList:e,fetchQuestion:f,renderList:g,submit:h,val:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/cpn/steps",["nc","../../../../../component/steps"],function(a,b,c){function d(a){var b=this;b.isEdit=!!a.isEdit}function e(){var a=this;a.step4||(a.step4=new k({renderTo:a.getEl(),current:a.currentStep,titles:["选择组卷方式","选择组卷题目",(a.isEdit?"编辑":"设置")+"试卷参数","完成"]})),a.step5&&a.step5.hide(),a.step4.show()}function f(){var a=this;a.step5||(a.step5=new k({renderTo:a.getEl(),current:a.currentStep,titles:["选择组卷方式","选择组卷题目",(a.isEdit?"编辑":"设置")+"抽题方式",(a.isEdit?"编辑":"设置")+"试卷参数","完成"]})),a.step4&&a.step4.hide(),a.step5.show()}function g(a){var b=this;b[5===a?"toFiveSteps":"toFourSteps"]()}var h=a("nc"),i=(h.$,h.Str,h.Component),j=h.Clazz,k=(h.Base,a("../../../../../component/steps")),l=c.exports=j.create();j.mix(l,i,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.currentStep=b.currentStep||1,a[5===b.totalStep?"toFiveSteps":"toFourSteps"]()}}]},{initialize:d,toFourSteps:e,toFiveSteps:f,change:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/cpn/tinyQList",["nc","cpn","../../../../../component/popupSub/popupQuestion","../../../../../core/siteConfig","../../../../../action/paper","../../../../../util/ajax","../listData","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../util/util","../util","../data","../../util"],function(a,b,c){function d(a){var b=this,c=!!a.isEdit;a.renderTo=a.renderTo||z(document.body),M=L.getDataUtil(c),b.listData=a.listData||new K({edit:c}),b.isCustomDir=M.isCustomDir(),b.isRandom=M.isRandomQuestionType()}function e(){var a=this;a.resize();var b=E.bind(a.resize,a);B.unlisten("winResize",b),B.listen("winResize",b),a.listen("destroy",function(){B.unlisten("winResize",b)})}function f(){function a(a,e){var g=d.listData.resortQuestion(a,e);if(g){var h=(d.getEl(),f.getQuestionDirId(a)),i=f.getDirQuestionId(h),j=f.getMultiSub(a,!0)||[a],k=E.indexOf(i,j[0]);if(k>=0){var l=d.getDirEl(h),m=b(l,a),n=e?m.first.prev():m.last.next(),o=z.trim(n.attr("data-id"));n=b(l,o)[e?"first":"last"];var p=c(m.items);p[e?"insertBefore":"insertAfter"](n),d.fixResort(h)}}}function b(a,b){var c=f.getMultiSub(b,!0)||[b],d=E.map(c,function(b){return a.find("li[data-id="+b+"]")});return{items:d,first:d[0],last:d[d.length-1]}}function c(a){var b=z(document.createDocumentFragment());return E.forEach(a,function(a){b.append(a)}),b}var d=this,e=d.getEl(),f=d.listData;e.on("click",".js-up",function(b){var c=d.getQid(b.currentTarget);c&&a(c,!0)}).on("click",".js-down",function(b){var c=d.getQid(b.currentTarget);c&&a(c)})}function g(){var a=this;a.listData.listen("dataChange",function(b){return{addDirScore:1,addQuestionScore:1,resortQuestion:1}[b]?void a.fixFooter():void a.refresh()})}function h(a,b){{var c=this;c.getEl()}c.renderBody(b),c.fixFooter()}function i(){var a=this,b=a.listData,c=b.getListDir(),d=0===c.length,e=a.listEl;a.tipsEl[d?"show":"hide"](),e[d?"hide":"show"]().html("");var f='<ul><li class="com-exam-hd"><div class="com-exam-title">题目</div><span class="com-exam-pipe">|</span><span class="com-exam-score">分值</span></li></ul>';E.forEach(c,function(c){var d=b.getDirQuestionId(c.id);f+=D.execTpl(['<ul data-id="#{id}">','<li class="hover com-exam-type">',"#{title}(#{count})",'<div class="score-txt-box">','<input class="w30 sm-input js-dir-score" type="text" value="#{score}"> / 题',"</div>",'<span class="com-exam-score">#{score}分 / 题</span>',"</li>","</ul>"].join(""),{id:c.id,title:(c.title||"").replace(/\[\$\#?\#?\$?\]?/g,"()"),count:d.length,score:a.getDirScore(c.id)})}),e.find("input.js-dir-score").unbind("blur"),e.html(f),e.find("input.js-dir-score").on("blur",function(b){var c=z(b.currentTarget),d=z.trim(c.val()),e=a.getDirId(c);a.scoreDir(e,d)}),E.forEach(c,function(b){var c=b.id,d=e.find("ul[data-id="+c+"]");d.append('<li class="js-more" style="text-align:center;">加载中...</li>'),a.renderDir(c,0)})}function j(a,b){var c=this,d=c.getEl(),e=c.listData,f=d.find("ul[data-id="+a+"]"),g=c.getInfoByPage(a,b),h=c.isRandom;e.getQuestionById(g.ids,!1,function(b){var d=E.map(b,function(a,b){var c=g.multi[b];return D.execTpl(['<li class="hover js-item #{cls}" data-id="#{id}">','<a href="javascript:void(0);" class="com-exam-title js-question" title="#{title}"><span class="js-index">#{index}</span>. #{title}</a>#{multi}',h?"":'<span class="com-exam-score">#{score}</span>','<div class="score-txt-box">',h?"":'<input class="w30 sm-input js-q-score" type="text" value="#{score}">',' <a href="javascript:void(0);" class="icon-trash js-remove"></a>',h?"":' <a href="javascript:void(0);" class="icon-arrow-up js-up"></a>',h?"":' <a href="javascript:void(0);" class="icon-arrow-down js-down"></a>',"</div>","</li>"].join(""),{id:a.id,index:g.start+b+1,cls:c?"with-link-item":"",title:a.title,score:e.getQuestionScore(a)})});f.find("input.js-q-score").unbind(),f.append(d.join("")),f.find(".js-more").remove(),g.hasMore&&f.append(D.execTpl('<li class="js-more com-exam-more" data-page="#{page}"><i class="icon-plus-sign"></i> 加载更多</li>',{page:g.page+1})),c.fixResort(a),h||f.find("input.js-q-score").on("blur",function(a){var b=z(a.currentTarget),d=c.getQid(b);c.score(d,b.val())})})}function k(){var a=this,b=a.getEl(),c=a.isRandom,d=b.find(".js-total"),e=a.listData,f=e.getListDir(),g=0,h=0;E.forEach(f,function(a){var b=e.getDirQuestionId(a.id);g+=b.length,c||E.forEach(b,function(a){h+=+e.getQuestionScore(a)})});var i="已选题目:"+g;!c&&(i+=", 总分:"+h),d.html(i)}function l(a){var b=this;if(!b.isRandom){var c=b.getEl(),d=c.find("ul[data-id="+a+"] li.js-item"),e=b.getIndexMap(a),f=d.length-1;d.find(".js-up").css("display","inline-block"),d.find(".js-down").css("display","inline-block"),z(d[0]).find(".js-up").hide(),z(d[f]).find(".js-down").hide();var g,h={};E.forEach(d,function(a,b){a=z(a);var c=z.trim(a.attr("data-id"));if(h[c])return a.remove();var d=e[c];h[c]=!0,z(a).find(".js-index").html(d.val),g=d.isMulit?d.isFirst?a:g:null,d.isMulit&&!d.isFirst&&(a.find(".js-remove").hide(),a.find(".js-up").hide(),a.find(".js-down").hide()),b===f&&d.isMulit&&g&&g.find(".js-down").hide()})}}function m(){var a=this;a.renderList(),a.show(),a.resize()}function n(a,b){var c=this,d=c.listData;a=z.trim(a);var e=+G.fix(b)||0;if(a){d.addQuestionScore(a,e);var f=c.listEl.find("li[data-id="+a+"]");f.find("input.sm-input").val(e),f.find(".com-exam-score").html(e);var g=f.closest("ul"),h=c.getDirId(f),i=g.find("input.js-dir-score"),j=c.getDirScore(h);i.val(j),i.closest("li").find(".com-exam-score").html(j+"分 / 题")}}function o(a,b){var c=this,d=c.listData;a=z.trim(a);var e=+G.fix(b)||0;if(a){d.addDirScore(a,e);var f=c.getDirEl(a),g=f.find("input.js-dir-score");if(g.val(e),g.closest("li").find(".com-exam-score").html(e+"分 / 题"),!c.isRandom){var h=f.find(".js-q-score");h.val(e),h.closest("li").find(".com-exam-score").html(e)}}}function p(a){var b=z(a).closest("li");return z.trim(b.attr("data-id"))}function q(a){var b=z(a).closest("ul");return z.trim(b.attr("data-id"))}function r(a){var b=this,c=b.listData;return b.isRandom||c.isScoreAllSame(a)?c.getDirScore(a):"--"}function s(a){var b=this,c=b.getEl();return c.find("ul[data-id="+a+"]")}function t(a,b){function c(a){return f.getMultiParentId(h[a])}var d=this;b=+b||0;var e,f=d.listData,g=b*O,h=f.getDirQuestionId(a),i=[],j=[],k=-1,l=!1;return E.forEach(h,function(a,b){var d=c(b),f=d===e;if(e=d,(l||!d||!f)&&(l=b>=g,l&&(k=-1===k?b:k,i.push(a),j.push(!!d)),i.length>=O)){var h=c(b+1);return h&&h===d?null:E.BREAK}}),{ids:i,multi:j,start:k,page:b,total:h.length,hasMore:h.length>0&&k+i.length<h.length}}function u(a){function b(a){return e.getMultiParentId(f[a])}var c,d=this,e=d.listData,f=e.getDirQuestionId(a),g={},h=0,i=1;return E.forEach(f,function(a,d){var e=b(d),f=e===c;c=e,i=e&&f?i+1:1,(!e||!f)&&h++,g[a]={val:e?h+"-"+i:h+"",isMulit:!!e,isFirst:1===i}}),g}function v(a,b){var c=this,d=c.rawConfig.module,e=window.win;a=z.trim(a),a&&(e&&e.showLoading(),c.listData.getQuestionById(a,!0,function(c){e&&e.showLoading(!1);var f=b&&b!==a;c&&J.show({data:c,id:f?a:null,subId:f?b:null,verify:"4"!==E.id(c.type)||"2"!==E.id(c.tikuType)?null:function(){var a=d.getNavUrl("question",{action:"verify/index",id:E.id(c.id),dataLocation:"back",hasInBack:!0});a=H.addParam({theme:"tinyLeft"},a),window.open(a)}})}))}function w(){var a=this,b=a.rawConfig,c=a.getEl(),d=z(b.renderTo).height();c.outerHeight(d),d=c.height(),c.find("div.oprt-bd").outerHeight(d-c.find("div.oprt-hd").outerHeight()-c.find("div.oprt-ft").outerHeight())}var x=a("nc"),y=a("cpn"),z=x.$,A=x.Component,B=x.Event,C=x.Clazz,D=(x.Db,x.Str),E=x.Base,F=x.Limit,G=x.Num,H=x.Uri,I=y.Popup,J=a("../../../../../component/popupSub/popupQuestion"),K=a("../listData"),L=a("../util"),M=null,N=c.exports=C.create(),O=20;C.mix(N,A,{_template:['<div class="subject-oprt-wrap">','<div class="oprt-bd">','<div class="js-list"></div>','<div class="empty-tips js-empty-tips">','<img src="//uploadfiles.nowcoder.com/images/20160713/56_1468422650883_2FFFB588E7310CB65C09FD2E21A0E834">','<p class="empty-tips-font">你还没有选择试卷题目，<br>请根据题型，难度和知识点出题吧</p>',"</div>","</div>",'<div class="oprt-ft">','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-reselect">重选</a>','<div><a href="javascript:void(0);" class="js-total" style="color:white;">已选题目:0</a></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.listEl=c.find(".js-list"),a.tipsEl=c.find(".js-empty-tips"),b.tiny&&c.css("top",0),a.initResize(),a.initResort(),a.initDataChange(),a.refresh()}},{name:"click a.js-remove",handler:function(a){var b=this,c=z(a.currentTarget),d=b.getQid(c),e=b.getDirId(c);d&&b.listData.removeQuestion(d,e)}},{name:"click .js-reselect",handler:function(){var a=this,b=a.listData;I.confirm("如果重选题目，该试卷所选题目将全部清空，是否确认重选？",function(){b.clear()})}},{name:"click .js-question",handler:function(a){var b=this,c=b.getQid(a.currentTarget),d=b.listData.getMultiParentId(c);b.showDetail(d||c,c)}},{name:"click .js-more",handler:function(a){var b=this,c=z(a.currentTarget);if(!F.mark(c)){c.html("加载中...");var d=+c.attr("data-page")||0,e=b.getDirId(c);b.renderDir(e,d)}}}]},{initialize:d,initResize:e,initResort:f,initDataChange:g,renderList:h,renderBody:i,renderDir:j,fixFooter:k,fixResort:l,refresh:m,score:n,scoreDir:o,getQid:p,getDirId:q,getDirScore:r,getDirEl:s,getInfoByPage:t,getIndexMap:u,showDetail:v,resize:w})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/data",["nc","../util","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this;b.dbName=a.dbName,b.isEdit=!!a.isEdit}function e(a){var b=this,c=b._db=b._db||new x(b.dbName);return w.trim(a)?c.get(a)||{}:c}function f(a,b){var c=this,d=c.getDb();d.refresh(),d.set(a,b)}function g(){var a=this,b=a.getDb();b.remove()}function h(a,b){var c=this,d=(a||{}).setting||{},e=d.randomQuestion?c.ADD_QUESTION_RANDOM:c.ADD_QUESTION_FIXED,f=d.customCategory,g=f?c.ADD_PAPER_CUSTOM:c.ADD_PAPER_TYPE,h=[];f&&(b=b||c.getLoadDirData(a),h=v.map(b,function(a){return{title:a.dirName,type:a.questionType,id:a.id}})),0===h.length&&h.push({});var i={paper:g,question:e,dir:h};return c.setDb(c.DB_ADD_TYPE,i),i}function i(a){var b=this,c=b.paper2data(a);return b.setDb(b.DB_ADD_PAPER,c),c}function j(a){var b=this,c=(a||{}).setting||{},d=c.customCategory,e=!!c.randomQuestion,f=b.getLoadDirData(a);b.loadStep1Data(a,f),b.loadStep4Data(a);var g={dirMap:{},dirScoreMap:{},questionMap:{},scoreMap:{},questionTypeMap:{},questionDirMap:{},multiMap:{},multiSubMap:{}},h={};v.forEach(f,function(a){var b=a.id;a.dirScore&&(g.dirScoreMap[b]=a.dirScore),v.forEach(a.questions,function(a){var c=v.id(a.id),f=a.parentId?v.id(a.parentId):null;g.dirMap[b]=g.dirMap[b]||[],g.dirMap[b].push(c),a.score&&(g.scoreMap[c]=a.score),g[d?"questionDirMap":"questionTypeMap"][c]=b,!e&&f&&(g.multiMap[f]=g.multiMap[f]||[],g.multiMap[f].push(c),g.multiSubMap[c]=f)}),e&&(h[a.dirName]=a.tags)}),b.setDb(b.DB_ADD_QUESTION,g),b.setDb(b.DB_ADD_TAG_COUNT,{tag:h,randomFrequentType:c.randomFrequentType||0})}function k(a){var b=(a||{}).setting||{},c=!!b.customCategory,d=!!b.randomQuestion,e=b.questionCategories||{},f=b.questionIdsTypes||{},g=b.questionTagNames||{},h=((b.questionNewCounts||"").split(","),(b.questionScores||"").split(",")),i={};return d?(v.forEach((b.questionNewCounts||"").split(","),function(a){var b=a.split(":"),d=w.trim(b[0]),j=w.trim(b[1]),k=w.trim(b[2]),l=+w.trim(b[3])||0,m=e[k];i[m]||(i[m]={id:c?v.key():"typeDir_"+d,tags:[],questions:[],questionType:d,dirName:m});var n=i[m],o=f[j]||[];g[j]&&n.tags.push({tagName:g[j]||"",ids:o,inputCount:Math.max(0,Math.min(o.length,l))});var p=+h.splice(0,l)[0]||0;v.forEach(o,function(a){n.questions.push({id:a,score:p})}),n.dirScore=p}),v.values(i)):(c&&v.forEach(b.questionCategories,function(a,b){i[b]={id:v.key(),questions:[],questionType:"",dirName:a}}),v.forEach(b.extQuestions,function(a){var b=v.id(a.type);c||i[b]||(i[b]={id:"typeDir_"+b,questions:[],questionType:b,dirName:{1:"单选",2:"不定项",3:"填空",4:"编程",5:"问答",6:"数据挖掘"}[b]||""});var d=i[c?a.categoryId:b];d&&(d.questionType=d.questionType||b,d.questions.push({id:a.id,score:+a.score,parentId:a.parentId}))}),v.values(i))}function l(a){var b={};v.copy(b,a,["paperName","duration","forever"]),a.forever||(b.beginTime=a.beginTime?z.form(new Date(a.beginTime),"yyyy-MM-dd HH:mm:ss"):"",b.endTime=a.endTime?z.form(new Date(a.endTime),"yyyy-MM-dd HH:mm:ss"):"");var c=a.setting||{};b.projectId=a.projectId,b.logo=c.logo,b.departmentIdList=v.map(a.departmentList,function(a){return v.id(a.id)}),b.needCamera=c.allow_camera,b.monitorPhone=c.monitorPhone,b.allowNew=c.allow_new,b.allowCopy=c.allowCopy,b.reportPlatform=c.reportPlatform,b.codePlayback=c.codePlayback,b.needMessage=c.allow_message,b.questionDisorder=c.question_disorder,b.optionDisorder=c.option_disorder,b.antiJumpOut=c.antiJumpOut,b.antiCodingJumpOut=c.antiCodingJumpOut,b.noQueueUp=c.noQueueUp,b.checkCheat=c.checkCheat,b.codingScoreRule=c.codingScoreRule,b.chooseScoreRule=c.chooseScoreRule,b.languageLimit=!!c.languageLimit,b.languageList=c.languageList||[],b.mJudgeCompletion=!0,b.mJudgeDesign=!0,b.mJudgeCoding=!0,v.forEach((c.not_need_judge_type||"").split("_"),function(a){var c={3:"mJudgeCompletion",4:"mJudgeCoding",5:"mJudgeDesign"}[a];c&&(b[c]=!1)}),b.beforeSummary=c.paperSummary,b.endTips=c.paper_end_summary;var d=[];return v.forEach(c.signUpFields,function(a){if("key"===a.name)b.keyTitle=a.title,b.keyFormat=a.format;else if("name"===a.name);else{var c=A.data2field({name:a.title,type:a.valueType,options:a.valueList,format:a.format,edit:a.edit});d.push(c)}}),b.optionalFields=d,b.passScoreLine=a.passScoreLine,b.simulation=c.simulation,b}function m(){var a=this;return a.getDb(a.DB_ADD_TYPE).question||a.ADD_QUESTION_FIXED}function n(){var a=this;return a.getQuestionType()===a.ADD_QUESTION_RANDOM}function o(){var a=this;return a.getPaperType()===a.ADD_PAPER_CUSTOM}function p(){var a=this;return a.getDb(a.DB_ADD_TYPE).paper||a.ADD_PAPER_TYPE}function q(){var a=this;return(a.getDb(a.DB_ADD_TYPE).dir||[]).slice(0)}function r(a){for(var b=this,c=b.getDir(),d=0,e=c.length;e>d;d++)if(c[d].id===a)return c[d]}function s(){var a=this;return a.getPaperType()!==a.ADD_PAPER_CUSTOM||a.getDir().length>0}function t(){var a=this;if(!a.isRandomQuestionType())return!0;var b=a.getDb(a.DB_ADD_TAG_COUNT)||{},c=b.tag||{};if(0===v.keys(c).length)return!1;var d=!0;return v.forEach(c,function(a){return 0!==a.length&&d?void v.forEach(a,function(a){var b=(a.ids||[]).length,c=+v.id(a.inputCount)||0;return 0===b||0===c||c>b||!a.tagName?(d=!1,v.BREAK):void 0}):(d=!1,v.BREAK)}),d}var u=a("nc"),v=u.Base,w=u.$,x=u.Db,y=u.Clazz,z=u.Time,A=a("../util"),B=a("../../../../core/siteConfig"),C=y.create();v.extend(C.prototype,{initialize:d,ADD_QUESTION_FIXED:"1",ADD_QUESTION_RANDOM:"2",ADD_PAPER_TYPE:"1",ADD_PAPER_CUSTOM:"2",DB_ADD_TYPE:"DB_ADD_TYPE",DB_ADD_QUESTION:"DB_ADD_QUESTION",DB_ADD_PAPER:"DB_ADD_PAPER",DB_ADD_TAG_COUNT:"DB_ADD_TAG_COUNT",DB_EDIT_INFO:"DB_EDIT_INFO",SCORE_DEFAULT:3,SCORE_MULTI:10,getDb:e,setDb:f,clearDb:g,loadStep1Data:h,loadStep4Data:i,loadStepFullData:j,getLoadDirData:k,paper2data:l,getQuestionType:m,getPaperType:p,getDir:q,getDirById:r,isRandomQuestionType:n,isCustomDir:o,isStep1Right:s,isStep3Right:t}),c.exports={add:new C({dbName:B.appDb.addPaper}),edit:new C({dbName:B.appDb.editPaper,isEdit:!0})}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/listData",["nc","../../extend/bll/paper","cpn","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../util/util","./util","./data","../util"],function(a,b,c){function d(a){var b=this;a=a||{},V=U.getDataUtil(a.edit),b.isCustomDir=V.isCustomDir(),b.isRandom=V.isRandomQuestionType(),b.initData()}function e(){var a=this;a.db=V.getDb(V.DB_ADD_QUESTION),a.db.scoreMap=a.db.scoreMap||{},a.db.defaultScoreMap=a.db.defaultScoreMap||{},a.db.dirScoreMap=a.db.dirScoreMap||{},a.db.dirMap=a.db.dirMap||{},a.db.questionMap=a.db.questionMap||{},a.db.questionDirMap=a.db.questionDirMap||{},a.db.questionTypeMap=a.db.questionTypeMap||{},a.db.multiMap=a.db.multiMap||{},a.db.multiSubMap=a.db.multiSubMap||{},a.isRandom=V.isRandomQuestionType();var b=V.getDir(),c=P.toMap(b,function(a){return{key:a.id,value:!0}});P.forEach(a.db.dirMap,function(b,d){a.isTypeDir(d)||c[d]||(delete a.db.dirMap[d],delete a.db.dirScoreMap[d])}),P.forEach(a.db.questionDirMap,function(b,d){!c[b]&&delete a.db.questionDirMap[d]}),P.forEach(a.db.dirMap,function(b){var c={};P.forReverse(b,function(d,e){c[d]?b.splice(e,1):a.isRandom&&(a.db.multiSubMap[d]||a.db.multiMap[d])&&(b.splice(e,1),delete a.db.scoreMap[d],delete a.db.questionDirMap[d],delete a.db.questionTypeMap[d]),c[d]=!0})}),a.save()}function f(a,b){var c=this,d=c.db.dirMap,e=c.db.questionMap,f=P.isArray(a);if(!f&&!b&&!c.isCustomDir&&c.isItem(a)&&(b=a.type),b=c.getTypeDir(b)){var g=f?a.slice(0):[a];P.forReverse(g,function(a,b){var d=c.getMultiSub(a,!0);d&&g.splice.apply(g,[b,1].concat(d))});var h=d[b]=d[b]||[],i=c.db[c.isTypeDir(b)?"questionTypeMap":"questionDirMap"];P.forEach(g,function(a){var d=c.getQuestionId(a),f=c.canSelect(d,b);f&&(!i[d]&&h.push(d),i[d]=b,c.isItem(a)&&(a.content||a.title)&&(e[d]={data:a,full:!1}))}),c.save(),c.fire("dataChange","addQuestion",b)}}function g(a,b){var c=this,d=c.isCustomDir,e=c.db.dirMap,f=c.db.scoreMap,g=c.db[d?"questionDirMap":"questionTypeMap"],h=P.isArray(a)?a.slice(0):[a];b=c.getTypeDir(b),b&&(P.forReverse(h,function(a){var b=c.getMultiSub(a,!0);b&&h.push.apply(h,b)}),P.forEach(h,function(a){if(c.canSelect(a,b)){var d=c.getQuestionDirId(a);if(d){var h=c.getQuestionId(a),i=P.without(e[d]||[],h);e[d]=i,delete f[h],delete g[h]}}}),c.save(),c.fire("dataChange","removeQuestion",b))}function h(a){var b=this;a=b.getTypeDir(a);var c=b.db.dirMap,d=b.db.scoreMap,e=b.isTypeDir(a),f=b.db[e?"questionTypeMap":"questionDirMap"];(c[a]||[]).length=0,P.forEach(f,function(b,c){a===b&&(delete d[c],delete f[c])}),b.save(),b.fire("dataChange","removeDirAllQuestion",a)}function i(a,b){var c=this,d=c.getQuestionId(a),e=c.getQuestionDirId(d);if(d&&e){var f,g=c.getMultiParentId(d)||d,h=c.getDirQuestionId(e);P.forReverse(h,function(a,b){var d=c.getMultiParentId(a);d&&(h[b]=d),d&&d===f&&h.splice(b,1),f=d});var i=P.indexOf(h,g);if(i>=0&&(b&&0!==i||!b&&i+1!==h.length)){var j=b?-1:1;return h[i]=h[i+j],h[i+j]=g,P.forReverse(h,function(a,b){var d=c.getMultiSub(a);d&&h.splice.apply(h,[b,1].concat(d))}),c.db.dirMap[e]=h,c.save(),c.fire("dataChange","resortQuestion",a),!0}}}function j(a,b){var c=this,d=P.isArray(a)?a:[a],e=c.db.questionMap;P.forEach(d,function(a){var d=c.getQuestionId(a);!d||e[d]&&e[d].full||(e[d]={data:a,full:b})}),c.save()}function k(a,b){var c=this,d=c.db.dirScoreMap,e=c.db.scoreMap;a=c.getTypeDir(a),d[a]=b;var f=c.getDirQuestionId(a);P.forEach(f,function(a){delete e[a]}),c.save(),c.fire("dataChange","addDirScore")}function l(a,b){var c=this,d=c.db.scoreMap,e=!1;if(P.isArray(a))P.forEach(a,function(a){var b=a.id,c=a.score;b&&d[b]!==c&&(d[b]=c,e=!0)});else{var f=c.getQuestionId(a);f&&d[f]!==b&&(d[f]=b,e=!0)}e&&(c.save(),c.fire("dataChange","addQuestionScore"))}function m(a,b){var c=this,d=c.db.defaultScoreMap,e=!1;if(P.isArray(a))P.forEach(a,function(a){if(a){var b=a.id,c=a.defaultScore||a.score;b&&P.id(d[b])!==P.id(c)&&(d[b]=c,e=!0)}});else{var f=c.getQuestionId(a);f&&P.id(d[f])!==P.id(b)&&(d[f]=b,e=!0)}e&&c.save()}function n(){var a=this,b=a.isCustomDir,c=a.db.dirMap,d=[];return b?d=(V.getDir()||[]).slice(0):P.forEach(["1","2","3","4","5","6","7","8","9"],function(b){var e=a.getTypeDir(b);(c[e]||[]).length>0&&d.push({id:e,type:b,title:T.getQuestionType(b,!0)})}),d}function o(a,b,c){var d=this,e=P.isArray(a),f=e?a:[a],g=[],h=[];return P.forEach(f,function(a){var c=d.getCacheQuestion(a,b);c&&h.push(c),!c&&g.push(a)}),0===g.length?c&&c(e?h:h[0]):void R.getQuestions({ids:g,call:function(a){var h=[];P.forEach(g,function(b){b&&a[b]&&h.push(a[b])}),d.cacheQuestion(h,!0),d.addDefaultScore(h);var i=P.map(f,function(a){var c=d.getCacheQuestion(a,b);return c||(b?null:{id:a,title:"未知问题"})});c&&c(e?i:i[0])}})}function p(a,b){var c=this,d=c.db.questionMap,e=d[a];return e=!e||b&&!e.full?null:e,(e||{}).data}function q(a){var b=this,c=b.db.dirScoreMap,d=0;if(a=b.getTypeDir(a),P.id(c[a]))d=c[a];else{var e=b.getDirType(a);e&&(d="4"===e||"5"===e?20:3)}return+d||0}function r(a){var b=this,c=b.db.dirMap;return a=b.getTypeDir(a),(c[a]||[]).slice(0)}function s(a,b){var c=this,d=c.db.scoreMap,e=c.db.defaultScoreMap,f=c.getQuestionId(a),g=0;if(c.isMultiItem(f)){var h=c.getMultiSub(f);return P.forEach(h,function(a){g+=c.getQuestionScore(a)}),g}if(P.id(d[f]))g=d[f];else{var i=e[f],j=c.getQuestionDirId(a);j&&!c.isSetDirScore(j)&&i?g=i:j?g=P.id(c.getDirScore(j)):i?g=i:(c.isItem(a)||b)&&(b=b||P.id(a.type),g="4"===b||"5"===b?10*(a.difficulty||1):3)}return+g||0}function t(a){var b=this,c=b.getQuestionId(a),d=b.db.questionDirMap,e=b.db.questionTypeMap,f=b.isCustomDir;return(f?d:e)[c]}function u(a){var b=this,c="";if(/^\d+$/.test(a))c=P.contains("12345".split(""),a)?a:null;else if(b.isTypeDir(a))c=/^typeDir_(\d+)$/.exec(a)[1];else{var d=V.getDirById(a);c=P.id((d||{}).type)}return c}function v(a){return a=a||"",/^\d+$/.test(a)?"typeDir_"+a:a}function w(a){return P.id(P.isObject(a)?a.id:a)}function x(a){var b=this;return!!b.getMultiSub(a)}function y(a,b){var c=this,d=c.getQuestionId(a);if(d){var e=[];P.forEach(b,function(a){var b=c.getQuestionId(a);b&&e.push(b),b&&(c.db.multiSubMap[b]=d)}),c.db.multiMap[d]=e,c.save()}}function z(a,b){var c=this;b&&(a=c.getMultiParentId(a)||a);var d=c.getQuestionId(a);return d?c.db.multiMap[d]:void 0}function A(a){var b=this;return a=b.getQuestionId(a),a?b.db.multiSubMap[a]:void 0}function B(a){var b=this,c=b.getListDir(),a=P.id(a),d=0;return P.forEach(c,function(c){if(P.id(c.type)===a){var e=b.getDirQuestionId(c.id);d+=e.length}}),d>0}function C(a){return P.isObject(a)}function D(a){return/^typeDir_\d+$/.test(a||"")}function E(a){var b=this,c=b.getMultiSub(a,!0);if(c)return!!P.find(c,function(a){return!!b.getQuestionDirId(a)});var d=b.getQuestionDirId(a);return!!d}function F(a){var b=this,c=b.getDirScore(a),d=b.getDirQuestionId(a),e=P.findIndex(d,function(a){var d=b.getQuestionScore(a);return c!==d});return 0>e}function G(a){var b=this,c=b.db.dirScoreMap;return a=b.getTypeDir(a),!!(a in c)}function H(a,b){var c=this,d=c.isCustomDir;if(d){var e=c.isMultiItem(a),f=e?null:c.getQuestionDirId(a);if(e){var g=c.getMultiSub(a);f=c.getQuestionDirId(g[0])}return!f||f===b}return!0}function I(a){var b=this;if(a)b.db.scoreMap={},b.db.dirScoreMap={},b.db.dirMap={},b.db.questionDirMap={},b.db.questionTypeMap={},b.save();else{var c=b.getListDir();P.forEach(c,function(a){b.removeDirAllQuestion(a.id)})}}function J(){var a=this,b=a.getListDir();if(0===b.length)return{right:!1,msg:"题目不能为空"};for(var c=0,d=b.length;d>c;c++){var e=b[c],f=a.getDirQuestionId(e.id);if(0===f.length)return{right:!1,msg:e.title+"的题目不能为空"};for(var g=0,h=f.length;h>g;g++){var i=+a.getQuestionScore(f[g])||0;if(0===i)return{right:!1,msg:"题目分数不能为空"}}}return{right:!0}}function K(a,b){var c=this,d=c.getListDir(),e=[];P.forEach(d,function(a){var b=c.getDirQuestionId(a.id);e.push.apply(e,b)}),S.getPublicCount({body:{ids:e},call:function(b){a&&a(b.data)},error:b})}function L(a){var b=this,c=b.getTypeDir("4"),d=c?b.getDirQuestionId(c)||[]:[];return 0===d.length?a&&a([]):void b.getQuestionById(d,!0,a)}function M(){var a=this;V.setDb(V.DB_ADD_QUESTION,a.db)}var N=a("nc"),O=N.Clazz,P=N.Base,Q=N.Event,R=(N.Num,a("../../extend/bll/paper")),S=a("../../../../action/paper"),T=a("../../../../util/util"),U=a("./util"),V=null,W=c.exports=O.create();P.extend(W.prototype,Q,{initialize:d,initData:e,addQuestion:f,removeQuestion:g,removeDirAllQuestion:h,resortQuestion:i,cacheQuestion:j,addDirScore:k,addQuestionScore:l,addDefaultScore:m,getListDir:n,getQuestionById:o,getCacheQuestion:p,getDirScore:q,getDirQuestionId:r,getQuestionScore:s,getQuestionDirId:t,getDirType:u,getTypeDir:v,getQuestionId:w,isMultiItem:x,addMulti:y,getMultiSub:z,getMultiParentId:A,hasTypeQuestion:B,isItem:C,isTypeDir:D,isSelected:E,isScoreAllSame:F,isSetDirScore:G,canSelect:H,clear:I,isDataRight:J,getPublicCount:K,getAllCodeQuestion:L,save:M})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step1/dirList",["nc","cpn","./formGroup"],function(a,b,c){function d(){var a=this;a.groups=[]}function e(){var a=this,b=!0,c=[];return p.forEach(a.groups,function(a){var d=a.val().title;!d||d.length>r?(a.setErrorTips("目录名字长度需要在1-"+r+"之间"),b=!1):p.contains(c,d)&&(a.setErrorTips("目录名字重复"),b=!1),c.push(d)}),b}function f(a){var b=this;if(0===arguments.length){var a=p.map(b.groups,function(a){return a.val()});return a=p.filter(a,function(a){return a.title})}p.forEach(b.groups,function(a){a.destroy()}),b.groups=[],p.forEach(a,function(a,c){b.createItem(c,a)}),b.fire("change")}function g(){var a=this,b=a.getEl(),c=a.groups;b.find(".js-add")[c.length>=r?"hide":"show"]()}function h(a,b){var c=this,d=c.getEl(),e=c.groups;if(e.length>=r)return void q.alert("最多可以创建"+r+"个目录");b=b||{};var f=b.id||p.key(),g=new s({renderTo:d.find(".js-add"),renderBy:"before",content:b.title,id:f,type:b.type,listeners:{change:function(){c.fire("change")},changeType:function(){c.fire("changeType",f)},remove:function(a){1!==e.length&&(c.deleteItem(a),c.fire("change"))},move:function(a,b){c.moveItem(a,b),c.fire("change")}}});return e.push(g),c.groupChange(),g}function i(a,b){var c=this,d=c.groups;if(!(a===b||0>b||b>d.length-1)){var e=d[b],f=d.splice(a,1)[0];d.splice(b,0,f),e.getEl()[b>a?"after":"before"](f.getEl()),c.groupChange()}}function j(a){var b=this,c=b.groups,d=c[a];d&&(c.splice(a,1),d.destroy(),b.groupChange())}function k(){var a=this,b=a.groups;p.forEach(b,function(a,c){a.groupChange(c,b.length)})}var l=a("nc"),m=a("cpn"),n=(l.$,l.Component),o=l.Clazz,p=l.Base,q=m.Popup,r=20,s=a("./formGroup"),t=c.exports=o.create();o.mix(t,n,{_template:['<div class="rules-mod">','<a href="javascript:void(0)" class="icon-plus-sign js-add">添加新目录</a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;b.val&&a.val(b.val)}},{name:"click .js-add",handler:function(){var a=this,b=a.groups;a.createItem(b.length),a.fire("change")}}]},{initialize:d,check:e,val:f,checkList:g,createItem:h,moveItem:i,deleteItem:j,groupChange:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step1/formGroup",["nc","cpn"],function(a,b,c){function d(a){var b=this,c=b.rawConfig,d=b.input,e=b.select;return 0===arguments.length?{id:c.id,title:o.trim(d.val()),type:e.val()}:(c.id=a.id,d.val(o.trim(a.title)),e.val(a.type),void 0)}function e(a){var b=this;b.input.setErrorTips(a)}function f(a,b){var c=this;c.setData("index",a),c.setData("catalog-num",b),c.renderTitle(),c.updateIconData(),c.renderIcons()}function g(){var a=this,b=["目录",a.getData("index")+1,"："].join("");a.getEl("label.js-title").html(b)}function h(){var a=this,b=a.getData("index"),c=a.getData("catalog-num"),d={remove:c>1,upward:0!==b&&c>1,downward:b!==c-1&&c>1};r.forEach(d,function(b,c){a.setData("show-"+c,b)})}function i(){var a=this;r.forEach(["remove","upward","downward"],function(b){a.renderIcon(b)})}function j(a){var b=this,c=b.getData("show-"+a);b.getEl(".js-"+a)[c?"show":"hide"]()}function k(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function l(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Component,q=m.Clazz,r=m.Base,s=n.Select,t=n.Input,u=c.exports=q.create();q.mix(u,p,{_template:['<div class="form-group">','<label class="js-title">#{title}：</label>','<span class="js-input"></span>',"<label>题型：</label>",'<span class="js-select"></span>','<a href="javascript:void(0)" class="icon-trash js-remove" style="margin-left:10px;"></a>','<a href="javascript:void(0)" class="icon-arrow-down js-downward" style="margin-left:10px;"></a>','<a href="javascript:void(0)" class="icon-arrow-up js-upward" style="margin-left:10px;"></a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.input=new t({placeholder:"输入目录名字",renderTo:b.find(".js-input"),renderBy:"replaceWith",value:c.content,listeners:{blur:function(){a.fire("change")}}});var d=c.type||"1";this.select=new s({renderTo:b.find(".js-select"),renderBy:"replaceWith",options:[{text:"单选题",value:"1",checked:"1"===d},{text:"不定项选择题",value:"2",checked:"2"===d},{text:"填空题",value:"3",checked:"3"===d},{text:"编程题",value:"4",checked:"4"===d},{text:"问答题",value:"5",checked:"5"===d}],change:function(){a.fire("changeType")}}),a.input.focus()}},{name:"click .js-remove",handler:function(){var a=this,b=a.getData("index");a.fire("remove",b)}},{name:"click .js-upward",handler:function(){var a=this,b=a.getData("index"),c=b-1;a.fire("move",b,c)}},{name:"click .js-downward",handler:function(){var a=this,b=a.getData("index"),c=b+1;a.fire("move",b,c)}}]},{val:d,setErrorTips:e,groupChange:f,renderTitle:g,updateIconData:h,renderIcons:i,renderIcon:j,setData:k,getData:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step1/index",["nc","cpn","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../../cpn/navProject","../../../../../component/navProject","../util","../data","../../util","../../../../../core/module","../../../../../util/util","./selectType","../cpn/popupPaperList","./dirList","./formGroup","../cpn/steps","../../../../../component/steps","../listData"],function(a,b,c){function d(a){var b=this,c=b.isEdit=s.isEdit(a);y=s.getDataUtil(c),b.listData=new x({edit:c})}function e(a){var b=this;new r({renderTo:b.getEl(),notAll:!0,current:b.getProjectId(),items:a,change:function(a){b.addParam({projectId:a})}})}function f(){var a=this,b=a.getEl();b.append(['<div class="steps-main">','<div class="js-content steps-detail"></div>','<div class="paper-btn-group">','<input class="btn btn-primary js-next" type="button" style="width:180px;" value="设置完毕，下一步">',"</div>","</div>"].join(""))}function g(){var a=this,b=a.getEl(".js-content"),c=a.steps=new w({renderTo:b,isEdit:a.isEdit,currentStep:1}),d=(a.selectType=new u({renderTo:b,data:{typeFixed:y.ADD_QUESTION_FIXED,typeRandom:y.ADD_QUESTION_RANDOM,paperType:y.ADD_PAPER_TYPE,paperCustom:y.ADD_PAPER_CUSTOM},listeners:{change:function(){var b=this.val();c.change(b.question===y.ADD_QUESTION_RANDOM?5:4),d[b.paper===y.ADD_PAPER_CUSTOM?"show":"hide"](),a.save()},loadPaper:function(b){p.confirm("是否覆盖现有配置?",function(){var c=y.loadStep1Data(b);a.val(c)})}}}),a.directoryList=new v({renderTo:b,listeners:{change:o.bind(a.save,a),changeType:function(b){a.listData.removeDirAllQuestion(b),a.save()}}})),e=y.getDir();0===e.length&&e.push({}),a.val({question:y.getQuestionType(),paper:y.getPaperType(),dir:e})}function h(a){var b=this;return 0===arguments.length?o.extend({},b.selectType.val(),{dir:b.directoryList.val()}):(b.selectType.val({question:a.question,paper:a.paper}),void b.directoryList.val(a.dir))}function i(){var a=this,b=a.val();if(b.paper===y.ADD_PAPER_CUSTOM){if(!a.directoryList.check())return!1;if(0===b.dir.length)return p.alert("请添加目录！"),!1}return!0}function j(){var a=this;y.setDb(y.DB_ADD_TYPE,a.val())}function k(){var a=this,b=a.getParam();return o.id(b.projectId)}var l=a("nc"),m=a("cpn"),n=(l.$,l.Clazz),o=l.Base,p=m.Popup,q=a("../../../extend/bll/paper"),r=a("../../cpn/navProject"),s=a("../util"),t=a("../../../../../core/module"),u=a("./selectType"),v=a("./dirList"),w=a("../cpn/steps"),x=a("../listData"),y=null,z=c.exports=n.create();n.mix(z,t,{style:"/stylesheets/styles/system/assemblePaper.css",title:"新增试卷",_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=!s.initAddEdit(a);if(c){if(a.isEdit)return a.initContainer(),a.initCpn();a.renderWait(),q.checkProject({force:!0,all:!0,simple:!0,projectId:a.getProjectId(),call:function(c,d){b.html(""),a.initNav(d),a.initContainer(),a.initCpn()}})}}},{name:"click .js-next",handler:function(){function a(){if(0===o.size(g))return b();var a='<span style="margin-bottom:10px;">您没有权限管理试卷中的以下题目：</span>';o.forEach(g,function(b,c){a+='<div style="color:#888;">'+c+"：第"+b.join("、")+"题</div>"}),p.show({hasNoTitle:!0,content:a,width:600,okTxt:"我知道了",ok:function(){b()}})}function b(){c.nav("paper",d?{action:"editStep2",id:c.getParam().id}:{action:"addStep2"})}var c=this,d=c.isEdit;if(c.check()){if(!d)return b();var e=c.listData=new x({edit:d}),f=e.getListDir(),g={},h=0;0===f.length&&b(),f.length>0&&o.forEach(f,function(b){var c=e.getDirQuestionId(b.id);e.getQuestionById(c,!0,function(c){var d,i=0,j=1;o.forEach(c,function(a){if(a){var c=e.getMultiParentId(a.id),f=c===d;if(d=c,j=c&&f?j+1:1,(!c||!f)&&i++,!a.hasPermission){var h=g[b.title]=g[b.title]||[];h.push(c?i+"-"+j:i+"")}}}),h++,h===f.length&&a()})})}}}]},{initialize:d,initNav:e,initContainer:f,initCpn:g,val:h,check:i,save:j,getProjectId:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step1/selectType",["nc","cpn","../cpn/popupPaperList","../../../../../action/paper","../../../../../util/ajax","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this;return 0===arguments.length?{question:b.questionChkGroup.val(),paper:b.paperChkGroup.val()}:void(a&&(a=j.extend({},a),b.questionChkGroup.val(a.question||"1",!0),b.paperChkGroup.val(a.paper||"1",!0),b.fire("change",b.val())))}function e(a){return a.data}var f=a("nc"),g=a("cpn"),h=(f.$,f.Component),i=f.Clazz,j=f.Base,k=g.CheckGroup,l=a("../cpn/popupPaperList"),m=c.exports=i.create();i.mix(m,h,{_template:["<div>",'<div class="form-group">','<label class="control-label"></label>','<div class="control-group">','<a href="javascript:void(0);" class="upload-paper-set link-green js-load-paper"><i class="icon-download-alt"></i> 载入已有试卷设置</a>',"</div>","</div>",'<div class="form-group">','<label class="control-label">出题方式</label>','<div class="control-group js-question">','<span class="label-with-example">','<label class="radio checked"><span class="icons"></span><input type="radio" value="#{typeFixed}"> 固定题目</label>','<span class="tag-example font-green" style="cursor:pointer;">说明','<div class="tooltip bottom tooltip-info" style="left:-200px;">','<div class="tooltip-arrow" style="left:210px;"><i></i></div>','<div class="tooltip-inner"><div style="width:300px">同张试卷考题一样，顺序可不同，最常用方式</div></div>',"</div>","</span>","</span>",'<span class="label-with-example">','<label class="radio"><span class="icons"></span><input type="radio" value="#{typeRandom}"> 随机抽取</label>','<span class="tag-example font-green" style="cursor:pointer;">说明','<div class="tooltip bottom tooltip-info" style="left:-200px;">','<div class="tooltip-arrow" style="left:210px;"><i></i></div>','<div class="tooltip-inner"><div style="width:300px">同张试卷考题不一样，出题量需大于试卷包含题目量</div></div>',"</div>","</span>","</span>","</div>","</div>",'<div class="form-group js-paper">','<label class="control-label">试卷组织形式</label>','<div class="control-group">','<span class="label-with-example">','<label class="radio checked"><span class="icons"></span><input class="js-paper" type="radio" value="#{paperType}"> 按题型分类</label>','<span class="tag-example font-green" style="cursor:pointer;">例','<div class="tooltip bottom tooltip-info" style="left:-217px;">','<div class="tooltip-arrow" style="left:224px;"><i></i></div>','<div class="tooltip-inner"><img style="width:750px;height:227px" src="https://static.nowcoder.net/images/hr/makepaper/by_type.png"/></div>',"</div>","</span>","</span>",'<span class="label-with-example">','<label class="radio"><span class="icons"></span><input class="js-paper" type="radio" value="#{paperCustom}"> 自定义分类</label>','<span class="tag-example font-green" style="cursor:pointer;">例','<div class="tooltip bottom tooltip-info" style="left:-348px;">','<div class="tooltip-arrow" style="left:353px;"><i></i></div>','<div class="tooltip-inner"><img style="width:750px;height:225px;" src="https://static.nowcoder.net/images/hr/makepaper/by_category.png"/></div>',"</div>","</span>","</span>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.questionChkGroup=new k({el:b.find(".js-question label.radio"),listeners:{change:function(){a.fire("change",a.val())}}}),a.paperChkGroup=new k({el:b.find(".js-paper label.radio"),listeners:{change:function(){a.fire("change",a.val())}}}),c.val&&a.val(c.val)}},{name:"click .js-load-paper",handler:function(){var a=this;l.show({listeners:{ok:function(b){a.fire("loadPaper",b)}}})}}]},{val:d,_getData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../util","../data","../../util","../cpn/steps","../../../../../component/steps","../cpn/tinyQList","../../../../../component/popupSub/popupQuestion","../../../../../action/paper","../../../../../util/ajax","../listData","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","./tab0/index","./tab0/filter","../../../../../action/tag","./tab1/index","./selectAll","./tab1/filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","./tab1/fetch"],function(a,b,c){function d(a){var b=this;b.isEdit=r.isEdit(a),x=r.getDataUtil(b.isEdit),b.isRandom=x.isRandomQuestionType(),b.isCustomDir=x.isCustomDir(),b.listData=new u({edit:b.isEdit}),b.listData.listen("dataChange",function(){b.tab1&&b.tab1.dealDataChange()})}function e(){var a=this,b=a.getWin(),c=a.getSysEl();c.main.css("paddingRight",300),a.listen("beforeLeave",function(){c.main.css("paddingRight",0)}),b.resize()}function f(){var a=this,b=a.getEl();a.steps=new s({renderTo:b.find(".js-steps-wrap"),renderBy:"replaceWith",isEdit:a.isEdit,currentStep:2,totalStep:a.isRandom?5:4})}function g(){{var a=this,b=a.getWin();a.listData}a.tinyQList=new t({renderTo:a.getSysEl().main,reselect:!0,module:a,tiny:b.isTinyTheme,isEdit:a.isEdit,listData:a.listData})}function h(a){var b=this,c=b.listData;c.getPublicCount(function(b){0>=b?a&&a():p.confirm("所选题目包含公共题库的试题，公共题库的题目很可能已经被考生在其他试卷中做过，确定继续使用？",a)},function(a){p.alert(a.msg)})}function i(){function a(a){var c=d.find("ul li");c.removeClass("selected"),m(c[a]).addClass("selected"),o.forEach([b.tab1,b.tab0],function(b,c){b&&b[c===a?"show":"hide"]()})}var b=this,c=b.getEl(),d=c.find(".js-content-tab"),e=c.find(".js-content");o.forEach([{name:"tab0",clazz:v},{name:"tab1",clazz:w}],function(a){if("tab0"!==a.name||!b.isCustomDir){var c=a.clazz;b[a.name]=new c({renderTo:e,parent:b,addUtil:x,listData:b.listData})}}),b.isCustomDir||(d.html(['<div class="menu-box">','<ul class="menu clearfix">','<li><a href="javascript:void(0);">手动挑题</a></li>','<li><a href="javascript:void(0);">自动选题</a></li>',"</ul>","</div>"].join("")),d.on("click","li",function(b){var c=m(b.currentTarget),d=c.index();a(d)}),a(0))}function j(){var a=this;a.tinyQList&&a.tinyQList.destroy(),y.superClass.beforeLeave.apply(a,arguments),a.listData.unlisten("dataChange")}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Clazz,o=(k.Str,k.Base),p=(l.Select,l.Popup),q=a("../../../../../core/module"),r=a("../util"),s=a("../cpn/steps"),t=a("../cpn/tinyQList"),u=a("../listData"),v=a("./tab0/index"),w=a("./tab1/index"),x=null,y=c.exports=n.create();n.mix(y,q,{style:"/stylesheets/styles/system/assemblePaper.css",title:"新增试卷",_template:['<div class="steps-main">','<div class="js-steps-wrap"></div>','<div class="js-content-tab"></div>','<div class="js-content"></div>','<div class="paper-btn-group">','<a class="btn btn-default js-go-pre" href="javascript:void" style="width:180px;">返回上一步</a>','<a class="btn btn-primary js-go-next" href="javascript:void" style="width:180px;">设置完毕，下一步</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.isEdit,d=a.getParam();if(!r.initAddEdit(a)){if(!x.isStep1Right())return void p.alert("参数错误，请重新设置组卷方式",function(){a.nav("paper",c?{action:"editStep1",id:d.id}:"addStep1")});a.emptyEl=b.find("div.com-empty-wrap"),a.waitEl=b.find("div.js-wait"),a.listEl=b.find("div.js-list"),a.initAppearance(),a.initStep(),a.initTab(),a.initQList(),a.tab1.loadData()}}},{name:"click .js-go-pre",handler:function(){var a=this,b=a.getParam();a.nav("paper",a.isEdit?{action:"editStep1",id:b.id}:{action:"addStep1"})}},{name:"click .js-go-next",handler:function(){var a=this,b=a.listData,c=b.isDataRight();return c.right?void a.checkPublic(function(){var b=a.isEdit,c=a.isRandom,d=a.getParam(),e=b?{action:c?"editStep3":"editStep4",id:d.id}:{action:c?"addStep3":"addStep4"};a.nav("paper",e)}):p.alert(c.msg)}}]},{initialize:d,initAppearance:e,initStep:f,initTab:i,initQList:g,checkPublic:h,beforeLeave:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/selectAll",["nc"],function(a,b,c){function d(a){var b=this;b.listData=a.listData,b.pageCount=a.pageCount||0,b.totalCount=a.totalCount||0,b.typeName=a.typeName||"",b.tipsEl=o(a.tipsEl),b.status="",b.dir=a.dir,b.pageIds=[]}function e(){function a(){var a=[{text:"本页",type:"current"},{text:"全部"+(b.pageCount?b.pageCount+"页":""),type:"all"}],c="";p.forEach(a,function(a){c+=s.execTpl('<li data-type="#{type}"><a href="javascript:void(0);">#{text}</a></li>',a)}),b.menuEl.html(c)}var b=this,c=b.getEl(),d=c.find("div.btn-group");a();var e;d.on("mouseenter",function(){window.clearTimeout(e),d.addClass("open")}).on("mouseleave",function(){e=window.setTimeout(function(){d.removeClass("open")},250)}),d.on("click","ul.dropdown-menu li",function(a){var c=o(a.currentTarget),d=o.trim(c.attr("data-type"));d&&b.select(d,d!==b.status,!0)}),b.chkEl.on("click",function(){var a=b.chkEl;b.select(b.status||"current",!a.hasClass("checked"),!1)})}function f(a,b,c){{var d=this;d.rawConfig,d.getEl(),d.status}a&&((c||!b&&"all"===a)&&d.fire("removeAll"),b?d.fire("all"===a?"selectAll":"selectCurrent"):"current"===a&&d.fire("removeCurrent"),d.status=b?a:"",d.updateChk(b?a:null),d.fire("change"))}function g(a){var b=this,c=b.listData,d=b.dir;c.canSelect(a,d)&&(c.isSelected(a)?c.removeQuestion(a,d):c.addQuestion(a,d),b.fire("change"))}function h(a){var b=this;b.pageIds=a.slice(0)}function i(){var a=this,b=o(a.tipsEl);if(0===b.length)return void b.html("");var c=a.listData,d=a.dir,e=c.getDirQuestionId(d).length,f="all"===a.status||a.totalCount===e,g="";f&&"current"!==a.status?g="全部页面"+(a.typeName||"")+"共"+e+'条记录已被选中。 <a href="javascript:void(0)" class="js-select-page link-green">只选择本页的'+a.pageIds.length+"条记录<a>":e>0&&(g=a.typeName+"共"+e+'条记录已被选中。 <a href="javascript:void(0)" class="js-select-all link-green">选择全部页面共'+a.totalCount+"条记录<a>"),b.html(g?'<div class="alert-warning">'+g+"</div>":""),b.unbind("click"),b.on("click",".js-select-all",function(){a.select("all",!0)}).on("click",".js-select-page",function(){a.select("current",!0,!0)})}function j(a){var b=this,c=b.menuEl,d=b.chkEl;c.find("i.icon-ok").remove(),d.removeClass("checked"),a&&(d.addClass("checked"),c.find("li[data-type="+a+"] a").append('<i class="icon-ok"></i>'))}function k(a,b){var c=this,d=(c.getEl(),c.listData);if(a=a||c.pageCount,b=b||c.totalCount,p.id(a)||p.id(b)){if(c.pageCount=a,c.totalCount=b,p.id(b)){var e=d.getDirQuestionId(c.dir).length;e===b&&(c.status="all",c.updateChk("all"))}c.menuEl.find("li[data-type=all] a").html("全部"+a+"页"+("all"===c.status?'<i class="icon-ok"></i>':"")),c.showTips(),c.fire("change")}}function l(a){var b=this;b.dir=a,b.status="",b.pageCount=0,b.totalCount=0,b.pageIds.length=0,b.updateChk(),b.refreshEl(),b.fire("change")}function m(){var a=this,b=a.getEl();b.html(['<label class="checkbox"><span class="icons"></span></label>','<div class="btn-group btn-group-notext btn-group-sm">','<button class="btn btn-default dropdown-toggle">','<span class="dropdown-value">全部</span>','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu js-menu"></ul>',"</div>"].join("")),a.chkEl=b.find("label.checkbox"),a.menuEl=b.find("ul.js-menu"),a.initSelect()}var n=a("nc"),o=n.$,p=n.Base,q=n.Component,r=n.Clazz,s=n.Str,t=(n.Dom,c.exports=r.create());r.mix(t,q,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.rawConfig;a.getEl()}a.refreshEl(),a.changePage(b.pageCount)}}]},{initialize:d,allText:"全部",initSelect:e,select:f,toggle:g,loadPage:h,showTips:i,updateChk:j,changePage:k,clear:l,refreshEl:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/tab0/filter",["nc","cpn","../../../../../../action/tag","../../../../../../util/ajax","../../../../../../action/paper"],function(a,b,c){function d(){var a=this;a.items=[]}function e(){var a=this,b=t(['<div class="form-group js-line" style="padding-bottom:20px;border-bottom:1px solid #d4d4d4;">','<label class="rules-label">规则<span class="js-index"></span>：</label>','<div class="rules-main" style="margin-left:60px;">','<div class="inline-block"><label class="control-label">题库</label><span class="js-source"></span></div>','<div class="inline-block"><label class="control-label">题型</label><span class="js-type"></span></div>','<div class="inline-block"><label class="control-label">知识点</label><span class="js-tag"></span></div>','<div class="inline-block"><label class="control-label">难度</label><span class="js-difficulty"></span></div>','<div class="inline-block js-note-container" style="display:none;"><label class="control-label">备注</label><span class="js-note"></span></div>','<div class="inline-block"><label class="control-label">题量</label><span class="js-count"></span></div>','<div class="inline-block"><label class="control-label">分值</label><span class="js-score"></span>分/题</div>','<a href="javascript:void(0);" class="icon-trash js-del"></a>',"</div>","</div>"].join(""));a.listEl.append(b);var c=b.find(".js-note-container"),d={};d.sourceSelect=new y({size:"small",renderTo:b.find(".js-source"),renderBy:"replaceWith",options:[{text:"私有题库",value:"1"},{text:"公共题库",value:"2",checked:!0}],change:function(){var b=this.val(),e="1"===b;c[e?"show":"hide"](),d.tagSelect.replaceOptions(a._getTagOption(!e))}}),d.typeSelect=new y({size:"small",renderTo:b.find(".js-type"),renderBy:"replaceWith",options:[{text:"单选题",value:"1",checked:!0},{text:"不定项选择题",value:"2"},{text:"填空题",value:"3"},{text:"编程题",value:"4"},{text:"问答题",value:"5"}]}),d.tagSelect=new A({size:"small",renderTo:b.find(".js-tag"),renderBy:"replaceWith",noSelectAll:!0,needSearch:!0,options:a._getTagOption(!0),listeners:{change:function(){a.fixLine()}}}),d.difficultySelect=new y({size:"small",renderTo:b.find(".js-difficulty"),renderBy:"replaceWith",options:[{text:"全部难度",value:"-1",checked:!0},{text:"一星",value:"1"},{text:"二星",value:"2"},{text:"三星",value:"3"},{text:"四星",value:"4"},{text:"五星",value:"5"}]}),d.noteSelect=new y({size:"small",renderTo:b.find(".js-note"),renderBy:"replaceWith",needSearch:!0,options:a._getNoteOption()}),d.countIpt=new x({renderTo:b.find(".js-count"),renderBy:"replaceWith",placeholder:"输入题目数量",render:function(){this.inputEl.addClass("w100")},listeners:{blur:function(){var a=w.fix(this.val());this.val(a)}}}),d.scoreIpt=new x({renderTo:b.find(".js-score"),renderBy:"replaceWith",placeholder:"输入每题分数",render:function(){this.inputEl.addClass("w100")}}),a.items.push(d),a.fixLine()}function f(){var a=this,b=a.getEl(),c=['<a href="javascript:void(0);" class="icon-plus-sign js-add-line">添加新规则</a>','<div class="auto-topic-bar">','<label class="checkbox js-chk checked">不选已出过的题</label>','<div class="auto-topic-btn">','<a href="javascript:void(0);" class="btn btn-primary js-ok">帮我抽题</a>',"</div>","</div>"].join("");a.extEl.html(c),a.newChk=B.transform(b.find(".js-chk"))}function g(){var a=this,b=a.newChk.isChecked(),c=s.map(a.items,function(a){var c=a.sourceSelect.val(),d=a.noteSelect.val(),e=a.difficultySelect.val(),f=w.fix(a.scoreIpt.val());return{source:c,type:a.typeSelect.val(),difficulty:"12345".indexOf(e)>=0?e:"",tags:(a.tagSelect.val()||[]).sort(function(a,b){return a>b}),note:"2"===c?"":"-1"===d?"":d,needCount:+a.countIpt.val()||0,containUsed:b?"false":"true",score:f||0}});return c}function h(){var a=this,b=a.items,c=a.val(),d={},e=!0;return s.forEach(c,function(a,c){if(+a.needCount<=0)e=!1,b[c].countIpt.setErrorTips("请填写正确的题目数量");else if(-1==="12345".indexOf(a.type))e=!1,z.alert("规则"+(c+1)+"请选择正确的题型");else{var f=[a.source,a.type,a.difficulty,a.tags,a.note].join("_");void 0!==d[f]?(e=!1,z.alert("规则"+(d[f]+1)+"和规则"+(c+1)+"重复")):d[f]=c}return e?void 0:s.BREAK}),e}function i(a){var b=this,c=b.getEl();c.find(".js-ok").html(a)}function j(a){var b=this;C.getAllTags({query:[],call:function(b){a&&a(b.data)},error:function(a){b.renderWait(a.msg)}})}function k(a){var b=this;D.getAllNote({query:[],call:function(b){a&&a(b.data)},error:function(a){b.renderWait(a.msg)}})}function l(){var a=this,b=(a.listEl.children(),a.items.length<=1);s.forEach(a.listEl.children(),function(a,c){a=t(a),a.find(".js-del")[b?"hide":"show"](),a.find(".js-index").html(c+1)})}function m(a){var b=this;b.listEl.html('<div style="text-align:center;">'+a+"</div>")}function n(a,b){var c=this,d=c.items;return a===!1?void s.forEach(d,function(a){a.countIpt.setNone()}):(b=b.replace(/needCount/g,"题量"),void d[a].countIpt.setErrorTips(b))}function o(a){var b=this,c=[];return s.forEach(b.tags,function(b){var d=0===b.creatorId;a===d&&c.push({value:s.id(b.id),text:b.name})}),c}function p(){var a=this,b=[];return b.push({value:"-1",text:"不限",checked:!0}),s.forEach(a.notes,function(a){b.push({value:a,text:a})}),b}var q=a("nc"),r=a("cpn"),s=q.Base,t=q.$,u=q.Component,v=q.Clazz,w=(q.Str,q.Num),x=r.Input,y=r.Select,z=r.Popup,A=r.SelectMult,B=r.CheckBox,C=a("../../../../../../action/tag"),D=a("../../../../../../action/paper"),E=c.exports=v.create();v.mix(E,u,{_template:["<div>",'<div class="js-list"></div>','<div class="js-ext"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.listEl=b.find(".js-list"),a.extEl=b.find(".js-ext"),a.renderWait("数据加载中..."),a.getTag(function(b){a.getNote(function(c){a.tags=b,a.notes=c,a.listEl.html(""),a.renderExt(),a.renderLine()})})}},{name:"click .js-add-line",handler:function(){var a=this;a.renderLine()}},{name:"click .js-del",handler:function(a){var b=this,c=t(a.currentTarget).closest(".js-line"),d=c.index();c.remove(),b.items.splice(d,1),b.fixLine()}},{name:"click .js-ok",handler:function(){var a=this;a.checkVal()&&a.fire("ok",a.val())}}]},{initialize:d,renderLine:e,renderExt:f,val:g,checkVal:h,changeBtnTxt:i,getTag:j,getNote:k,fixLine:l,renderWait:m,showError:n,_getTagOption:o,_getNoteOption:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/tab0/index",["nc","cpn","../../../../../../action/paper","../../../../../../util/ajax","./filter","../../../../../../action/tag"],function(a,b,c){function d(a){var b=this;b.listData=a.listData,q=a.addUtil}function e(){var a=this,b=a.getEl();a.filter=new o({renderTo:b.find(".js-content"),renderBy:"html",listeners:{ok:function(b){a.getQuestions(b)}}})}function f(a){function b(){return h.showLoading(!1),q?(e.addQuestionScore(p),j.forEach(l,function(a){e.addQuestion(a.ids,a.dir)}),m.tips("抽题完成"),void f.changeBtnTxt("继续抽题")):void j.forEach(l,function(a,b){j.isString(a)&&f.showError(b,a)})}function c(a,b){var d=a[i],f=j.id(d.type),g=k[f]||e.getDirQuestionId(f)||[];g.length>0&&(d.excludeIds=g);var h=d.score;delete d.score,n.randomQuestions({body:d,call:function(a){var b=a.data||[];b.length!==d.needCount?(l.push("题库数量不够"),q=!1):(h&&j.forEach(b,function(a){p.push({id:a,score:h})}),l.push({ids:b,dir:f}),o=o.concat(b),k[f]=j.uniq(g.concat(b)),q=q&&!0)},error:function(a){l.push(a.msg),q=!1},always:function(){i++,i>=a.length?b&&b():c(a,b)}})}var d=this,e=d.listData;if(a=a||[],0!==a.length){var f=d.filter,g=d.getParent(),h=g.getWin(),i=0;h.showLoading("请稍等...");var k={},l=[],o=[],p=[],q=!0;f.showError(!1),c(a,function(){q?e.getQuestionById(o,!1,b):b()})}}function g(){var a=this,b=a.rawConfig;return b.parent}var h=a("nc"),i=a("cpn"),j=h.Base,k=(h.$,h.Component),l=h.Clazz,m=(h.Str,i.Popup),n=a("../../../../../../action/paper"),o=a("./filter"),p=c.exports=l.create(),q=null;l.mix(p,k,{_template:['<div class="steps-detail" style="padding:0;">','<div class="rules-mod js-content">','<div style="font-size:14px;padding:20px 0;text-align:center;">开发中...</div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter()}}]},{initialize:d,initFilter:e,getQuestions:f,getParent:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/tab1/fetch",["nc","../../../../../../action/paper","../../../../../../util/ajax","cpn"],function(a,b,c){function d(a){var b=this;b.isRandom=!!a.isRandom,b.listData=a.listData}function e(a){var b=this,c=b.isRandom,d=a.query;d.excludeMultiQuestions=c?1:0,l.getQuestions({query:d,call:function(c){var d=c.data.datas;b.fixMulti({items:d,call:function(e){b.listData.cacheQuestion((d||[]).concat(e)),a.call&&a.call(c)},error:a.error})},error:a.error,always:a.always})}function f(a){var b=this,c=a.query;c.excludeMultiQuestions=b.isRandom?1:0;var d=b.getQueryKey(c),e=b._fetchAllIdCache=b._fetchAllIdCache||{};return e[d]?a.call&&a.call(e[d]):void l.getIds({query:c,call:function(c){var f=c.data;b.fixMulti({force:!0,items:f,call:function(c){b.listData.cacheQuestion(c),e[d]=f,a.call&&a.call(f)},error:a.error})},error:a.error})}function g(a){var b=this,c=[],d=!!a.force,e=a.items;return!b.isRandom&&k.forEach(e,function(a){k.isObject(a)?(a.multi||d)&&c.push(k.id(a.id)):a&&c.push(a)}),0===c.length?a.call&&a.call([]):void l.getSubQuestion({query:{ids:c},call:function(d){var e={};k.forEach(d.data,function(a){var b=k.id(a.parentId);b&&(e[b]=e[b]||[]).push(a)}),k.forEach(c,function(a){e[a]&&b.listData.addMulti(a,e[a])}),a.call&&a.call(d.data||[])},error:a.error})}function h(a){var b=k.keys(a).sort(function(a,b){return a-b}),c=[];return k.forEach(b,function(b){var d=a[b];"page"!==b&&null!==d&&void 0!==d&&(c.push(b),c.push(d))}),JSON.stringify(c)}var i=a("nc"),j=(i.$,i.Clazz),k=i.Base,l=a("../../../../../../action/paper"),m=c.exports=j.create();k.extend(m.prototype,{initialize:d,fetchItems:e,fetchAllIds:f,fixMulti:g,getQueryKey:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/tab1/filter",["nc","cpn","../../../../../../component/filter/filter","../../../../../../component/filter/filterCond","../../../../../../component/filter/condUtil","../../../../../../action/common","../../../../../../util/ajax","../../../../../../component/popupSub/popupCommon","../../../../../../component/filter/popupCustomCond","../../../../../../action/tag","../../../../../../action/paper"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=!!b.isCustomDir,d={id:"source",title:"题库",type:"select",conf:{options:[{text:"私有题库",value:"1",checked:!0},{text:"公共题库",value:"2"}]}},e={id:"type",title:"题型",type:"select",conf:{options:[{text:"单选题",value:"1",checked:!0},{text:"不定项选择题",value:"2"},{text:"填空题",value:"3"},{text:"编程题",value:"4"},{text:"问答题",value:"5"}]}},f={id:"difficulty",title:"难度",type:"select",conf:{options:[{text:"全部难度",value:"-1",checked:!0},{text:"一星",value:"1"},{text:"二星",value:"2"},{text:"三星",value:"3"},{text:"四星",value:"4"},{text:"五星",value:"5"}]}},g={id:"tag",title:"知识点",type:"selectMult",conf:{needSearch:!0,noSelectAll:!0,options:a._getTagOption(!1)}},h={id:"creator",title:"上传者",type:"selectMult",conf:{options:w.map(a.creators,function(a){return{text:a.name,value:w.id(a.id)}})}},i={id:"note",title:"题目备注",type:"select",conf:{needSearch:!0,options:[{text:"不限",value:"-1",checked:!0}].concat(w.map(a.notes,function(a){return{text:a,value:a}}))}},j={id:"search",title:"关键词",type:"input",conf:{placeholder:"回车搜索"}},k={id:"count",title:"出卷次数",type:"range",conf:{startPlaceholder:"最低",endPlaceholder:"最高,回车确定"}},l=a.filter=new y({renderTo:a.contentEl,renderBy:"html",noSumbit:!0,line:[{items:[d,e,f,g,h,i,j,k]}],clearAll:function(){a.val({})},listeners:{submit:w.bind(a.submit,a),change:function(b){!{source:1,search:1,count:1}[b]&&a.submit()}}}),m=l.getItem("count");if(m.startIpt.listen("pressEnter",w.bind(a.submit,a)),m.endIpt.listen("pressEnter",w.bind(a.submit,a)),c){var n=l.getItem("type");n.disabled(),n.getEl().on("click",function(){x.alert("自定义分类试卷不允许切换题型")})}l.getItem("source").listen("change",function(){a.changeTag(),a.changeNote(),a.changeCount(),a.changeCreator(),a.submit()})}function e(){var a=this,b=a.filter;return b.getItem.apply(b,arguments)}function f(a){var b=this,c=b.filter,d=c.getItem("source"),e=c.getItem("type"),f=c.getItem("difficulty"),g=c.getItem("tag"),h=c.getItem("creator"),i=c.getItem("note"),j=c.getItem("search"),k=c.getItem("count");if(0===arguments.length){var l=d.val(),m=e.val(),n=f.val(),o=g.val(),p=h.val(),q="1"===l?i.val():"-1",r=t.trim(j.val()),a={source:l,type:"-1"===m?void 0:m,difficulty:"-1"===n?void 0:n,tagId:0===o.length?void 0:o.join(","),creatorIds:0===p.length?void 0:p,note:"-1"===q?"":q,key:r,paperCountFloor:w.id(k.startIpt.val())||void 0,paperCountCeil:w.id(k.endIpt.val())||void 0};return b.changeNote(),a}a.source&&d.val(a.source),a.type&&e.val(a.type),f.val(a.difficulty||"-1"),g.val((a.tagId||"").split(",")),h.val(w.isArray(a.creatorIds)?a.creatorIds:(a.creatorIds||"").split(",")),i.val(a.note||"-1"),j.val(a.key||""),k.startIpt.val(a.paperCountFloor||""),k.endIpt.val(a.paperCountCeil||"")}function g(){var a=this,b=a.rawConfig;b.ok&&b.ok(a.val())}function h(a){var b=this;z.getAllTags({type:"GET",call:function(c){b.tags=c.data,a&&a()},error:function(a){b.renderWait(a.msg)}})}function i(a){var b=this;A.getAllNote({type:"GET",call:function(c){b.notes=c.data,a&&a()},error:function(a){b.renderWait(a.msg)}})}function j(a){var b=this;A.getQuestionCreators({type:"GET",call:function(c){b.creators=c.data,a&&a(b.creators)},error:function(a){b.renderWait(a.msg)}})}function k(a){var b=this;b.contentEl.html('<div style="padding:20px 0;text-align:center;font-size:14px;">'+(a||"加载中...")+"</div>")}function l(){var a=this,b=a.filter,c=b.getItem("source"),d=b.getItem("tag"),e=c.val();d.replaceOptions(a._getTagOption("1"!==e)),b.updateCond()}function m(){var a=this,b=a.filter,c=b.getItem("source"),d=b.getItemEl("note"),e=b.getItemConf("note"),f=c.val();d["1"===f?"show":"hide"](),e.condHide="1"!==f,b.updateCond()}function n(){var a=this,b=a.filter,c=b.getItem("source"),d=b.getItemEl("count"),e=b.getItemConf("count"),f=c.val();d["1"===f?"show":"hide"](),e.condHide="1"!==f,b.updateCond()}function o(){var a=this,b=a.filter,c=b.getItem("source"),d=b.getItemEl("creator"),e=b.getItemConf("creator"),f=c.val();d["1"===f?"show":"hide"](),e.condHide="1"!==f,b.updateCond()}function p(a){var b=this;if(b.loadFinished)return a&&a();var c=b._waitList=b._waitList||[];c.push(a),1===c.length&&b.listen("loadFinished",function(){w.forEach(c,function(a){a&&a()}),c.length=0})}function q(a){var b=this,c=[];return a=!!a,w.forEach(b.tags,function(b){var d=0===b.creatorId,e=a?d:!d||b.tagQuestion;e&&c.push({text:b.name,value:w.id(b.id)})}),c}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Component,v=r.Clazz,w=r.Base,x=s.Popup,y=a("../../../../../../component/filter/filter"),z=a("../../../../../../action/tag"),A=a("../../../../../../action/paper"),B=c.exports=v.create();v.mix(B,u,{_template:['<div class="manage-box">','<div class="manage-bd"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.contentEl=c.find(".manage-bd"),a.renderWait("条件加载中..."),w.forEachAsync(["getAllTag","getAllNote","getQuestionCreators"],function(b,c){a[b](w.bind(c,null,null))},function(){a.loadFinished=!0,a.initCpn(),a.val(b.data),a.fire("loadFinished")})}}]},{initCpn:d,getItem:e,val:f,submit:g,getAllTag:h,getAllNote:i,getQuestionCreators:j,renderWait:k,changeTag:l,changeNote:m,changeCount:n,changeCreator:o,wait:p,_getTagOption:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step2/tab1/index",["nc","cpn","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/paper","../../../../../../util/ajax","../selectAll","./filter","../../../../../../component/filter/filter","../../../../../../component/filter/filterCond","../../../../../../component/filter/condUtil","../../../../../../action/common","../../../../../../component/popupSub/popupCommon","../../../../../../component/filter/popupCustomCond","../../../../../../action/tag","./fetch"],function(a,b,c){function d(a){var b=this;S=a.addUtil,b.listData=a.listData;var c=b.parent=a.parent;b.isCustomDir=c.isCustomDir,b.isRandom=c.isRandom,b.fetchUtil=new R({isRandom:!!b.isRandom,listData:b.listData})}function e(){var a=this;a.initFilter(),a.filter.wait(function(){a.initDirSelect(),a.initPageSelect(),a.initSelectAll()})}function f(){var a=this,b=a.getEl(),c=a.getParam(),d=S.getDir(),e=a.isCustomDir,f=e?d[0].type:c.type;e&&a.addParam({type:f});var g=a.filter=new Q({renderTo:b.find(".js-filter"),renderBy:"replaceWith",isCustomDir:e,data:{source:c.source,type:f,difficulty:c.difficulty,tagId:c.tagId,creatorIds:c.creatorIds,note:c.note,key:c.key},ok:function(b){b.page=1,a.addParam(b),a.fetchItems()}});e||g.wait(function(){g.getItem("type").listen("change",function(){a.allChk.clear(this.val())})})}function g(){var a=this,b=a.parent,c=a.getEl(),d=c.find(".js-subject-choosed");if(!b.isCustomDir)return d.remove();var e=S.getDir();d.show(),a.dirSelect=new K({size:"small",renderTo:d.find(".js-type-select"),renderBy:"replaceWith",options:D.map(e,function(a,b){return{text:a.title,value:a.id,checked:0===b}}),listeners:{change:function(){var b=this.val(),c=S.getDirById(b);a.allChk.clear(b),a.filter.getItem("type").val(c.type),a.filter.submit()}}}),a.dirSelect.getEl().css("bottom","5px"),d.find("input.js-dir-score").on("blur",function(c){var d=E(c.currentTarget),e=a.getCurrentDir();b.tinyQList&&b.tinyQList.scoreDir(e,d.val())})}function h(){var a=this,b=a.getEl(),c=a.getParam(),d=+c.pageSize||20;d=D.contains([20,50,100],d)?d:20,a.pageSelect=new K({size:"xsmall",renderTo:b.find(".js-page-select"),renderBy:"replaceWith",options:[{text:20,value:20,checked:20===d},{text:50,value:50,checked:50===d},{text:100,value:100,checked:100===d}],listeners:{change:function(){a.addParam({pageSize:this.val()}),a.filter.submit()}}})}function i(){function a(){return D.map(b.getTrList(),function(a){return E(a).attr("data-id")})}{var b=this,c=b.getEl(),d=b.listData;b.listEl}b.allChk=new P({renderTo:c.find("th.with-checkbox-select"),tipsEl:b.listEl.find(".js-select-tips"),listData:b.listData,dir:b.getCurrentDir(),listeners:{removeAll:function(){var a=b.getCurrentDir();d.removeDirAllQuestion(a)},removeCurrent:function(){var c=b.getCurrentDir(),e=a();d.removeQuestion(e,c)},selectAll:function(){b.fetchAllIds(function(a){var c=b.getCurrentDir();d.addQuestion(a,c),b.allChk.changePage(null,d.getDirQuestionId(c).length)})},selectCurrent:function(){var c=b.getCurrentDir(),e=a();d.addQuestion(e,c)}}})}function j(){var a=this;a.filter.wait(function(){a.isCustomDir&&a.dirSelect.fire("change"),!a.isCustomDir&&a.filter.submit()})}function k(){var a=this,b=a.getEl(),c=a.listData,d=(a.listEl,a.allChk),e=a.getCurrentDir(),f=0,g=0,h=a.getTrList();D.forEach(h,function(b){b=E(b);var d=E.trim(b.attr("data-id")),e=b.find("label.checkbox"),h=a.canSelect(d);if(e=E(e).removeClass("disabled"),!h)return e.addClass("disabled"),void f++;var i=c.isSelected(d);if(i&&g++,H.cls(e,{checked:i}),!a.isRandom){var j=c.isMultiItem(d);j&&b.find("input.js-multi-score").val(c.getQuestionScore(d)),!j&&b.find("input.js-score").val(c.getQuestionScore(d)).prop("disabled",!i||!h)}});var i=g>0&&f+g===h.length;d.status=i?"all"===d.status||d.totalCount===c.getDirQuestionId(e).length?"all":"current":"",d.showTips(),d.updateChk(d.status),a.isCustomDir&&(b.find(".js-type-count").html("已选"+c.getDirQuestionId(e).length),b.find(".js-dir-score").val(a.isRandom||c.isScoreAllSame(e)?c.getDirScore(e):"--"))}function l(){var a=this;a.showStatus(0),a.waitEl.html("加载中..."),a.fetchUtil.fetchItems({query:a.getQuery(),call:function(b){b.isOrder&&a.renderItems(b.data)},error:function(b){a.showStatus(0),a.waitEl.html(b.msg)}})}function m(a){var b=this,c=b.parent,d=c.getWin();d.showLoading("请稍等..."),b.fetchUtil.fetchAllIds({query:b.getQuery(),call:function(b){d.showLoading(!1),a&&a(b)},error:function(){d.showLoading(!1),L.alert("出现错误，全选失败，请重试")}})}function n(a){var b=this;b.waitEl[0===a?"show":"hide"](),b.emptyEl[1===a?"show":"hide"](),b.listEl[2===a?"show":"hide"](),2!==a&&b.listEl.find(".js-list-pager").html("")}function o(a){var b=this,c=b.getParam(),d=b.parent,e=b.listEl.find("table.no-border-table"),f=(a||{}).datas||[];if(b._updateCount(a.totalCount),b._updateRank(),b.showStatus(0===f.length?1:2),0!==f.length){b.listData.addDefaultScore(f),b._trList&&(b._trList.length=0),e.find("input.js-score").unbind();var g=b._getTableHtml(f);e.find("tbody").html(g),e.find(".js-table-creator")[1===+c.source?"show":"hide"]();var h=b.listEl.find("div.js-list-pager");F.recycle(h,!1),new M({renderTo:h,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.addParam({page:a}),b.fetchItems(),d.goTop()}});var i=[];D.forEach(f,function(a){var c=D.id(a.id);b.canSelect(c)&&i.push(c)});var j=b.allChk;j.typeName=O.getQuestionType(c.type),j.loadPage(i),j.changePage(a.totalPage,a.totalCount),b.dealDataChange(),!b.isRandom&&e.find("input.js-score").on("blur",function(a){var c=E(a.currentTarget),e=b.getQid(c);e&&d.tinyQList.score(e,c.val())})}}function p(){var a=this,b=a.getParam();return{excludeMultiQuestions:a.isRandom?1:0,source:b.source||"2",type:D.contains("12345".split(""),b.type)?b.type:null,difficulties:D.contains("12345".split(""),b.difficulty)?b.difficulty:null,tags:b.tagId?b.tagId.split(","):null,creatorIds:b.creatorIds,keyWord:b.key||null,note:b.note||null,paperCountFloor:b.paperCountFloor,paperCountCeil:b.paperCountCeil,sortBy:b.orderBy||null,order:b.order||null,page:+b.page||1,pageSize:+b.pageSize||null}}function q(){var a=this;return a.isCustomDir?a.dirSelect.val():a.filter.getItem("type").val()}function r(){var a=this;if(a.isCustomDir&&a.dirSelect){var b=a.getEl(),c=S.getDb("DB_ADD_QUESTION"),d=a.dirSelect.val(),e=((c.dirMap||{})[d]||[]).length;b.find(".js-type-count").html("已选"+e)}}function s(a){var b=this,c=b.listData,d=b.getCurrentDir();return a&&c.canSelect(a,d)}function t(a){return E.trim(E(a).closest("tr").attr("data-id"))}function u(){var a=this,b=a._trList||[];return b=a._trList=0===b.length?a.listEl.find("tr.js-tr"):b}function v(){var a=this,b=a.parent;return b.addParam.apply(b,arguments)}function w(){var a=this,b=a.parent;return b.getParam.apply(b,arguments)}function x(a){var b=this,c=b.listData,d="",e=b.getParam();return D.forEach(a,function(a){var f=D.id(a.id),g=c.isSelected(a),h=b.canSelect(f),i=a.multi;d+=I.execTpl(['<tr class="js-tr" data-id="#{id}">','<td class="text-left"><label title="#{tips}" data-id="#{id}" class="checkbox #{cls} js-chk-#{id}"><span class="icons"></span></label></td>','<td class="t-subject-title"><a class="js-title" href="javascript:void(0);">#{link}#{title}</a></td>',"<td>#{type}</td>","<td>#{difficulty}星</td>","<td>#{tags}</td>","<td>#{whereFrom}</td>","<td>#{paperTotal}</td>","<td>#{createTime}</td>","#{creatorHrName}",b.isRandom?"":'<td class="choosed-wrap">'+(i?'<div class="js-tips" title="请到右侧已选题目中编辑系列题分数"><input disabled class="w50 js-multi-score" type="text" value="--">分</div>':'<div><input #{disabled} class="w50 js-score" type="text" placeholder="分值">分</div>')+"</div></td>","</tr>"].join(""),{id:f,cls:h?"":"disabled",tips:h?"":"已被其他目录选中",title:(a.title||"").replace(/\[\$\#?\#?\$?\]?/g,"()"),link:i?' <span class="tag-push js-tips" style="display:inline-block;margin:0 5px 0 0;" title="系列题：包含'+a.subQuestionCount+'个子题，点击查看">系列题</span>':"",type:O.getQuestionType(a.type,!0),difficulty:["","一","二","三","四","五"][+a.difficulty||0]||"",tags:(a.tags||[]).join(","),whereFrom:a.whereFrom||"",paperTotal:a.paperTotal||0,createTime:J.form(new Date(a.createTime),"yyyy-MM-dd HH:mm"),creatorHrName:1===+e.source?"<td>"+a.creatorHrName+"</td>":"",disabled:g&&h?"":"disabled"})}),d}function y(a){var b=this,c=b.getEl();c.find(".js-count").html('共<span class="font-green">'+(a||0)+"</span>条")}function z(){var a=this,b=a.getParam();a.listEl.find(".js-rank").removeClass("selected"),a.listEl.find("div[data-order-by="+b.orderBy+"]").find(".js-rank[data-order="+b.order+"]").addClass("selected")}function A(a){var b=a.parent;return{scoreIpt:b.isRandom?"":'<th width="100">分值</th>'}}var B=a("nc"),C=a("cpn"),D=B.Base,E=B.$,F=B.Component,G=B.Clazz,H=B.Dom,I=B.Str,J=B.Time,K=C.Select,L=C.Popup,M=C.Pager,N=(C.Tips,c.exports=G.create()),O=a("../../../../../../util/util"),P=(a("../../../../../../action/paper"),a("../selectAll")),Q=a("./filter"),R=a("./fetch"),S=null;G.mix(N,F,{_template:["<div>",'<div class="js-filter"></div>','<div class="steps-detail paper-search" style="padding:0;">','<div class="subject-choosed clearfix" style="padding:0 10px;">',"<span>",'<span style="margin-right:5px;line-height:35px;" class="js-count"></span>','<span style="margin-right:5px;">每页显示</span>','<span class="js-page-select"></span>',"</span>",'<span class="js-subject-choosed" style="display:none;">','<span style="margin-right:5px;">当前选题目录</span>','<span class="js-type-select"></span>','<span class="input-score-wrap"><input class="w30 input-sm js-dir-score" type="text" value=""> 分/题 </span>','<span class="js-type-count">已选0</span>',"</span>",'<div class="subject-tools">','<a href="javascript:void(0);" class="link-green js-go-question"><i class="icon-plus-sign"></i> 新增试题</a>',"</div>","</div>",'<div class="js-main-content">','<div class="js-wait" style="padding:20px;font-size:14px;text-align:center;">加载中...</div>','<div class="com-empty-wrap" style="display:none;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450323797641_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip">当前查询条件下暂无题目，你可以更换题库/题型/难度/知识点试试。</div>',"</div>",'<div class="js-list" style="display:none;">','<div class="js-select-tips"></div>','<table class="no-border-table need-hover">',"<thead>","<tr>",'<th width="10" class="with-checkbox-select text-left"></th>','<th width="180">题目</th>','<th width="50">题型</th>','<th width="40">难度</th>','<th width="90">知识点</th>','<th width="90">备注</th>','<th width="50">出卷次数</th>','<th width="140">上传时间<div class="rank-oprt" data-order-by="4"><a href="javascript:void(0);" data-order="1" class="js-rank icon-sort-up" title="升序"></a><a href="javascript:void(0);" data-order="2" class="js-rank icon-sort-down" title="降序"></a></div></th>','<th width="50" class="js-table-creator">上传者</th>',"#{scoreIpt}","</tr>","</thead>","<tbody></tbody>","</table>",'<div class="js-list-pager"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.emptyEl=b.find("div.com-empty-wrap"),a.waitEl=b.find("div.js-wait"),a.listEl=b.find("div.js-list"),a.initCpn()}},{name:"click .js-go-question",handler:function(){var a=this,b=a.parent;b.nav("question","add/index")}},{name:"click label.checkbox",handler:function(a){var b=this,c=E(a.currentTarget),d=c.attr("data-id");d&&b.allChk.toggle(d)}},{name:"click a.js-title",handler:function(a){var b=this,c=b.parent,d=E(a.currentTarget),e=b.getQid(d);e&&c.tinyQList&&c.tinyQList.showDetail(e)}},{name:"click .js-rank",handler:function(a){var b=this,c=E(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:1,orderBy:e,order:f}),b.loadData())}}]},{initialize:d,initCpn:e,initFilter:f,initDirSelect:g,initPageSelect:h,initSelectAll:i,loadData:j,dealDataChange:k,fetchItems:l,fetchAllIds:m,showStatus:n,renderItems:o,getQuery:p,getCurrentDir:q,updateDirCount:r,canSelect:s,getQid:t,getTrList:u,addParam:v,getParam:w,_getTableHtml:x,_updateCount:y,_updateRank:z,_getData:A})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step3/dirGroup",["nc","./dirList","./formGroup","cpn"],function(a,b,c){function d(a){var b=this;b.listData=a.listData}function e(){{var a=this,b=a.getEl(),c=a.rawConfig;a.dirList=new n({renderTo:b.find(".js-rules-mod"),renderBy:"replaceWith",val:c.val,options:c.options,listeners:{change:function(b){a.fire("change",b)},remove:function(){a.fire("remove")}}})}a.renderTotalScore()}function f(){var a=this,b=a.getEl(),c=a.rawConfig,d=a.dirList.val(),e=a.listData.getDirScore(c.dirId),f=0;m.forEach(d,function(a){var b=m.id(a.inputCount);f+=b?+b:0}),b.find(".js-total-count").text(f),b.find(".js-total-score").text(f*e)}function g(a){var b=this,c=b.getEl(),d=b.rawConfig;if(0===arguments.length){var e=m.id(c.find(".js-total-count").text())||0,f=m.id(c.find(".js-total-score").text())||0;return{dirName:d.directory,input:b.dirList.val(),totalScore:+f,totalCount:+e}}a&&b.dirList.val(a.input)}function h(a,b){var c=this;c.dirList.setErrorTips(a,b)}function i(a){return{directory:a.directory}}var j=a("nc"),k=(j.$,j.Component),l=j.Clazz,m=j.Base,n=a("./dirList"),o=c.exports=l.create();l.mix(o,k,{_template:['<div class="module-box">','<div class="module-head clearfix">',"<h1>#{directory}</h1>",'<div class="module-head-oprt">','每张试卷：抽<span class="font-green js-total-count">0</span>道题，共<span class="font-green js-total-score">0</span>分',"</div>","</div>",'<div class="js-rules-mod"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.rawConfig}a.initCpn()}}]},{initialize:d,initCpn:e,renderTotalScore:f,val:g,setErrorTips:h,_getData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step3/dirList",["nc","./formGroup","cpn"],function(a,b,c){function d(){var a=this;a.groups=[]}function e(a){var b=this;if(0===arguments.length){var a=n.map(b.groups,function(a){return a.val()});return a}n.forEach(a,function(a,c){b.createItem(c,a)})}function f(a,b){var c=this,d=c.getEl(),e=c.groups,f=c._getAvailableOptions(a);if(!(e.length>=t||0===f.length)){var g=new o({renderTo:d.find(".js-add"),renderBy:"before",title:"规则"+(a+1),id:"groupId"+Math.floor(1e4*Math.random()),options:f,val:b,listeners:{selected:function(){c.selected=void 0===g.val().tagName?void 0:g.val().tagName===q?r:s,c.checkList(),c.fire("change",n.indexOf(e,g))},change:function(){c.fire("change",n.indexOf(e,g))},remove:function(){var a=n.indexOf(e,this);a>=0&&e.splice(a,1),this.destroy(),n.forEach(e,function(a,b){a.title("规则"+(b+1))}),c.checkList(),c.fire("remove")}}});return c.selected=void 0===g.val().tagName?void 0:g.val().tagName===q?r:s,e.push(g),c.checkList(),g}}function g(){var a=this,b=a.getEl(),c=a.groups,d=a._getAvailableOptions();if(0===c.length)return!1;var e=!1;1!==c.length||a.selected!==r&&2!=d.length?c.length>1&&(c.length>=t||0===d.length)&&(e=!0):e=!0,b.find(".js-add")[e?"hide":"show"](),c[0].showDelete(c.length>1),a._refreshOptions()}function h(a,b){var c=this;c.groups[b].setErrorTips(a,b)}function i(a){var b=this,c=b.rawConfig,d=b.groups,e=c.options,f=0===arguments.length;if(d.length<=1&&(f||0===a))return e;var g=n.filter(d,function(b,c){return f||c!=a}),h=n.map(g,function(a){return a.val().tagName});return n.filter(e,function(a){return a.tagName!==q&&!n.contains(h,a.tagName)})}function j(){var a=this,b=a.groups;n.forEach(b,function(b,c){var d=a._getAvailableOptions(c);b.refreshOptions(d)})}var k=a("nc"),l=(k.$,k.Component),m=k.Clazz,n=k.Base,o=a("./formGroup"),p=c.exports=m.create(),q="不限",r=1,s=2,t=20;m.mix(p,l,{_template:['<div class="module-body rules-mod">','<a href="javascript:void(0)" class="icon-plus-sign js-add">添加新规则</a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;b.val&&a.val(b.val)}},{name:"click .js-add",handler:function(){var a=this,b=a.groups;a.createItem(b.length)}}]},{initialize:d,val:e,checkList:g,createItem:f,setErrorTips:h,_getAvailableOptions:i,_refreshOptions:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step3/formGroup",["nc","cpn"],function(a,b,c){function d(a){var b=this,c=b.input,d=b.select;return 0===arguments.length?{tagName:d.val(),inputCount:c.val()}:void(a&&d.val(a.tagName)&&c.val(a.inputCount))}function e(a){var b=this,c=b.getEl();c.find(".js-rule-title").html(l.trim(a)+"：")}function f(a){var b=this,c=b.getEl();c.find(".js-input-total").html("总数："+a)}function g(a){var b=this,c=b.getEl();c.find(".js-delete")[a===!1?"hide":"show"]()}function h(a){var b=this;b.input.setErrorTips(a)}function i(a){var b=this,c=b.select,d=0;o.forEach(a,function(a,b){c.val()===a.tagName&&(d=b)}),b.select=new p({renderTo:c.getEl(),renderBy:"replaceWith",text:"选择知识点",options:o.map(a,function(a,b){return{text:a.tagName,value:a.tagName,checked:b===d}}),listeners:{change:function(){b.fire("selected",this)}}}),b.totalCount(a[d].totalCount),c.destroy()}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=j.Base,p=k.Select,q=k.Input,r=c.exports=n.create();n.mix(r,m,{_template:['<div class="form-group">','<label class="js-rule-title">规则</label>','<label class="control-label">知识点</label>','<span class="js-select-knowledge"></span>','<label class="control-label">题量</label>','<span class="js-input-quantity"></span>','<label class="control-label js-input-total"></label>','<a href="javascript:void(0)" class="icon-trash js-delete"></a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig,d=c.options||[],e=c.val||{},f=0;o.forEach(d,function(a,b){e.tagName===a.tagName&&(f=b)});this.select=new p({renderTo:b.find(".js-select-knowledge"),renderBy:"replaceWith",text:"选择知识点",options:o.map(d,function(a,b){return{text:a.tagName,value:a.tagName,checked:b===f}}),listeners:{change:function(){a.fire("selected",this)}}});a.totalCount(d[f].totalCount),a.input=new q({placeholder:"输入题量",renderTo:b.find(".js-input-quantity"),renderBy:"replaceWith",value:e.inputCount,listeners:{blur:function(){a.fire("change")}}}),a.title(c.title)}},{name:"click .js-delete",handler:function(){{var a=this;a.rawConfig||{}}a.fire("remove")}}]},{val:d,title:e,totalCount:f,showDelete:g,setErrorTips:h,refreshOptions:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step3/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../listData","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../util","../data","../../util","../cpn/steps","../../../../../component/steps","./dirGroup","./dirList","./formGroup"],function(a,b,c){function d(a){var b=this;b.isEdit=t.isEdit(a),x=t.getDataUtil(b.isEdit),b.listData=new s({edit:b.isEdit}),b.dirGroups=[],b.optionsList=[]}function e(){var a=this,b=a.getEl(),c=a.listData,d=c.getListDir(),e=x.isRandomQuestionType();a.steps=new u({renderTo:b.find(".js-steps-wrap"),renderWith:"replaceWith",isEdit:a.isEdit,currentStep:3,totalStep:e?5:4}),a.renderDir(d.slice(0),function(){var c=b.find(".js-steps-detail");c.append('<p>每张试卷：抽<span class="font-green js-paper-count">0</span>道题，共<span class="font-green js-paper-score">0</span>分</p>'),a.renderTotalScore()}),a.initRandomChoice()}function f(){var a=this;a.randomChoiceCpn=q.mix({el:a.getEl(".js-random-choice label.radio"),listeners:{change:function(){x.setDb(x.DB_ADD_TAG_COUNT,a.val())}}});var b=x.getDb(x.DB_ADD_TAG_COUNT);a.randomChoiceCpn.val((b.randomFrequentType||0)+"")}function g(){var a=this,b=a.dirGroups,c={tag:{}},d=c.tag;return o.forEach(b,function(b,c){var e=a.optionsList[c],f=b.val().input;o.forEach(f,function(a){var b=o.find(e,function(b){return b.tagName===a.tagName})||{};a.ids=b.ids}),d[b.val().dirName]=f}),c.randomFrequentType=a.randomChoiceCpn.val(),c}function h(){var a=this,b=a.dirGroups,c=!0;return o.forEach(b,function(b,d){var e=b.val(),f=e.input;return c?f&&0!==f.length?void o.forEach(f,function(e,f){var g=a.checkOne(b,d,e,f);c&&!g&&(c=g)}):(c=!1,p.alert('请给目录"'+e.dirName+'"添加抽题规则!'),!1):!1}),c}function i(a,b,c,d){a.setErrorTips("",d);var e=this,f=!0,g=o.id(c.inputCount);if(g)if("0"===g)a.setErrorTips("题量必须大于0",d),f=!1;else{var h=+g,i=e.optionsList[b],j=o.find(i,function(a){return c.tagName===a.tagName})||{},k=j.totalCount||0;h>k&&(f=!1,a.setErrorTips("不能大于"+k,d))}else a.setErrorTips("请填写数字!",d),f=!1;return f}function j(a,b){var c=this,d=c.getEl();if(0===a.length)return d.find(".js-temp-wait").remove(),b&&b(),!1;var e=c.listData,f=c.dirGroups,g=x.getDb(x.DB_ADD_TAG_COUNT),h=g.tag||{},i=a.shift();w.getTagCount({body:{questionIds:e.getDirQuestionId(i.id)},call:function(e){d.find(".js-temp-wait").remove();var g=o.map(e.data,function(a){return{tagName:a.tagName,totalCount:a.tagCount,ids:a.ids}});c.optionsList.push(g);var j=h[i.title]||[{}],k=new v({renderTo:d.find(".js-steps-detail"),listData:c.listData,directory:i.title,dirId:i.id,options:g,val:j,listeners:{change:function(a){c.checkOne(k,o.indexOf(f,k),k.val().input[a],a)&&(x.setDb(x.DB_ADD_TAG_COUNT,c.val()),k.renderTotalScore(),c.renderTotalScore())},remove:function(){k.renderTotalScore(),c.renderTotalScore()}}});f.push(k),c.renderDir(a,b)}})}function k(){var a=this,b=a.getEl(),c=a.dirGroups,d=0,e=0;o.forEach(c,function(a){var b=a.val();d+=b.totalCount||0,e+=b.totalScore||0}),b.find(".js-paper-count").text(d),b.find(".js-paper-score").text(e)}var l=a("nc"),m=a("cpn"),n=(l.$,l.Clazz),o=l.Base,p=(l.Limit,m.Popup),q=m.CheckGroup,r=a("../../../../../core/module"),s=a("../listData"),t=a("../util"),u=a("../cpn/steps"),v=a("./dirGroup"),w=a("../../../../../action/paper"),x=null,y=c.exports=n.create();n.mix(y,r,{style:"/stylesheets/styles/system/assemblePaper.css",title:"新增试卷",_template:['<div class="steps-main">','<div class="js-steps-wrap"></div>','<div class="form-group js-random-choice">','<label class="control-label" style="line-height:21px;">抽题频率</label>','<div class="control-group">','<span class="label-with-example">','<label class="radio checked"><span class="icons"></span><input type="radio" value="0"> 每张试卷</label>','<span class="tag-example font-green js-note" style="cursor:pointer;">说明','<div class="tooltip bottom tooltip-info" style="left:-100px;">','<div class="tooltip-arrow" style="left:110px;"><i></i></div>','<div class="tooltip-inner"><div style="width:300px">每张试卷随机抽题，每一位考生题目均不同</div></div>',"</div>","</span>","</span>",'<span class="label-with-example">','<label class="radio"><span class="icons"></span><input type="radio" value="1"> 每自然日</label>','<span class="tag-example font-green js-note" style="cursor:pointer;">说明','<div class="tooltip bottom tooltip-info" style="left:-200px;">','<div class="tooltip-arrow" style="left:210px;"><i></i></div>','<div class="tooltip-inner"><div style="width:300px">不同日期打开试卷的考生题目不同，同一天（0点-24点）考生题目相同</div></div>',"</div>","</span>","</span>","</div>","</div>",'<div class="steps-detail js-steps-detail">','<div class="js-temp-wait"></div>',"</div>",'<div class="paper-btn-group">','<input class="btn btn-default js-pre" type="button" style="width:180px;" value="返回上一步">','<input class="btn btn-primary js-next" type="button"  style="width:180px;" value="设置完毕，下一步">',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.isEdit,d=a.getParam();if(a.renderWait(b.find(".js-temp-wait")),!t.initAddEdit(a)){if(!x.isStep1Right())return void p.alert("参数错误，请重新设置组卷方式",function(){a.nav("paper",c?{action:"editStep1",id:d.id}:"addStep1")});var e=a.listData.isDataRight();return e.right?void a.initCpn():void p.alert(e.msg,function(){a.nav("paper",c?{action:"editStep2",id:d.id}:"addStep2")})}}},{name:"click .js-pre",handler:function(){var a=this,b=a.getParam();a.nav("paper",a.isEdit?{action:"editStep2",id:b.id}:{action:"addStep2"})}},{name:"click .js-next",handler:function(){var a=this,b=a.isEdit,c=a.getParam();return a.check()?(x.setDb(x.DB_ADD_TAG_COUNT,a.val()),void a.nav("paper",b?{action:"editStep4",id:c.id}:{action:"addStep4"})):!1}}]},{initialize:d,initCpn:e,initRandomChoice:f,val:g,check:h,checkOne:i,renderDir:j,renderTotalScore:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step4/field",["nc","cpn","../../cpn/popupField","../../util"],function(a,b,c){function d(){var a=this;a.aliasMap={},a.chk={},a.isPaperPublic=!1}function e(a,b){var c=this;if(0===arguments.length){var d={},e={email:"Email",phone:"Phone",id:"IDCard"},b=c.isPaperPublic;return x.forEach(c.chk,function(a,f){var g=a.need,h=a.option;if(g&&g.chk&&g.chk.isChecked()){var i=C.field2data(g.value);d.keyTitle=i.name,d.keyFormat=e[f]||null}else if(h&&h.chk&&h.chk.isChecked()){if(f===E)return;var j=c.isSystem(f,!0),k=e[f]||null,l=h.value,i=C.field2data(l,j?{edit:b?"2":"0"}:null);j&&(i.type="0"),k&&(i.format=k),l=C.data2field(i),d.optionalFields=d.optionalFields||[],d.optionalFields.push(l)}}),d}c.valPublic(b,!0);var f=x.toMap(c.chk,function(a){return a.id!==E&&(a.need&&a.need.chk&&a.need.chk.checked(!1),a.option&&a.option.chk&&a.option.chk.checked(!1)),{key:a.name,value:a}});if(x.forEach(a.optionalFields,function(a){var b=C.field2data(a),d=f[b.name];if(!d||!d.option){var e=d?d.id:x.key();return c.renderItem({id:e,value:a,option:!0}),d=d||c.chk[e],void d.option.chk.checked(!0)}d.option.chk.checked(!0),c.renderItem({id:d.id,value:a,option:!0})}),a.keyTitle){var g=f[a.keyTitle];if(!g||!g.need){var h=g?g.id:x.key();c.renderItem({id:h,value:a.keyTitle,need:!0}),g=c.chk[h]}g.need.chk.checked(!0),c.toggle(g.id,!0)}}function f(a,b){function c(b){var c=b.id,b=e[c].option,f=C.field2data(b.value);f.edit=a?"1":"0",f.type="0";var g=C.data2field(f);d.renderItem({id:c,value:g,need:!1,option:!0})}var d=this,e=d.chk;x.forEach(F,function(a){a.id!==E&&c(a)}),x.forEach(G,c),!b&&d.fire("change")}function g(){var a=this;x.forEach(F,function(b){a.renderItem(x.extend({need:!0,option:!0,noChecked:!0},b))}),x.forEach(G,function(b){var c="phone"===b.id||"email"===b.id?{noChecked:!1}:{};a.renderItem(x.extend({need:!1,option:!0,noChecked:!0},b,c))}),a.toggle("resume")}function h(a){function b(a,b){var c,e=d.chk,f=a.id,g=(e[f]||{})[b?"need":"option"];return g?(c=g.chk.getEl().closest("div.js-field-item"),a.noChecked=!g.chk.isChecked(),a.disabled=g.chk.isDisabled(),g.chk.destroy(),c.html("")):(c=t(H.cloneNode()),d[b?"needEl":"optionEl"].find(".js-add").before(c)),c.attr("data-id",f),c.attr("data-need",b?1:0),a.alone&&c.css("display","block"),c}function c(a,b){return b?"":u.execTpl('<span class="js-edit choose-tips tester-fill-tips"><a href="javascript:void(0);">#{type}#{ext}</a></span>',{type:"0"===a.edit?"HR统一导入":"考生"+({1:"单选",2:"多选"}[a.type]||"自填"),ext:{1:"(选填)",2:"(必填)"}[a.edit]||""})}var d=this,e=d.chk,f=a.id,g=[!!a.need,!!a.option],h=d.isSystem(f,!0);x.forCount(2,function(i){if(g[i]){var j=0===i,k=b(a,j),l=C.field2data(a.value),m=l.name,n=new y({renderTo:k,radio:j,text:u.encodeHTML(m),val:f});if(j){var o=d.commonGroup;o&&o.addItem(n),o||(o=d.commonGroup=A.mix({items:[n]}),o.listen("change",function(a){d.toggle(a.val())}))}a.hint&&n.getEl().append('<span class="choose-tips">'+a.hint+"</span>"),(!h||!j)&&f!==E&&k.append(c(l,j)),e[f]=e[f]||{id:f,name:m},e[f][j?"need":"option"]={chk:n,value:a.value},!a.noChecked&&n.checked(!0),a.disabled&&n.disabled();var p=d.aliasMap[f]=d.aliasMap[f]||{title:m,alias:[]};p.title=m,a.alias&&(p.alias=x.uniq(p.alias.concat(a.alias)))}})}function i(a,b){var c=this;c.isValUsable(a,b,null,function(a,d){c.renderItem({id:a,value:d,need:b,option:!b}),b&&c.commonGroup&&c.commonGroup.val(a,!0),c.toggle(a,!0),c.fire("change")})}function j(a,b){var c=this,d=c.chk,e=a?d[a][b?"need":"option"]:null;if(e){var f=c.isSystem(a,!0);B.show({noEditName:c.isSystem(a),onlyIpt:f&&!b,value:e.value,ok:function(d){c.isValUsable(d,b,a,function(d,e){a!==d&&c.delItem(a,b),c.renderItem({id:d,value:e,need:b,option:!b}),c.toggle(d,!0),c.renameItem(d,C.field2data(e).name,!b),c.fire("change")})}})}}function k(a,b){var c=this,d=c.chk,e=(d[a]||{})[b?"need":"option"];if(e){var f=e.chk.getEl().closest("div.js-field-item");e.chk.destroy(),f.remove(),delete d[a][b?"need":"option"],d[a].need||d[a].option||delete d[a],d[a]||delete c.aliasMap[a]}}function l(a,b,c){var d=this,e=d.chk,f=e[a][c?"need":"option"],g=(f||{}).value;if(g){var h=C.field2data(g);h.name!==b&&(h.name=b,g=C.data2field(h),d.renderItem({id:a,value:g,need:c,option:!c}),d.toggle(a,!0),d.fire("change"))}}function m(a,b){var c=this,d=(c.chk[a].need||{}).chk,e=(c.chk[a].option||{}).chk;if(!d||!d.isChecked())return void(e&&e.disabled(!1));if(e&&(e.checked(!1),e.disabled()),c.lastToggleId&&c.lastToggleId!==a){var f=(c.chk[c.lastToggleId].option||{}).chk;f&&f.disabled(!1)}c.lastToggleId=a,!b&&c.fire("change")}function n(a,b){var c=this;c._systemNeedMap||(c._systemNeedMap=x.toMap(F,function(a){return{key:a.id,value:!0}})),c._systemOptionMap||(c._systemOptionMap=x.toMap(G,function(a){return{key:a.id,value:!0}}));var d=!!c._systemNeedMap[a],e=!!c._systemOptionMap[a];return b?d:d||e}function o(a,b,c,d){var e=this;if(b&&x.contains(["姓名","输入姓名","名字","真实姓名"],a))return void z.alert("禁止使用"+a+"作为考试编号，建议使用投递编号");var f=C.field2data(a),g=f.name,h=e.getSameId(g);if(!h||h===c)return d&&d(h||x.key(),a);var i=!(!h||!e.chk[h][b?"need":"option"]),j=e.aliasMap[h].title,k="你录入的“"+u.encodeHTML(g)+"”可以使用“"+u.encodeHTML(j)+"”代替",l="你录入的“"+u.encodeHTML(g)+"”已经存在",m=j===g;return i?z.alert(m?l+(c?"，无法修改":"，无需重复设置"):k+"，无需重复设置"):void(m?d&&d(h,a):z.confirm(k+"，是否使用“"+u.encodeHTML(j)+"”代替？",function(){f.name=j;var a=C.data2field(f);d&&d(h,a)}))}function p(){var a=this,b=0;return x.forEach(a.chk,function(a){a.need&&a.need.chk&&a.need.chk.isChecked()&&b++}),b}function q(a){var b,c=this;return x.forEach(c.aliasMap,function(c,d){var e=c.title,f=e===a||x.contains(c.alias,a);return f=f||u.searchRegExp(e).test(a)||u.searchRegExp(a).test(e),f?(b=d,x.BREAK):void 0}),b}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Str,v=r.Component,w=r.Clazz,x=r.Base,y=s.CheckBox,z=s.Popup,A=s.CheckGroup,B=a("../../cpn/popupField"),C=a("../../util"),D=c.exports=w.create(),E="name",F=[{id:"resume",value:"投递编号",alias:"输入投递编号,投递号".split(","),hint:"*推荐，如使用简历系统安排笔试，请务必使用此项",option:!1,alone:!0,noChecked:!1},{id:"name",value:"姓名",alias:"输入姓名,名字,真实姓名".split(","),hint:"*考生必填，用于识别考生身份",alone:!0,need:!1,noChecked:!1,disabled:!0},{id:"testId",value:"考号",alias:"输入考号,考试号,考生编号".split(",")},{id:"phone",value:"手机号码",alias:"输入手机号码,手机号,手机,电话,联系电话".split(",")},{id:"email",value:"邮箱",alias:"输入邮箱,e-mail,mail".split(",")},{id:"id",value:"身份证",alias:"输入身份证,身份证号码,身份号码".split(",")}],G=[{id:"resume",value:"投递编号",alias:"输入投递编号,投递号".split(",")},{id:"job",value:"职位",alias:"输入职位,岗位,意向职位,意向岗位,面试岗位,面试职位".split(",")},{id:"department",value:"部门",alias:"输入部门,意向部门,投递部门".split(",")},{id:"school",value:"学校",alias:"输入学校,院校,毕业学校,毕业院校".split(",")},{id:"edu",value:"学历",alias:"输入学历,教育程度,最高学历,文化水平".split(",")},{id:"area",value:"地区"}],H=document.createElement("div");H.className="other-info-item js-field-item",w.mix(D,v,{_template:['<div class="tester-info-mod">','<div class="exam-tips">* 必须项用于识别考生身份，除姓名外，需至少一项；必须项和选填项不能重复</div>','<div class="form-group info-input-wrap">','<label class="control-label" style="width:300px;">考生录入信息<span class="choose-tips">考试开始后无法修改</span></label>','<div class="control-group">','<div class="info-blank-item js-need">','<label class="blank-label">考试编号(考生唯一识别号)</label>','<div class="candidate-num">','<a href="javascript:void(0);" class="link-green js-add" data-type="1">+ 新增</a>',"</div>","</div>",'<div class="info-blank-item js-option">','<label class="blank-label">考生其他信息</label>','<div class="candidate-num">','<a href="javascript:void(0);" class="link-green js-add" data-type="2">+ 新增</a>',"</div>","</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.needEl=b.find(".js-need"),a.optionEl=b.find(".js-option"),a.renderList()}},{name:"click .js-add",handler:function(a){var b=this,c=t(a.currentTarget),d=c.attr("data-type");if("1"===d||"2"===d){var e="1"===d;B.show({isNeed:e,ok:function(a){b.addItem(a,e)}})}}},{name:"click .js-edit",handler:function(a){var b=this,c=t(a.currentTarget).closest(".js-field-item"),d=t.trim(c.attr("data-id")),e="1"===t.trim(c.attr("data-need"));d!==E&&b.editItem(d,e)}}]},{initialize:d,val:e,valPublic:f,renderList:g,renderItem:h,addItem:i,editItem:j,delItem:k,renameItem:l,toggle:m,isSystem:n,isValUsable:o,getNeedCount:p,getSameId:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step4/index",["nc","cpn","./field","../../cpn/popupField","../../util","./limitLang","../listData","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../../../../../util/util","../util","../data","../cpn/popupPaperList","../cpn/steps","../../../../../component/steps","../../../../../core/module","../../../../../util/switch","../../../../../action/user","../../../../../component/department"],function(a,b,c){function d(a){var b=this;b.isEdit=L.isEdit(a),W=L.getDataUtil(b.isEdit),b.isRandom=W.isRandomQuestionType(),b.listData=new K({edit:b.isEdit}),b.hasCodeQuestion=b.listData.hasTypeQuestion("4"),b.cpn={}}function e(){var a=this,b=a.isEdit,c=a.getParam();if(L.initAddEdit(a))return!1;if(!W.isStep1Right())return G.alert("参数错误，请重新设置组卷方式",function(){a.nav("paper",b?{action:"editStep1",id:c.id}:"addStep1")}),!1;var d=a.listData.isDataRight();return d.right?W.isStep3Right()?!0:(G.alert("参数错误，请重新设置抽题方式",function(){a.nav("paper",b?{action:"editStep3",id:c.id}:"addStep3")}),!1):(G.alert(d.msg,function(){a.nav("paper",b?{action:"editStep2",id:c.id}:"addStep2")}),!1)}function f(){var a=this,b=a.getEl(),c=a.cpn,d=W.isRandomQuestionType();new N({renderTo:b.find(".js-steps-wrap"),renderWith:"replaceWith",isEdit:a.isEdit,currentStep:d?4:3,totalStep:d?5:4});var e=c.titleIpt=C.transform(b.find(".js-title"));e.getEl().width(e.inputEl.outerWidth());var f=c.durationIpt=C.transform(b.find(".js-duration"),{blur:function(){this.val(B.fix(this.val()))}});f.getEl().width(f.inputEl.outerWidth()),c.startDateIpt=C.transform(b.find(".js-start-date")),c.startTimeIpt=C.transform(b.find(".js-start-time")),c.endDateIpt=C.transform(b.find(".js-end-date")),c.endTimeIpt=C.transform(b.find(".js-end-time"));var g=[c.startDateIpt,c.startTimeIpt,c.endDateIpt,c.endTimeIpt];c.durationChk=D.transform(b.find(".js-forever"),{change:function(){var a=this.isChecked();x.forEach(g,function(b){b.disabled(a),b.setNone()})}}),x.forEach(g,function(b){var d=b===c.startDateIpt||b===c.endDateIpt,e=E.show({target:b.getEl(),ipt:b.inputEl,canShow:function(){return!b.isDisabled()},type:d?"date":"time",startDate:d?"now":void 0,endDate:d?E.yearDiff(8)+"-12-31":void 0,call:function(c,d){b.val(d),a.saveData()}});a.pushChild(e)}),c.department=new V({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",type:"selectMult",departmentData:a.departmentData,marginLeft:"-35px",gap:"20px",tip:"只有拥有参与管理的机构权限的账号可以进行管理试卷和添加考生的操作",userId:a.getUserId()}),c.department.getEl(".control-label").width(135),c.cheatCameraChk=D.transform(b.find(".js-cheat-camera")),c.cheatPhoneChk=D.transform(b.find(".js-cheat-phone")),c.cheatLeaveChk=D.transform(b.find(".js-cheat-leave")),c.cheatLeaveCodeChk=D.transform(b.find(".js-cheat-leave-code")),c.cheatQuestionChk=D.transform(b.find(".js-cheat-question")),c.cheatOptionChk=D.transform(b.find(".js-cheat-option")),c.codePlaybackChk=D.transform(b.find(".js-code-playback")),c.reportPlatformChk=D.transform(b.find(".js-report-platform")),c.judgeTkChk=D.transform(b.find(".js-judge-tk")),c.judgeWdChk=D.transform(b.find(".js-judge-wd")),c.judgeBcChk=D.transform(b.find(".js-judge-bc")),c.limitLang=new J({ignore:!a.hasCodeQuestion,renderTo:b.find(".js-limit-lang"),renderBy:"replaceWith"});var h=[["paperAccessChk",".js-paper-access"],["paperQueueChk",".js-paper-queue"],["customerServiceChk",".js-customer-service"],["codingScoreChk",".js-coding-score"],["chooseScoreChk",".js-choose-score"],Q.can("paperSimulation")?["ifSimulationChk",".js-if-simulation"]:null];x.forEach(h,function(a){a&&(c[a[0]]=new F({el:b.find(a[1])}))}),c.paperAccessChk.listen("change",function(){var a=this.val();c.field&&(c.field.valPublic("true"===a),G.alert("“考生录入信息”已经根据当前试卷类型进行重置，请注意检查"))}),c.passLineIpt=C.transform(b.find(".js-pass-line")),c.passLineIpt.listen("blur",function(){this.val(B.fix(this.val()))}),c.field=new I({renderTo:b.find(".js-field-container")}),c.noticeBeforeIpt=C.transform(b.find(".js-notice-before")),z.txtAutoHeight({el:c.noticeBeforeIpt.inputEl}),c.noticeAfterIpt=C.transform(b.find(".js-notice-after")),z.txtAutoHeight({el:c.noticeAfterIpt.inputEl}),x.forEach([c.cheatLeaveChk,c.cheatLeaveCodeChk],function(b){b.listen("change",function(){var b=c.noticeBeforeIpt.val(),d=a.fixNoticeBefore(b,c.cheatLeaveChk.isChecked(),c.cheatLeaveCodeChk.isChecked());d!==b&&c.noticeBeforeIpt.val(d)})})}function g(){var a=this,b=a.getEl(),c=H.show({target:b.find(".js-upload-cover"),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",url:P.getUploadUrl(1),call:function(b){var c=b.data;a.logoUrl=c,a.fixLogo(c),a.saveData()}});a.pushChild(c),a.isEdit||window.setTimeout(function(){a.logoUrl||T.getPreLogo({type:"GET",call:function(b){b.data&&a.fixLogo(b.data)}})},0)}function h(){var a=this,b=a.cpn;x.forEach(b,function(b){b.listen("change",function(){a.saveData()})})}function i(a){var b=this,c=b.getEl(),d=b.isEdit,e=b.getParam();y.mark(c)||T[d?"updatePaper":"createPaper"]({type:d?"PUT":"POST",body:a,params:d?{paperId:e.id}:null,call:function(a){var c=a.data;W.clearDb(),b.nav("paper",{action:d?"editStep5":"addStep5",paperId:c.id,random:b.isRandom})},statusCall:{1304:function(){return G.alert("该试卷名已被占用，为更好的进行试卷管理，请您更换为其他试卷名称。"),!1}},error:function(a){G.alert(a.msg)},always:function(){y.clear(c)}})}function j(){var a=this,b=a.listData,c=a.cpn,d=W.isRandomQuestionType(),e=W.isCustomDir(),f=b.getListDir(),g=W.getDb(W.DB_ADD_TAG_COUNT),h={paperName:v.trim(c.titleIpt.val())||null,duration:v.trim(c.durationIpt.val())||null,beginTime:v.trim(c.startDateIpt.val())+" "+v.trim(c.startTimeIpt.val()),endTime:v.trim(c.endDateIpt.val())+" "+v.trim(c.endTimeIpt.val()),forever:c.durationChk.isChecked(),logo:a.logoUrl||null,departmentIdList:c.department.val(),needCamera:c.cheatCameraChk.isChecked(),monitorPhone:c.cheatPhoneChk.isChecked(),needMessage:"true"===c.customerServiceChk.val(),allowNew:"true"===c.paperAccessChk.val(),noQueueUp:"false"===c.paperQueueChk.val(),antiJumpOut:c.cheatLeaveChk.isChecked(),antiCodingJumpOut:c.cheatLeaveCodeChk.isChecked(),questionDisorder:c.cheatQuestionChk.isChecked(),optionDisorder:c.cheatOptionChk.isChecked(),codePlayback:c.codePlaybackChk.isChecked(),allowCopy:!1,reportPlatform:c.reportPlatformChk.isChecked(),checkCheat:!0,codingScoreRule:+c.codingScoreChk.val(),chooseScoreRule:+c.chooseScoreChk.val(),mJudgeCompletion:c.judgeTkChk.isChecked(),mJudgeDesign:c.judgeWdChk.isChecked(),mJudgeCoding:c.judgeBcChk.isChecked(),beforeSummary:v.trim(c.noticeBeforeIpt.val())||null,endTips:v.trim(c.noticeAfterIpt.val())||null,randomQuestion:d,customCategory:e},i=c.limitLang.val();x.extend(h,i);var j=c.field.val();x.extend(h,j);var k=100,l={},m={};if(x.forEach(f,function(a,b){var c=e?k+b:a.type;l[c]=a.title,m[a.id]=c}),h.questionCategories=JSON.stringify(l),W.isRandomQuestionType()){var n=(g||{}).tag||{},o=a.buildParam(f,n,m,b);x.extend(h,o),x.extend(h,{randomFrequentType:g.randomFrequentType||0})}else{var p=[];x.forEach(f,function(a){var c=b.getDirQuestionId(a.id),d=m[a.id];x.forEach(c,function(c){p.push({questionId:c,score:b.getQuestionScore(c),questionType:a.type,categoryType:d})})}),h.relationJson=JSON.stringify(p)}return Q.can("paperPassLine")&&(h.passScoreLine=v.trim(c.passLineIpt.val())),Q.can("paperSimulation")&&(h.simulation="1"===c.ifSimulationChk.val()),h}function k(a){var b=this,c=(b.getEl(),b.cpn);if(c.titleIpt.val(a.paperName||""),c.durationIpt.val(a.duration||""),a.beginTime){var d=a.beginTime.split(" ");c.startDateIpt.val(d[0]),c.startTimeIpt.val(d[1])}if(a.endTime){var d=a.endTime.split(" ");c.endDateIpt.val(d[0]),c.endTimeIpt.val(d[1])}c.durationChk.checked(!!a.forever),c.durationChk.fire("change"),b.fixLogo(a.logo||b.getWin().getUserByKey("headUrl")),c.department.val(a.departmentIdList),c.cheatCameraChk.checked(!!a.needCamera),c.cheatPhoneChk.checked(!!a.monitorPhone),c.cheatLeaveChk.checked(!!a.antiJumpOut),c.cheatLeaveCodeChk.checked(!!a.antiCodingJumpOut),c.cheatQuestionChk.checked(!!a.questionDisorder),c.cheatOptionChk.checked(!!a.optionDisorder),c.codePlaybackChk.checked(!!a.codePlayback),c.reportPlatformChk.checked(!!a.reportPlatform),c.judgeTkChk.checked(!!a.mJudgeCompletion),c.judgeWdChk.checked(void 0===a.mJudgeDesign?!0:!!a.mJudgeDesign),c.judgeBcChk.checked(!!a.mJudgeCoding),c.customerServiceChk.val(a.needMessage?"true":"false"),c.paperAccessChk.val(a.allowNew?"true":"false"),c.paperQueueChk.val(a.noQueueUp?"false":"true"),c.codingScoreChk.val("2"===x.id(a.codingScoreRule)?"2":"1"),c.chooseScoreChk.val("1"===x.id(a.chooseScoreRule)?"1":"2"===x.id(a.chooseScoreRule)?"2":"3"),c.noticeBeforeIpt.val(b.fixNoticeBefore(a.beforeSummary||_,!!a.antiJumpOut,!!a.antiCodingJumpOut)),c.noticeAfterIpt.val(a.endTips||ab),c.limitLang.val({languageLimit:!!a.languageLimit,languageList:a.languageList||[]}),c.field.val(a,!!a.allowNew),Q.can("paperPassLine")&&c.passLineIpt.val(a.passScoreLine),Q.can("paperSimulation")&&c.ifSimulationChk.val(a.simulation?"1":"2"),Q.can("paperSimulation")&&!Q.can("paperOfficial")&&(c.ifSimulationChk.val("1"),x.forEach(c.ifSimulationChk.option,function(a){a.disabled(!0),a.getEl().on("click",function(){G.alert("该账号只能使用模拟卷")})})),b.saveData()}function l(){function a(a,b){!h&&G.alert(a),!h&&b&&z.highLight({el:b,times:12}),h=!0,g=!1}var b=this,c=b.getEl(),d=b.cpn,e=b.isRandom,f=b.getData(),g=!0,h=!1;if(f.paperName||(d.titleIpt.setErrorTips("考试标题不能为空"),g=!1),f.duration||(d.durationIpt.setErrorTips("考试时长不能为空"),g=!1),!f.forever){var i=v.trim(d.startDateIpt.val()),j=v.trim(d.startTimeIpt.val()),k=v.trim(d.endDateIpt.val()),l=v.trim(d.endTimeIpt.val()),m=!0;if(A.checkDate(i)||(d.startDateIpt.setErrorTips("日期格式不正确"),m=!1),A.checkTime(j)||(d.startTimeIpt.setErrorTips("时间格式不正确"),m=!1),A.checkDate(k)||(d.endDateIpt.setErrorTips("日期格式不正确"),m=!1),A.checkTime(l)||(d.endTimeIpt.setErrorTips("时间格式不正确"),m=!1),m){var n=new Date(f.beginTime).getTime(),o=new Date(f.endTime).getTime();if(o<=(new Date).getTime()?(d.endDateIpt.setErrorTips("结束时间不能早于当前时间"),d.endTimeIpt.setError(),m=!1):n>=o&&(d.startDateIpt.setErrorTips("开始时间不能晚于结束时间"),d.startTimeIpt.setError(),d.endDateIpt.setError(),d.endTimeIpt.setError(),m=!1),m){var p=o-n,q=60*+f.duration*1e3;q>p&&(d.durationIpt.setErrorTips("考试时长必须小于等于试卷有效期，请修改考试时长或考试有效期"),m=!1)}}g=g&&m}return f.logo||a("请选择考试LOGO图片",c.find("div.js-logo-container")),f.languageLimit&&(f.languageList||[]).length<=0&&a("请选择编程题语言",d.limitLang.getEl()),f.keyTitle||a("考生录入信息必须选择两个必填信息",c.find("div.js-field-container")),f.beforeSummary||(d.noticeBeforeIpt.setErrorTips("考前须知不能为空"),g=!1),f.endTips||(d.noticeAfterIpt.setErrorTips("考后说明不能为空"),g=!1),e||0!==x.json(f.relationJson,[]).length||a("缺少试卷的题目信息，请返回上一步确认"),g}function m(){var a=this,b=a.getData();W.setDb(W.DB_ADD_PAPER,b)}function n(a){var b=this,c=b.getEl(),d=c.find("div.paper-logo");d.find("img").attr("src",a||bb),b.logoUrl=a}function o(a,b,c,d){var e=1,f={},g=[],h=[],i={};return x.forEach(a,function(a){var j=a.title,k=a.type,l=b[j]||[];x.forEach(l,function(b){var j=k+":"+e+":"+c[a.id]+":"+b.inputCount;f[e]=b.ids,i[e]=b.tagName,g.push(j),e++;for(var l=0,m=+x.id(b.inputCount)||0;m>l;l++)h.push(d.getDirScore(a.id))})}),{questionIdsTypes:JSON.stringify(f),questionTagNames:JSON.stringify(i),questionScores:h.join(","),questionNewCount:g.join(",")}}function p(a,b){var c=this;R.checkProject({force:!0,call:function(d){U.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:[d],entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,x.isFunction(a)&&a(d)},error:function(a){x.isFunction(b)&&b(a.msg)}})}})}function q(){return['<div class="js-steps-wrap"></div>','<div class="steps-detail">','<div class="detail-group">','<div class="form-group">','<a href="javascript:void(0)" class="upload-paper-set link-green js-load-paper"><i class="icon-download-alt"></i> 载入已有试卷设置</a>',"</div>",'<div class="form-group">','<label class="control-label">考试标题</label>','<div class="control-group js-title"><input type="text" placeholder="考试标题" /></div>',"</div>",'<div class="form-group">','<label class="control-label">考试时长/分钟</label>','<div class="control-group js-duration"><input type="text" placeholder="考试时长/分钟" /></div>',"</div>",'<div class="form-group">','<label class="control-label">试卷有效期</label>','<div class="control-group paper-term">','<div class="control-group js-start-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-start-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<span class="term-label">至</span>','<div class="control-group js-end-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-end-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<label class="checkbox js-forever">长期有效</label>',"</div>","</div>",'<div class="form-group js-logo-container">','<label class="control-label">考试LOGO图片</label>','<div class="control-group">','<div class="paper-logo"><img style="width:50px;height:50px;" src="',bb,'"></div>','<div style="display:inline-block;position:relative;">','<a href="javascript:void(0);" class="link-green js-upload-cover">修改 (建议80px*80px)</a>',"</div>","</div>","</div>",'<div class="js-department-home"></div>',"</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">防作弊机制</label>','<div class="control-group">','<label class="checkbox js-cheat-camera">开启摄像头</label>','<label class="checkbox js-cheat-phone">开启手机监控 <span class="icon-question-sign js-tips" title="考生在考试中手机需持续开启考试监控小程序，如跳出打开其他应用会进行记录，杜绝使用手机作弊行为" data-theme="white"></span></label>','<label class="checkbox js-cheat-leave">禁止做题跳出页面（编程题除外）</label>','<label class="checkbox js-cheat-leave-code">禁止编程题跳出页面 <span class="icon-question-sign js-tips" title="编程题仅能在线作答，不支持线下编码，防作弊机制更严格，但会对编码体验有所影响" data-theme="white"></span></label>','<label class="checkbox js-cheat-question">题目乱序</label>','<label class="checkbox js-cheat-option">选择题选项乱序</label>','<label class="checkbox js-code-playback">代码回看 <span class="icon-question-sign js-tips" title="实时记录考生考试中的代码编写过程，可在成绩报告中回看不同时刻的代码" data-theme="white"></span></label>','<label class="checkbox js-report-platform">开启举报平台</label>',cb,"</div>","</div>",'<div class="form-group">','<label class="control-label">人工判题题型</label>','<div class="control-group">','<label class="checkbox js-judge-tk">填空题</label>','<label class="checkbox js-judge-wd">问答题</label>','<label class="checkbox js-judge-bc">编程题</label>',"</div>","</div>",'<div class="js-limit-lang"></div>',"</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">试卷类型</label>','<div class="control-group">','<label class="radio js-paper-access"><input value="false" />私密，仅邀请可见</label>','<label class="radio js-paper-access"><input value="true"/>公开，所有人可见</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">在线客服窗口</label>','<div class="control-group">','<label class="radio js-customer-service"><input value="false"/>关闭</label>','<label class="radio js-customer-service"><input value="true"/>开启（仅VIP可用）<span class="icon-question-sign js-tips" title="本功能仅大规模考试（超过2000人次）可用，需开考前提前联系牛客客服团队:010-84873384" data-theme="white"></span></label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">排队发卷</label>','<div class="control-group">','<label class="radio js-paper-queue"><input value="false" />关闭</label>','<label class="radio js-paper-queue"><input value="true"/>开启（200人以上建议使用）</label>',cb,"</div>","</div>",'<div class="form-group">','<label class="control-label">编程题计分规则</label>','<div class="control-group">','<label class="radio js-coding-score"><input value="1" />每题以多次提交中最高得分计分</label>','<label class="radio js-coding-score"><input value="2"/>每题以最后一次提交得分计分</label>',cb,"</div>","</div>",'<div class="form-group">','<label class="control-label">多选题计分规则</label>','<div class="control-group">','<label class="radio js-choose-score"><input value="1" />少选错选不得分</label>','<label class="radio js-choose-score"><input value="2"/>错选不得分，少选得1/2分</label>','<label class="radio js-choose-score"><input value="3"/>错选不得分，少选得1/3分</label>',cb,"</div>","</div>",Q.can("paperPassLine")?['<div class="form-group">','<label class="control-label">及格分数线</label>','<div class="control-group js-pass-line"><input type="text" placeholder="及格分数线" /></div>',"</div>"].join(""):"",Q.can("paperSimulation")?['<div class="form-group">','<label class="control-label">是否为模拟卷</label>','<div class="control-group">','<label class="radio js-if-simulation"><input value="2"/>否</label>','<label class="radio js-if-simulation"><input value="1"/>是 <span class="icon-question-sign js-tips" title="模拟试卷的考试数据不回传，不跑作弊检测" data-theme="white" style="margin-left:10px;"></span></label>',"</div>","</div>"].join(""):"","</div>",'<div class="detail-group js-field-container"></div>','<div class="detail-group">','<div class="form-group">','<label class="control-label">考前须知</label>','<div class="control-group js-notice-before"><textarea class="form-textarea"></textarea></div>',"</div>","</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">考后说明</label>','<div class="control-group js-notice-after"><textarea class="form-textarea"></textarea></div>',"</div>","</div>","</div>",'<div class="paper-btn-group">','<a class="btn btn-default js-go-pre" href="javascript:void" style="width:180px;">返回上一步</a>','<a class="btn btn-primary js-go-next" href="javascript:void" style="width:180px;">设置完毕，下一步</a>',"</div>"].join("")}function r(a){var b=this,c=b.listData;c.getAllCodeQuestion(function(b){var c=x.find(b,function(a){var b=x.json((a.codingProblem||{}).testCasesExt,{}).samples||[];return!!x.find(b,function(a){return(a.input||"").length>=30})},!0);a&&a(c)})}function s(a,b,c){var d=a.replace(Y,"#{cheatTips}").replace(Z,"#{cheatTips}").replace($,"#{cheatTips}"),e=b&&c?Z:!b&&c?$:Y,f=d.replace("#{cheatTips}",e);return f}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Clazz,x=t.Base,y=t.Limit,z=t.Dom,A=t.Time,B=t.Num,C=u.Input,D=u.CheckBox,E=u.AttachDate,F=u.CheckGroup,G=u.Popup,H=u.AttachUpload,I=(u.Tips,a("./field")),J=a("./limitLang"),K=a("../listData"),L=a("../util"),M=a("../cpn/popupPaperList"),N=a("../cpn/steps"),O=a("../../../../../core/module"),P=a("../../../../../util/util"),Q=a("../../../../../util/switch"),R=a("../../../extend/bll/paper"),S=a("../../../extend/bll/serverTime"),T=a("../../../../../action/paper"),U=a("../../../../../action/user"),V=a("../../../../../component/department"),W=null,X=c.exports=w.create(),Y="考试中除编程题之外，其他考试页面不可跳出当前页面，前三次跳出会有提醒，之后将不再提醒。编程题支持本地IDE编码后复制粘贴至考试页面，不做跳出限制。",Z="考试中全部题型（含编程题）不可跳出当前页面，只能在考试页面作答，前三次跳出会有提醒，之后将不再提醒。",$="考试中编程题不可跳出当前页面，只能在考试页面作答，前三次跳出会有提醒，之后将不再提醒。",_=["1、请使用最新版chrome浏览器作答（44版本以上），如考试需开启摄像头，请确保电脑带有摄像头。","2、"+Y,"3、考试时允许使用草稿纸，请提前准备纸笔。考试过程中允许上厕所等短暂离开，但请控制离开时间。","4、考试期间如遇到断电、断网、死机等问题，可以关闭浏览器重新打开试卷链接即可继续做题。","5、遇到问题请即时反馈给考试主办方。"].join("\n"),ab="本场考试已结束，请保持通讯畅通，方便接收后续通知",bb="//uploadfiles.nowcoder.com/images/20160520/56_1463728821615_B856A5CA00C64BEA1A77436F8FE39D5E",cb='<span class="choose-tips">考试开始后无法修改</span>';w.mix(X,O,{style:"/stylesheets/styles/system/assemblePaper.css",title:"新增试卷",_template:'<div class="steps-main step2"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl(),c=a.isEdit;a.getParam()}if(a.initCheckData()){{var d=W.getDb(W.DB_ADD_PAPER)||{};0===x.size(d)}c&&d.projectId&&a.addParam({projectId:d.projectId}),a.renderWait(b),a.getDepartment(function(){a.getOverExampleCode(function(c){b.html(a.getModuleHtml()),a.initCpn(),a.initAvatar();var d=W.getDb(W.DB_ADD_PAPER)||{},e=0===x.size(d);e&&(d.keyTitle="投递编号",d.optionalFields=["手机号码:Phone","邮箱:Email","职位","学校","学历"],d.allowCopy=c.length>0,d.codePlayback=!0),a.setData(d),a.initAutoCache()})},function(c){a.renderNone(b,c)})}}},{name:"click .js-go-pre",handler:function(){var a=this,b=a.isRandom,c=a.getParam(),d=a.isEdit?{action:b?"editStep3":"editStep2",id:c.id}:{action:b?"addStep3":"addStep2"};a.nav("paper",d)}},{name:"click .js-go-next",handler:function(){function a(a){return e?a&&a():void R.checkProject({force:!0,call:function(b){f.projectId=b,a&&a()}})}function b(a){return f.forever?a&&a():void S.getTime(function(b){var c=new Date(f.beginTime).getTime()||0,d=Math.floor((c-b)/864e5);if(d>=15){var e=G.confirm("考试将在"+d+"天后开始，确认组卷？",null,a);e.okBtn.html("返回修改"),e.cancelBtn.html("继续保存")}else a&&a()})}function c(a){return a&&a()}var d=this,e=d.isEdit;if(!d.checkData())return d.goTop();var f=d.getData();f.forever&&delete f.beginTime,f.forever&&delete f.endTime,a(function(){c(function(){b(function(){d.submit(f)})})})}},{name:"click a.js-load-paper",handler:function(){var a=this;M.show({listeners:{ok:function(b){var c=W.loadStep4Data(b);a.setData(c)}}})}}]},{initialize:d,initCheckData:e,initCpn:f,initAvatar:g,initAutoCache:h,submit:i,getData:j,setData:k,checkData:l,saveData:m,fixLogo:n,buildParam:o,getDepartment:p,getModuleHtml:q,getOverExampleCode:r,fixNoticeBefore:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step4/limitLang",["nc","cpn"],function(a,b,c){function d(a){var b=this;b.isNeed=!a.ignore}function e(){var a=this;a.chk=new n({el:a.getEl(".js-limit-lang"),listeners:{change:function(){var b="true"===this.val();a.select&&a.select[b?"show":"hide"](),a.fire("change")}}})}function f(){var a=this,b=a.select=new o({renderTo:a.getEl(".js-select"),text:"请选择编程语言",size:"small",noSelectAll:!0,options:l.map(m.getQuestionLang(!0),function(a){return{text:m.getNameById(a),value:a}}),listeners:{change:function(){a.fire("change")}}});b.getEl().css("marginLeft","10px"),b.hide()}function g(a){var b=this,c=(!!b.isNeed,b.chk),d=b.select;if(0===arguments.length){var e=b.isNeed&&"true"===c.val();return{languageLimit:e,languageList:e?d.val():[]}}a=b.isNeed?a:{languageLimit:!1,languageList:[]};var e=!!a.languageLimit,f=l.map(a.languageList,function(a){return l.id(a)});c.val(e===!0?"true":"false"),d.val(f),d[e?"show":"hide"]()}var h=a("nc"),i=a("cpn"),j=(h.$,h.Str,h.Component),k=h.Clazz,l=h.Base,m=h.CodeLang,n=i.CheckGroup,o=i.SelectMult,p=c.exports=k.create();k.mix(p,j,{_template:['<div class="form-group">','<label class="control-label">限定编程语言</label>','<div class="control-group">','<label class="radio js-limit-lang checked"><input value="false"/>否</label>','<label class="radio js-limit-lang"><input value="true"/>是</label>','<span class="icon-question-sign js-tips" title="限制编程题语言后，考生只能使用指定的编程语言作答" data-theme="white"></span>','<span class="js-select"></span>','<span class="choose-tips">考试开始后无法修改</span>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.rawConfig,a.getEl()}a.initChk(),a.initSelect(),a[a.isNeed?"show":"hide"]()}}]},{initialize:d,initChk:e,initSelect:f,val:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/step5/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/steps","../../../../../action/paper","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../util","../data","../../util","../cpn/steps"],function(a,b,c){function d(a){var b=this;b.isEdit=z.isEdit(a)}function e(a){var b=this,c=b.getEl(),d=n.id(a.id);a.testUrl=(0===(a.testUrl||"").indexOf("//")?"https:":"")+(a.testUrl||"");var e=o.addParam({theme:"tinyLeft"},b.getNavUrl("paper",{action:"preview/index",id:d})),f=q.execTpl(['<div class="js-steps"></div>',"<div>",'<div class="paper-finish">','<div v-if="!data.forever" style="display:none;" class="paper-countdown-tips js-count-down">','<i class="icon-time"></i>',"<span>距考试开始还剩</span>",'<div class="countdown-time-item"><p>0</p>天</div>','<div class="countdown-time-item"><p>0</p>小时</div>','<div class="countdown-time-item"><p>0</p>分钟</div>','<div class="countdown-time-item"><p>0</p>秒</div>',"</div>","<span>你已#{isEdit ? '编辑' : '生成'}测评试卷“#{data.paperName}”</span>","<div>",'<span>测评链接：<a :href="data.testUrl" target="_blank">#{data.testUrl}</a></span>&nbsp;&nbsp;&nbsp;&nbsp;','<a v-if="(data.setting || {}).allow_new" class="js-copy" :data-clipboard-text="data.testUrl" href="javascript:void(0);">复制链接</a>',"<div v-else>此试卷为私密试卷，每个考生有自己的专属链接</div>","</div>","</div>",'<div class="paper-btn-group">','<div class="paper-btn-item" style="padding:0;text-align:center;">','<div style="margin-bottom:10px;">','<a class="btn btn-primary js-add-user" href="javascript:void(0);">邀请考生</a>','<a class="btn btn-primary" target="_blank" :href="previewUrl">预览试卷</a>','<a class="btn btn-primary js-go-list" target="_blank" href="javascript:void(0);">返回试卷列表</a>',"</div>","</div>","</div>","</div>"].join(""),{data:a,isEdit:b.isEdit,previewUrl:e});c.html(f),u.copy(c.find(".js-copy"),function(){s.tips("复制成功")})}function f(a){function b(a){if(a>e)return d.hide();var b=p.second2data((e-a)/1e3),c=m.execTpl([b.day<=0?"":'<div class="countdown-time-item"><p>#{day}</p>天</div>','<div class="countdown-time-item"><p>#{hour}</p>小时</div>','<div class="countdown-time-item"><p>#{min}</p>分钟</div>','<div class="countdown-time-item"><p>#{second}</p>秒</div>'].join(""),{day:r.form(b.day),hour:r.form(b.hour),min:r.form(b.min),second:r.form(b.second)});d.find(".countdown-time-item").remove(),d.append(c).show()}var c=this,d=c.getEl(".js-count-down"),e=a.beginTime;a.forever||(x.listen("nextTick",b),c.listen("destroy",function(){x.unlisten("nextTick",b)}))}function g(){var a=this,b=a.getEl(),c=a.getParam(),d="copy"===c.type,e=!!c.tested;return d||e?void new v({renderTo:b.find(".js-steps"),renderWith:"replaceWith",titles:["编辑试卷参数","完成"],current:2}):void new A({renderTo:b.find(".js-steps"),renderWith:"replaceWith",isEdit:a.isEdit,currentStep:c.random?5:4,totalStep:c.random?5:4})}function h(a){{var b=this,c=b.getParam(),d="copy"===c.type;!!c.tested}return(d?"复制试卷":b.isEdit?"编辑试卷":"新增试卷")+"("+a.paperName+")"}function i(a){var b=this,c=b.getEl(),d=b.getParam(),e=d.paperId;return e?void w.getPaper({type:"GET",params:{paperId:e},call:function(b){a&&a(b.data)},error:function(){b.renderWait(c,"操作成功，但获取数据失败，请刷新页面重试")}}):b.renderWait(c,"错误的参数")}var j=a("nc"),k=a("cpn"),l=(j.$,j.Clazz),m=j.Str,n=j.Base,o=j.Uri,p=j.Time,q=j.Node,r=j.Num,s=k.Popup,t=a("../../../../../core/module"),u=a("../../../../../util/util"),v=a("../../../../../component/steps"),w=a("../../../../../action/paper"),x=a("../../../extend/bll/serverTime"),y=a("../../../extend/bll/paper"),z=a("../util"),A=a("../cpn/steps"),B=c.exports=l.create();l.mix(B,t,{style:"/stylesheets/styles/system/company.css",title:"新增试卷",_template:'<div class="steps-main step3"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b),a.fetchData(function(b){a.initHtml(b),a.initCountDown(b),a.initSteps(),a.crumbTitle=a.getTitle(b),a.refreshCrumb()})}},{name:"click .js-add-user",handler:function(){var a=this,b=a.getParam();a.nav("paper",{action:"notice/addUser/index",paperId:n.id(b.paperId),type:"1"})}},{name:"click .js-go-list",handler:function(){var a=this;y.checkProject({call:function(b){a.nav("paper",{action:"project/paperList",projectId:b})}})}}]},{initialize:d,initHtml:e,initCountDown:f,initSteps:g,getTitle:h,fetchData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/add/util",["nc","cpn","./data","../util","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=a.param||{},c=b.action||"";return c&&!/^add/.test(b.action||"")}function e(a){return k[a?"edit":"add"]}function f(a){var b=this,c=a;if(c.isEdit=b.isEdit(c.rawConfig),c.isEdit){var d=c.getParam(),e=i.id(d.id);if(!e)return j.alert("参数错误",function(){c.nav("paper")}),!0;var f=b.getDataUtil(c.isEdit),g=f.getDb(f.DB_EDIT_INFO)||{};if(g.beenTested||i.id(g.id)!==e)return c.nav("paper",{action:"edit",id:d.id}),!0;c.crumbTitle="编辑试卷("+g.paperName+")",c.refreshCrumb()}}var g=a("nc"),h=a("cpn"),i=g.Base,j=h.Popup,k=a("./data");c.exports={isEdit:d,getDataUtil:e,initAddEdit:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/index/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/department","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/user","../../../../../action/testinfo","../../../../../action/paper"],function(a,b,c){function d(){var a=this;a.db=new w(E.appDb.paperCandidate)}function e(){var a=this,b=a.rawConfig,c=b.paper,d=b.department,e=b.paperId,f=b.module.getParam(),g={id:"paper",title:"笔试试卷",type:"selectMult",conf:{text:"筛选试卷",size:"small",needSearch:!0,options:u.map(c,function(a){var b=u.id(a.id);return{text:a.paperName,value:b,checked:b===e}}),change:function(){a.fixRemark(),a.fixCheat()}}},h={id:"testTime",title:"考试时间段",type:"duration",ext:{today:!0}},i={id:"grade",title:"成绩区间",type:"range"},j={id:"department",title:"机构",type:"selectMult",conf:{needSearch:!0,options:B.getOption(d)}},k={id:"remark",title:"上传备注",type:"select",conf:{needSearch:!0,options:[]}},l=[{text:"不限",value:"-1"},{text:"是",value:"1"},{text:"否",value:"0"}],m=!(!f.judgeType||!{0:1,1:1}[f.judgeType]);u.forEach(l,function(a){a.checked=m?a.value===f.judgeType:"-1"===a.value});var n={id:"judge",title:"人工阅卷",type:"select",conf:{options:l,change:function(){a.fixJudge()}}},o=[{text:"不限",value:"-1"},{text:"是",value:"1"},{text:"否",value:"0"}],p=!(!f.judgeFinish||!{0:1,1:1}[f.judgeFinish]);u.forEach(o,function(a){a.checked=p?a.value===f.judgeFinish:"-1"===a.value});var q={id:"judgeFinish",title:"判卷完毕",type:"select",conf:{options:o,change:function(){a.fixJudge()}}},r={id:"judgeProgress",title:"阅卷进度",type:"selectMult",conf:{options:[]}},s={id:"ifCheat",title:"是否作弊",type:"select",conf:{options:[{text:"不限",value:"-1",checked:!0},{text:"是",value:"1"},{text:"否",value:"2"}],change:function(){a.fixCheat()}}},t={id:"cheatReason",title:"作弊原因",type:"select",conf:{options:[{text:"不限",value:"-1"},{text:"多IP登录",value:"1"},{text:"人工标记",value:"2"},{text:"代码相似度",value:"3"},{text:"截图异常",value:"5"},{text:"跳出次数过多",value:"6"},{text:"手机监控异常",value:"7"}],change:function(){a.fixCheat()}}},v={id:"cheatQuestion",title:"作弊题目",type:"select",conf:{options:[],needSearch:!0}},w={id:"similar",title:"相似度区间",type:"range",ext:{chkTips:"系统默认将代码相似度大于等于80%的考生判定为作弊"}},x={id:"keyword",title:"关键词",type:"search",conf:{placeholder:"输入关键词搜索，多个关键词用空格分割"},ext:{chkTitle:"包含任意关键词",chkTips:"默认是搜索包含了所有关键字的考生，多个关键词用空格分割"}};a.filter=new A({renderTo:a.getEl(),submitTxt:"查询",line:[{border:!0,items:[g,h,i,j,k]},{border:!0,items:[n,q,r]},{border:!0,fold:!0,items:[s,t,v,w]},{border:!1,fold:!0,items:[x]}],clearAll:function(){a.val({})},listeners:{submit:function(){a.submit()}}}),a.fixGrade(),a.fixRemark(),a.fixJudge(),a.fixCheat()}function f(a){var b=this,c=b.filter,d=c.getItem("paper"),e=c.getItem("testTime"),f=c.getItem("grade"),g=c.getItem("department"),h=c.getItem("remark"),i=c.getItem("judge"),j=c.getItem("judgeProgress"),k=c.getItem("ifCheat"),l=c.getItem("cheatReason"),m=c.getItem("cheatQuestion"),n=c.getItem("similar"),o=c.getItem("keyword");if(0===arguments.length){var p=h.val()||void 0,q=i.val()||void 0,r=k.val(),t=l.val();t="1"===r&&"-1"!==t?t:void 0;var u=m.val(),v={paperId:d.val(),minTestTime:b.wrapDuration(e.startIpt,!0),maxTestTime:b.wrapDuration(e.endIpt),minGrade:s.trim(f.startIpt.val())||void 0,maxGrade:s.trim(f.endIpt.val())||void 0,departmentIdList:g.val(),remark:"-1"===p?void 0:p,judgeType:"-1"===q?void 0:q,judgeStatusList:j.val(),ifCheat:"-1"===r?void 0:"1"===r,cheatReason:t,question:"3"===t&&"-1"!==t?u:void 0,minSimilar:"3"===t?s.trim(n.startIpt.val()):void 0,maxSimilar:"3"===t?s.trim(n.endIpt.val()):void 0,keyword:s.trim(o.ipt.val())||void 0,union:o.chk.isChecked()?1:0};return b.cache(v),v}d.val(a.paperId||[]),e.todayChk.checked(!1),e.todayChk.fire("change"),e.startIpt.val(a.minTestTime||""),e.endIpt.val(a.maxTestTime||""),f.startIpt.val(s.trim(a.minGrade)||""),f.endIpt.val(s.trim(a.maxGrade)||""),g.val(a.departmentIdList),h.val(a.remark||"-1"),i.val(a.judgeType||"-1"),j.val(a.judgeStatusList),k.val(a.ifCheat||"-1"),l.val(a.cheatReason||"-1"),m.val(a.question||"-1"),n.startIpt.val(a.minSimilar||""),n.endIpt.val(a.maxSimilar||""),o.ipt.val(a.keyword||""),o.chk.checked(s.trim(a.union)?!0:!1),b.fixRemark(),b.fixCheat()}function g(){var a=this,b=a.val(),c=b.minGrade,d=b.maxGrade,e=b.minSimilar,f=b.maxSimilar;return c&&!d||!c&&d?(y.alert("请填写完成的成绩区间"),!1):c&&!u.id(c)||d&&!u.id(d)?(y.alert("成绩区间必须为数值"),!1):e&&!f||!e&&f?(y.alert("请填写完成的相似度区间"),!1):e&&!u.id(e)||f&&!u.id(f)?(y.alert("相似度区间必须为数值"),!1):e&&.8>+e||f&&+f>1?(y.alert("相似度区间只允许输入0.8到1之间的小数"),!1):!0}function h(){var a=this,b=a.rawConfig;a.check()&&b.submit()}function i(){var a=this,b=a.filter,c=b.getItem("grade"),d=c.startIpt,e=c.endIpt,f=a.db.get("grade")||[];if(0!==f.length){var g=d.getEl().outerWidth()-2,h=z.show({input:d.inputEl,attach:{extOffset:{left:-1}},needSame:!1,reqList:function(b,c){var d=a.db.get("grade")||[];c&&c(d)},getItemStr:function(a){return x.execTpl('<li class="js-item" data-id="#{_sid}" style="min-width:#{width}px;"><a href="javascript:void(0);">#{min} - #{max}</a></li>',{_sid:a._sid,width:g,min:a.min,max:a.max})},ok:function(a){d.val(a.min),e.val(a.max)}});a.pushChild(h)}}function j(){var a=this,b=a.filter,c=b.getItem("paper"),d=b.getItem("remark"),e=c.val();a.fetchData(e,"remark",function(a){var b=u.map(a,function(a){return{text:a,value:a}});0===b.length&&(b=[{text:"不限",value:"-1",checked:!0}]),d.replaceOptions(b)})}function k(){var a=this,b=a.filter,c=b.getItem("ifCheat"),d=b.getItem("cheatReason"),e=b.getItemEl("cheatReason"),f=b.getItemEl("cheatQuestion"),g=b.getItemEl("similar");if("1"===c.val()){e.show();var h="3"===d.val();f[h?"show":"hide"](),g[h?"show":"hide"](),h&&a.fixCheatOption()}else e.hide(),f.hide(),g.hide()}function l(){var a=this,b=a.filter,c=b.getItem("judge"),d=b.getItemConf("judgeFinish"),e=b.getItem("judgeFinish"),f=b.getItemEl("judgeFinish"),g=b.getItemConf("judgeProgress"),h=b.getItem("judgeProgress"),i=b.getItemEl("judgeProgress"),j=c.val(),k=e.val(),l={text:"无需分配",value:"-1",checked:!0},m={text:"待判题",value:"0",checked:!0},n={text:"部分题目已判题",value:"1",checked:!0},o={text:"已判题",value:"2",checked:!0},p={text:"待分配",value:"3",checked:!0},q={text:"无需人工阅卷",value:"4",checked:!0},r={"-11":[l,q,o],"-10":[p,m,n],"1-1":[l,m,o,p,n],11:[l,o],10:[m,p,n]}[j+k]||[],s=r.length>0,t="0"!==j;f[t?"show":"hide"](),d.condHide=!t,h.replaceOptions(r),i[s?"show":"hide"](),g.condHide=!s,b.updateCond()}function m(){var a=this,b=a.filter,c=b.getItem("paper"),d=b.getItem("cheatQuestion"),e=c.val();a.fetchData(e,"question",function(a){var b=u.map(a,function(a){return{text:a.title,value:u.id(a.id)}});0===b.length&&(b=[{text:"不限",value:"-1",checked:!0}]),d.replaceOptions(b)})}function n(a,b,c){function d(b){C.getCodingQuestionTitle({type:"GET",query:{paperIdList:0===a.length?void 0:a},call:b,error:b})}function e(b){D.getTestUserNotes({type:"GET",params:{paperId:a[0]||1},query:0===a.length?{allPaper:!0}:null,call:b,error:b})}var f=this,g=f.paperData=f.paperData||{};a.sort(function(a,b){return a-b});var h=b+(a.join("|")||"0");return g[h]?c&&c(g[h]):void("question"===b?d:e)(function(a){a&&a.data&&(g[h]=a.data),c&&c((a||{}).data||[])})}function o(a,b){return a.val()?a.val()+(b?" 00:00:00":" 23:59:59"):void 0}function p(a){var b=this,c=b.db,d=u.id(a.minGrade),e=u.id(a.maxGrade);if(e&&d){var f=c.get("grade")||[],g=u.find(f,function(a){return a.min===d&&a.max===e});g||(f.unshift({min:d,max:e}),f.length=Math.min(f.length,5),c.set("grade",f))}}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Base,v=(q.Num,q.Component),w=q.Db,x=q.Str,y=r.Popup,z=r.AttachSuggest,A=a("../../../../../component/filter/filter"),B=a("../../../../../component/department"),C=a("../../../../../action/testinfo"),D=a("../../../../../action/paper"),E=a("../../../../../core/siteConfig"),F=c.exports=t.create();t.mix(F,v,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter()}}]},{initialize:d,initFilter:e,val:f,check:g,submit:h,fixGrade:i,fixRemark:j,fixCheat:k,fixJudge:l,fixCheatOption:m,fetchData:n,wrapDuration:o,cache:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/index/index",["nc","cpn","../../cpn/navProject","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../../../../../component/navProject","../../../../../core/module","../../../../../util/util","../../../../../component/selectAll","../../../../../action/testinfo","../../../../../action/user","../../../../../component/table","./filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/department","../../../../../util/switch","./popupMarkCheat","./popupCancelCheat"],function(a,b,c){function d(a){var b=this;b.projectData=a,new B({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b.resetParam({projectId:a}),b.refresh()}})}function e(){var a=this,b=a.getEl(),c=['<div class="js-filter"></div>','<div class="com-content">','<div class="import-tool clearfix" style="padding:10px;">','<div class="import-census">','<div class="census-num">共有<span class="font-green js-student-count"></span>名考生</div>','<div class="form-group"><label class="control-label">每页显示</label><div class="control-group js-page-select"></div></div>',"</div>",'<div class="import-tool-bar">','<ul class="manage-hd-oprt" style="float:right;line-height:37px;">','<li class="manage-sub-oprt">','<i class="resume-ico8"></i>','<span class="manage-oprt-green">下载</span>','<span class="icon-angle-down"></span><span class="icon-angle-up"></span>',"<ul>",'<li class="js-batch-action" data-type="batchExcel" style="width:91px;">下载成绩Excel</li>','<li class="js-batch-action" data-type="batchPdf">导出报告PDF</li>',"</ul>","</li>",'<li class="manage-sub-oprt">','<i class="resume-ico10"></i>','<span class="manage-oprt-green">作弊判定</span>','<span class="icon-angle-down"></span><span class="icon-angle-up"></span>','<ul style="left:-9px;">','<li class="js-batch-action" data-type="batchMarkCheat" style="width:85px;">人工标记作弊</li>','<li class="js-batch-action" data-type="batchCancelCheat">批量取消作弊</li>',"</ul>","</li>","</ul>","</div>","</div>",'<div class="js-content" style="padding:0 0 100px;"></div>',"</div>"].join("");b.append(c),a.tableCpn=new G({renderTo:b.find(".js-content"),needSelect:!0,needFixHeader:!0,pageChange:function(b){a.goTop(),a.addParam({page:b}),a.fetchList(!1)}}),a.tableCpn.renderWait()}function f(a){{var b=this,c=b.getParam();b.getEl()}b.filter=new J({renderTo:b.getEl(".js-filter"),paper:a,department:b.departmentData,paperId:c.paperId,module:b,submit:function(){b.addParam({page:1}),b.fetchList(!0)}})}function g(){var a=this;a.pageSizeCpn=new z({renderTo:a.getEl(".js-page-select"),size:"xsmall",options:w.map([20,50,100],function(a,b){return{text:a,value:a,checked:0===b}}),change:function(){a.fetchList(!1)}})}function h(a,b){var c=this;if(!x.mark(a)){var d=c.getCond(),e=d.paperIds;if(e&&1===e.length){var f=c.getPaperById(e[0])||{};b.paperName=f.paperName||""}H.downloadTestNew(b),x.pause(a)}}function i(a,b){x.mark(a)||(H.downloadTestPDF(b),x.pause(a))}function j(a,b){var c=this,d=c.filter,e=c.tableCpn.selectAll,f=e.isSelectAll?e.totalCount-e.selectIds.length:e.selectIds.length,g=d.val();d.fetchData(g.paperId,"question",function(a){K.show({studentNum:f,questionOption:w.map(a,function(a){return{text:a.title,value:w.id(a.id)}}),reasonChoice:g.cheatReason,questionChoice:g.question,submit:function(a){var d=+a.reasonCode;b.cancelCheatType=d,b.cancelCheatQuestionId=3===d?a.questionCode:void 0,b.confirm=2,b.operation=a.markType,E.cancelCheatTest({type:"POST",body:b,call:function(a){var b=A.mask("请稍等...");I.getTaskProgress(!0,a.data.jobId,function(a){var d=a.end,e=a.content,f=(a.error,w.json(e));d&&(b.destroy(),f.notNeedCount>0?A.alert(f.msg||"操作成功",function(){c.fetchList(!0)}):A.tips(f.msg||"操作成功",function(){c.fetchList(!0)}))})},error:function(a){A.alert(a.msg)}})}})})}function k(a,b){var c=this,d=c.filter,e=c.tableCpn.selectAll,f=e.isSelectAll?e.totalCount-e.selectIds.length:e.selectIds.length,g=d.val();d.fetchData(g.paperId,"question",function(a){L.show({studentNum:f,questionOption:w.map(a,function(a){return{text:a.title,value:w.id(a.id)}}),reasonChoice:g.cheatReason,questionChoice:g.question,submit:function(a,d,e,f){a=+a,b.cancelCheatType=a,b.cancelCheatQuestionId=3===a?e:void 0,b.confirm=2,E.cancelCheatTest({type:"POST",body:b,call:function(b){var e=A.mask("撤销中...");I.getTaskProgress(!0,b.data.jobId,function(b){var g=b.end,h=b.content,i=(b.error,w.json(h));if(g){e.destroy();var j=i.totalCount-i.cancelCheatCount,k=j>0?"，其他"+j+"名无此作弊项，无须撤销":"",l=["本次共勾选考生",i.totalCount,"名，其中",i.cancelCheatCount,"名撤销【",3===a?d+"-"+f:d,"】作弊判定成功",k].join("");A.alert(l,function(){c.fetchList(!0)})}})},error:function(a){A.alert(a.msg)}})}})})}function l(a){var b=this,c=b.getEl(),d=b.getCond();a&&b.tableCpn.selectAll.clear(),b.tableCpn.renderWait(),D.getTests({params:{userId:b.getUserId()},body:d,call:function(a){b.lastData=a.data,b.renderList(a.data),u(".js-rank").removeClass("selected"),u("div[data-order-by="+d.orderBy+"]").find(".js-rank[data-order="+d.order+"]").addClass("selected")},error:function(a){"请选择作弊题目"===a.msg&&b.tableCpn.renderWait(a.msg),b.tableCpn.renderWait('出现错误，<a href="javascript:void(0);" class="js-error-refresh link-green">点击重试</a>'),c.find("a.js-error-refresh").one("click",function(){b.fetchList(!0)})}})}function m(a){var b=this,c=b.getEl(),d=b.tableCpn;if(c.find(".js-student-count").html(a.totalCount),0===a.totalCount)return d.renderNone("暂无候选人");var e={head:[{text:"姓名",width:"10%"},{text:"考号",width:"10%"},{text:"完成试卷",width:"15%"},{text:"完成时间",width:"15%",order:1},{text:"得分",order:2},{text:"排名",width:"5%"},{text:"作弊"},{text:"作弊原因",width:"10%"},{text:"判卷完毕",width:"10%"},{text:"",width:"10%"}],list:[]};w.forEach(a.datas,function(a){var c=a.bought,d=b.getNavUrl("paper",{action:"candidate/result/index",testId:a.id}),f=b.getNavUrl("paper",{action:"monit/pics",paperId:a.paperId,account:a.testUserKey}),g='<a href="javascript:void(0);" target="_blank" class="btn btn-default js-go-bought" title="去充值" data-price="#{price}">购买后查看</a>';g=a.bought?'<a href="#{url}" target="_blank" class="icon-file-alt js-tips" title="做题记录"></a><a href="#{monitUrl}" target="_blank" class="icon-camera js-tips js-url" title="考试截图"></a>':g;var h=[{text:'<a href="#{url}" target="_blank">#{userName}</a>',cls:"txt-left",data:{url:d,userName:(a.user||{}).displayName}},a.testUserKey,a.paperName,y.form(new Date(a.finishTime),"yyyy-MM-dd HH:mm"),c?'<span class="js-tips" title="试卷总分：'+a.paperScore+'分">'+(a.score||0).toFixed(1)+"</span>":"-",c?'<span class="js-tips" title="到场人数：'+a.paperOpenCount+'">'+a.numberRank+"</span>":"-",1===a.cheated?"是":"否",a.cheatReasonList.join("|"),'<span class="js-tips" title="'+(a.judgingTip||"")+'">'+(a.judged?"是":"否（"+a.notJudgedReason+")")+"</span>",{text:g,data:{url:d,monitUrl:f,price:a.price},cls:"com-btn-wrap"}];e.list.push({items:h,attr:{"data-id":w.id(a.id)}})}),d.updateHtml(e,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage})}function n(a,b){var c=this;F.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getProjectId(),entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,w.isFunction(a)&&a(d)},error:function(a){w.isFunction(b)&&b(a.msg)}})}function o(a){var b=this;return a=w.id(a),w.find(b.allPaper,function(b){return w.id(b.id)===a})}function p(){var a=this,b=a.getParam();return w.id(b.projectId)}function q(a){var b=u(a).closest("tr");return u.trim(b.attr("data-id"))}function r(){var a=this,b=a.getParam(),c=a.filter.val(),d=a.getProjectId();return{projectIdList:"0"===d?H.getAllId(a.projectData):d,page:b.page||1,pageSize:a.pageSizeCpn.val()||20,word:c.keyword&&c.keyword.split(/\s+/),union:c.union,paperIds:c.paperId,orderBy:b.orderBy||0,order:b.order||2,testFinishBeginTime:c.minTestTime,testFinishEndTime:c.maxTestTime,minScore:c.minGrade,maxScore:c.maxGrade,note:c.remark,isCheated:c.ifCheat,cheatType:c.cheatReason,cheatQuestionId:c.question,minCheat:c.minSimilar,maxCheat:c.maxSimilar,judgeType:c.judgeType,judgeStatusList:c.judgeStatusList,departmentIdList:c.departmentIdList}}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Clazz,w=(s.Str,s.Base),x=s.Limit,y=s.Time,z=t.Select,A=(t.Tips,t.Popup),B=(t.Pager,a("../../cpn/navProject")),C=a("../../../../../core/module"),D=(a("../../../../../component/selectAll"),a("../../../../../action/api")),E=a("../../../../../action/testinfo"),F=a("../../../../../action/user"),G=a("../../../../../component/table"),H=a("../../../extend/bll/paper"),I=a("../../../extend/bll/task"),J=a("./filter"),K=a("./popupMarkCheat"),L=a("./popupCancelCheat"),M=c.exports=v.create();v.mix(M,C,{style:"/stylesheets/styles/system/scoreManage.css",showTask:!0,title:"成绩管理",_template:'<div class="com-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b),H.checkProject({all:!0,simple:!0,projectId:a.getProjectId(),call:function(c,d){a.getDepartment(function(){c="0"===w.id(c)?H.getAllId(d):c,H.getAllPaper({id:c,call:function(c){return b.html(""),a.allPaper=c,a.initNav(d),0===c.length?(b.append('<div class="js-paper-empty"></div>'),a.renderNone(b.find(".js-paper-empty"),"没有试卷")):(a.initContainer(),a.initFilter(c),a.initToolBar(),void a.filter.submit())}})},function(c){a.renderNone(b,c)})}})}},{name:"click a.js-rank",handler:function(a){var b=this,c=u(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:1,orderBy:e,order:f}),b.fetchList(!0))}},{name:"click .js-batch-action",handler:function(a){var b=this,c=u(a.currentTarget),d=u.trim(c.attr("data-type")),e=b.tableCpn.selectAll;if(!e.isSelectAll&&e.selectIds.length<=0)return A.alert("请先选择考生");if(d&&b[d]){var f={};f.isAll=e.isSelectAll?1:2,f.ids=e.selectIds,e.isSelectAll&&w.extend(f,b.getCond()),b[d](c,f)}}},{name:"click a.js-go-bought",handler:function(a){var b=this,c=u(a.currentTarget),d=c.attr("data-price"),e='<div style="font-size:14px;padding:20px 0;">考生未在邀请名单中，需支付考试费用<span class="font-red">'+d+"</span>元。您账户内余额不足，无法查看该考生成绩。现在去充值吗？</div>";new A({title:"余额不足",width:600,content:e,okTxt:"去充值",cancelTxt:"一会儿再充",listeners:{ok:function(){b.nav("purchase",{action:"recharge"})},cancel:function(){}}})}}]},{initNav:d,initContainer:e,initFilter:f,initToolBar:g,batchExcel:h,batchPdf:i,batchMarkCheat:j,batchCancelCheat:k,fetchList:l,renderList:m,getDepartment:n,getPaperById:o,getProjectId:p,getLineId:q,getCond:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/index/popupCancelCheat",["nc","cpn"],function(a,b,c){function d(a){a=a||{};{var b=new r(a);q.wrap(b,{title:"撤销作弊判定",content:b.html(),width:560,okTxt:"确定",cancelTxt:"取消",hasScroll:!0,ok:function(){var c=b.cpnHome,d=c.reason.val(),e=b.reasonValMap[d],f=c.question.val(),g=b.questionValMap[f];a.submit&&a.submit(d,e,f,g)},cancel:function(){}})}return b}function e(){}function f(){var a=this,b=a.rawConfig||{};a.reasonValMap={},a.questionValMap={};var c=a.reasonOption=[{text:"多IP登录",value:"1"},{text:"人工标记",value:"2"},{text:"代码相似度",value:"3"},{text:"截图异常",value:"5"},{text:"跳出次数过多",value:"6"},{text:"手机监控异常",value:"7"}];o.forEach(c,function(c){a.reasonValMap[c.value]=c.text,c.checked=c.value===(b.reasonChoice||"1")}),o.forEach(b.questionOption,function(c){a.questionValMap[c.value]=c.text,c.checked=c.value===b.questionChoice})}function g(){var a=this;a.cpnHome={},a.initReasonCpn(),a.initQuestionCpn()}function h(){var a=this;a.cpnHome.reason=new p({renderTo:a.getEl(".js-reason-cpn"),renderBy:"html",options:a.reasonOption,change:function(){a.renderQuestionShow()}})}function i(){var a=this,b=a.rawConfig.questionOption;a.cpnHome.question=new p({renderTo:a.getEl(".js-question-cpn"),renderBy:"html",needSearch:!0,options:b})}function j(a){var b=this,a=b.cpnHome.reason.val();b.getEl(".js-question-cpn").closest(".form-group")["3"===a?"show":"hide"]()}var k=a("nc"),l=a("cpn"),m=(k.$,k.Component),n=k.Clazz,o=k.Base,p=(k.Limit,l.Select),q=l.Popup,r=c.exports=n.create();n.mix(r,m,{_template:["<div>",'<div class="form-group" style="margin-bottom:15px; font-size:16px;margin-left:88px;">','您共勾选<span class="js-num"></span>名考生，需要取消的作弊判定为',"</div>",'<div class="form-group" style="margin-bottom:0px;margin-left:50px;">','<label class="control-label">作弊原因</label>','<div class="js-reason-cpn"></div>',"</div>",'<div class="form-group" style="display:none;margin-left:50px;">','<label class="control-label">作弊题目</label>','<div class="js-question-cpn"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.renderQuestionShow(),a.getEl(".js-num").html(a.rawConfig.studentNum)}}],show:d},{initialize:e,initData:f,initCpns:g,initReasonCpn:h,initQuestionCpn:i,renderQuestionShow:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/index/popupMarkCheat",["nc","cpn"],function(a,b,c){function d(a){a=a||{};{var b=new t(a);r.wrap(b,{title:"人工标记作弊",content:b.html(),width:560,okTxt:"确定",cancelTxt:"取消",hasScroll:!0,ok:function(){var c=b.cpnHome,d=c.reason.val(),e=c.question.val();a.submit&&a.submit({markType:c.markType.val(),reasonCode:d,reasonName:b.reasonValMap[d],questionCode:e,questionName:b.questionValMap[e]})},cancel:function(){}})}return b}function e(){}function f(){var a=this,b=a.rawConfig||{};a.reasonValMap={},a.questionValMap={};var c=a.reasonOption=[{text:"多IP登录",value:"1"},{text:"代码相似度",value:"3"},{text:"截图异常",value:"5"},{text:"跳出次数过多",value:"6"},{text:"手机监控异常",value:"7"}];p.forEach(c,function(c){a.reasonValMap[c.value]=c.text,c.checked=c.value===(b.reasonChoice||"1")}),p.forEach(b.questionOption,function(c){a.questionValMap[c.value]=c.text,c.checked=c.value===b.questionChoice})}function g(){var a=this;a.cpnHome={},a.initMarkType(),a.initReasonCpn(),a.initQuestionCpn()}function h(){var a=this;a.cpnHome.markType=s.mix({el:a.getEl(".js-mark-type label.radio")}),a.cpnHome.markType.val("1")}function i(){var a=this;a.cpnHome.reason=new q({renderTo:a.getEl(".js-reason-cpn"),renderBy:"html",options:a.reasonOption,change:function(){a.renderQuestionShow()}})}function j(){var a=this,b=a.rawConfig.questionOption;a.cpnHome.question=new q({renderTo:a.getEl(".js-question-cpn"),renderBy:"html",needSearch:!0,options:b})}function k(a){var b=this,a=b.cpnHome.reason.val();b.getEl(".js-question-cpn").closest(".form-group")["3"===a?"show":"hide"]()}var l=a("nc"),m=a("cpn"),n=(l.$,l.Component),o=l.Clazz,p=l.Base,q=(l.Limit,m.Select),r=m.Popup,s=m.CheckGroup,t=c.exports=o.create();o.mix(t,n,{_template:["<div>",'<div class="form-group" style="margin-bottom:15px; font-size:16px;margin-left:38px;">','您共勾选<span class="js-num"></span>名考生，请选择标记方式和原因',"</div>",'<div class="form-group js-mark-type">','<label class="control-label">标记方式</label>','<div class="control-group" style="width:380px;line-height:42px;">',"<div>",'<label class="radio"><input value="1">恢复系统作弊判定</label>','<span class="pop-fill-tips">用于恢复被取消的系统作弊判定</span>',"</div>","<div>",'<label class="radio"><input value="2">人工标记作弊</label>','<span class="pop-fill-tips" style="margin-left:28px;">用于新增作弊标记</span>',"</div>","</div>","</div>",'<div class="form-group" style="margin-bottom:0px;">','<label class="control-label">作弊原因</label>','<div class="js-reason-cpn"></div>',"</div>",'<div class="form-group" style="display:none;">','<label class="control-label">作弊题目</label>','<div class="js-question-cpn"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.renderQuestionShow(),a.getEl(".js-num").html(a.rawConfig.studentNum)}}],show:d},{initialize:e,initData:f,initCpns:g,initMarkType:h,initReasonCpn:i,initQuestionCpn:j,renderQuestionShow:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rAverage",["nc","../../../../../../action/testResult","../../../../../../util/ajax","cpn","./rBase","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),j.getAvgScoreSummary({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||[])},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);if(0===a.length)return b.destroy();var d=a.apiNormalScoreList;if(0===d.length)return c.html(["<table>","<thead><tr><th>题型</th><th>刷题</th><th>通过</th><th>正确率</th></tr></thead>",'<tbody><tr><td colspan="5">没有数据</td></tr></tbody>',"</table>"].join(""));var e=[],f=['<div class="examinee-count js-chat" style="width:18%">&nbsp;</div>','<table style="width:78%">',"<thead><tr><th>题型</th><th>刷题</th><th>通过</th><th>正确率</th></tr></thead>","<tbody>"].join("");i.forEach(d,function(a){f+=h.execTpl("<tr><td>#{tagName}</td><td><span>#{doneCount}</span></td><td>#{rightCount}</td><td>#{rightPercent}%</td></tr>",a)}),i.forEach(a.skillGraphList,function(a){a.displayValue=100*a.displayValue,e.push({name:a.tagName+"\n("+a.displayValue.toFixed(1)+"/"+a.fullValue+")",min:-100,max:100,value:a.displayValue})}),f+="</tbody></table>",c.html(f),b.renderRadar({el:c.find("div.js-chat"),value:e})}var f=a("nc"),g=(f.$,f.Clazz),h=f.Str,i=f.Base,j=a("../../../../../../action/testResult"),k=a("./rBase"),l=c.exports=g.create();g.mix(l,k,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>牛客网平时成绩</h1></div>','<div class="report-bd js-content">',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rBase",["nc","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(){}function e(){}function f(a){var b=this;b.renderWait(a,'<a href="javascript:void(0);" class="link-green js-reload">加载失败，点击重试</a>')}function g(a){var b=m(a.el),c=b.outerWidth();b.outerWidth(c).outerHeight(Math.max(b.outerHeight(),c,200)),b.html(""),q.loadEcharts(function(){var c=+a.value||0,d=+a.total||1,e=m.trim(a.text),f=m.trim(a.valueColor)||"#21a88b",g=m.trim(a.totalColor)||"#ddd",h=Math.min(b.width(),b.height()),i=Math.round(h/2-10),c=100*c/d,j=100-c,k={series:[{type:"pie",clockWise:!1,hoverAnimation:!1,animation:!1,radius:[i-10,i],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1},color:f}},data:[{value:j,itemStyle:{normal:{color:g,label:{formatter:e,show:!0,position:"center",textStyle:{baseline:"middle",color:"#333",fontSize:14,fontWeight:"normal"}}},emphasis:{color:g}}},{value:c,name:"invisible"}]}]},l=window.echarts.init(b.get(0));l.setOption(k)},s)}function h(a){var b=this,c=m(a.el),d=c.outerWidth();return c.outerWidth(d).outerHeight(Math.max(c.outerHeight(),d,200)),c.html(""),a.value&&0!==a.value.length?void q.loadEcharts(function(){var b=[],d=[];p.forEach(a.value,function(a){var c=m.trim(a.name),e=+a.max||100,f=+a.min||0,g=+a.value||0;b.push({text:c,min:f,max:e}),d.push(g)});var e={calculable:!1,polar:[{indicator:b,radius:"50%",splitNumber:5,type:"circle",name:{formatter:"{value}",textStyle:{color:"#333"},interval:0}}],series:[{type:"radar",animation:!1,data:[{value:d,itemStyle:{normal:{areaStyle:{color:"rgba(33, 168, 139, 0.5)",type:"default"},color:"#21a88b",lineStyle:{width:1}}}}]}]},f=window.echarts.init(c.get(0));f.setOption(e)},s):b.renderWait(c,"没有图表数据")}function i(){var a=this,b=a.rawConfig;return b.test}function j(){var a=this,b=a.rawConfig;return b.module}function k(){return q.renderWait.apply(q,arguments)}var l=a("nc"),m=l.$,n=l.Component,o=l.Clazz,p=l.Base,q=a("../../../../../../util/util"),r=c.exports=o.create(),s="//static.nowcoder.net/lib/echarts-plain.js";o.mix(r,n,{_template:'<div class="report-box"></div>',listeners:[{name:"click a.js-go-part",handler:function(a){var b=this,c=m(a.currentTarget),d=b.getModule(),e=m.trim(c.attr("data-dest"));e&&d.gotoIndexEl(e)}},{name:"click a.js-reload",handler:function(){var a=this;a.fetchData(function(){a.renderData.apply(a,arguments)})}}]},{fetchData:d,renderData:e,renderFail:f,renderCircle:g,renderRadar:h,getTest:i,getModule:j,renderWait:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rCheat",["nc","../../../../../../action/testResult","../../../../../../util/ajax","cpn","./rBase","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),k.getCheatInfoV2({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data)},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);var d="",d='<ul class="cheating-risk">';if(1===a.cheatInfo.markCheat){{var e=+a.leaveCount;+a.loginCount}d+=b._getItemHtml({title:"人工标记",danger:!0,items:[0===a.cheatInfo.markCheat?null:{title:(a.markCheatUser?a.markCheatUser.name:"")+"标记考生作弊"}]})}if(a.loginCount>1||3===a.multiIp){var f=j.map(a.loginAbnormalList,function(a){return a.address}).join("、");d+=b._getItemHtml({title:"多IP登录",danger:!0,items:[3===a.multiIp?{title:"人工标记（"+a.multiIpOperatorHrName+")"}:null,a.loginCount>1?{title:"考试过程中，考生链接在"+f+"同时登录"}:null,a.loginCount>1?{title:"登录地点",ext:a.loginCount+"个",danger:!0}:null]})}if(a.leaveCount>=3||3===a.jumpOut){var e=+a.leaveCount,g=e>10||3===a.jumpOut;d+=b._getItemHtml({title:g?"跳出过多":"离开页面",danger:g,items:[3===a.jumpOut?{title:"人工标记（"+a.jumpOutOperatorHrName+")"}:null,e>=3?{title:"考生离开页面"+e+"次"+(e>=3?"，跳出次数过多":"")}:null,e>=3?{title:"可能浏览其它网页，也可能是软件弹窗造成"}:null],btn:e>=3?'<a href="javascript:void(0);" class="link-green js-go-part" data-dest="leave">查看跳出记录</a>':null})}if((a.userHasNoPic||a.littlePic)&&(d+=b._getItemHtml({title:"未开启摄像头",danger:!0,items:[{title:a.userHasNoPic?"考生考试过程中未开启摄像头":"考生可能关闭摄像头，导致视频截图较少"}]})),(3===a.ctsPicAbnormal||a.markPicCheatCount>0)&&(d+=b._getItemHtml({title:"截图异常",danger:!0,items:[0===a.markPicCheatCount?null:{title:a.markPicCheatCount+"张截图，被人工标记作弊"},3===a.ctsPicAbnormal?{title:"人工标记（"+a.picOperatorHrName+")"}:null]})),(a.hasMultiFace||a.noFace||a.partNoFace)&&(d+=b._getItemHtml({title:"人脸异常",danger:!1,items:[a.noFace?{title:"截图中未检测到人脸，存在遮挡摄像头嫌疑"}:null,a.partNoFace?{title:"部分截图中未检测到人脸，有遮挡摄像头嫌疑"}:null,a.hasMultiFace?{title:"截图出现多个人脸，可能是考试环境造成"}:null]})),a.similarCodeInfoList&&a.similarCodeInfoList.length>0){var h=[],i=!1;j.forEach(a.similarCodeInfoList,function(a){0===a.artificialMark&&(i=!0),h.push({title:"编程题"+a.pos+(1===a.artificialMark?"被人工标记作弊（"+a.operatorHrName+")":""),ext:1===a.artificialMark?null:(100*a.prob).toFixed(1)+"%",danger:!0})}),d+=b._getItemHtml({title:"代码相似度",danger:!0,items:h,btn:i?'<a href="javascript:void(0);" class="link-green js-go-part" data-dest="similarity">查看详情</a>':null})}if(a.monitorPhone&&(1===a.monitorPhoneOff||a.monitorPhoneCloseCount>0||a.monitorPhoneLeaveCount>0||3===a.monitorPhoneOff)){var h=[],i=!1,k=!1;1===a.monitorPhoneOff?(h.push({title:"考试中始终未开启",danger:!0}),k=!0):3===a.monitorPhoneOff&&(h.push({title:"人工标记作弊（"+a.monitorPhoneOperatorHrName+")",danger:!0}),k=!0),a.monitorPhoneCloseCount>0&&(h.push({title:"未开启时间：共"+a.totalMonitorPhoneCloseMins+"分钟",danger:!0}),i=!0,k=!0),a.monitorPhoneLeaveCount>0&&(k=k||a.monitorPhoneLeaveCount>10,h.push({title:"手机跳出监控程序"+a.monitorPhoneLeaveCount+"次",danger:k}),i=!0),d+=b._getItemHtml({title:"手机监控",danger:k,items:h,btn:i?'<a href="javascript:void(0);" class="link-green js-go-part" data-dest="phoneLeave">查看详情</a>':null})}if(a.timeAbnormalList&&a.timeAbnormalList.length>0){var h=[];j.forEach(a.timeAbnormalList,function(a){h.push({title:"编程题"+a.pos,ext:b._formTime(+a.duration||0)+" | 平均"+b._formTime(+a.avgDuration||0),danger:!0})}),d+=b._getItemHtml({title:"编程用时异常",danger:!1,items:h})}+a.historyCheatCount>0&&(d+=b._getItemHtml({title:"历史信用",danger:!1,items:[{title:"参加考试",ext:a.historyTestCount+"次"},{title:"疑似作弊",ext:a.historyCheatCount+"次"},{title:"考试记录仅供参考"}]})),a.historyRankRisk&&(d+=b._getItemHtml({title:"成绩可信度",danger:!1,items:[{title:"参加考试",ext:a.historyTestCount+"次"},{title:"平均排名",ext:a.historyAvgRank+"%"},{title:"本次排名",ext:a.rank+"%"},{title:"考试记录仅供参考"}]})),c.html('<ul class="cheating-risk">'+d+"</ul>")}function f(a){return j.id(a)?60>a?a+"秒":Math.floor(a/60)+"分"+Math.floor(a%60)+"秒":""}function g(a){var b=['<div class="cheating-hd">',a.danger?'<div class="risk-high">高风险</div>':'<div class="risk-low">低风险</div>',"<h4>"+a.title+"</h4>","</div>"].join("");return b+='<div class="cheating-bd">',j.forEach(a.items,function(a){b+=a&&a.title?["<p>",a.title||"",a.ext?'<span class="risk-num '+(a.danger?"font-red":"")+'">'+a.ext+"</span>":"","</p>"].join(""):""}),b+="</div>",a.btn&&(b+='<div class="cheating-ft">'+a.btn+"</div>"),"<li>"+b+"</li>"}var h=a("nc"),i=(h.$,h.Clazz),j=h.Base,k=(h.Time,a("../../../../../../action/testResult")),l=a("./rBase"),m=c.exports=i.create();i.mix(m,l,{_template:['<div class="report-box js-cheat">','<div class="report-hd clearfix"><h1>作弊风险</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){b.showCheatRisk?a.renderData(b):a.destroy()})}}]},{fetchData:d,renderData:e,_formTime:f,_getItemHtml:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rCode",["nc","../../../../../../action/testResult","../../../../../../util/ajax","cpn","./rBase","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),k.getCodeAbility({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||[])},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);var d=a.detailedList,e='<div class="examinee-count js-chat" style="width:18%">&nbsp;</div>';e+='<table style="width:78%;"><thead><tr><th>题型</th><th>正确性</th><th>提交次数</th><th>做题用时</th><th>使用语言</th><th>运行时间</th><th>占用内存</th><th>编程思路</th><th>代码规范</th><th>成绩排名</th></tr></thead><tbody>',0===(d||[]).length?e+='<tr><td colspan="4">没有记录</td></tr>':i.forEach(d,function(a,b){e+=h.execTpl(["<tr>","<td>编程题#{pos}</td>",'<td><span class="font-green">#{rightRation}%</span></td>',"<td>#{submissionCount}</td>","<td>#{duration}</td>","<td>#{language}</td>","<td>#{runTime}</td>","<td>#{runMemory}</td>","<td>#{thoughDegree}</td>","<td>#{styleDegree}</td>","<td>#{rank}</td>","</tr>"].join(""),{pos:b+1,rightRation:a.totalCaseRation,submissionCount:0===+a.submissionCount?"-":a.submissionCount,duration:0===+a.submissionCount?"-":j.second(+a.timeCost||0),language:0===+a.submissionCount?"-":a.judgeLanguage,runTime:0===+a.submissionCount?"-":a.runTimeCost+"ms",runMemory:0===+a.submissionCount?"-":a.runMemoryCost+"KB",thoughDegree:0===+a.submissionCount?"-":5===a.codeThoughtScore?"优":a.codeThoughtScore>=4?"良":a.codeThoughtScore>=2?"中":"差",styleDegree:0===+a.submissionCount||0===a.styleScore?"-":5===a.styleScore?"优":a.styleScore>=4?"良":a.styleScore>=2?"中":"差",rank:+a.scoreRankPercentage>0&&+a.totalCaseRation>0?+a.scoreRankPercentage+"%":"-"},!0)}),e+="</tbody></table>",c.html(e);var f=a.avgRightScore||0,g=a.avgStyleScore||0,k=a.avgDoneQuestionTimeScore||0,l=a.avgCodeRunTimeScore||0,m=a.avgCodeThoughtScore||0;b.renderRadar({el:c.find("div.js-chat"),value:[{name:"正确性\n("+f.toFixed(1)+"/5.0)",max:5,min:-5,value:f},{name:"规范性\n("+g.toFixed(1)+"/5.0)",max:5,min:-5,value:g},{name:"速度\n("+k.toFixed(1)+"/5.0)",max:5,min:-5,value:k},{name:"代码效率\n("+l.toFixed(1)+"/5.0)",max:5,min:-5,value:l},{name:"思路\n("+m.toFixed(1)+"/5.0)",max:5,min:-5,value:m}]})}var f=a("nc"),g=(f.$,f.Clazz),h=f.Str,i=f.Base,j=f.Time,k=a("../../../../../../action/testResult"),l=a("./rBase"),m=c.exports=g.create();g.mix(m,l,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>编码能力</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rLeave",["nc","./rBase","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","cpn"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),k.getPermit({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||[])},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);if(0===a.length)return b.destroy();var d="<table><thead><tr><th>序号</th><th>时间</th><th>所在题目</th><th>记录</th></tr></thead><tbody>";h.forEach(a,function(a,b){var c=a.time?i.form(new Date(a.time)):"";d+="<tr><td>"+(b+1)+"</td><td>"+c+"</td><td>"+(a.questionTitle||"目录页")+"</td><td>"+a.reason+"</td></tr>"}),d+="</tbody></table>",c.html(d)}var f=a("nc"),g=(f.$,f.Clazz),h=f.Base,i=f.Time,j=a("./rBase"),k=a("../../../../../../action/testResult"),l=c.exports=g.create();g.mix(l,j,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>离开页面详情</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rMonit",["nc","./rBase","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","cpn","../../../util"],function(a,b,c){function d(a){var b=this,c=b.getTest();k.getPhotos({params:{testId:c.id},query:{num:20},call:function(b){a&&a(b.data||[])},error:function(){a&&a()}})}function e(a){var b=this,c=b.getModule(),d=b.getTest(),e=b.getEl("div.js-content");if(!a)return b.renderFail(e);var f='<ul class="screenshot-list">';0===a.length?f+='<li><img src="//uploadfiles.nowcoder.com/images/20160324/56_1458796958175_FB5C81ED3A220004B71069645F112867"></li>':(h.forEach(a,function(a){f+="<li"+(l.isDanger(a)?' class="danger"':"")+'><img src="'+j.fixUrlProtocol(a.url)+'"></li>'}),d.testUserKey&&(f+='<li class="list-show-all"><a href="'+c.getNavUrl("paper",{action:"monit/pics",account:d.testUserKey,paperId:d.paperId})+'" target="_blank"><p class="icon-plus"></p><p>查看全部</p></a></li>')),f+="</ul>",e.html(f)}var f=a("nc"),g=(f.$,f.Clazz),h=f.Base,i=a("./rBase"),j=a("../../../../../../util/util"),k=a("../../../../../../action/testResult"),l=a("../../../util"),m=c.exports=g.create();g.mix(m,i,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>监控截图</h1></div>','<div class="report-bd clearfix js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b.find("div.js-content")),a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rPhoneLeave",["nc","./rBase","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","cpn"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),k.getMonitorPhoneOffRecords({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||[])},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);if(0===a.length)return b.destroy();var d="<table><thead><tr><th>序号</th><th>详情时刻</th><th>持续时间</th></tr></thead><tbody>";h.forEach(a,function(a,b){var c=i.form(new Date(a.beginTime),"HH:mm:ss")+"-"+i.form(new Date(a.endTime),"HH:mm:ss"),e=a.diffSeconds<60?a.diffSeconds+"秒":Math.floor(a.diffSeconds/60)+"分钟";d+="<tr><td>"+(b+1)+"</td><td>"+c+"</td><td>"+e+"</td></tr>"}),d+="</tbody></table>",c.html(d)}var f=a("nc"),g=(f.$,f.Clazz),h=f.Base,i=f.Time,j=a("./rBase"),k=a("../../../../../../action/testResult"),l=c.exports=g.create();g.mix(l,j,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>手机监控离开页面详情</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rScore",["nc","./rBase","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","cpn"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),m.getScoreSummary({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||{})},error:function(){a&&a()}})}function e(a){var b=this,c=(b.getModule(),b.getTest(),b.getEl("div.js-content"));if(!a)return b.renderFail(c);var d=a.infos;if(0===d.length)return c.html(["<table>","<thead><tr><th>题型</th><th>得分</th><th>正确题数</th><th>排名</th><th>用时</th><th>是否阅卷</th></tr></thead>",'<tbody><tr><td colspan="6">没有数据</td></tr></tbody>',"</table>"].join(""));var e=['<div class="examinee-scores" style="width:50%;">','<div class="examinee-count js-chat-score" style="width:20%;">&nbsp;</div>','<div class="examinee-count js-chat-time" style="width:20%;">&nbsp;</div>','<div class="examinee-count js-chat-rank" style="width:20%;">&nbsp;</div>',"</div>",'<table style="width:49%;">',"<thead><tr><th>题型</th><th>得分</th><th>正确题数</th><th>排名</th><th>用时</th><th>是否阅卷</th></tr></thead>","<tbody>"].join("");j.forEach(d,function(a){var b=j.id(a.done);e+=i.execTpl("<tr><td>#{questionTypeName}</td><td><span>#{score}</span></td><td>#{rightCount}</td><td>#{rank}</td><td>#{time}</td><td>#{judged}</td></tr>",{questionTypeName:a.categoryTypeName,score:(+a.score||0).toFixed(1),rightCount:j.id(a.rightCount)||"-",rank:"0"===b||"0"===j.id(a.score)?"-":a.rank,time:"0"===b?"-":k.second(+a.time||0),judged:"0"===b?"-":a.needJudge?a.judged?'<span class="font-green">已阅</span>':'<span class="font-red">未阅</span>':"-"})}),e+="</tbody></table>",c.html(e),b.renderChat(a)}function f(a){var b=this,c=b.getEl(),d=+a.totalScore||0;b.renderCircle({el:c.find("div.js-chat-score"),value:d,total:+a.paperScore||1,text:d.toFixed(1)+"\n得分"});var e=+a.time||0;b.renderCircle({el:c.find("div.js-chat-time"),value:e,total:+a.paperTime||1,valueColor:"#7dc3e0",text:k.second(Math.floor(e/1e3))+"\n用时"});var f=+a.rank||0;b.renderCircle({el:c.find("div.js-chat-rank"),value:f,total:100,valueColor:"#d4cb6a",text:f+"%\n排名"})}var g=a("nc"),h=(g.$,g.Clazz),i=g.Str,j=g.Base,k=g.Time,l=a("./rBase"),m=a("../../../../../../action/testResult"),n=c.exports=h.create();h.mix(n,l,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>考生成绩</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e,renderChat:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rSimilarity",["nc","cpn","ncPlugin/highlighter/highlighter","../../../../../../action/testResult","../../../../../../util/ajax","../../../../../../action/testinfo","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","./rBase","../../../../../../util/util","../../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),p.getSimilarCode({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||{})},error:function(){a&&a()}})}function e(a){function b(a){var b=l.json(a),c='<pre class="prettyprint">';return b?c+k.encodeHTML(b.html)+"</pre>"+c+k.encodeHTML(b.css)+"</pre>"+c+k.encodeHTML(b.js)+"</pre>":c+k.encodeHTML(a)+"</pre>"}var c=this,d=c.getModule(),e=(c.getTest(),c.getEl("div.js-content"));if(!a)return c.renderFail(e);if(0===a.length)return c.destroy();var f="";l.forEach(a,function(a,c){f+=k.execTpl(['<table class="js-similar-item" data-question-id="#{questionId}" style="margin-top:',0===c?0:20,'px;">','<thead><tr><th colspan="4" class="fn-left">编程题#{pos}相似代码</th></tr></thead>',"<tbody>",'<tr><td style="width:25%;">相似代码来源考生：<a href="#{similarUrl}" class="js-similar" target="_blank">#{{userName}}</a></td><td style="width:25%;">相似度：#{pro}%</td><td style="width:25%;"><a href="javascript:void(0);" class="js-cancel-cheat" style="color:#25bb9b;">取消作弊判定</a></td><td style="width:25%;">通过时间提前：#{diffTime}</td></tr>',"<tr>",'<td colspan="4">','<dl class="similar-mod">',"<dt>本代码</dt>",'<dd class="js-code-home">#{thisCode}</dd>',"</dl>",'<dl class="similar-mod">',"<dt>相似代码</dt>",'<dd class="js-code-home">#{similarCode}</dd>',"</dl>","</td>","</tr>","</tbody>","</table>"].join(""),{questionId:a.questionId,pos:a.pos,userName:a.similarUserName,similarUrl:d.getNavUrl("paper",{action:"candidate/result/index",testId:a.similarTestId}),pro:(100*a.prob).toFixed(1),diffTime:m.second(+a.diffTime/1e3||0),thisCode:b(a.thisCode),similarCode:b(a.sourceCode)})}),f+="</tbody></table>",e.html(f),c.renderHeight(),o.init()}function f(){var a=this,b=a.getEl(".js-similar-item");l.forEach(b,function(a){a=i(a);var b=a.find(".js-code-home"),c=Math.max(i(b[0]).height(),i(b[1]).height());b.height(c)})}var g=a("nc"),h=a("cpn"),i=g.$,j=g.Clazz,k=g.Str,l=g.Base,m=g.Time,n=h.Popup,o=a("ncPlugin/highlighter/highlighter"),p=a("../../../../../../action/testResult"),q=a("../../../../../../action/testinfo"),r=a("../../../../extend/bll/task"),s=a("./rBase"),t=c.exports=j.create();j.mix(t,s,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>异常代码相似度</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}},{name:"click .js-cancel-cheat",handler:function(a){var b=this,c=i(a.target),d=c.closest("table").attr("data-question-id"),e=b.getTest(),f=n.mask("请稍等...");q.cancelCheatTest({type:"POST",body:{isAll:2,ids:e.id,confirm:1,cancelCheatType:3,cancelCheatQuestionId:d},call:function(a){r.getTaskProgress(!0,a.data.jobId,function(a){{var c=a.end,d=a.content,e=a.error;l.json(d)}return c?(f.close(),void n.tips("操作成功",function(){b.fire("refreshPage")})):void(e&&n.alert(d))})},error:function(a){n.alert(a.msg)}})}}]},{fetchData:d,renderData:e,renderHeight:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rSkill",["nc","./rBase","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","cpn"],function(a,b,c){function d(a){var b=this,c=b.getTest();b.renderWait(b.getEl("div.js-content")),m.getTagSkill({type:"GET",params:{testId:c.id},call:function(b){a&&a(b.data||{})},error:function(){a&&a()}})}function e(a){var b=this,c=b.getModule(),d=(b.getTest(),b.getEl("div.js-content"));if(0===(a||[]).length)return d.html(["<table>","<thead><tr><th>知识点</th><th>得分</th><th>正确题数</th></tr></thead>",'<tbody><tr><td colspan="3">没有数据</td></tr></tbody>',"</table>"].join(""));var e=['<div class="examinee-scores js-skill-progress" style="width:50%;">&nbsp;</div>','<table style="width:49%;">',"<thead><tr><th>知识点</th><th>得分</th><th>正确题数</th></tr></thead>","<tbody>"].join("");k.forEach(a,function(a){k.id(a.done);e+=j.execTpl("<tr><td>#{tagName}</td><td><span>#{score}</span></td><td>#{rightCount}</td></tr>",{tagName:a.tagName,score:(+a.score||0).toFixed(1),rightCount:k.id(a.rightCount)||"-"})}),e+="</tbody></table>",d.html(e),b.renderChat(a),c.bindWinResize(function(){b.fixSize()})}function f(a){var b=this,c=b.getEl(),d=c.find(".js-skill-progress"),e=k.map(a,function(a){return j.execTpl(['<li style="margin-bottom:10px;">','<span class="data-progress-name" style="float:left;">#{tagName}</span>','<div class="data-progress-box" style="display: block; margin-left: 10em;">','<span class="data-progress-txt">#{rightCount}/#{totalQuestionCount}</span>','<div class="data-progress-bg js-item" style="margin-right: 112px;">','<div class="data-progress-bar" style="width:#{progress}%;"></div>',"</div>","</div>","</li>"].join(""),{tagName:a.tagName,rightCount:k.id(a.rightCount)||"-",totalQuestionCount:k.id(a.totalQuestionCount)||"-",progress:a.rightCount&&a.totalQuestionCount?100*a.rightCount/a.totalQuestionCount:0})}).join("");d.html('<ul class="progress-status-list js-item-home" style="font-size:14px;">'+e+"</ul>"),b.fixSize()}function g(){var a=this,b=a.getEl(),c=b.find(".js-skill-progress"),d=c.find(".data-progress-box"),e=Math.max(c.width()-parseFloat(d.css("marginLeft"))-20,150);d.width(e)}var h=a("nc"),i=(h.$,h.Clazz),j=h.Str,k=h.Base,l=(h.Time,a("./rBase")),m=a("../../../../../../action/testResult"),n=c.exports=i.create();i.mix(n,l,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>技能图谱</h1></div>','<div class="report-bd js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){a.renderData(b)})}}]},{fetchData:d,renderData:e,renderChat:f,fixSize:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/rSummary",["nc","../../../../../../util/util","../../../../../../core/siteConfig","./rBase"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.rawConfig,d=c.test,e=l.fixUrlProtocol(d.headUrl);e&&b.find(".js-avatar").attr("src",e);var f=b.find(".js-name");f.html(h.trim(d.name)||"没有姓名信息"),b.find("div.js-conclude").html(h.trim(d.review)),d.paperSimulation&&b.find("div.js-conclude").hide(),a.renderItem(d),a.renderOverallEvaluate(d)}function e(a){var b=this,c=b.getEl(),d=[],e=[];j.forEach(a.signUpFields,function(a){"true"===a.required?"姓名"!==a.title&&d.push(a):d.push(a)}),1!==a.cheated||a.paperSimulation||c.find(".js-cheat-logo").show();var f="";j.forEach(d.concat(e),function(b){var c=b.name;if("name"!==c){var d="key"===c||"name"===c,e=h.trim(d?a[c]:(a.userExt||{})[c]);f+="<span>"+b.title+"："+(e||"没有信息")+"</span>"}}),f+="<span>参考地区："+(a.ipAddress?a.ipAddress+"（"+a.ip+"）":a.ip||"没有信息")+"</span>",f+="<span>做题用时："+k.second(+a.elapseTime||0)+"</span>",c.find("div.js-detail").html(f)}function f(a){var b=this,c="",d="",e={},f=b.getEl(".js-remark");j.forEach(a.remarkList,function(a){if(0===a.questionId)return void(c+=a.userName+"："+a.remark+"<br>");var b=e[a.uid]=e[a.uid]||[];b.push(a)}),j.forEach(e,function(a){var b=a[0].userName+"：";j.forEach(a,function(c,d){b+=["（",c.questionIdx,"）备注：",c.remark,d===a.length-1?"<br>":"；"].join("")}),d+=b});var g=(c?"整体评价：<br>"+c+"<br>":c)+(d?"各题目备注：<br>"+d:d);f.html(g),f[g?"show":"hide"]()}var g=a("nc"),h=g.$,i=g.Clazz,j=g.Base,k=g.Time,l=a("../../../../../../util/util"),m=a("./rBase"),n=c.exports=i.create();i.mix(n,m,{_template:['<div class="report-box">','<div class="report-hd clearfix"><h1>考生信息</h1>','<i class="error-mark js-cheat-logo" style="display: none;"><img src="//uploadfiles.nowcoder.com/images/20170720/55_1500536757622_16E3D04BF34175EE58E2E7B373CA9528"  alt="">有作弊嫌疑</i></div>','<div class="report-bd">','<div class="examinee-info clearfix">','<div class="examinee-head"><img class="js-avatar" src="//uploadfiles.nowcoder.com/images/20160723/56_1469258463201_F8D58201856E4DC632535F3424E9E822"></div>','<div class="examinee-detail">','<div class="examinee-name js-name"></div>','<div class="examinee-items js-detail"></div>',"</div>","</div>",'<div class="examinee-conclude js-conclude"></div>','<p class="examinee-remarks js-remark"></p>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}}]},{initData:d,renderItem:e,renderOverallEvaluate:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/tCodePlayback",["nc","cpn","ncPlugin/highlighter/highlighter"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=b.item,d=c.doneQuestion,e=a.items=[],f=0!==d.id&&(c.doneAnswers||[]).length>0;if(a.submitId="",q.forEach(c.ctsCodePlaybacks,function(a){var b="12"===q.id(a.language),c=b?q.json(a.content,{}):{};e.push({id:q.key(),createTime:a.createdDate,content:b?[p.encodeHTML(c.html),p.encodeHTML(c.css),p.encodeHTML(c.js)]:[p.encodeHTML(a.content)]})}),f){var g={id:q.key(),isSubmit:!0,content:[]};a.submitId=g.id,e.push(g),q.forEach(c.doneAnswers,function(a){g.createTime=a.createTime,g.content.push(a.content)})}e.sort(function(a,b){return a.createTime-b.createTime});var h=e.length,i=0===h?0:e[0].createTime,j=0===h?0:e[h-1].createTime,k=j-i;q.forEach(e,function(b){b.timestamp=1>=h?"0分0秒":a.getDurationFormat(b.createTime-i),b.progress=1>=h?100:100*(b.createTime-i)/k}),a.itemMap=q.toMap(e,function(a){return{key:a.id,value:a}})}function e(){var a=this,b=a.getEl(),c=a.items,d=c.length;if(0===d||1===d&&a.submitId)return a.renderContent(b,c[0]);var e=c[d-1],f=q.map(c,function(a){return p.execTpl(['<div class="nk-slider-button-wrapper gray js-item" style="left:#{progress}%;" data-id="#{id}">','<div class="nk-slider-button nk-tooltip js-tips" title="#{title}" style="#{extStyle}"></div>',"</div>"].join(""),{id:a.id,progress:a.progress,extStyle:a.isSubmit?"background:#25bb9b":"",title:r.form(new Date(a.createTime))+(a.isSubmit?" 提交运行":"")})}).join("");b.html(['<div role="slider" class="nk-slider">','<div class="nk-slider-runway">','<div class="nk-slider-bar" style="width:0%;left:0%;"></div>',f,'<div class="nk-slider-button-wrapper js-main-button" style="display:none;"><div class="nk-slider-button nk-tooltip"></div></div>',"</div>",'<div class="nk-slider-txt"><span class="js-timestamp"></span>/'+e.timestamp+"</div>","</div>",'<div class="js-code-content"></div>'].join("")),a.renderItemById(a.submitId||c[d-1].id)}function f(){function a(a){var b=q.find(c,function(b){return a>=b.progress},!0);return 0===b.length?c[0]:b[b.length-1]}var b=this,c=b.items;if(!(c.length<=1)){var d=b.getEl(),e=d.find(".nk-slider-runway"),f=e.find(".nk-slider-bar"),g=e.find(".js-main-button"),h=e.outerWidth(),i=g.outerWidth()/2,j=null;new u({drag:g,listeners:[{name:"start",handler:function(){this.startLeft=t.getPosLeft(g,e)+i}},{name:"drag",handler:function(){var c=this.startLeft+this._moveX-this._downX,d=Math.max(0,Math.min(100,100*c/h));f.width(d+"%"),g.css("left",d+"%");var e=a(d);j!==e&&(j=e,b.renderItem(e,!0))}},{name:"drop",handler:function(){b.renderItem(j)}}]})}}function g(a,b){var c=this;c.renderItem(a?c.itemMap[a]:null,b)}function h(a,b){{var c=this,d=c.getEl();c.items}if(c.renderContent(d.find(".js-code-content"),a),a){var e=d.find(".js-main-button");d.find(".js-timestamp").html(a.timestamp),e.show(),b||(d.find(".nk-slider-bar").width(a.progress+"%"),e.css("left",a.progress+"%"))}}function i(a,b){return b?(a.html(q.map(b.content,function(a){return'<div class="coding-main"><pre class="prettyprint">'+(a||"")+"</pre></div>"}).join("")),void v.init()):a.html('<div class="coding-main">空</div>')}function j(a){var b=r.second2data(a/1e3),c=1440*b.day+60*b.hour+b.min;return(c>0?c+"分":"")+s.form(b.second)+"秒"}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Component,o=k.Clazz,p=k.Str,q=k.Base,r=k.Time,s=k.Num,t=k.Dom,u=k.DragDrop,v=(l.PopupImage,a("ncPlugin/highlighter/highlighter")),w=c.exports=o.create();o.mix(w,n,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initContent(),a.initDragDrap()}},{name:"click .js-item",handler:function(a){var b=this,c=m(a.currentTarget),d=m.trim(c.attr("data-id"));d&&b.renderItemById(d)}}]},{initData:d,initContent:e,initDragDrap:f,renderItemById:g,renderItem:h,renderContent:i,getDurationFormat:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/component/type",["nc","cpn","ncPlugin/highlighter/highlighter","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/testResult","../../../../../../util/ajax","./tCodePlayback"],function(a,b,c){function d(a){var b=this;b.module=a.module}function e(a){var b=this,c=b.rawConfig;N.getQuestions({params:{testId:c.test.id},query:{type:c.type},call:function(b){var c={},d={},e=[];I.forEach(b.data,function(a){var b=a.question.id,f=a.question.parentId,g=f||b;g&&(c[f]=!!f,!d[g]&&e.push(g),d[g]=d[g]||[],d[g].push(a))});var f=0,g=[];I.forEach(e,function(a){f++,I.forEach(d[a],function(b,d){var e=c[a],h=b.question;e&&0===d&&g.push({question:{type:h.type,content:h.parentContent},multiIndex:f,isMulti:!0}),b.multiIndex=e?f+"-"+(d+1):f+"",g.push(b)})}),a&&a(g)},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function f(a){var b=H.execTpl(['<div class="question-box" style="border-bottom:0;padding-bottom:0;">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">#{content}</div>',"</div>","</div>"].join(""),{index:a.multiIndex,content:a.question.content});return b}function g(a){var b=this,c=b.getIsRight(a),d=b.getXZAnswer(a),e=H.execTpl(['<div class="question-box" #{style}>','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">','<span class="font-green">[#{type}|得分#{score}分/平均分#{avgScore}分|#{rightCount}人正确/#{totalCount}人做题|用时#{elapseTime}]</span> ',"<span>#{content}</span>","</div>",'<div class="option-list">#{option}</div>',"</div>",'<div class="answer-main">','<div class="answer-item"><span>他的回答：</span><span class="#{cls}">#{answer}(#{tips})</span></div>','<div class="answer-item"><span>正确答案：</span><span>#{right}</span></div>',"</div>",b.getRemark(a),b.getReference(a),"</div>"].join(""),{style:a.question.parentId?'style="margin-left:30px"':"",type:b.getTypeName(a),index:a.multiIndex,score:b.getScore(a),avgScore:b.getAvgScore(a),rightCount:b.getRightCount(a),totalCount:b.getTotalCount(a),elapseTime:b.getElapseTime(a),content:b.getContent(a),option:d.option,cls:c?"font-green":"font-red",tips:c?"正确":"错误",answer:d.answer.join(""),right:d.right.join("")});return e}function h(a){var b=this,c=b.getTKAnswer(a),d=b.getResultCode(a),e=H.execTpl(['<div class="question-box" #{style}>','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">','<div class="topic-item"><span class="font-green">[#{type}|得分#{score}分/平均分#{avgScore}分|#{rightCount}人正确/#{totalCount}人做题|用时#{elapseTime}]</span> <span>#{content}</span></div>',"</div>","</div>",'<div class="answer-main">','<div class="answer-item"><span>他的回答：#{tips}</span><div class="#{cls}">#{answer}</div></div>','<div class="answer-item"><span>正确答案#{answerMode}：</span><div>#{right}</div></div>',"</div>",b.getRemark(a),b.getReference(a),"</div>"].join(""),{style:a.question.parentId?'style="margin-left:30px"':"",type:b.getTypeName(a),index:a.multiIndex,score:b.getScore(a),avgScore:b.getAvgScore(a),rightCount:b.getRightCount(a),totalCount:b.getTotalCount(a),elapseTime:b.getElapseTime(a),content:b.getContent(a),tips:"0"===d?"(待定)":"1"===d?'<span class="font-green">(正确)</span>':"2"===d?'<span class="font-red">(错误)</span>':"",cls:"1"===d?"font-green":"2"===d?"font-red":"",answer:c.answer.join(""),answerMode:a.question.discardAnswerOrder?"（顺序可不一致）":"",right:c.right.join("")});return e}function i(a,b){var c=this;if(!a.doneQuestion||0===a.doneQuestion.id){var d=H.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">','<span class="font-green">[#{type}|得分#{score}分/平均分#{avgScore}分|#{rightCount}人正确/#{totalCount}人做题|提交#{submitCount}次]</span>',"<div>#{content}</div>","</div>","</div>",'<div class="answer-main">','<div class="answer-item" style="margin:0;">',"<span>他的代码：</span>",'<div class="js-code-panel-#{id}"><div style="text-align:center;">加载中...</div></div>',"</div>","</div>",c.getRemark(a),c.getReference(a),"</div>"].join(""),{id:a.question.id,type:c.getTypeName(a),index:a.multiIndex,score:c.getScore(a),avgScore:c.getAvgScore(a),rightCount:c.getRightCount(a),totalCount:c.getTotalCount(a),submitCount:c.getSubmitCount(a),content:c.getContent(a)});return d}var e='<div class="js-code-panel-'+a.question.id+'"><div style="text-align:center;">加载中...</div></div>',f=a.apiCodeStatistics;if(f){var g="";I.forEach(f.judgeResultStatistics,function(a){g+='<tr><td class="fn-left">'+a.judgeReply+"</td><td>提交"+a.submissionCount+"次</td></tr>"});var h='<div class="code-mod two-column last"><div class="code-hd">代码规范及可读性</div><div class="code-bd"><table>',i=0,j=f.codeStyleResult;if(j){f.styleScore>0&&(i++,h+=c.getCodeCheckTr("代码规范得分：&nbsp;"+f.styleScore.toFixed(1)+" / 5.0"));for(var k=0,l=Math.min(j.length,5);l>k;k++)i++,h+=c.getCodeCheckTr(j[k])}else{var m=!!{Java:1,"C++":1,C:1,Python:1}[f.judgeLanguage];h+=c.getCodeCheckTr(m?"规范检查任务还未完成":"暂不支持该语言"),i++}3>i&&(h+=new Array(3-i+1).join(c.getCodeCheckTr())),h+="</table></div></div>";var n=H.execTpl(['<div class="code-fragment-wrap">',"<h4>代码报告</h4>",'<div class="code-fragment clearfix">','<div class="code-mod three-column">','<div class="code-hd">功能实现</div>','<div class="code-bd">',"<table>","<tr><td></td><td>TA的</td><td>平均</td></tr>",'<tr><td class="fn-left">总通过率</td><td>#{totalCaseRation}%</td><td>#{avgTotalCaseRation}</td></tr>','<tr><td class="fn-left">基本测试用例通过率</td><td>#{baseCaseRation}%</td><td>#{avgBaseCaseRation}</td></tr>','<tr><td class="fn-left">边缘测试用例通过率</td><td>#{extraCaseRation}%</td><td>#{avgExtraCaseRation}</td></tr>',"</table>","</div>","</div>",'<div class="code-mod three-column">','<div class="code-hd">代码提交统计</div>','<div class="code-bd">',"<table>","<tr><td></td><td>TA的</td><td>平均</td></tr>",'<tr><td class="fn-left">使用语言</td><td>#{language}</td><td></td></tr>','<tr><td class="fn-left">做题用时</td><td>#{doneQuestionTime}</td><td>#{avgDoneQuestionTime}</td></tr>','<tr><td class="fn-left">提交次数</td><td>#{submissionCount}</td><td>#{avgSubmissionCount}</td></tr>',"</table>","</div>","</div>",'<div class="code-mod three-column last">','<div class="code-hd">代码执行统计</div>','<div class="code-bd">',"<table>",g,"</table>","</div>","</div>","</div>",'<div class="code-fragment clearfix">','<div class="code-mod two-column">','<div class="code-hd">代码效率</div>','<div class="code-bd">',"<table>","<tr><td></td><td>TA的</td><td>参考</td></tr>",'<tr><td class="fn-left">运行时间</td><td>#{timeConsumption}ms</td><td>#{avgTimeConsumption}s</td></tr>','<tr><td class="fn-left">占用内存</td><td>#{memoryConsumption}K</td><td>#{avgMemoryConsumption}K</td></tr>',"</table>","</div>","</div>",h,"</div>","</div>"].join(""),{totalCaseRation:f.totalCaseRation,avgTotalCaseRation:c.getExtStr(f.avgTotalCaseRation,"%","-"),baseCaseRation:f.basicCaseRation,avgBaseCaseRation:c.getExtStr(f.avgBasicCaseRation,"%","-"),extraCaseRation:f.extraCaseRation,avgExtraCaseRation:c.getExtStr(f.avgExtraCaseRation,"%","-"),language:f.judgeLanguage,doneQuestionTime:c.formTime(f.timeCost),avgDoneQuestionTime:c.formTime(f.avgTimeCost)||"-",submissionCount:f.submissionCount,avgSubmissionCount:c.getExtStr(f.avgSubmissionCount,"","-"),timeConsumption:f.runTimeCost,avgTimeConsumption:f.avgRunTimeCost,memoryConsumption:f.runMemoryCost,avgMemoryConsumption:f.avgRunMemoryCost})}var o=a.doneAnswers[0],d=H.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">','<span class="font-green">[#{type}|得分#{score}分/平均分#{avgScore}分|#{rightCount}人正确/#{totalCount}人做题|提交#{submitCount}次]</span>',"<div>#{content}</div>","</div>","</div>",n,'<div class="answer-main">','<div class="answer-item" style="margin:0;">',"<span>他的代码：</span>",'<div class="coding-status">',"<span>做题用时：#{elapseTime}</span>","<span>语言：#{language}</span>","timeConsumption"in o?"<span>运行时间：#{timeConsumption}ms</span>":"","memoryConsumption"in o?"<span>占用内存：#{memoryConsumption}K</span>":"",'<span class="#{cls}">程序状态：#{status}</span>',"</div>",e,"</div>","</div>",c.getRemark(a),c.getReference(a),"</div>"].join(""),{type:c.getTypeName(a),index:b+1,content:c.getContent(a),score:c.getScore(a),avgScore:c.getAvgScore(a),rightCount:c.getRightCount(a),totalCount:c.getTotalCount(a),submitCount:c.getSubmitCount(a),elapseTime:c.getElapseTime(a),language:o.language,timeConsumption:o.timeConsumption,memoryConsumption:o.memoryConsumption,cls:"答案正确"===o.status?"font-green":"font-red",status:o.status});return d}function j(a){var b=this,c="",d="";I.forEach(a.doneAnswers,function(a){c+="<p>"+a.userContent+"</p>",I.forEach(a.attachments,function(a){d+=H.execTpl('<div><div class="option-item">#{name}<a href="#{url}" target="_blank">下载</a></div></div>',a)})});var e=H.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item"><span class="font-green">[#{type}|得分#{score}分/平均分#{avgScore}分|#{rightCount}人正确/#{totalCount}人做题|用时#{elapseTime}]</span><div>#{content}</div></div>',"</div>",'<div class="answer-main">','<div class="answer-item" style="margin:0;"><span>他的回答：</span>',c,d,"</div>","</div>",b.getRemark(a),b.getReference(a),"</div>"].join(""),{type:b.getTypeName(a),index:a.multiIndex,score:b.getScore(a),avgScore:b.getAvgScore(a),rightCount:b.getRightCount(a),totalCount:b.getTotalCount(a),elapseTime:b.getElapseTime(a),content:b.getContent(a)});return e}function k(a){return"1"===I.id(a.doneQuestion.code)}function l(a){return I.id(a.doneQuestion.code)}function m(a){return M.getQuestionType(a.question.type)}function n(a){return(a.doneQuestion.score||0).toFixed(1)}function o(a){return(a.doneQuestion.avgScore||0).toFixed(1)}function p(a){return a.doneQuestion.rightCount||0}function q(a){return a.doneQuestion.totalCount||0}function r(a){return(a.doneQuestion.content.match(/:/g)||[]).length}function s(a){var b=this,c=Math.round(a.doneQuestion.duration||0);return b.formTime(c)}function t(a){var b=I.isArray(a.remarkList)?a.remarkList:[],c=0===b.length?"":['<div class="answer-main">',I.map(b,function(a){return a?'<div class="answer-item">'+a.userName+"备注："+a.remark+"</div>":""}).join(""),"</div>"].join("");return c}function u(a){var b=E.trim(a.question.referenceAnswer);return b=b?'<div class="suggest-answer open"><h2>参考答案：<span class="js-angle-action icon-angle-up" title="收起"></span><span class="js-angle-action icon-angle-down" title="展开"></span></h2><div>'+b+"</div></div>":""}function v(a){var b=a.question.content;if(a.question.contents){b="";var c=a.question.contents.length;I.forEach(a.question.contents,function(a,d){b+=a,b+=d+1===c?"":'<span class="blank-item">(<span class="blank-num">'+(d+1)+"</span>)</span>"})}return b}function w(a){var b="",c=[],d=[],e={};return I.forEach((a.doneQuestion.content||"").split(","),function(a){e[a]=1}),I.forEach(a.answers,function(a,f){1===a.type&&d.push(Q.charAt(f)),e[I.id(a.id)]&&c.push(Q.charAt(f)),b+=H.execTpl('<div><pre class="option-item"><span class="option-num">#{order}.</span>#{content}</pre></div>',{order:Q.charAt(f),content:a.content})}),{option:b,answer:c,right:d}}function x(a){var b=[],c=[];return I.forEach(a.doneAnswers,function(a,d){b.push("<div>("+(d+1)+'). <pre class="option-item">'+a.userContent+"</pre></div>"),c.push("<div>("+(d+1)+'). <pre class="option-item">'+a.content+"</pre></div>")}),{answer:b,right:c}}function y(a){return I.id(a)?60>a?a+"秒":Math.floor(a/60)+"分"+Math.floor(a%60)+"秒":""}function z(){var a=this;return a.module.renderWait.apply(a.module,arguments)}function A(a){return a=E.trim(a)||"&nbsp;",'<tr><td class="fn-left">'+a+"</td></tr>"}function B(a,b,c){return I.id(a)?a+(b||""):c}var C=a("nc"),D=a("cpn"),E=C.$,F=C.Component,G=C.Clazz,H=C.Str,I=C.Base,J=C.Limit,K=D.PopupImage,L=a("ncPlugin/highlighter/highlighter"),M=a("../../../../../../util/util"),N=a("../../../../../../action/testResult"),O=a("./tCodePlayback"),P=c.exports=G.create(),Q="ABCDEFGHIJKLMNOPQRSTUVWXYZ";G.mix(P,F,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig,d=I.id(c.questionType),e="renderType"+d;return a[e]?(a.renderWait(b),void a.initData(function(c){var f=I.map(c,function(b,c){return a[b.isMulti?"renderMulti":e](b,c)||""}).join("");b.html(f),"4"===d&&I.forEach(c,function(a){new O({renderTo:b.find(".js-code-panel-"+a.question.id),renderBy:"replaceWith",item:a})}),0===(c||[]).length&&a.renderWait.renderWait(b,"没有该题型的题目"),L.init()})):a.renderWait(b,"暂不支持查看该题型")}},{name:"click .js-angle-action",handler:function(a){var b=E(a.currentTarget),c=b.closest("div.suggest-answer"),d=c.find("div"),e=c.hasClass("open");J.mark(c)||d[e?"slideUp":"slideDown"](100,function(){c[e?"removeClass":"addClass"]("open"),J.clear(c)})}},{name:"click .answer-main img",handler:function(a){var b=E(a.currentTarget),c=E.trim(b.attr("src"));c&&K.show(c)}}]},{initialize:d,initData:e,renderMulti:f,renderType1:g,renderType2:g,renderType3:h,renderType4:i,renderType5:j,getIsRight:k,getResultCode:l,getTypeName:m,getScore:n,getAvgScore:o,getRightCount:p,getTotalCount:q,getSubmitCount:r,getElapseTime:s,getRemark:t,getReference:u,getContent:v,getXZAnswer:w,getTKAnswer:x,formTime:y,renderWait:z,getCodeCheckTr:A,getExtStr:B})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/candidate/result/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/navTab","./component/rSummary","./component/rBase","./component/rScore","../../../../../action/testResult","../../../../../util/ajax","./component/rSkill","./component/rCheat","./component/rLeave","./component/rPhoneLeave","./component/rSimilarity","ncPlugin/highlighter/highlighter","../../../../../action/testinfo","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","./component/rCode","./component/rAverage","./component/rMonit","../../util","./component/type","./component/tCodePlayback"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.getParam(),d=c.testId;return d?(a.renderWait(b),void D.getTest({type:"GET",params:{testId:d},call:function(c){a.test=c.data||{},a.isSimulation=a.test.paperSimulation||!1,b.html(""),a.initNav(),a.refreshCrumb()},error:function(c){a.renderWait(b,'<a href="javascript:void(0);" class="link-green js-all-reload">'+c.msg+"，点击重试</a>")}})):a.renderWait(b,"缺少参数")}function e(){var a=this,b=a.getEl(),c=a.getParam(),d=[{id:"index",title:"成绩报告"}],e={};o.forEach(a.test.categoryTypeList,function(a){var b=a.type;e[b]=a.questionType,d.push({id:o.id(b),title:a.title})}),a.navModule=new r({renderTo:b,current:m.trim(c.tab)||"index",tabs:d,select:function(b){a.addParam({tab:b});var c="index"===b;c&&a.goIndex(b),!c&&a.goType(b,e[b])}})}function f(){var a=this,b=(a.getEl(),a.showTabEl("index"));a.indexPart=a.indexPart||{};var c=[{cpn:s,name:"summary"},{cpn:t,name:"score"},{cpn:u,name:"skill"}];a.isSimulation||(c.push({cpn:v,name:"cheat"}),c.push({cpn:w,name:"leave"}),c.push({cpn:x,name:"phoneLeave"}),c.push({cpn:y,name:"similarity"}),c.push({cpn:A,name:"average"}),a.test.allowCamera&&c.push({cpn:B,name:"monit"})),a.test.hasCodeProblem&&c.push({cpn:z,name:"code"}),b&&o.forEach(c,function(c){var d=c.cpn,e=new d({renderTo:b,module:a,test:a.test,listeners:{refreshPage:function(){a.initData()}}});a.indexPart[c.name]=e})}function g(a,b){var c=this,d=(c.getEl(),c.showTabEl(a));d&&new C({renderTo:d,module:c,test:c.test,type:a,questionType:b})}function h(a){var b=this,c=b.indexPart[a];if(c){var d=c.getEl();p.scrollToEl({scrollEl:b.getSysWinEl(),el:d}),p.highLight({el:d})}}function i(a){var b=this,c=b.getEl();if(a=m.trim(a)){var d=!0,e=c.find(".js-tab.js-tab-"+a);return 0===e.length&&(e=m('<div class="js-tab js-tab-'+a+'" style="display:none;"></div>'),c.append(e),d=!1),c.find(".js-tab").hide(),d?e.slideDown(250):e.show(),d?null:e}}function j(){{var a=this,b=a.test;E.isInDev()}return b?{crumb:[{title:b.paperName,module:"paper",param:{action:"candidate/index/index",paperId:b.paperId}}],ext:[{html:'<a href="'+b.pdfUrl+'" target="_blank" class="btn btn-primary">下载PDF</a>'}]}:void 0}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Clazz,o=k.Base,p=k.Dom,q=(l.Popup,a("../../../../../core/module")),r=a("../../../../../component/navTab"),s=a("./component/rSummary"),t=a("./component/rScore"),u=a("./component/rSkill"),v=a("./component/rCheat"),w=a("./component/rLeave"),x=a("./component/rPhoneLeave"),y=a("./component/rSimilarity"),z=a("./component/rCode"),A=a("./component/rAverage"),B=a("./component/rMonit"),C=a("./component/type"),D=a("../../../../../action/testResult"),E=a("../../../../../util/util"),F=c.exports=n.create();n.mix(F,q,{style:"/stylesheets/styles/system/scoreReport.css",extStyle:["ncPlugin/highlighter/style/shCoreDefault.css"],title:"成绩报告",_template:'<div class="report-wrapper"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}},{name:"click a.js-all-reload",handler:function(){var a=this;a.initData()}}]},{initData:d,initNav:e,goIndex:f,goType:g,gotoIndexEl:h,showTabEl:i,getCrumbConf:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/copy/edit/index",["nc","cpn","../../add/step4/field","../../cpn/popupField","../../util","../../add/cpn/popupPaperList","../../../../../action/paper","../../../../../util/ajax","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../add/data","../../../../../component/steps","../../../../../core/module","../../../../../util/util","../../../../../util/switch","../../../../../action/user","../../../../../component/department"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.cpn={};new H({renderTo:b.find(".js-steps-wrap"),renderWith:"replaceWith",titles:["编辑试卷参数","完成"],current:1});var d=c.titleIpt=y.transform(b.find(".js-title"));d.getEl().width(d.inputEl.outerWidth());var e=c.durationIpt=y.transform(b.find(".js-duration"),{blur:function(){this.val(x.fix(this.val()))}});e.getEl().width(e.inputEl.outerWidth()),c.startDateIpt=y.transform(b.find(".js-start-date")),c.startTimeIpt=y.transform(b.find(".js-start-time")),c.endDateIpt=y.transform(b.find(".js-end-date")),c.endTimeIpt=y.transform(b.find(".js-end-time"));var f=[c.startDateIpt,c.startTimeIpt,c.endDateIpt,c.endTimeIpt];c.durationChk=z.transform(b.find(".js-forever"),{change:function(){var a=this.isChecked();u.forEach(f,function(b){b.disabled(a),b.setNone()})}}),u.forEach(f,function(b){var d=b===c.startDateIpt||b===c.endDateIpt,e=A.show({target:b.getEl(),ipt:b.inputEl,canShow:function(){return!b.isDisabled()},type:d?"date":"time",startDate:d?"now":void 0,endDate:d?A.yearDiff(8)+"-12-31":void 0,call:function(a,c){b.val(c)}});a.pushChild(e)}),c.department=new P({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",type:"selectMult",departmentData:a.departmentData,marginLeft:"-35px",gap:"20px",tip:"只有拥有参与管理的机构权限的账号可以进行管理试卷和添加考生的操作"}),c.department.getEl(".control-label").width(135),c.cheatCameraChk=z.transform(b.find(".js-cheat-camera")),c.cheatPhoneChk=z.transform(b.find(".js-cheat-phone")),c.cheatLeaveChk=z.transform(b.find(".js-cheat-leave")),c.cheatLeaveCodeChk=z.transform(b.find(".js-cheat-leave-code")),c.cheatQuestionChk=z.transform(b.find(".js-cheat-question")),c.cheatOptionChk=z.transform(b.find(".js-cheat-option")),c.codePlaybackChk=z.transform(b.find(".js-code-playback")),c.reportPlatformChk=z.transform(b.find(".js-report-platform")),c.judgeTkChk=z.transform(b.find(".js-judge-tk")),c.judgeWdChk=z.transform(b.find(".js-judge-wd")),c.judgeBcChk=z.transform(b.find(".js-judge-bc"));var g=[["paperAccessChk",".js-paper-access"],["paperQueueChk",".js-paper-queue"],["customerServiceChk",".js-customer-service"],["codingScoreChk",".js-coding-score"],["chooseScoreChk",".js-choose-score"],K.can("paperSimulation")?["ifSimulationChk",".js-if-simulation"]:null];u.forEach(g,function(a){a&&(c[a[0]]=new B({el:b.find(a[1])}))}),c.paperAccessChk.listen("change",function(){var a=this.val();c.field&&(c.field.valPublic("true"===a),C.alert("“考生录入信息”已经根据当前试卷类型进行重置，请注意检查"))}),c.passLineIpt=y.transform(b.find(".js-pass-line"),{blur:function(){this.val(x.fix(this.val()))}}),c.field=new E({renderTo:b.find(".js-field-container")}),c.noticeBeforeIpt=y.transform(b.find(".js-notice-before")),v.txtAutoHeight({el:c.noticeBeforeIpt.inputEl}),c.noticeAfterIpt=y.transform(b.find(".js-notice-after")),v.txtAutoHeight({el:c.noticeAfterIpt.inputEl}),u.forEach([c.cheatLeaveChk,c.cheatLeaveCodeChk],function(b){b.listen("change",function(){var b=c.noticeBeforeIpt.val(),d=a.fixNoticeBefore(b,c.cheatLeaveChk.isChecked(),c.cheatLeaveCodeChk.isChecked());d!==b&&c.noticeBeforeIpt.val(d)})})}function e(){var a=this,b=a.getEl(),c=D.show({target:b.find(".js-upload-cover"),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",url:J.getUploadUrl(1),call:function(b){var c=b.data;a.logoUrl=c,a.fixLogo(c)}});a.pushChild(c)}function f(a){var b=this,c=b.getWin().showLoading("请稍等...");O.copyPaper({params:{paperId:b.getPaperId()},body:a,call:function(a){var c=a.data;b.nav("paper",{action:"addStep5",paperId:c.id,type:"copy"})},statusCall:{1304:function(){return C.alert("该试卷名已被占用，为更好的进行试卷管理，请您更换为其他试卷名称。"),!1}},error:function(a){C.alert(a.msg)},always:function(){c.close()}})}function g(){var a=this,b=a.getParam();return u.id(b.paperId)}function h(a){var b=this,c=b.getEl(),d=b.getPaperId();return d?void O.getPaper({type:"GET",params:{paperId:d},call:function(c){var d=c.data;b.crumbTitle="复制试卷("+d.paperName+")",b.refreshCrumb(),a&&a(d)},error:function(a){b.renderWait(c,a.msg)}}):b.renderWait(c,"错误的参数")}function i(){var a=this;a.nav("paper",{action:"addManualOne"})}function j(){var a=this,b=a.cpn,c={paperName:s.trim(b.titleIpt.val())||null,duration:s.trim(b.durationIpt.val())||null,beginTime:s.trim(b.startDateIpt.val())+" "+s.trim(b.startTimeIpt.val()),endTime:s.trim(b.endDateIpt.val())+" "+s.trim(b.endTimeIpt.val()),forever:b.durationChk.isChecked(),logo:a.logoUrl||null,departmentIdList:b.department.val(),needCamera:b.cheatCameraChk.isChecked(),monitorPhone:b.cheatPhoneChk.isChecked(),needMessage:"true"===b.customerServiceChk.val(),allowNew:"true"===b.paperAccessChk.val(),noQueueUp:"false"===b.paperQueueChk.val(),antiJumpOut:b.cheatLeaveChk.isChecked(),antiCodingJumpOut:b.cheatLeaveCodeChk.isChecked(),questionDisorder:b.cheatQuestionChk.isChecked(),optionDisorder:b.cheatOptionChk.isChecked(),codePlayback:b.codePlaybackChk.isChecked(),allowCopy:!1,reportPlatform:b.reportPlatformChk.isChecked(),checkCheat:!0,codingScoreRule:+b.codingScoreChk.val(),chooseScoreRule:+b.chooseScoreChk.val(),mJudgeCompletion:b.judgeTkChk.isChecked(),mJudgeDesign:b.judgeWdChk.isChecked(),mJudgeCoding:b.judgeBcChk.isChecked(),beforeSummary:s.trim(b.noticeBeforeIpt.val())||null,endTips:s.trim(b.noticeAfterIpt.val())||null};K.can("paperPassLine")&&(c.passScoreLine=s.trim(b.passLineIpt.val())),K.can("paperSimulation")&&(c.simulation="1"===b.ifSimulationChk.val());var d=b.field.val();return u.extend(c,d),c}function k(a){var b=this,c=(b.getEl(),b.cpn);if(c.titleIpt.val(a.paperName||""),c.durationIpt.val(a.duration||""),a.beginTime){var d=a.beginTime.split(" ");c.startDateIpt.val(d[0]),c.startTimeIpt.val(d[1])}if(a.endTime){var d=a.endTime.split(" ");c.endDateIpt.val(d[0]),c.endTimeIpt.val(d[1])}c.durationChk.checked(!!a.forever),c.durationChk.fire("change"),b.fixLogo(a.logo||b.getWin().getUserByKey("headUrl")),c.department.val(a.departmentIdList),c.cheatCameraChk.checked(!!a.needCamera),c.cheatPhoneChk.checked(!!a.monitorPhone),c.cheatLeaveChk.checked(!!a.antiJumpOut),c.cheatLeaveCodeChk.checked(!!a.antiCodingJumpOut),c.cheatQuestionChk.checked(!!a.questionDisorder),c.cheatOptionChk.checked(!!a.optionDisorder),c.codePlaybackChk.checked(!!a.codePlayback),c.reportPlatformChk.checked(!!a.reportPlatform),c.judgeTkChk.checked(!!a.mJudgeCompletion),c.judgeWdChk.checked(!!a.mJudgeDesign),c.judgeBcChk.checked(!!a.mJudgeCoding),c.customerServiceChk.val(a.needMessage?"true":"false"),c.paperAccessChk.val(a.allowNew?"true":"false"),c.paperQueueChk.val(a.noQueueUp?"false":"true"),c.codingScoreChk.val("2"===u.id(a.codingScoreRule)?"2":"1"),c.chooseScoreChk.val("1"===u.id(a.chooseScoreRule)?"1":"2"===u.id(a.chooseScoreRule)?"2":"3"),c.noticeBeforeIpt.val(a.beforeSummary||U),c.noticeAfterIpt.val(a.endTips||V),K.can("paperPassLine")&&c.passLineIpt.val(a.passScoreLine),K.can("paperSimulation")&&c.ifSimulationChk.val(a.simulation?"1":"2"),K.can("paperSimulation")&&!K.can("paperOfficial")&&(c.ifSimulationChk.val("1"),u.forEach(c.ifSimulationChk.option,function(a){a.disabled(!0),a.getEl().on("click",function(){C.alert("该账号只能使用模拟卷")})})),c.field.val(a)}function l(){var a=this,b=a.getEl(),c=a.cpn,d=a.getData(),e=!0,f=!1;if(d.paperName||(c.titleIpt.setErrorTips("考试标题不能为空"),e=!1),d.duration||(c.durationIpt.setErrorTips("考试时长不能为空"),e=!1),!d.forever){var g=s.trim(c.startDateIpt.val()),h=s.trim(c.startTimeIpt.val()),i=s.trim(c.endDateIpt.val()),j=s.trim(c.endTimeIpt.val()),k=!0;if(w.checkDate(g)||(c.startDateIpt.setErrorTips("日期格式不正确"),k=!1),w.checkTime(h)||(c.startTimeIpt.setErrorTips("时间格式不正确"),k=!1),w.checkDate(i)||(c.endDateIpt.setErrorTips("日期格式不正确"),k=!1),w.checkTime(j)||(c.endTimeIpt.setErrorTips("时间格式不正确"),k=!1),k){var l=new Date(d.beginTime).getTime(),m=new Date(d.endTime).getTime();if(m<=(new Date).getTime()?(c.endDateIpt.setErrorTips("结束时间不能早于当前时间"),c.endTimeIpt.setError(),k=!1):l>=m&&(c.startDateIpt.setErrorTips("开始时间不能晚于结束时间"),c.startTimeIpt.setError(),c.endDateIpt.setError(),c.endTimeIpt.setError(),k=!1),k){var n=m-l,o=60*+d.duration*1e3;o>n&&(c.durationIpt.setErrorTips("考试时长必须小于等于试卷有效期，请修改考试时长或考试有效期"),k=!1)}}e=e&&k}return d.logo||(C.alert("请选择考试LOGO图片"),v.highLight({el:b.find("div.js-logo-container"),times:12}),f=!0,e=!1),d.keyTitle||(!f&&C.alert("考生录入信息必须选择两个必填信息"),v.highLight({el:b.find("div.js-field-container"),times:12}),e=!1),d.beforeSummary||(c.noticeBeforeIpt.setErrorTips("考前须知不能为空"),e=!1),d.endTips||(c.noticeAfterIpt.setErrorTips("考后说明不能为空"),e=!1),e}function m(a){var b=this,c=b.getEl(),d=c.find("div.paper-logo");d.find("img").attr("src",a||W),b.logoUrl=a}function n(a,b){var c=this;L.checkProject({force:!0,call:function(d){N.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:[d],entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,u.isFunction(a)&&a(d)},error:function(a){u.isFunction(b)&&b(a.msg)}})}})}function o(){return['<div class="js-steps-wrap"></div>','<div class="steps-detail">','<div class="detail-group">','<div class="form-group">','<a href="javascript:void(0)" class="upload-paper-set link-green js-load-paper"><i class="icon-download-alt"></i> 载入已有试卷设置</a>',"</div>",'<div class="form-group">','<label class="control-label">考试标题</label>','<div class="control-group js-title"><input type="text" placeholder="考试标题" /></div>',"</div>",'<div class="form-group">','<label class="control-label">考试时长/分钟</label>','<div class="control-group js-duration"><input type="text" placeholder="考试时长/分钟" /></div>',"</div>",'<div class="form-group">','<label class="control-label">试卷有效期</label>','<div class="control-group paper-term">','<div class="control-group js-start-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-start-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<span class="term-label">至</span>','<div class="control-group js-end-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-end-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<label class="checkbox js-forever">长期有效</label>',"</div>","</div>",'<div class="form-group js-logo-container">','<label class="control-label">考试LOGO图片</label>','<div class="control-group">','<div class="paper-logo"><img style="width:50px;height:50px;" src="',W,'"></div>','<div style="display:inline-block;position:relative;">','<a href="javascript:void(0);" class="link-green js-upload-cover">修改 (建议80px*80px)</a>',"</div>","</div>","</div>",'<div class="js-department-home"></div>',"</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">防作弊机制</label>','<div class="control-group">','<label class="checkbox js-cheat-camera">开启摄像头</label>','<label class="checkbox js-cheat-phone">开启手机监控 <span class="icon-question-sign js-tips" title="考生在考试中手机需持续开启考试监控小程序，如跳出打开其他应用会进行记录，杜绝使用手机作弊行为" data-theme="white"></span></label>','<label class="checkbox js-cheat-leave">禁止做题跳出页面（编程题除外）</label>','<label class="checkbox js-cheat-leave-code">禁止编程题跳出页面 <span class="icon-question-sign js-tips" title="编程题仅能在线作答，不支持线下编码，防作弊机制更严格，但会对编码体验有所影响" data-theme="white"></span></label>','<label class="checkbox js-cheat-question">题目乱序</label>','<label class="checkbox js-cheat-option">选择题选项乱序</label>','<label class="checkbox js-code-playback">代码回看 <span class="icon-question-sign js-tips" title="实时记录考生考试中的代码编写过程，可在成绩报告中回看不同时刻的代码" data-theme="white"></span></label>','<label class="checkbox js-report-platform">开启举报平台</label>',X,"</div>","</div>",'<div class="form-group">','<label class="control-label">人工判题题型</label>','<div class="control-group">','<label class="checkbox js-judge-tk">填空题</label>','<label class="checkbox js-judge-wd">问答题</label>','<label class="checkbox js-judge-bc">编程题</label>',"</div>","</div>","</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">试卷类型</label>','<div class="control-group">','<label class="radio js-paper-access"><input value="false" />私密，仅邀请可见</label>','<label class="radio js-paper-access"><input value="true"/>公开，所有人可见</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">在线客服窗口</label>','<div class="control-group">','<label class="radio js-customer-service"><input value="false"/>关闭</label>','<label class="radio js-customer-service"><input value="true"/>开启（仅VIP可用）<span class="icon-question-sign js-tips" title="本功能仅大规模考试（超过2000人次）可用，需开考前提前联系牛客客服团队:010-84873384" data-theme="white"></span></label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">排队发卷</label>','<div class="control-group">','<label class="radio js-paper-queue"><input value="false" />关闭</label>','<label class="radio js-paper-queue"><input value="true"/>开启（200人以上建议使用）</label>',X,"</div>","</div>",'<div class="form-group">','<label class="control-label">编程题计分规则</label>','<div class="control-group">','<label class="radio js-coding-score"><input value="1" />每题以多次提交中最高得分计分</label>','<label class="radio js-coding-score"><input value="2"/>每题以最后一次提交得分计分</label>',X,"</div>","</div>",'<div class="form-group">','<label class="control-label">多选题计分规则</label>','<div class="control-group">','<label class="radio js-choose-score"><input value="1" />少选错选不得分</label>','<label class="radio js-choose-score"><input value="2"/>错选不得分，少选得1/2分</label>','<label class="radio js-choose-score"><input value="3"/>错选不得分，少选得1/3分</label>',X,"</div>","</div>",K.can("paperPassLine")?['<div class="form-group">','<label class="control-label">及格分数线</label>','<div class="control-group js-pass-line"><input type="text" placeholder="及格分数线" /></div>',"</div>"].join(""):"",K.can("paperSimulation")?['<div class="form-group">','<label class="control-label">是否为模拟卷</label>','<div class="control-group">','<label class="radio js-if-simulation"><input value="2"/>否</label>','<label class="radio js-if-simulation"><input value="1"/>是</label>',"</div>","</div>"].join(""):"","</div>",'<div class="detail-group js-field-container"></div>','<div class="detail-group"><div class="form-group">','<label class="control-label">考前须知</label>','<div class="control-group js-notice-before"><textarea class="form-textarea"></textarea></div>',"</div></div>",'<div class="detail-group"><div class="form-group">','<label class="control-label">考后说明</label>','<div class="control-group js-notice-after"><textarea class="form-textarea"></textarea></div>',"</div></div>","</div>",'<div class="paper-btn-group">','<a class="btn btn-default js-go-pre" href="javascript:void" style="width:180px;">返回上一步</a>','<a class="btn btn-primary js-go-next" href="javascript:void" style="width:180px;">设置完毕，下一步</a>',"</div>"].join("")}function p(a,b,c){var d=a.replace(R,"#{cheatTips}").replace(S,"#{cheatTips}").replace(T,"#{cheatTips}"),e=b&&c?S:!b&&c?T:R,f=d.replace("#{cheatTips}",e);return f}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=q.Base,v=(q.Limit,q.Dom),w=q.Time,x=q.Num,y=r.Input,z=r.CheckBox,A=r.AttachDate,B=r.CheckGroup,C=r.Popup,D=r.AttachUpload,E=(r.SelectMult,r.Tips,a("../../add/step4/field")),F=a("../../add/cpn/popupPaperList"),G=a("../../add/data").add,H=a("../../../../../component/steps"),I=a("../../../../../core/module"),J=a("../../../../../util/util"),K=a("../../../../../util/switch"),L=a("../../../extend/bll/paper"),M=a("../../../extend/bll/serverTime"),N=a("../../../../../action/user"),O=a("../../../../../action/paper"),P=a("../../../../../component/department"),Q=c.exports=t.create(),R="考试中除编程题之外，其他考试页面不可跳出当前页面，前三次跳出会有提醒，之后将不再提醒。编程题支持本地IDE编码后复制粘贴至考试页面，不做跳出限制。",S="考试中全部题型（含编程题）不可跳出当前页面，只能在考试页面作答，前三次跳出会有提醒，之后将不再提醒。",T="考试中编程题不可跳出当前页面，只能在考试页面作答，前三次跳出会有提醒，之后将不再提醒。",U=["1、请使用最新版chrome浏览器作答（44版本以上），如考试需开启摄像头，请确保电脑带有摄像头。","2、"+R,"3、考试时允许使用草稿纸，请提前准备纸笔。考试过程中允许上厕所等短暂离开，但请控制离开时间。","4、考试期间如遇到断电、断网、死机等问题，可以关闭浏览器重新打开试卷链接即可继续做题。","5、遇到问题请即时反馈给考试主办方。"].join("\n"),V="本场考试已结束，请保持通讯畅通，方便接收后续通知",W="//uploadfiles.nowcoder.com/images/20160520/56_1463728821615_B856A5CA00C64BEA1A77436F8FE39D5E",X='<span class="choose-tips">考试开始后无法修改</span>';t.mix(Q,I,{style:"/stylesheets/styles/system/assemblePaper.css",title:"复制试卷",_template:'<div class="steps-main step2"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b),a.getPaper(function(c){a.getDepartment(function(){u.forEach("paperName,forever,beginTime,endTime".split(","),function(a){delete c[a]}),b.html(a.getModuleHtml()),a.initCpn(),a.initAvatar(),a.setData(G.paper2data(c))},function(c){a.renderNone(b,c)})})}},{name:"click .js-go-pre",handler:function(){var a=this,b=L.getCacheProjectId();a.nav("paper",{action:"project/paperList",projectId:b||"0"})}},{name:"click .js-go-next",handler:function(){function a(a){return a.forever?b.submit(a):void M.getTime(function(c){var d=new Date(a.beginTime).getTime()||0,e=Math.floor((d-c)/864e5);e>=15?C.confirm("考试将在"+e+"天后开始，确认组卷？",function(){b.submit(a)}):b.submit(a)})}var b=this,c=(b.getParam(),b.checkData());if(!c)return b.goTop();var d=b.getData();d.forever&&delete d.beginTime,d.forever&&delete d.endTime,L.checkProject({force:!0,call:function(b){d.projectId=b,a(d)}})}},{name:"click a.js-load-paper",handler:function(){var a=this;F.show({listeners:{ok:function(b){var c=G.paper2data(b);a.setData(c)}}})}}]},{initCpn:d,initAvatar:e,submit:f,getPaperId:g,getPaper:h,goBack:i,getData:j,setData:k,checkData:l,fixLogo:m,getDepartment:n,getModuleHtml:o,fixNoticeBefore:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/cpn/navProject",["nc","cpn","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject"],function(a,b,c){function d(){var a=this,b=a.rawConfig;new i({renderTo:a.getEl(),items:b.items,current:b.current,notAll:b.notAll,change:function(a){h.setCacheProjectId(a),b.change&&b.change(a)}})}var e=a("nc"),f=(a("cpn"),e.$,e.Clazz),g=(e.Base,e.Component),h=a("../../extend/bll/paper"),i=a("../../../../component/navProject"),j=c.exports=f.create();f.mix(j,g,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}}]},{initCpn:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/cpn/popupField",["nc","cpn","../util"],function(a,b,c){function d(a){{var b=new y(a);a.id,u.wrap(b,{title:"添加"+(a.isNeed?"必填":"选填")+"信息",width:720,content:b.html(),ok:function(){return b.check()?void(a.ok&&a.ok(b.val())):!0},cancel:function(){}})}return b}function e(a){var b=this;b.isNeed=!!a.isNeed,b.isOnlyIpt=!!a.onlyIpt,b.options=[]}function f(a){var b=this,c=b.getEl();b.nameIpt=v.transform(c.find(".js-name")),b.editChk=new w({el:c.find(".js-edit")}),b.typeChk=new w({el:c.find(".js-type")}),b.typeChk.listen("change",function(){var a=this.val();b.clearError(),b.listEl["0"===a?"hide":"show"]()}),c.find(".js-tab").on("click",function(a){var c="hr"===q.trim(q(a.currentTarget).attr("data-type"));b.valTab(c)}),a.noEditName&&b.nameIpt.disabled()}function g(a){var b=this,c=b.rawConfig,d=b.getEl(),e=!!b.isNeed,f=!!b.isOnlyIpt;if(0===arguments.length){var g=x.field2data(b.lastVal),h=q.trim(b.typeChk.val()),i=q.trim(b.editChk.val());return i=e||b.valTab()?"0":{1:"1",2:"2"}[i]||"1",h="0"===i||f?"0":{1:"1",2:"2"}[h]||"0",x.data2field({name:c.noEditName?g.name:q.trim(b.nameIpt.val()),format:g.format,type:h,options:t.map(b.options,function(a){return q.trim(a.val())}),edit:i})}b.lastVal=a;var g=x.field2data(a);b.nameIpt.val(g.name),b.editChk.val("2"===g.edit?"2":"1"),b.typeChk.val(e?"0":g.type,!0),b.valOptions(g.options),b.valTab(b.isNeed||"0"===g.edit),d.find(".js-container")[e?"hide":"show"](),b.isOnlyIpt&&(b.typeChk.val("0",!0),t.forEach(b.typeChk.option,function(a){a.disabled()}))}function h(a){var b=this,c=b.getEl(),d=c.find(".js-tab"),e=c.find(".js-info");return 0===arguments.length?c.find(".js-tab[data-type=hr]").hasClass("selected"):(e[a?"hide":"show"](),d.removeClass("selected"),void c.find(".js-tab[data-type="+(a?"hr":"user")+"]").addClass("selected"))}function i(a){var b=this,c=(b.optionEl,b.options);for(a.length=Math.max(a.length,2);c.length>a.length;)b.removeOption();for(;c.length<a.length;)b.addOption();t.forEach(a,function(a,b){c[b].val(q.trim(a))})}function j(){var a=this,b=a.options,c=a.val(),d=x.field2data(c),e="0"===d.type,f=!0;a.clearError(),d.name?d.name.length>18?(a.nameIpt.setErrorTips("名称不能超过18个字符"),f=!1):/[:_]/.test(d.name)&&a.nameIpt.setErrorTips("名称不能包含字符 : _"):(a.nameIpt.setErrorTips("名称不能为空"),f=!1),f=f&&d.name&&d.name.length<=18;var g={};return t.forEach(b,function(a,b){if(!e){var c=q.trim(a.val());c?/[:_\s]/.test(c)?(a.setErrorTips("选项不能包含 空格 : _"),f=!1):(g[c]=g[c]||[],g[c].push(b+1)):(a.setErrorTips("选项不能为空"),f=!1)}}),t.forEach(g,function(a){a.length>1&&(t.forEach(a,function(c){b[c-1].setErrorTips("选项"+a.join("、")+"内容相同")}),f=!1)}),f}function k(){var a=this;a.nameIpt.setNone(),t.forEach(a.options,function(a){a.setNone()})}function l(a){var b=this,c=(b.options,q(['<div class="form-group js-option">','<label class="control-label">选项1</label>','<div class="control-group with-remove-icon">','<input type="text" value="'+q.trim(a)+'" placeholder="输入选项"> ','<a href="javascript:void(0);" class="js-del icon-trash"></a>',"</div>","</div>"].join(""))),d=v.transform(c.find(".control-group"));b.optionEl.append(c),b.options.push(d),b.fixOption()}function m(a){var b=this,c=(b.getEl(),b.options),d=c.length;a=t.id(a)?+a:d-1,d>2&&d>a&&(c[a].getEl().closest(".js-option").remove(),c[a].destroy(),c.splice(a,1)),b.fixOption()}function n(){var a=this,b=a.options.length;t.forEach(a.options,function(a,c){var d=a.getEl().closest(".js-option");d.find("label.control-label").html("选项"+(c+1)),d.find(".js-del")[b>2?"show":"hide"]()})}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Component,s=o.Clazz,t=(o.Str,o.Base),u=(o.Dom,p.Popup),v=p.Input,w=p.CheckGroup,x=a("../util"),y=c.exports=s.create();s.mix(y,r,{_template:['<div class="pop-info-fill">','<div class="form-group">','<label class="control-label">名称</label>','<div class="js-name control-group">','<input type="text" placeholder="输入名称，不能超过18个字符"> ',"</div>","</div>",'<section class="pop-fill-wrapper js-container">','<div class="form-group">','<label class="control-label">填写要求</label>','<div class="control-group pop-fill-btnbox">','<a href="javascript:void(0);" class="btn btn-simple js-tab js-tips" data-type="hr" title="添加考生时由HR统一导入，且必须导入，考生不能修改该字段"><i class="pop-icon-import"></i>HR统一导入</a>','<a href="javascript:void(0);" class="btn btn-simple js-tab js-tips mark" data-type="user" title="考试时由考生填写或者从候选项中选择，常用于采集考生信息，支持从系统预先导入，考生可以修改"><i class="icon-pencil"></i>考生填写</a>',"</div>","</div>",'<div class="pop-filled-type js-info">',"<div>",'<label class="control-label">是否必填</label>','<div class="control-group">','<label class="radio js-edit"><input value="1">选填</label>','<label class="radio js-edit"><input value="2">必填</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">填写方式</label>','<div class="control-group">','<section class="fill-space-box">','<label class="radio js-type"><input value="0" />内容不限</label>',"</section>","<section>",'<label class="radio js-type"><input value="1" />固定选项 - 单选</label><br>','<label class="radio js-type"><input value="2" />固定选项 - 多选</label>',"</section>","</div>","</div>",'<div class="js-list">','<div class="js-options"></div>','<div class="form-group">','<a href="javascript:void(0);" class="js-add pop-fill-add link-green">+ 添加选项</a>',"</div>","</div>","</div>","</section>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.listEl=c.find(".js-list"),a.optionEl=c.find(".js-options"),a.delEl=c.find(".js-del"),a.initCpn(b),a.val(b.value||""),a.isNeed&&t.forEach(a.typeChk.option,function(a){"0"!==a.val()&&a.disabled()}),a.popup.fixPosition()}},{name:"click .js-del",handler:function(a){var b=this,c=q(a.currentTarget).closest(".js-option");b.removeOption(c.index())}},{name:"click .js-add",handler:function(){var a=this;a.addOption()}}],show:d},{initialize:e,initCpn:f,val:g,valTab:h,valOptions:i,check:j,clearError:k,addOption:l,removeOption:m,fixOption:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/cpn/popupProject",["nc","cpn","../../../../action/paper","../../../../util/ajax","../../../../component/department","../../../../util/switch","../../../../util/util","../../../../core/siteConfig","../../../../action/user"],function(a,b,c){function d(a){a=a||{};var b=p.id((a.project||{}).id)||"0",c=new u(a),d=r.wrap(c,{title:"0"!==b?"修改笔试项目":"新建笔试项目",width:600,cancelTxt:"取消",content:c.html(),ok:function(){return c.checkName(function(){c.submit(function(){d.close()})}),!0},cancel:function(){}});return c}function e(a){var b=this,c=b.val(),d=b.rawConfig.project||{},e=d.name||"",f=c.projectName,g=c.projectRemark;if(!f)return b.nameInput.setErrorTips("项目名字不能为空");if(f===e)return a&&a();if(f.length>20)return b.nameInput.setErrorTips("项目名字长度不能超过20字符");if(g.length>100)return b.remarkInput.setErrorTips("项目备注的长度不能超过100字符");var h={projectName:f};"0"===b.getId()||p.extend(h,{projectId:b.getId()}),s.checkProjectName({query:h,call:function(c){"1"===p.id(c.data)?b.nameInput.setErrorTips("名字已经存在"):a&&a()},error:a})}function f(){var a=this,b=a.getEl(),c=a.rawConfig.project||{};a.nameInput=new q({placeholder:"输入项目名称，不能超过20字符",renderTo:b.find(".js-project-name"),renderBy:"replaceWith",value:c.name||""}),a.nameInput.inputEl.on("keyup",function(){var b=m.trim(this.value);a.nameInput[b.length>20?"setErrorTips":"setNone"]("项目名字长度不能超过20字符")}),a.remarkInput=new q({placeholder:"输入项目备注，不能超过100字符",renderTo:b.find(".js-project-remark"),renderBy:"replaceWith",value:c.remark||""}),a.remarkInput.inputEl.on("keyup",function(){var b=m.trim(this.value);a.remarkInput[b.length>100?"setErrorTips":"setNone"]("项目备注的长度不能超过100字符")})}function g(){var a=this,b=a.rawConfig,c=b.project||{},d=a.department=new t({renderTo:a.getEl(".js-department"),renderBy:"replaceWith",type:"selectMult",marginLeft:"-55px",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以看见并管理该笔试项目",userId:b.userId,value:"0"===a.getId()?void 0:p.map(c.departmentList,function(a){return p.id(a.id)})});d.getEl(".control-label").width(135)}function h(a){var b=this,c=b.rawConfig,d=b.getId(),e="0"!==d;s[e?"updateProject":"addProject"]({type:e?"PUT":"POST",params:{projectId:d},body:b.val(),call:function(){r.tips(e?"修改成功":"创建成功"),a&&a(),c.call&&c.call()},error:function(a){r.alert(a.msg)}})}function i(){var a=this;return{projectName:m.trim(a.nameInput.val()),projectRemark:m.trim(a.remarkInput.val()),departmentIdList:a.department.val()}}function j(){var a=this,b=a.rawConfig.project||{};return p.id(b.id)||"0"}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Component,o=k.Clazz,p=k.Base,q=l.Input,r=l.Popup,s=(l.SelectMult,a("../../../../action/paper")),t=a("../../../../component/department"),u=c.exports=o.create();o.mix(u,n,{_template:["<div>",'<div class="form-group">','<label class="control-label">项目名称</label>','<span class="js-project-name"></span>',"</div>",'<div class="form-group">','<label class="control-label">项目备注</label>','<span class="js-project-remark"></span>',"</div>",'<div class="js-department"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initIpt(),a.initDepartment(),a.getEl().css("margin-left","70px")}}],show:d},{initIpt:f,initDepartment:g,checkName:e,submit:h,val:i,getId:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/cpn/popupProjectList",["nc","cpn","../../../../action/paper","../../../../util/ajax","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new p(a);return n.wrap(b,{title:a.title||"请选择项目",hasNoFooter:!1,content:b.html(),width:500,cancel:function(){},ok:function(){var c=b.val();a.ok&&a.ok(c)}}),b}function e(){var a=this;o.getAllProject({call:function(b){a.projectList=b,a.renderList(b),a.popup.fixPosition()}})}function f(a){var b=this,c=b.getEl();b.select=new m({renderTo:c.find(".js-content"),renderBy:"replaceWith",needSearch:(a||[]).length>5,options:l.map(a,function(a,b){return{text:a.name,value:a.id,checked:0===b}})})}function g(){var a=this,b=l.id(a.select.val());return l.find(a.projectList,function(a){return l.id(a.id)===b})}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=i.Select,n=i.Popup,o=(a("../../../../action/paper"),a("../../extend/bll/paper")),p=c.exports=k.create();k.mix(p,j,{_template:'<div><div style="text-align:center;font-size:14px;"><div  class="js-content">加载中...</div></div></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchList()}}],show:d},{fetchList:e,renderList:f,val:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/edit/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/paper","../../../../util/ajax","../add/util","../add/data","../util"],function(a,b,c){function d(a){var b=this;m.getPaper({type:"GET",params:{paperId:b.paperId},call:function(b){a&&a(b.data)},error:function(){b.renderWait("数据加载出错，请重试")}})}function e(a){function b(e){m.getPaperQuestion({type:"GET",params:{paperId:c.paperId},query:{page:e,pageSize:200},call:function(c){var f=c.data;d=d.concat(f.datas||[]),f.currentPage<f.totalPage?b(e+1):a&&a(d)},error:function(){c.renderWait("数据加载出错，请重试")}})}var c=this,d=[];b(1)}function f(a){var b=this,c=b.getParam();if(o.clearDb(),o.setDb(o.DB_EDIT_INFO,a),a.beenTested)return o.loadStep4Data(a),void b.nav("paper",{action:"edit/tested/step1",id:c.id},{replace:!0});o.loadStepFullData(a);var d=j.id(c.step),e="1234".indexOf(d)>=0?"editStep"+d:"editStep1";b.nav("paper",{action:e,id:c.id},{replace:!0})}var g=a("nc"),h=a("cpn"),i=(g.$,g.Clazz),j=g.Base,k=h.Popup,l=a("../../../../core/module"),m=a("../../../../action/paper"),n=a("../add/util"),o=n.getDataUtil(!0),p=c.exports=i.create();i.mix(p,l,{style:"/stylesheets/styles/system/assemblePaper.css",title:"编辑试卷",_template:['<div class="com-main">','<div class="com-content">','<div class="com-cont-main js-main"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam(),c=j.id(b.id);return c?(a.paperId=c,a.mainEl=a.getEl(".js-main"),a.renderWait(a.mainEl,"数据加载中..."),void a.reqPaperData(function(b){var c=(b||{}).setting=(b||{}).setting||{},d=!!c.randomQuestion;d||b.beenTested?a.loadData(b):a.reqQuestionData(function(d){c.extQuestions=d,a.loadData(b)})})):k.alert("参数错误",function(){a.nav("paper")})}}]},{reqPaperData:d,reqQuestionData:e,loadData:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/edit/tested/step1",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/steps","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../../../../../component/department","../../../../../util/switch","../../../../../action/user","../../add/cpn/popupPaperList","../../add/util","../../add/data","../../util"],function(a,b,c){function d(){var a=this,b=R.getDb(R.DB_EDIT_INFO);b&&!b.forever&&(a.lastEndTime=y.form(new Date(b.endTime),"yyyy-MM-dd HH:mm:ss")),a.cpn={}}function e(){var a=this,b=a.getParam();if(!b.id)return E.alert("参数错误",function(){a.nav("paper")}),!0;var c=R.getDb(R.DB_EDIT_INFO)||{};return c.beenTested&&v.id(c.id)===v.id(b.id)?(a.crumbTitle="编辑试卷("+c.paperName+")",void a.refreshCrumb()):(a.nav("paper",{action:"edit",id:b.id}),!0)}function f(){var a=this,b=a.getEl(),c=a.cpn;new I({renderTo:b.find(".js-steps-wrap"),renderWith:"replaceWith",titles:["编辑试卷参数","完成"],current:1}),c.titleIpt=A.transform(b.find(".js-title"),{render:function(){this.getEl().width(this.inputEl.width())}}),c.durationIpt=A.transform(b.find(".js-duration"),{render:function(){this.getEl().width(this.inputEl.width())},blur:function(){this.val(z.fix(this.val()))}}),c.startDateIpt=A.transform(b.find(".js-start-date")),c.startTimeIpt=A.transform(b.find(".js-start-time")),c.endDateIpt=A.transform(b.find(".js-end-date")),c.endTimeIpt=A.transform(b.find(".js-end-time"));var d=[c.startDateIpt,c.startTimeIpt,c.endDateIpt,c.endTimeIpt];c.department=new K({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",type:"selectMult",departmentData:a.departmentData,marginLeft:"-35px",gap:"20px",tip:"只有拥有参与管理的机构权限的账号可以进行管理试卷和添加考生的操作"}),c.department.getEl(".control-label").width(135),c.startDateIpt.disabled(),c.startTimeIpt.disabled(),c.durationChk=B.transform(b.find(".js-forever"),{change:function(){var a=this.isChecked();v.forEach(d,function(b){b!==c.startDateIpt&&b!==c.startTimeIpt&&b.disabled(a),b.setNone()})}}),v.forEach(d,function(b){var d=b===c.startDateIpt||b===c.endDateIpt,e=b===c.startDateIpt||b===c.startTimeIpt,f=b.getEl(),g=e?null:C.show({target:f,ipt:b.inputEl,canShow:function(){return!b.isDisabled()},type:d?"date":"time",startDate:d?"now":void 0,endDate:d?C.yearDiff(8)+"-12-31":void 0,call:function(c,d){b.val(d),a.saveData()}});g&&a.pushChild(g),e&&(f.attr("title","试卷已有人完成，开始时间不支持编辑"),G.titleEl(f,{},function(b){a.pushChild(b)}))}),c.judgeTkChk=B.transform(b.find(".js-judge-tk")),c.judgeWdChk=B.transform(b.find(".js-judge-wd")),c.judgeBcChk=B.transform(b.find(".js-judge-bc"));var e=[["paperAccessChk",b.find(".js-paper-access")],["customerServiceChk",b.find(".js-customer-service")],M.can("paperSimulation")?["ifSimulationChk",b.find(".js-if-simulation")]:null];v.forEach(e,function(a){a&&(c[a[0]]=new D({el:a[1]}))}),c.passLineIpt=A.transform(b.find(".js-pass-line"),{blur:function(){this.val(z.fix(this.val()))}}),c.noticeBeforeIpt=A.transform(b.find(".js-notice-before")),x.txtAutoHeight({el:c.noticeBeforeIpt.inputEl}),c.noticeAfterIpt=A.transform(b.find(".js-notice-after")),x.txtAutoHeight({el:c.noticeAfterIpt.inputEl})}function g(){var a=this,b=a.getEl(),c=F.show({target:b.find(".js-upload-cover"),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",url:L.getUploadUrl(1),call:function(b){var c=b.data;a.logoUrl=c,a.fixLogo(c),a.saveData()}});a.pushChild(c)}function h(){var a=this,b=a.cpn;v.forEach(b,function(b){b.listen("change",v.bind(a.saveData,a))})}function i(){var a=this;a.nav("paper",{action:"addManualOne"})}function j(){var a=this,b=a.cpn,c={paperName:t.trim(b.titleIpt.val())||null,duration:t.trim(b.durationIpt.val())||null,beginTime:t.trim(b.startDateIpt.val())+" "+t.trim(b.startTimeIpt.val()),endTime:t.trim(b.endDateIpt.val())+" "+t.trim(b.endTimeIpt.val()),forever:b.durationChk.isChecked(),logo:a.logoUrl||null,departmentIdList:b.department.val(),needMessage:"true"===b.customerServiceChk.val(),allowNew:"true"===b.paperAccessChk.val(),mJudgeCompletion:b.judgeTkChk.isChecked(),mJudgeDesign:b.judgeWdChk.isChecked(),mJudgeCoding:b.judgeBcChk.isChecked(),beforeSummary:t.trim(b.noticeBeforeIpt.val())||null,endTips:t.trim(b.noticeAfterIpt.val())||null};return M.can("paperPassLine")&&(c.passScoreLine=t.trim(b.passLineIpt.val())),M.can("paperSimulation")&&(c.simulation="1"===b.ifSimulationChk.val()),c}function k(a){var b=this,c=(b.getEl(),b.cpn);if(c.titleIpt.val(a.paperName||""),c.durationIpt.val(a.duration||""),a.beginTime){var d=a.beginTime.split(" ");c.startDateIpt.val(d[0]),c.startTimeIpt.val(d[1])}if(a.endTime){var d=a.endTime.split(" ");c.endDateIpt.val(d[0]),c.endTimeIpt.val(d[1])}c.durationChk.checked(!!a.forever),c.durationChk.fire("change"),b.fixLogo(a.logo),c.department.val(a.departmentIdList),c.judgeTkChk.checked(!!a.mJudgeCompletion),c.judgeWdChk.checked(!!a.mJudgeDesign),c.judgeBcChk.checked(!!a.mJudgeCoding),c.customerServiceChk.val(a.needMessage?"true":"false"),c.paperAccessChk.val(a.allowNew?"true":"false"),c.noticeBeforeIpt.val(a.beforeSummary||T),c.noticeAfterIpt.val(a.endTips||U),M.can("paperPassLine")&&c.passLineIpt.val(a.passScoreLine),M.can("paperSimulation")&&c.ifSimulationChk.val(a.simulation?"1":"2"),M.can("paperSimulation")&&!M.can("paperOfficial")&&(c.ifSimulationChk.val("1"),v.forEach(c.ifSimulationChk.option,function(a){a.disabled(!0),a.getEl().on("click",function(){E.alert("该账号只能使用模拟卷")})})),b.saveData()}function l(){var a=this,b=a.getEl(),c=a.cpn,d=a.getData(),e=!0,f=!1;if(d.paperName||(c.titleIpt.setErrorTips("考试标题不能为空"),e=!1),d.duration||(c.durationIpt.setErrorTips("考试时长不能为空"),e=!1),!d.forever){var g=t.trim(c.startDateIpt.val()),h=t.trim(c.startTimeIpt.val()),i=t.trim(c.endDateIpt.val()),j=t.trim(c.endTimeIpt.val()),k=!0;if(y.checkDate(g)||(c.startDateIpt.setErrorTips("日期格式不正确"),k=!1),y.checkTime(h)||(c.startTimeIpt.setErrorTips("时间格式不正确"),k=!1),y.checkDate(i)||(c.endDateIpt.setErrorTips("日期格式不正确"),k=!1),y.checkTime(j)||(c.endTimeIpt.setErrorTips("时间格式不正确"),k=!1),k){var l=new Date(d.beginTime).getTime(),m=new Date(d.endTime).getTime();m<=(new Date).getTime()&&a.lastEndTime!==d.endTime?(c.endDateIpt.setErrorTips("结束时间不能早于当前时间"),c.endTimeIpt.setError(),k=!1):l>=m&&(c.startDateIpt.setErrorTips("开始时间不能晚于结束时间"),c.startTimeIpt.setError(),c.endDateIpt.setError(),c.endTimeIpt.setError(),k=!1)}e=e&&k}return d.logo||(E.alert("请选择考试LOGO图片"),x.highLight({el:b.find("div.js-logo-container"),times:12}),f=!0,e=!1),d.beforeSummary||(c.noticeBeforeIpt.setErrorTips("考前须知不能为空"),e=!1),d.endTips||(c.noticeAfterIpt.setErrorTips("考后说明不能为空"),e=!1),e}function m(){var a=this,b=a.getData();R.setDb(R.DB_ADD_PAPER,b)}function n(a){var b=this,c=b.getEl(),d=c.find("div.paper-logo");d.find("img").attr("src",a||V),b.logoUrl=a}function o(){var a=this;return a._generateId=a._generateId||1,a._generateId++ +""}function p(a,b){var c=this;J.checkProject({force:!0,call:function(d){P.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:[d],entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,v.isFunction(a)&&a(d)},error:function(a){v.isFunction(b)&&b(a.msg)}})}})}function q(){return['<div class="js-steps-wrap"></div>','<div class="steps-detail">','<div class="detail-group">','<div class="form-group">','<a href="javascript:void(0)" class="upload-paper-set link-green js-load-paper"><i class="icon-download-alt"></i> 载入已有试卷设置</a>',"</div>",'<div class="form-group">','<label class="control-label">考试标题</label>','<div class="control-group js-title"><input type="text" placeholder="考试标题" /></div>',"</div>",'<div class="form-group">','<label class="control-label">考试时长/分钟</label>','<div class="control-group js-duration"><input type="text" placeholder="考试时长/分钟" /></div>',"</div>",'<div class="form-group">','<label class="control-label">试卷有效期</label>','<div class="control-group paper-term">','<div class="control-group js-start-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-start-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<span class="term-label">至</span>','<div class="control-group js-end-date"><input class="w105" type="text" placeholder="格式:2016-09-09"></div>','<div class="control-group js-end-time"><input class="w105" type="text" placeholder="格式:00:00:00"></div>','<label class="checkbox js-forever"><span class="icons"></span>长期有效</label>',"</div>","</div>",'<div class="form-group js-logo-container">','<label class="control-label">考试LOGO图片</label>','<div class="control-group">','<div class="paper-logo"><img src="',V,'"></div>','<div style="display:inline-block;position:relative;">','<a href="javascript:void(0);" class="link-green js-upload-cover">修改 (建议80px*80px)</a>',"</div>","</div>","</div>",'<div class="js-department-home"></div>',"</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">人工判题题型</label>','<div class="control-group">','<label class="checkbox js-judge-tk"><span class="icons"></span>填空题</label>','<label class="checkbox js-judge-wd"><span class="icons"></span>问答题</label>','<label class="checkbox js-judge-bc"><span class="icons"></span>编程题</label>',"</div>","</div>","</div>",'<div class="detail-group">','<div class="form-group">','<label class="control-label">试卷类型</label>','<div class="control-group">','<label class="radio js-paper-access"><span class="icons"></span><input value="false" />私密，仅邀请可见</label>','<label class="radio js-paper-access"><span class="icons"></span><input value="true"/>公开，所有人可见</label>',"</div>","</div>",'<div class="form-group">','<label class="control-label">在线客服窗口</label>','<div class="control-group">','<label class="radio js-customer-service"><span class="icons"></span><input value="false"/>关闭</label>','<label class="radio js-customer-service"><span class="icons"></span><input value="true"/>开启（仅VIP可用）','<span class="icon-question-sign js-cs-tips"><div class="tooltip bottom tooltip-info">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">本功能仅大规模考试（超过2000人次）可用，需开考前提前联系牛客客服团队。</div>',"</div>","</span>","</label>","</div>","</div>",M.can("paperPassLine")?['<div class="form-group">','<label class="control-label">及格分数线</label>','<div class="control-group js-pass-line"><input type="text" placeholder="及格分数线" /></div>',"</div>"].join(""):"",M.can("paperSimulation")?['<div class="form-group">','<label class="control-label">是否为模拟卷</label>','<div class="control-group">','<label class="radio js-if-simulation"><input value="2"/>否</label>','<label class="radio js-if-simulation"><input value="1"/>是</label>',"</div>","</div>"].join(""):"","</div>",'<div class="detail-group"><div class="form-group">','<label class="control-label">考前须知</label>','<div class="control-group js-notice-before"><textarea class="form-textarea"></textarea></div>',"</div></div>",'<div class="detail-group"><div class="form-group">','<label class="control-label">考后说明</label>','<div class="control-group js-notice-after"><textarea class="form-textarea"></textarea></div>',"</div></div>","</div>",'<div class="paper-btn-group">','<a class="btn btn-primary js-go-next" href="javascript:void" style="width:180px;">设置完毕，下一步</a>',"</div>"].join("")}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Clazz,v=r.Base,w=r.Limit,x=r.Dom,y=r.Time,z=r.Num,A=s.Input,B=s.CheckBox,C=s.AttachDate,D=s.CheckGroup,E=s.Popup,F=s.AttachUpload,G=s.Tips,H=a("../../../../../core/module"),I=a("../../../../../component/steps"),J=a("../../../extend/bll/paper"),K=a("../../../../../component/department"),L=a("../../../../../util/util"),M=a("../../../../../util/switch"),N=a("../../add/cpn/popupPaperList"),O=a("../../../../../action/paper"),P=a("../../../../../action/user"),Q=a("../../add/util"),R=Q.getDataUtil(!0),S=c.exports=u.create(),T=["1、请使用最新版chrome浏览器作答（44版本以上），如考试需开启摄像头，请确保电脑带有摄像头。","2、考试中除编程题之外，其他考试页面不可跳出当前页面，前三次跳出会有提醒，之后将不再提醒。编程题支持本地IDE编码后复制粘贴至考试页面，不做跳出限制。","3、考试时允许使用草稿纸，请提前准备纸笔。考试过程中允许上厕所等短暂离开，但请控制离开时间。","4、考试期间如遇到断电、断网、死机等问题，可以关闭浏览器重新打开试卷链接即可继续做题。","5、遇到问题请即时反馈给考试主办方。"].join("\n"),U="本场考试已结束，请保持通讯畅通，方便接收后续通知",V="//uploadfiles.nowcoder.com/images/20160520/56_1463728821615_B856A5CA00C64BEA1A77436F8FE39D5E";u.mix(S,H,{style:"/stylesheets/styles/system/assemblePaper.css",title:"编辑试卷",_template:'<div class="steps-main step2"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();if(!a.initDataCheck()){a.renderWait(b);var c=R.getDb(R.DB_ADD_PAPER);c.projectId&&a.addParam({projectId:c.projectId}),a.getDepartment(function(){b.html(a.getModuleHtml()),a.initCpn(),a.initAutoCache(),a.initAvatar(),a.setData(c||{})},function(c){a.renderNone(b,c)})}}},{name:"click .js-go-next",handler:function(){var a=this,b=a.getEl(),c=a.getParam(),d=a.checkData();if(!d)return void a.goTop();var e=a.getData();delete e.beginTime,e.forever&&delete e.endTime,O.updatePaper({type:"PUT",body:e,params:{paperId:c.id},call:function(b){R.clearDb(),a.nav("paper",{action:"editStep5",paperId:(b.data||{}).id,tested:!0})},statusCall:{1304:function(){return E.alert("该试卷名已被占用，为更好的进行试卷管理，请您更换为其他试卷名称。"),!1}},error:function(a){E.alert(a.msg)},always:function(){w.clear(b)}})}},{name:"click a.js-load-paper",handler:function(){var a=this;N.show({listeners:{ok:function(b){var c=R.loadStep4Data(b);a.setData(c)}}})}}]},{initialize:d,initDataCheck:e,initCpn:f,initAvatar:g,initAutoCache:h,goBack:i,getData:j,setData:k,checkData:l,saveData:m,fixLogo:n,generateId:o,getDepartment:p,getModuleHtml:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step1/conditionGroupIpt",["nc","cpn","./formGroup","../../../../../../action/judge","../../../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.groups=[]}function e(){var a=this;a.initConditionCkn(),a.initExtraCondition()}function f(){var a=this,b=a.getEl();a.conditionCkn=A.transform(b.find(".js-condition-union"),{change:function(){a.useUnion=this.isChecked()?1:0,a.fire("change")}})}function g(){var a=this,b=a.rawConfig.val.signUpFieldList||[];return 0===b.length?void a.getEl(".js-extra-div").hide():void x.forEach(b,function(b){var c=a.createItemEl(b);a.getValByCond(b,c,x.bind(a.createItemSelect,a))})}function h(a){var b=this,c=['<div style="display:inline-block;margin-right:30px;">','<span class="js-cond-name">',a,"：</span>","</div>"].join(""),d=b.getEl(".js-extra-home"),e=u(c);return d.append(e),e}function i(a,b,c){var d=this,e=d.rawConfig;C.searchSignupValue({params:{userId:e.userId||0},query:{paperId:e.paperId||0,signUpField:a},call:function(d){c&&c(a,b,d.data)},error:function(a){b.find(".js-cond-name").html(a.msg)}})}function j(a,b,c){var d=this,e=d.selectHome=d.selectHome||{},f=d.getListName(a),g=[];x.forEach(c,function(a){g.push({text:a||"未填写",value:a})}),e[f]=new B({renderTo:b,renderBy:"append",needSearch:!0,options:g,text:"不限",change:function(){d.fire("change")}})}function k(a){var b={"职位":"jobNameList","部门":"departmentList","学校":"schoolList","学历":"degreeList","地区":"areaList"};return a?b[a]:b}function l(){var a=this,b=!0,c=!1,d=a.getListName();return x.forEach(d,function(b){var d=(a.selectHome||{})[b]||{};c=c||(x.isFunction(d.val)?0!==d.val().length:!1)}),c?(x.forEach(a.groups,function(a){a.setErrorTips("")}),b):(x.forEach(a.groups,function(c){var d=c.val(),e=d.compareScore;e?a.isDigit(e)||(c.setErrorTips("只能输入整数"),b=!1):(c.setErrorTips("请输入筛选的分数"),b=!1);var f=x.id(d.questionType),g=x.id(d.compare);"-1"!==f&&"1"!==g&&"0"===e&&(c.setErrorTips("请设置0以上的分数线"),b=!1)}),b)}function m(a){var b=this;if(0===arguments.length){var c=x.map(b.groups,function(a){return a.val()}),d="",e="",f="";x.forEach(c,function(a){""!==u.trim(a.compareScore)&&(d&&(d+="_"),d+=a.questionType,e&&(e+="_"),e+=a.compare,f&&(f+="_"),f+=a.compareScore)});var a={},g=b.getListName();return x.forEach(g,function(c){var d=(b.selectHome||{})[c]||{};a[c]=x.isFunction(d.val)?d.val():void 0}),x.extend(a,{categoryList:d,compareList:e,valList:f,union:b.conditionCkn.isChecked()?1:0}),a}b.aCategoryTypeList=a.categoryTypeList,x.forEach(b.groups,function(a){a.destroy()}),b.groups=[];var h=(a.categoryList||"").split("_"),i=(a.compareList||"").split("_"),j=(a.valList||"").split("_");if(h.length!==i.length||h.length!==j.length||0===h.length)return void b.createItem();for(var k=[],l=0,m=h.length;m>l;l++)k.push({category:h[l],compare:i[l],score:j[l]});x.forEach(k,function(a,c){b.createItem(c,a)}),b.conditionCkn.checked(1===(a.union||0)),b.fire("change");var n=b.getListName();x.forEach(n,function(c){a[c]&&b.fire("valSelect",c,a[c])})}function n(a,b){var c=this,d=c.getEl(),e=c.groups;if(!(e.length>=5)){b=b||{},b.categoryTypeList=c.aCategoryTypeList;var f=new z({renderTo:d.find(".js-condition-union"),renderBy:"before",content:b.title,val:b,listeners:{change:function(){c.fire("change")},remove:function(){if(1!==e.length){var a=e.indexOf(this);a>=0&&e.splice(a,1),c.refreshCondUnion(),this.destroy(),c.checkList(),c.fire("change")}}}});return e.push(f),c.refreshCondUnion(),c.checkList(),f}}function o(){var a=this,b=a.getEl(),c=a.groups;b.find(".js-add")[c.length>=5?"hide":"show"](),c[0].showDelete(c.length>1),x.forEach(c,function(a,b){a.title("选择条件"+(b+1))})}function p(a){return a=y.str(a),!!(a&&x.isString(a)&&/^(\d|-)+$/g.test(a)&&a.length>0)}function q(a){var b=this,c=b.getEl().find(".js-num");c.html('符合筛选条件的试卷数量：<span class="font-green">'+a+"</span>")}function r(){var a=this,b=a.getEl(".js-condition-union"),c=a.groups||[];b[c.length>1?"show":"hide"]()}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Component,w=s.Clazz,x=s.Base,y=s.Str,z=a("./formGroup"),A=t.CheckBox,B=t.SelectMult,C=(t.Popup,a("../../../../../../action/judge")),D=c.exports=w.create();w.mix(D,v,{_template:['<div class="condition-info">','<div class="condition-detail">',"<h2>分数</h2>",'<label class="checkbox js-condition-union" style="margin-right:50px;display:none;"><span class="icons"></span><span class="menu-label">符合以上任意一个分数条件即可</span></label><br>','<a href="javascript:void(0)" class="condition-add-btn js-add"><i class="icon-plus-sign"></i>添加条件</a>',"</div>",'<div class="condition-detail js-extra-div">',"<h2>其他条件</h2>",'<div class="js-extra-home" style="line-height:33px;font-size:14px;margin-top:10px;"></div>',"</div>",'<div class="condition-num">','<span class="js-num"></span>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns();var b=a.rawConfig;b.val&&a.val(b.val)}},{name:"click .js-add",handler:function(){var a=this,b=a.groups;a.createItem(b.length)}},{name:"valSelect",type:"custom",handler:function(a,b){var c=this;window.setTimeout(function(){var d=(c.selectHome||{})[a];return d?(x.isFunction(d.val)&&d.val(b),void c.fire("change")):void window.setTimeout(arguments.callee,500)})}}]},{initialize:d,initCpns:e,initConditionCkn:f,initExtraCondition:g,createItemEl:h,getValByCond:i,createItemSelect:j,getListName:k,check:l,val:m,checkList:o,createItem:n,isDigit:p,setConditionAlloNum:q,refreshCondUnion:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step1/formGroup",["nc","cpn"],function(a,b,c){function d(a){var b=this;if(0===arguments.length){var c=b.input,d=b.typeSelect,e=b.compareSelect;return{compareScore:l.trim(c.val()),compare:e.val(),questionType:d.val()}}b.oItem=a}function e(){var a=this,b=p.str(a.input.val());if(""===l.trim(b))return!0;var c=!!(b&&o.isString(b)&&/^(\d|-)+$/g.test(b)&&b.length>0);if(!c)return a.setErrorTips("只能输入整数"),!1;var d=o.id(a.typeSelect.val()),e=o.id(a.compareSelect.val());return"-1"!==d&&"1"!==e&&"0"===b?(a.setErrorTips("请设置0以上的分数线"),!1):(a.setErrorTips(""),!0)}function f(a){var b=this,c=b.getEl();c.find("label").html(l.trim(a))}function g(a){var b=this,c=b.getEl();c.find(".js-delete")[a===!1?"hide":"show"]()}function h(a){var b=this;b.input.setErrorTips(a)}function i(){var a=this,b=o.id(a.oItem.category)||"-1",c=[{text:"总分",value:-1,checked:"-1"===b}];return c.push({text:"全部客观题",value:0,checked:"0"===b}),o.forEach(a.oItem.categoryTypeList,function(b){c.push({text:b.name,value:b.type,checked:o.id(a.oItem.category)===o.id(b.type)})}),c}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=j.Base,p=j.Str,q=k.Select,r=k.Input,s=c.exports=n.create();n.mix(s,m,{_template:['<div class="form-group">','<label class="control-label js-title">选择条件</label>','<span class="js-question-category"></span>','<span class="js-val-equal"></span>','<span class="js-score"></span>','<i class="icon-trash js-delete"></i>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;c.val&&a.val(c.val),a.typeSelect=new q({size:"small",renderTo:b.find(".js-question-category"),renderBy:"replaceWith",options:a.getTypeCheckList(),listeners:{change:function(){a.input.val()&&a.fire("change")}}}),a.typeSelect.getEl().addClass("control-group");var d=o.id(a.oItem.compare)||"1";a.compareSelect=new q({size:"small",renderTo:b.find(".js-val-equal"),renderBy:"replaceWith",options:[{text:"大于",value:"1",checked:"1"===d},{text:"大于等于",value:"2",checked:"2"===d},{text:"等于",value:"3",checked:"3"===d},{text:"小于等于",value:"4",checked:"4"===d},{text:"小于",value:"5",checked:"5"===d}],listeners:{change:function(){a.input.val()&&a.fire("change")}}}),a.compareSelect.getEl().addClass("control-group"),a.input=new r({placeholder:"输入筛选分数线",renderTo:b.find(".js-score"),renderBy:"replaceWith",value:a.oItem.score||"",listeners:{blur:function(){a.check()&&a.fire("change")}}}),a.input.inputEl.on("keyup",function(){var b=p.str(a.input.val());b&&a.check()&&a.fire("change")})}},{name:"click .js-delete",handler:function(){{var a=this;a.rawConfig||{}}a.fire("remove")}}]},{val:d,title:f,showDelete:g,setErrorTips:h,check:e,getTypeCheckList:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step1/index",["nc","cpn","../../../../../../core/module","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/judge","../../../../../../util/ajax","../steps","../../../../../../util/switch","./selectAllocCpn","./conditionGroupIpt","./formGroup","./uploadCtl","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","../util"],function(a,b,c){function d(a){var b=this,c=b.getEl(),d=c.find(".js-content"),e=b.getParam(),f=(b.steps=new u({renderTo:d,module:b,currentStep:1,paperName:a.paperName,unAssignedCnt:a.unAssignedCnt}),b.selectMethodCpn=new v({renderTo:d,listeners:{change:function(){var a=this.val(),b=q.id(a.method);f["2"===b?"show":"hide"](),g["3"===b?"show":"hide"]()}}}),b.selectConditionCpn=new w({renderTo:d,userId:b.getUserId(),paperId:e.paperId,val:{categoryTypeList:a.categoryTypeList,signUpFieldList:a.signUpFieldList}}));b.selectConditionCpn.listen("change",function(){b.check()&&b.queryConditionNum()}),f.hide();var g=b.uploadCtl=new x({renderTo:d,userId:b.getUserId(),paperId:e.paperId,parent:b,val:a});g.hide(),b.sPaperName=a.paperName,b.nUnAssignedCnt=a.unAssignedCnt;var h=b.getDb();h.categoryTypeList=a.categoryTypeList,b.val(h)}function e(a){var b=this;return 0===arguments.length?q.extend({},b.selectMethodCpn.val(),b.selectConditionCpn.val(),b.uploadCtl.val(),{paperName:b.sPaperName,unAssignedCnt:b.nUnAssignedCnt,chooseAllocCount:b.nChooseAllocCount||0}):(b.selectMethodCpn.val(a.method),b.selectConditionCpn.val(a),void b.uploadCtl.val(a))}function f(){var a=this,b=a.val(),c=q.id(b.method);if("2"===c)return a.selectConditionCpn.check();if("3"===c){if(!b.excel)return r.alert("请先上传考生名单"),!1;if(0===b.nParseCount)return r.alert("解析上传文件中考生数量为0，请按照模板重新上传"),!1;if(0===b.nMatchUidCount)return r.alert("解析上传文件中考生未分配的试卷数为0， 请重新上传"),!1}return"0"===q.id(a.nUnAssignedCnt)?(r.alert("没有需要分配的试卷"),!1):!0}function g(){var a=this,b=a.getParam();y.setDb(y.DB_ALLOCATION_METHOD+"_"+b.paperId,a.val())}function h(){var a=this,b=a.getParam();y.removeDb(y.DB_ALLOCATION_METHOD+"_"+b.paperId)}function i(){var a=this,b=a.getParam();return y.getDb(y.DB_ALLOCATION_METHOD+"_"+b.paperId)}function j(a){var b=this,c=b.getParam();t.getNotAssignCount({params:{userId:b.getUserId()},query:{paperId:c.paperId},call:function(b){var c=b.data;a&&a(c)}})}function k(){var a=this,b=a.val(),c=q.id(b.method),d=a.getParam();if("1"===c)a.nChooseAllocCount=b.unAssignedCnt,a.save(),a.nav("paper",{action:"judge/allocate/step2/index",paperId:d.paperId});else if("2"===c)a.searchUnassignCount(function(b){return"0"===q.id(b)?void r.alert("符合条件试卷数量为0，请修改条件重新筛选"):(a.nChooseAllocCount=b,a.save(),void a.nav("paper",{action:"judge/allocate/step2/index",paperId:d.paperId}))});else{if("0"===q.id(b.matchUidCount))return void r.alert("2"===c?"符合条件试卷数量为0，请重新选择条件":"3"===c?"符合条件试卷数量为0，请重新上传名单":"没有试卷需要判卷");a.nChooseAllocCount=b.matchUidCount,a.save(),a.nav("paper",{action:"judge/allocate/step2/index",paperId:d.paperId})}}function l(){var a=this,b=a.val();"2"===q.id(b.method)&&a.searchUnassignCount(function(b){a.selectConditionCpn.setConditionAlloNum(b),a.nChooseAllocCount=b,"0"!==q.id(b)&&a.save()})}function m(a){var b=this,c=b.getParam(),d=b.val();t.searchUnassignCount({params:{userId:b.getUserId()},query:{paperId:c.paperId,categoryList:d.categoryList||"",compareList:d.compareList||"",valList:d.valList||"",union:d.union||0,jobNameList:d.jobNameList||void 0,departmentList:d.departmentList||void 0,schoolList:d.schoolList||void 0,degreeList:d.degreeList||void 0,areaList:d.areaList||void 0},call:function(b){q.isFunction(a)&&a(b.data)},error:function(a){r.alert(a.msg)}})}var n=a("nc"),o=a("cpn"),p=(n.$,n.Clazz),q=n.Base,r=o.Popup,s=a("../../../../../../core/module"),t=a("../../../../../../action/judge"),u=a("../steps"),v=a("./selectAllocCpn"),w=a("./conditionGroupIpt"),x=a("./uploadCtl"),y=a("../util"),z=c.exports=p.create();p.mix(z,s,{style:"/stylesheets/styles/system/checkSubjectProgress.css",title:"分配判题",_template:['<div class="module-body">','<div class="js-content"></div>','<div class="btn-wrap">','<a href="javascript:void(0);" class="btn btn-default js-cancel">暂不分配</a>','<a href="javascript:void(0);" class="btn btn-primary js-next">下一步</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.nChooseAllocCount=0,a.getData(function(b){a.initCpn(b)})}},{name:"click .js-next",handler:function(){{var a=this;a.val(),a.getParam()}a.check()&&a.nextStep()}},{name:"click .js-cancel",handler:function(){var a=this;a.removeDb(),a.nav("paper",{action:"judge/allocation"})}}]},{initCpn:d,val:e,check:f,save:g,removeDb:h,getDb:i,getData:j,nextStep:k,queryConditionNum:l,searchUnassignCount:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step1/selectAllocCpn",["nc","cpn"],function(a,b,c){function d(a){var b=this;return 0===arguments.length?{method:b.allocChkGroup.val()||1}:void(a&&(b.allocChkGroup.val(a||1,!0),b.fire("change",b.val())))}var e=a("nc"),f=a("cpn"),g=(e.$,e.Component),h=e.Clazz,i=(e.Base,f.CheckGroup),j=c.exports=h.create();h.mix(j,g,{_template:["<div>",'<div class="check-radio-box js-allocation-methold">','<label class="radio checked"><span class="icons"></span><input type="radio" value="1"> 全部分配</label>','<label class="radio"><span class="icons"></span><input type="radio" value="2"> 按条件分配</label>','<label class="radio"><span class="icons"></span><input type="radio" value="3"> 分配指定考生名单</label>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.allocChkGroup=new i({el:b.find(".js-allocation-methold label.radio"),listeners:{change:function(){a.fire("change",a.val())}}}),c.val&&a.val(c.val)}}]},{val:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step1/uploadCtl",["nc","cpn","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/judge","../../../../../../util/ajax","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=l.show({target:b.find(".js-upload"),url:n.getUploadUrl(o.uploadType.file),fileType:"*.xlsx;xls;",call:function(b){a.renderData(b.data)}});a.pushChild(c)}function e(a){var b=this;return 0===arguments.length?{parseCount:b.parseCount||0,matchUidCount:b.nMatchUidCount||0,excel:b.sUrl||""}:(b.parseCount=a.parseCount||0,b.nMatchUidCount=a.matchUidCount||0,b.sUrl=a.excel,b.renderData(b.sUrl),void b.fire("change",b.val()))}function f(a){var b=this;if(a){var c=b.rawConfig,d=c.parent,e=d.getWin();p.queryByExcel({params:{userId:c.userId},body:{paperId:c.paperId,excel:a},call:function(c){var d=e.showLoading("解析中...");q.getTaskProgress(!0,c.data,function(c){var e=c.end,f=c.content,g=c.error,h=c.type;if(g){if(d.close(),3===h){var i=JSON.parse(f),j=k.id(i.code),l=(i.msg||"").replace(/\n+/g,"<br />");if("1308"===j){var n=JSON.parse(f),o='已解析完毕，名单中考生数量为：<span class="font-green">'+n.parseCount+"</span>";return o+='，完成测试考生数量为：<span class="font-green">'+n.finishCount+"</span>",o+='，符合条件的试卷数：<span class="font-green">'+n.matchUidCount+"</span>",o+='，无需判卷（答案为空，记0分）：<span class="font-green">'+n.notNeedJudgeCount+"</span>",b.resultDiv.html(o),b.nParseCount=n.parseCount,b.nMatchUidCount=n.matchUidCount,b.sUrl=a,new m({title:"提醒",content:['<div style="font-size:14px;padding:20px 0;text-align:center;line-height:2;">',"<div>"+l+"</div>","<div>"+(i.errorFileUrl?'<a class="link-green" href="'+i.errorFileUrl+'" target="_blank">点击下载错误名单</a>':"")+"</div>","</div>"].join(""),okTxt:"我知道了"})}}m.alert(f)}else e&&(d.close(),m.tips("解析成功",function(){var c=JSON.parse(f),d='已解析完毕，名单中考生数量为：<span class="font-green">'+c.parseCount+"</span>";d+='，完成测试考生数量为：<span class="font-green">'+c.finishCount+"</span>",d+='，符合条件的试卷数：<span class="font-green">'+c.matchUidCount+"</span>",d+='，无需判卷（答案为空，记0分）：<span class="font-green">'+c.notNeedJudgeCount+"</span>",b.resultDiv.html(d),b.nParseCount=c.parseCount,b.nMatchUidCount=c.matchUidCount,b.sUrl=a}));b.uploadBtn.html("重新上传名单")})},error:function(a){m.alert(a.msg),b.uploadBtn.html("重新上传名单")}})}}var g=a("nc"),h=a("cpn"),i=(g.$,g.Component),j=g.Clazz,k=g.Base,l=(g.Uri,h.CheckGroup,h.AttachUpload),m=h.Popup,n=a("../../../../../../util/util"),o=a("../../../../../../core/siteConfig"),p=a("../../../../../../action/judge"),q=a("../../../../extend/bll/task"),r=c.exports=j.create();j.mix(r,i,{_template:['<div class="condition-info">','<div class="condition-detail empty">','<p class="empty-tips">请先<a class="link-green js-download-template" href="javascript:void(0)">点击下载数据模板</a>，按模板填写拟判题名单后上传。</p>','<span style="display:inline-block;position:relative;" class="js-upload" data-type="excel"><div class="btn btn-primary js-upload-btn">按模板上传名单</div></span>',"</div>",'<div class="condition-num js-result"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.uploadBtn=b.find(".js-upload-btn"),a.resultDiv=b.find(".js-result"),a.initUpload(),c.val&&a.val(c.val)}},{name:"click .js-upload",handler:function(){}},{name:"click .js-download-template",handler:function(){var a=this,b=a.rawConfig,c=p.getTemplateExcelUrl({params:{userId:b.userId},query:{paperId:b.paperId}});window.open(c,"_blank")}}]},{val:e,initUpload:d,renderData:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step2/alloc",["nc","cpn","../../../../../../action/paper","../../../../../../util/ajax","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../component/miniInput","../../../../../../component/department","../../../../../../util/switch","../../../../../../action/user"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=a.getEl(),d=a.cpn={departments:[]};c.find(".js-question-title").html(b.question?['<span class="topic-main" style="margin-left:0px;">','<a href="javascript:void(0);">',b.question.categoryMenu.categoryTypeName,b.question.categoryMenu.index,"：",b.question.title,"</a>","</span>"].join(""):b.paperName),y.forEach([{name:"departChk",cls:".js-depart"},{name:"peopleChk",cls:".js-people"},{name:"innerChk",cls:".js-inner"}],function(b){var e=d[b.name]=E.transform(c.find(b.cls));e.listen("change",y.bind(a.dealTypeChange,a,e))}),d.departmentSel=new F({renderTo:a.getEl(".js-department-cpn"),renderBy:"replaceWith",size:"small",options:J.getOption(b.departments),change:function(){a.saveDepartmentVal(),a.fixDepartment(),a.mapCpn(),a.refreshCtl()}}),d.departmentSel.getEl().width("auto"),c.find(".check-filter-item").css("min-width","202px")}function e(){function a(a,b){var c=arguments.callee;return b=b||{},y.forEach(a,function(a){a&&a.users&&c(a.users,b),a&&a.input&&!a.input.isDisabled()&&(b[a.id]=a.input.val())}),b}var b=this;b.departmentVal=a(b.cpn.departments)}function f(){function a(a,b){var c=arguments.callee;return b=b||{},y.forEach(a,function(a){b[a.id]=a,c(a.subDepartments,b)}),b}function b(a,b){var c=arguments.callee;return b=b||{},y.forEach(a,function(a){y.forEach(a.userList,function(c){var d=b[c.id]=b[c.id]||[];d.push(y.id(a.id))}),a.subDepartments&&a.subDepartments.length>0&&c(a.subDepartments,b)}),b}function c(a,b,c){var f=a.getEl(),g=f.find(".tooltip"),h=!y.id(c);B.hover(f,function(){var b=a.isDisabled();if(g[b?"show":"hide"](),b)if(h){var c="如需手动设置，";e.departChk.isChecked()?c+="请关闭顶部“按机构平均分配”，并开启“机构内平均分配”":e.peopleChk.isChecked()?c+="请关闭顶部“按人数分配”，并开启“机构内平均分配”":e.innerChk.isChecked()||(c="分配总数为该机构内各账号分配数加总，如需手动设置, 请开启“机构内平均分配”"),g.find(".tooltip-inner").html(c).show()}else g.find(".tooltip-inner").html("如需手动设置，请取消顶部“按人数分配”及“机构内平均分配”").show()},function(){g.hide()}),a.inputEl.on("keyup blur",function(){d.dealIptChange(a,b,c)})}var d=this,e=d.cpn,f=d.rawConfig.departments,g=d.cpn.departmentSel.val(),h=d.departmentVal,i=d.userMap=d.userMap||a(f),j=d.departmentMap=d.departmentMap||b(f),k=d.getEl(".js-department-home"),l=d.getEl(".js-user-home"),m=e.departments=[];k.html(""),l.html(""),y.forEach(g,function(a){var b=i[a];if(b){var d={id:b.id,name:b.department,users:[]};m.push(d);var e=x(['<div class="item" data-id="',a,'">','<label style="margin-right:5px;">',b.department,"</label>",'<div class="control-group js-count-ipt">','<input type="text" />','<div class="tooltip bottom tooltip-info" style="min-width:150px;display:none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">如需手动设置, 请关闭顶部“按机构平均分配”，并开启“机构内平均分配”</div>',"</div>","</div>","</div>"].join(""));d.input=I.transform(e.find(".js-count-ipt")),y.id(h[a])&&d.input.val(h[a]),k.append(e),c(d.input,a),y.forEach(b.userList,function(b){var e={id:b.id,name:b.name};d.users.push(e);var f=x(['<div class="item" data-id="',b.id,'">','<label style="margin-right:5px;">',b.name,"</label>",'<div class="form-group">','<div class="control-group js-count-ipt">','<input type="text" />','<div class="tooltip bottom tooltip-info" style="min-width:150px;display:none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">如需手动设置，请取消顶部“按人数分配”及“机构内平均分配”</div>',"</div>","</div>","</div>","</div>"].join(""));e.input=I.transform(f.find(".js-count-ipt")),y.id(h[b.id])&&e.input.val(h[b.id]),l.append(f),c(e.input,a,b.id)})}}),k.find(".item").hover(function(a){var b=x(a.currentTarget).attr("data-id"),c=i[b];x(a.currentTarget).css("background-color","#d8d8d8"),y.forEach(c.userList,function(a){l.find('.item[data-id="'+a.id+'"]').css("background-color","#d8d8d8")})},function(a){var b=x(a.currentTarget).attr("data-id"),c=i[b];x(a.currentTarget).css("background-color","#f3f3f3"),y.forEach(c.userList,function(a){l.find('.item[data-id="'+a.id+'"]').css("background-color","#fff")})}),l.find(".item").hover(function(a){var b=x(a.currentTarget).attr("data-id");x(a.currentTarget).css("background-color","#d8d8d8"),y.forEach(j[b],function(a){k.find('.item[data-id="'+a+'"]').css("background-color","#d8d8d8")})},function(a){var b=x(a.currentTarget).attr("data-id");x(a.currentTarget).css("background-color","#fff"),y.forEach(j[b],function(a){k.find('.item[data-id="'+a+'"]').css("background-color","#f3f3f3")})}),d.departmentVal=null}function g(a){var b=this,c=b.cpn,d=a.isChecked(),e=c.departChk,f=c.peopleChk,g=c.innerChk;d&&(a===e||a===g?f.checked(!1):(e.checked(!1),g.checked(!1))),b.setInputNone(),b.refreshCtl()}function h(a,b,c){var d=this,e=d.cpn,f=!y.id(c),g=d.getTotal(),h=x.trim(a.val()).replace(/[^\d]/g,""),i=+h||0;if(a.val(h),d.setInputNone(),!h||0===i)return d.refreshCtl(),void d.fire("change");if(f){var j=d.getDepartInputTotal();j>g&&a.setErrorTips("数目超过可分配的总数")}else if(e.departChk.isChecked()){var k=d.getUserDepartCpn(c),l=+k.input.val()||0,m=d.getUserInputTotal(b);m>l&&a.setErrorTips("输入的分配数超过分配给这个组的总数")}else{var m=d.getUserInputTotal();m>g&&a.setErrorTips("输入的分配数超过可分配的总数")}d.refreshCtl()}function i(){var a=this,b=a.cpn,c=a.rawConfig,d=[],e=[],f=0,g=0;y.forEach(b.departments,function(a){y.forEach(a.users,function(a){d.push(a.id);var b=+a.input.val()||0;b&&g++,e.push(b),f+=b})});var h={uidList:d.join("_"),countList:e.join("_"),totalAssignCnt:f,totalUserCnt:d.length,validUserCount:g};return c.question&&y.extend(h,{qid:c.question.categoryMenu.questionId}),h}function j(){var a=this,b=a.cpn,c=a.rawConfig,d=a.getTotal(),e=a.getUserInputTotal(),f="";if(c.question&&(f=c.question.categoryMenu.categoryTypeName+c.question.categoryMenu.index+": "),e>d)return{right:!1,msg:f+"数目超过可分配的总数"};var g=[];if(y.forEach(b.departments,function(a){var b=y.find(a.users,function(){return!0});!b&&g.push(a.name)}),g.length>0){var h=f+"您还未选择"+g.join("/")+"该组的判题人";return{right:!1,msg:h}}var i=a.val();return 0===i.totalAssignCnt?{right:!1,msg:"抱歉，"+f+"未全部分配，请先选择要分配的判题账号"}:e!==d?{right:!1,msg:f+"未全部分配，请修改该题阅卷官的分配数量，使未分配数量为0"}:{right:!0}}function k(){function a(a,b){a=+a||0;var c=Math.max(b.length,1),d=Math.floor(a/c),e=a-d*c;y.forEach(b,function(a,b){a.input.val(d+(e>b?1:0))})}var b=this,c=b.getEl(),d=b.getTotal(),e=b.cpn,f=e.departments,g=e.departChk.isChecked(),h=e.peopleChk.isChecked(),i=e.innerChk.isChecked(),j=[];if(y.forEach(f,function(a){j.push(a),a.input.disabled(g||!i),y.forEach(a.users,function(a){a.input.disabled(h||i)})}),g&&a(d,j),i&&y.forEach(j,function(b){var c=[];y.forEach(b.users,function(a){c.push(a),a.input.val(""),a.input.disabled(!0)}),a(b.input.val(),c)}),h){var k=[];y.forEach(j,function(a){a.input.disabled(!0),y.forEach(a.users,function(a){a.input.disabled(!0),k.push(a)})}),a(d,k),y.forEach(j,function(a){var b=0;y.forEach(a.users,function(a){b+=+a.input.val()||0}),a.input.val(b)})}g||i||h||y.forEach(j,function(a){var c=b.getUserInputTotal(a.id);a.input.val(c)}),b.fire("change"),b.val().totalAssignCnt===d?c.find(".js-tag").removeClass("tag-spot-red").addClass("tag-spot-green"):c.find(".js-tag").removeClass("tag-spot-green").addClass("tag-spot-red")}function l(){var a=this,b=a.rawConfig;return+b.count||0}function m(){var a=this,b=0;return y.forEach(a.cpn.departments,function(a){b+=+a.input.val()||0}),b}function n(a){var b=this,c=0;if(y.id(a)){var d=b.getDepartCpn(a);y.forEach((d||{}).users,function(a){c+=+a.input.val()||0})}else y.forEach(b.cpn.departments,function(a){y.forEach(a.users,function(a){c+=+a.input.val()||0})});return c}function o(){var a=this,b={},c={},d={};y.forEach(a.cpn.departments,function(a){var e=a.id;b[e]=a,y.forEach(a.users,function(a){c[a.id]=a,d[a.id]=e})}),a.cpnMap={departments:b,users:c,userDepartMap:d}}function p(a){var b=this;return b.cpnMap.departments[a]}function q(a){var b=this;return b.cpnMap.users[a]}function r(a){var b=this,c=b.cpnMap.userDepartMap[a];return b.cpnMap.departments[c]}function s(){var a=this;y.forEach(a.cpn.departments,function(a){a.input.setNone(),y.forEach(a.users,function(a){a.input.setNone()})})}function t(a){function b(a){if(null===a)return void(c.loadPopup=new D({title:"提示",content:'<div style="font-size:14px;text-align:center;">加载中...</div>',ok:function(){}}));var b="";if(1===a.type||2===a.type)y.forEach(a.answers,function(a,c){b+="<p>"+K.charAt(c)+" "+a.content+"</p>"});else if(4===a.type){var d=a.codingProblem;b+=d.inputDesc?"</br><h5><b>输入描述:</b></h5><pre>"+d.inputDesc+"</pre></br>":"",b+=d.outputDesc?"</br><h5><b>输出描述:</b></h5><pre>"+d.outputDesc+"</pre>":"",b+=d.inputSample?"</br><h5><b>输入例子:</b></h5><pre>"+d.inputSample+"</pre>":"",b+=d.outputSample?"</br><h5><b>输出例子:</b></h5><pre>"+d.outputSample+"</pre>":""}new D({title:H.getQuestionType(a.type),width:960,content:A.execTpl(['<div class="pop-questions">',"<h2>#{title}</h2>",'<dl><dd style="border:none;padding:0 0 10px 0;">#{content}</dd><dd style="border:none;padding:0;">#{ext}</dd></dl>',"</div>"].join(""),{title:4===a.type||6===a.type?a.title:"",content:a.content,ext:b}),ok:function(){}})}var c=this;window.win&&window.win.showLoading(),G.getQuestions({query:{ids:a},call:function(a){b(a.data.datas[0])},error:function(){b(null)}})}function u(a){return{count:a.count}}var v=a("nc"),w=a("cpn"),x=v.$,y=v.Base,z=v.Clazz,A=v.Str,B=v.Dom,C=v.Component,D=w.Popup,E=w.CheckBox,F=w.SelectMult,G=(w.Input,a("../../../../../../action/paper")),H=a("../../../../../../util/util"),I=a("../../../../../../component/miniInput"),J=a("../../../../../../component/department"),K="ABCDEFGHIJKLMNOPQRSTUVWXYZ",L=c.exports=z.create();z.mix(L,C,{_template:['<div class="condition-check-info" style="margin-bottom:20px;">','<div class="condition-hd"><h2 class="js-question-title"></h2></div>','<div class="condition-check-wrap">','<label class="checked js-depart">按机构平均分配</label>','<label class="js-people" style="margin-left:20px">按人数分配</label>','<label class="checked js-inner" style="margin-left:20px">机构内平均分配</label>',"</div>",'<div class="condition-check-filter clearfix">','<div class="form-group check-filter-item">',"<label>机构</label>",'<div class="js-department-cpn"></div>',"</div>",'<div class="data-item-box js-department-home"></div>',"</div>",'<div class="data-item-box js-user-home"></div>','<div class="condition-num">符合条件的待分配试卷数量：','<span class="font-green">#{count}</span>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn(),a.refreshCtl()}},{name:"click .js-question-title",handler:function(){var a=this,b=a.rawConfig;a.showQuestion(b.question.categoryMenu.questionId)}}]},{initCpn:d,saveDepartmentVal:e,fixDepartment:f,dealTypeChange:g,dealIptChange:h,refreshCtl:k,val:i,check:j,getTotal:l,getDepartInputTotal:m,getUserInputTotal:n,mapCpn:o,getDepartCpn:p,getUserCpn:q,getUserDepartCpn:r,setInputNone:s,showQuestion:t,_getData:u})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/step2/index",["nc","cpn","../../../../../../core/module","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/judge","../../../../../../util/ajax","../../../../../../action/user","../../../../../../component/miniInput","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","../steps","../../../../../../util/switch","./alloc","../../../../../../action/paper","../../../../../../component/department","../util"],function(a,b,c){function d(a){{var b=this;b.getParam()}u.getSimpleFullDepartments({params:{userId:b.getUserId()},query:{role:1},call:function(c){var d=c.data;b.departmentList=d||[],"0"===q.id(b.judgingAllocType)?a&&a():b.getJudgingQuestionData(a)}})}function e(a){var b=this,c=b.getPreStepAllocCondition(),d=b.getParam();return 2===+d.beginStep?void t.reJudgeQuestionAssign({query:{paperId:d.paperId,assignedUserId:d.subUserId},call:function(c){var d=b.getWin().showLoading("载入中...");v.getTaskProgress(!0,c.data,function(c){var e=c.end,f=c.content,g=c.error;g?(d.close(),r.alert(f)):e&&(d.close(),b.questions=JSON.parse(f),a&&a())})},error:function(a){r.alert(a.msg)}}):void t.submitNeedJudgeQuestionsOfPaperJob({query:c,call:function(c){var d=b.getWin().showLoading("载入中...");v.getTaskProgress(!0,c.data,function(c){var e=c.end,f=c.content,g=c.error;g?(d.close(),r.alert(f)):e&&(d.close(),b.questions=JSON.parse(f),a&&a())})},error:function(a){r.alert(a.msg)}})}function f(a){var b=this,c=b.getPreStepAllocCondition(),d=b.getParam();return q.extend(c,{allocType:b.isAllocByWhole()?0:1}),2===+d.beginStep?(q.extend(c,a,{paperId:d.paperId,oldAssignedUserId:d.subUserId}),void t.reJudge({type:"POST",params:{userId:b.getUserId()},body:c,call:function(a){var c=b.getWin().showLoading("转移中...");v.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),r.alert(e)):d&&(c.close(),b.removePreStepData(),r.tips("转移成功",function(){b.nav("paper",{action:"judge/allocation"})}))})},error:function(a){r.alert(a.msg)}})):void t.assign({params:{userId:b.getUserId()},body:q.extend(c,a),call:function(a){var c=b.getWin().showLoading("分配中...");v.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),r.alert(e)):d&&(c.close(),b.removePreStepData(),r.tips("分配成功",function(){b.nav("paper",{action:"judge/allocation"})}))})},error:function(a){r.alert(a.msg)}})}function g(){var a=this,b=a.getEl(),c=a.getParam(),d=['<div class="js-step" style="margin-top: 10px;"></div>','<div class="js-content"></div>','<div class="btn-wrap">',2===+c.beginStep?"":'<a href="javascript:void(0);" class="btn btn-default js-pre">上一步</a>','<a href="javascript:void(0);" class="btn btn-primary js-alloc">完成分配</a>',"</div>"].join("");b.html(d),a.contentEl=b.find(".js-content"),a.stepEl=b.find(".js-step");{var e=a.getPreStepData();a.steps=new w({renderTo:a.stepEl,module:a,currentStep:2,beginStep:c.beginStep||1,paperName:e.paperName||"",unAssignedCnt:e.unAssignedCnt||0,judgingAllocType:a.judgingAllocType})}a.isAllocByWhole()?a.allocItem=new x({renderTo:a.contentEl,departments:a.departmentList,paperName:e.paperName,count:a.chooseAllocCount,listeners:{change:function(){}}}):(a.questionCpns=[],q.forEach(a.questions,function(b){var c=new x({renderTo:a.contentEl,departments:a.departmentList,count:b.count,question:b,listeners:{change:function(){}}});a.questionCpns.push(c)})),e.chooseAllocCount||r.alert("数据已失效",function(){a.nav("paper",{action:"judge/allocation"})})}function h(){var a=this,b=a.getParam();return y.getDb(y.DB_ALLOCATION_METHOD+"_"+b.paperId)}function i(){var a=this,b=a.getParam();return y.removeDb(y.DB_ALLOCATION_METHOD+"_"+b.paperId)}function j(){var a=this,b=a.getPreStepData();return{paperId:a.getParam().paperId,method:b.method,categoryList:b.categoryList,compareList:b.compareList,valList:b.valList,union:b.union,excel:b.excel,jobNameList:b.jobNameList,departmentList:b.departmentList,schoolList:b.schoolList,degreeList:b.degreeList,areaList:b.areaList}}function k(){var a=this;return"0"===q.id(a.judgingAllocType)}function l(){var a=this;if(a.isAllocByWhole()){var b=a.allocItem.check();return b.right?!0:(r.alert(b.msg),!1)}var c=!0;return q.forEach(a.questionCpns,function(a){var b=a.check();return b.right?void 0:(r.alert(b.msg),c=!1,q.BREAK)}),c}function m(){var a=this;if(a.isAllocByWhole())return a.allocItem.val();var b=[],c=[],d=0;return q.forEach(a.questionCpns,function(a){var e=a.val();b.push(e),d+=e.validUserCount;var f=e.uidList.split("_");q.forEach(f,function(a){-1==c.indexOf(a)&&c.push(a)})}),{allocData:JSON.stringify(b),totalUserCnt:c.length,validUserCount:d}}var n=a("nc"),o=a("cpn"),p=(n.$,n.Clazz),q=n.Base,r=o.Popup,s=a("../../../../../../core/module"),t=a("../../../../../../action/judge"),u=a("../../../../../../action/user"),v=(a("../../../../../../component/miniInput"),a("../../../../extend/bll/task")),w=a("../steps"),x=a("./alloc"),y=a("../util"),z=c.exports=p.create();p.mix(z,s,{style:"/stylesheets/styles/system/checkSubjectProgress.css",title:"分配判题",_template:'<div class="module-body"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}a.judgingAllocType=q.id(a.getParam().allocType)||a.getWin().user.judgingAllocType,a.departmentList=[];var b=a.getPreStepData();a.chooseAllocCount=b.chooseAllocCount,a.getData(function(){a.renderData()})}},{name:"click .js-alloc",handler:function(){var a=this;if(a.check()){var b=a.val(),c=['你将要分配的试卷总数为：<a href="javascript:void(0);" class="link-green">',a.chooseAllocCount,"</a><br/>",'分配的判题账号总数为：<a href="javascript:void(0);" class="link-green">',b.validUserCount,"</a>"].join("");r.confirm(c,function(){a.alloc(b)})}}},{name:"click .js-pre",handler:function(){var a=this,b=a.getParam();a.nav("paper",{action:"judge/allocate/step1/index",paperId:b.paperId})}}]},{getData:d,renderData:g,alloc:f,getPreStepData:h,removePreStepData:i,getJudgingQuestionData:e,getPreStepAllocCondition:j,isAllocByWhole:k,check:l,val:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/steps",["nc","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(){var a=this,b=(a.rawConfig,a.getEl()),c=f.execTpl(['<div class="cur-positon">',"<span>分配试卷：#{paperName}</span>",'<span>未判题试卷：<i class="font-green">#{unAssignedCnt}</i></span>','<div class="check-btn-wrap">','<span class="assigned-mod">',"当前分配方式：#{allocType}","#{changeMethod}","</span>","</div>","</div>"].join(""),{paperName:a.paperName,unAssignedCnt:a.unAssignedCnt,allocType:"0"===a.judgingAllocType?"整卷分配":"按题目分配",changeMethod:j.can("isSubUser")?"":'<a href="javascript:void(0);" class="js-go-judging-alloc"><i class="icon-random"></i>更换判题方式</a>'}),d=a.currentStep,e=["确定分配范围","选择改卷人员","完成"].slice(a.beginStep-1);c+='<div class="step-main" style="margin-top:50px"><div class="steps-wrap">',i.forEach(e,function(a,b){var e=b+1;c+=f.execTpl('<div class="item #{cls}"><div class="step-num-wrap"><div class="step-num">#{step}</div></div><h3 class="steps-tit">#{title}</h3></div>',{cls:d>=e?"done":"",step:e,title:a})}),c+="</div></div>",b.html(c)}var e=a("nc"),f=(e.$,e.Str),g=e.Component,h=e.Clazz,i=e.Base,j=a("../../../../../util/switch"),k=c.exports=h.create();h.mix(k,g,{_template:"",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=b.module.getWin().user;a.judgingAllocType=i.id(b.judgingAllocType||c.judgingAllocType),a.isHr=c.subUser&&"0"===i.id(c.role),a.currentStep=b.currentStep||1,a.beginStep=b.beginStep||1,a.paperName=b.paperName,a.unAssignedCnt=b.unAssignedCnt,a.renderList()}},{name:"click a.js-go-judging-alloc",handler:function(){var a=this,b=a.rawConfig.module;b.nav("account",{action:"judgingSetting",back:{module:"paper",param:b.getParam()}})}}]},{renderList:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocate/util",["nc","../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b._db=b._db||new i(j.appDb.judgeAllocation);return h.trim(a)?c.get(a)||{}:c}function e(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function f(a){var b=this,c=b.getDb();b._db.refresh(),c.remove(a)}var g=a("nc"),h=(g.Base,g.$),i=g.Db,j=a("../../../../../core/siteConfig");c.exports={DB_ALLOCATION_METHOD:"DB_JUDGE_METHOD",getDb:d,setDb:e,removeDb:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/allocation",["nc","cpn","../cpn/navProject","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject","../../../../core/module","../../../../util/util","../../../../action/judge","../../../../action/user","../../../../component/table","../../../../component/selectAll","./cpn/popupDepartPaperJudge","../../../../component/department","../../../../util/switch","./allocate/util","./util"],function(a,b,c){function d(a){var b=this;b.projectData=a,new s({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b.resetParam({projectId:a}),b.refresh()}})}function e(){var a=this,b=a.getEl(),c=a.getWin(),d=p.id(c.getUserByKey("judgingAllocType"));b.append(['<div class="menu-txt-box">','<ul class="menu-txt clearfix">','<li class="selected"><a href="javascript:void(0);">判题分配</a></li><li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/index">判题进度</a></li><li class="menu-pipe">|</li>','<li><a class="js-url" data-module="paper" data-action="judge/detail" href="javascript:void(0);">任务详情</a></li>',A.can("paperMyWork")?'<li class="menu-pipe">|</li><li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/myWork">我的任务</a></li>':"","</ul>",'<div class="check-btn-wrap">','<span class="assigned-mod">',"当前分配方式：","0"===d?"整卷分配":"按题目分配",A.can("isSubUser")?"":'<a href="javascript:void(0);" class="js-go-judging-alloc"><i class="icon-random"></i>更换判题方式</a>',"</span>",A.can("isSubUser")?"":'<a href="javascript:void(0);" class="js-add-subAccount">+添加判题账号</a>','<a href="javascript:void(0);" class="js-export-detail"><i class="icon-cloud-upload"></i>导出分配详情</a>',"</div>","</div>",'<div class="js-list"></div>'].join("")),a.listEl=b.find(".js-list"),a.tableCpn=new y({renderTo:a.listEl,needSelect:!0,needFixHeader:!0,noFixSelectList:!0,pageChange:function(b){a.addParam({page:b}),a.fetchList()}})}function f(){var a=this,b=(a.getEl(),a.getParam()),c=a.getProjectId();a.tableCpn.renderWait(),u.getAssignSummary({params:{userId:a.getUserId()},query:{page:b.page||"1",pageSize:20,onlyAlloc:b.onlyAlloc||"0",projectIdList:c?c:x.getAllId(a.projectData)},call:function(b){a.renderList(b.data)},error:function(b){a.tableCpn.renderNone(b.msg)}})}function g(a){var b=this,c=b.getEl(),d=b.getParam(),e=a.data||[],f=b.listData={};if(0===e.length)return b.tableCpn.renderNone();var g=['<a href="javascript:void(0);" class="help-wrapper link-gray">','<i class="icon-question-sign"></i>','<div class="tooltip bottom tooltip-info" style="min-width:250px;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">试卷答案为空，自动记为0分，不需要判卷</div>',"</div>","</a>"].join(""),h={head:[{text:"试卷",width:"15%"},"总数","待分配","无需分配"+g,"已分配","待判题","已判题",{text:"判题题型",width:"15%"},{text:"分配详情",width:"10%"},{text:'<label class="checkbox js-alloc-chk '+("1"===d.onlyAlloc?"checked":"")+'"><span class="icons"></span>仅显示未分配试卷</label>',width:"20%",style:{"min-width":"168px"}}],list:[]};p.forEach(e,function(a){f[a.id]=a;var b=p.map(a.questionCntList,function(a){var b=w.getQuestionType(a.questionType,!0);return b+"("+a.count+")"}).join(" | "),c=a.assignCnt||0,d=a.unAssignCnt||0,e=a.judgingCnt||0,g=a.partialJudgingCnt||0,i=g+e>c?0:c-e-g,j="";0!==d||0!==i&&0!==c?d>0&&(j='<a href="javascript:void(0);" class="btn btn-xs btn-auto btn-primary js-allocation" data-pid="'+a.id+'">分配</a>'):j='<a href="javascript:void(0);" class="btn btn-xs btn-auto btn-default" data-pid="'+a.id+'">'+(0===c?"无需分配":"已分配")+"</a>",i>0&&c>0&&(j+='<a href="javascript:void(0);" class="btn btn-xs btn-auto btn-default js-reset" style="margin-left:10px" data-pid="'+a.id+'">撤销</a>');var k=a.assignCnt-a.judgingCnt,l=[{text:['<label class="checkbox',a.assignCnt?'"':' disabled" title="这张试卷还没有被分配"','><span class="icons"></span></label>'].join(""),cls:"text-left"},{text:a.paperName,cls:"t-subject-title"},'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="-1_0_2_3">'+a.totalTestCount||"0</span>",'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="3">'+a.unAssignCnt||"0</span>",'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="-1">'+a.notNeedAllocCount||"0</span>",'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="0_2">'+a.assignCnt||"0</span>",'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="0">'+k+"</span>",'<a href="javascript:void(0);" class="font-green js-go-candidate" data-status="2">'+a.judgingCnt+"</span>",b,a.departmentAssignCntList&&a.departmentAssignCntList.length?'<a href="javascript:void(0);" class="font-green js-check-detail">查看详情</a>':"",{text:j}];h.list.push({items:l,attr:{"data-id":a.id}})}),b.tableCpn.updateHtml(h,{totalPage:a.totalPage,currentPage:a.currentPage,totalCount:a.totalCount}),r.transform(c.find("label.js-alloc-chk"),{change:function(){var a=!!this.isChecked();b.addParam({onlyAlloc:a?"1":null,page:null}),b.fetchList()}})}function h(a,b){v.getDepartmentTree({query:{},call:function(b){a&&a(b.data||[])},error:function(a){b&&b(a.msg)}})}function i(a){var b=n(a).closest("tr");return n.trim(b.attr("data-id"))}function j(){var a=this,b=a.getParam(),c=p.id(b.projectId);return"0"!==c?c:void 0}function k(){var a=this;a.nav("account",{action:"judgingSetting",back:{module:"paper",param:a.getParam()}})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=(l.Str,l.Base),q=(l.Time,l.Node,m.Popup),r=m.CheckBox,s=(m.Pager,a("../cpn/navProject")),t=a("../../../../core/module"),u=a("../../../../action/judge"),v=a("../../../../action/user"),w=a("../../../../util/util"),x=(a("../../extend/bll/task"),a("../../extend/bll/paper")),y=a("../../../../component/table"),z=(a("../../../../component/selectAll"),a("./cpn/popupDepartPaperJudge")),A=a("../../../../util/switch"),B=a("./util"),C=c.exports=o.create();o.mix(C,t,{style:"/stylesheets/styles/system/checkSubjectProgress.css",title:"判题分配",showTask:!0,_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl(),c=a.getWin();c.user.roleList||[]}return A.can("paperOnlyJudger")?a.nav("paper",{action:"judge/detail"}):(a.renderWait(b),void x.checkProject({all:!0,simple:!0,projectId:a.getProjectId(),call:function(c,d){a.getDepartmentTree(function(c){a.departmentData=c,b.html(""),a.initNav(d),a.initContainer(),a.fetchList()},function(b){a.renderNone(a.getEl(),b)})}}))}},{name:"click a.js-allocation",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-pid");u.checkCanJudgingAlloc({query:{paperId:d},call:function(a){var c=p.id(a.data);"2"===c?q.alert("你管理的机构暂未设置判题账号，无法进行判题分配，请先设置判题账号"):"1"===c?q.confirm("本套试卷为随机抽题试卷，考生抽取题目不同，不支持按题分配方式。是否修改默认分配方式？",p.bind(b.goSetting,b)):b.nav("paper",{action:"judge/allocate/step1/index",paperId:d})},error:function(a){q.alert(a.msg)}})}},{name:"click a.js-add-subAccount",handler:function(){var a=this;a.nav("account",{action:"authority/index/index"})}},{name:"click a.js-check-detail",handler:function(a){var b=this,c=b.getLineId(n(a.currentTarget)),d=(b.listData||{})[c];if(d){var e=b.getProjectId();z.show({module:b,projectIdList:e?e:x.getAllId(b.projectData),data:d,departmentData:b.departmentData,refresh:function(){b.fetchList()}})}}},{name:"click a.js-reset",handler:function(a){var b=this,c=n(a.currentTarget);q.confirm("本操作只能撤销未开始判题的试卷分配，撤销后的试卷将不会出现在判题官的判题页面，需要重新分配，是否确定撤销？",function(){u.resetJudge({params:{userId:b.getUserId()},type:"DELETE",body:{paperId:c.attr("data-pid")},call:function(){q.tips("分配撤销成功",function(){b.fetchList()})},error:function(a){q.alert(a.msg)}})})}},{name:"click a.js-go-judging-alloc",handler:function(){var a=this;a.goSetting()}},{name:"click .js-export-detail",handler:function(){var a=this,b=a.tableCpn.selectAll;return b.isSelectAll||0!==b.selectIds.length?void B.exportDetail({onlyAlloc:a.getParam().onlyAlloc||0,isAll:b.isSelectAll?1:2,ids:b.selectIds,projectIdList:a.getProjectId()}):q.alert("请先选择要导出分配详情的试卷")}},{name:"click .js-go-candidate",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-status").split("_");b.nav("paper",{action:"candidate/index/index",judgeType:"1",judgeStatusList:d,paperId:b.getLineId(c)})}}]},{initNav:d,initContainer:e,fetchList:f,renderList:g,getDepartmentTree:h,getLineId:i,getProjectId:j,goSetting:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/cpn/popupDepartPaperJudge",["nc","cpn","../../../../../action/judge","../../../../../util/ajax","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/department","../../../../../util/switch","../../../../../action/user","../allocate/util"],function(a,b,c){function d(a){a=a||{};var b=a.data||{},c=new u(a),d=c.popup=o.wrap(c,{content:c.html(),title:b.paperName+"分配详情",width:650,okTxt:"确定",hasScroll:!0,ok:function(){c.needRefresh&&n.isFunction(a.refresh)&&a.refresh()}});return d.popupContent.addClass("clearfix"),c}function e(){var a=this;a.departmentCpn=new p({renderTo:a.getEl(".js-department-cpn"),size:"small",options:s.getOption(a.rawConfig.departmentData),change:function(){a.fetchList()}})}function f(a){var b=this,c=b.rawConfig,d=c.data||{};q.getPaperDepartmentAssign({params:{userId:c.module.getUserId()},query:{departmentIdList:b.departmentCpn.val(),page:a,paperId:d.id,projectIdList:c.projectIdList},call:function(a){b.getEl(".js-table").html(b.getStr(a.data)),b.popup.fixPosition()},error:function(a){b.popup.close(),o.alert(a.msg)}})}function g(a){var b=this;b.listData={},b.totalAssigmentCount=0,b.totalJudgingCount=0,b.totalAssignCountByPaper=0,b.totalAssignCountByQuestion=0,n.forEach(a,function(a){b.totalAssigmentCount+=+a.assignCount,b.totalJudgingCount+=+a.judgingCount,b.totalAssignCountByPaper+=+a.assignCountByPaper,b.totalAssignCountByQuestion+=+a.assignCountByQuestion});var c=[{text:"账号",width:"20%"},{text:"机构",width:"20%"},{text:"总任务",width:"20%"},{text:"已判题",width:"20%"}];b.totalAssignCountByPaper&&c.push({text:"未判题（整卷分配）",width:"20%",style:{"min-width":"180px"}}),b.totalAssignCountByQuestion&&c.push({text:"未判题（按题目分配）",width:"20%"});var d=["合计","",b.totalAssigmentCount,b.totalJudgingCount];b.totalAssignCountByPaper&&d.push(['<span style="width:30%;display:inline-block;">',b.totalAssignCountByPaper,"</span>",'<span style="width:35%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-reset-all">全部撤销</a></span>','<span style="width:35%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-transfer-department" data-type="0">全部转移</a></span>'].join("")),b.totalAssignCountByQuestion&&d.push(['<span style="width:40%;display:inline-block;">',b.totalAssignCountByQuestion,"</span>",'<span style="width:60%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-transfer-department" data-type="1">全部转移</a></span>'].join(""));var e={head:c,list:[],footer:d};return n.forEach(a,function(a){b.listData[a.id]=a;var c=[a.name,a.department,a.assignCount,a.judgingCount];b.totalAssignCountByPaper&&c.push(['<span style="width:30%;display:inline-block;">',a.assignCountByPaper,"</span>",'<span style="width:35%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-reset-user">',a.assignCountByPaper?"撤销":"","</a></span>",'<span style="width:35%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-transfer-task" data-type="0">',a.assignCountByPaper?"转移":"","</a></span>"].join("")),b.totalAssignCountByQuestion&&c.push(['<span style="width:40%;display:inline-block;">',a.assignCountByQuestion,"</span>",'<span style="width:60%;display:inline-block;"><a href="javascript:void(0);" class="font-green js-transfer-task" data-type="1">',a.assignCountByQuestion?"转移":"","</a></span>"].join("")),e.list.push({items:c,attr:{"data-id":a.id}})}),r.getHtml(e)}function h(a){var b=this,c=k(a).closest("tr").attr("data-id");return b.listData[c]}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Str,i.Node,j.Popup),p=j.SelectMult,q=a("../../../../../action/judge"),r=a("../../../../../component/table"),s=a("../../../../../component/department"),t=a("../allocate/util"),u=c.exports=m.create();m.mix(u,l,{_template:["<div>",'<div class="js-department-cpn" style="margin-bottom:20px;"></div>','<div class="js-table"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.fetchList(1)}},{name:"click .js-reset-all",handler:function(){function a(){q.resetJudge({type:"DELETE",params:{userId:d.getUserId()},body:{paperId:e.id},call:function(){o.tips("分配撤销成功",function(){b.fetchList(1),b.needRefresh=!0})},error:function(a){b.popup.close(),o.alert(a.msg)}})}var b=this,c=b.rawConfig,d=c.module,e=c.data;return 0===b.totalAssigmentCount?o.alert("本组没有分配判题"):0===b.totalAssignCountByPaper?o.alert("该组已完成全部整卷分配的判题任务，无法撤销"):0===b.totalJudgingCount?o.confirm("是否确定撤销该组的全部判题任务？",a):void o.confirm("该组已开始判题，本操作只能撤销未开始判题的试卷分配，撤销后的试卷将不会出现在判题官的判题页面，需要重新分配，是否确定撤销余下判题任务？",a)}},{name:"click .js-reset-user",handler:function(a){function b(){q.resetJudge({type:"DELETE",params:{userId:e.getUserId()},body:{subUserId:g.id,paperId:h.id},call:function(){o.tips("分配撤销成功",function(){c.fetchList(1),c.needRefresh=!0})},error:function(a){c.popup.close(),o.alert(a.msg)}})}var c=this,d=c.rawConfig,e=d.module,f=k(a.currentTarget),g=c.getLineData(f),h=d.data;return f.blur(),0===g.judgingCount?o.confirm("是否确定撤销该账号的全部整卷分配的判题任务？",b):void o.confirm("该账号已开始判卷，本操作只能撤销未开始判题的试卷分配，撤销后的试卷将不会出现在判题官的判题页面，需要重新分配，是否确定撤销余下整卷分配的判题任务？",b)}},{name:"click .js-transfer-task",handler:function(a){var b=this,c=b.rawConfig,d=k(a.currentTarget),e=b.getLineData(d),f=c.data,g=+d.attr("data-type"),h=[e.assignCountByPaper,e.assignCountByQuestion][g];o.confirm("确定将"+h+"个未判题任务转移给其他判题账号？",function(){t.setDb(t.DB_ALLOCATION_METHOD+"_"+f.id,{chooseAllocCount:h,method:"1",paperName:f.paperName,unAssignedCnt:h}),c.module.nav("paper",{action:"judge/allocate/step2/index",beginStep:2,paperId:f.id,subUserId:e.id,allocType:g})})}},{name:"click .js-transfer-department",handler:function(a){var b=this,c=b.rawConfig,d=c.data,e=k(a.currentTarget),f=+e.attr("data-type"),g=[b.totalAssignCountByPaper,b.totalAssignCountByQuestion][f];o.confirm("确定将全部"+(f?"按题目分配":"按整卷分配")+"的未判题任务转移给其他判题账号？",function(){t.setDb(t.DB_ALLOCATION_METHOD+"_"+d.id,{chooseAllocCount:g,method:"1",paperName:d.paperName,unAssignedCnt:g}),c.module.nav("paper",{action:"judge/allocate/step2/index",beginStep:2,paperId:d.id,allocType:f})})}}],show:d},{initCpns:e,getStr:g,fetchList:f,getLineData:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/cpn/popupDepartSubJudgePro",["nc","cpn","../../../../../action/judge","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new r(a),c=p.wrap(b,{content:b.html(),title:a.departmentName+"判题账号判题进度",width:650,okTxt:"确定",hasScroll:!0,ok:function(){}});return c.popupContent.addClass("clearfix"),b}function e(){var a=this,b=a.rawConfig.departmentData;a.departmentCpn=new n({renderTo:a.getEl(".js-department-cpn"),size:"small",options:l.map(b,function(b){return{text:b.department,value:l.id(b.id),checked:l.id(a.rawConfig.departmentId)===l.id(b.id)}}),change:function(){a.fetchList(1)}})}function f(a){var b=this,c=b.rawConfig;q.getSubUsersByDepartment({params:{userId:c.userId},query:{departmentIdList:b.departmentCpn.val(),page:a,projectIdList:c.projectIdList},call:function(c){var d=c.data,e=b.getStr(d.datas);b.getEl(".js-main").html(e),new o({renderTo:b.getEl(".js-main"),current:a,total:d.totalPage,pageChange:function(a){b.fetchList(a)}}),b.popup.fixPosition()},error:function(a){b.popup.close(),p.alert(a.msg)}})}function g(a){return m.execTpl(["<div>",'<div v-if="items.length === 0" style="text-align:center;font-size:14px;">该组暂无判题任务</div>',"<table v-else>","<tbody>","<tr>",'<th width="170">账号</th>','<th width="140">登录邮箱</th>','<th width="120">总任务</th>','<th width="80">已判题</th>','<th width="80">待判题</th>',"</tr>",'<tr v-for="item in items">',"<td width=\"170\">#{item.name + (item.status === 1 ? '(已删除)' : '')}</td>",'<td width="140">#{item.email}</td>','<td width="120">#{item.assignCount}</td>','<td width="80">#{item.judgeCount}</td>','<td width="80">#{item.unJudgeCount}</td>',"</tr>","</tbody>","</table>","</div>"],{items:a||[]})}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=(h.Limit,h.Str,h.Node),n=i.SelectMult,o=i.Pager,p=i.Popup,q=a("../../../../../action/judge"),r=c.exports=k.create();k.mix(r,j,{_template:["<div>",'<div class="js-department-cpn" style="margin-bottom:20px;"></div>','<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.fetchList(1)}}],show:d},{initCpns:e,getStr:g,fetchList:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/cpn/popupNotJudgePro",["nc","cpn","../../../../../action/judge","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new o(a),c=m.wrap(b,{content:b.html(),title:"未判题详情",width:650,okTxt:"确定",hasScroll:!0,ok:function(){}});return c.popupContent.addClass("clearfix"),b}function e(a){var b=this,c=b.rawConfig;n.getSubUsersNotJudge({params:{userId:c.userId},query:{page:a,pageSize:10,projectIdList:c.projectIdList},call:function(c){var d=c.data;b.getEl().html(b.getStr(d.datas)),new l({renderTo:b.getEl(),current:a,total:d.totalPage,pageChange:function(a){b.fetchList(a)}}),b.popup.fixPosition()},error:function(a){b.popup.close(),m.alert(a.msg)}})}function f(a){return k.execTpl(["<div>",'<div v-if="items.length === 0" style="text-align:center;font-size:14px;">没有未判题信息</div>',"<table v-else>","<tbody>","<tr>",'<th width="170">分组</th>','<th width="170">账号</th>','<th width="120">总任务</th>','<th width="80">待判题</th>',"</tr>",'<tr v-for="item in items">','<td width="170">#{item.departmentName}</td>','<td width="170">#{item.name}</td>','<td width="120">#{item.assignCount}</td>','<td width="80">#{item.unJudgeCount}</td>',"</tr>","</tbody>","</table>","</div>"],{items:a||[]})}var g=a("nc"),h=a("cpn"),i=(g.$,g.Component),j=g.Clazz,k=(g.Base,g.Limit,g.Str,g.Node),l=h.Pager,m=h.Popup,n=a("../../../../../action/judge"),o=c.exports=j.create();j.mix(o,i,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchList(1)}}],show:d},{getStr:f,fetchList:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/cpn/popupOverallEvaluate",["nc","cpn","../../../../../action/remark","../../../../../util/ajax"],function(a,b,c){function d(a){var b=new t(a),c=q.wrap(b,{title:"整体评价",content:b.html(),width:650,cancelTxt:"取消",ok:function(){return b.submit(function(){q.tips("操作成功！"),c.close()}),!0}});return b}function e(){var a=this,b=a.ipt=new r({renderTo:a.getEl(".js-my-evaluate"),renderBy:"html",type:"textarea",clsIpt:"pop-recovery-txt",placeholder:"请输入你对考生的整体评价"});b.getEl().width("100%"),b.getEl("textarea").css("resize","none")}function f(a){var b=this,c=b.getEl(),d=b.rawConfig,e=m.id(d.userId),f="";m.forEach(a,function(a){return m.id(a.uid)===e?b.ipt.val(a.remark):void(f+='<div class="pop-written-comment">'+a.userName+"："+(a.remark||"没有填写评价")+"</div>")}),c.find(".js-other-evaluate").html(f),c.find(".js-other-evaluate-home")[f?"show":"hide"]()}function g(a){var b=this,c=b.rawConfig;b.tip(b.tipEl,"加载中..."),s.getTestRemark({params:{userId:c.userId},query:{testId:c.testId,questionId:0},call:function(c){b.mainEl.show(),b.tipEl.hide();var d=m.isArray(c.data)?c.data:[];d=m.filter(d,function(a){return!!a}),a&&a(d)},error:function(c){b.tip(b.tipEl,c.msg,function(){b.fetchData(a)})}})}function h(a){var b=this,c=b.rawConfig,d=b.getEl();p.mark(d)||s.addRemarkToTest({params:{userId:c.userId},body:{testId:c.testId,remark:b.ipt.val(),questionId:0},call:a,error:function(a){q.alert(a.msg)},always:function(){p.clear(d)}})}function i(a,b,c){var d=this,e=['<div style="font-size:14px;text-align:center;">',b,c?'&lt;<a href="javascript:void(0);" class="font-green js-error-call">点击重试</a>&gt;':"","</div>"].join("");l(a).html(e),c&&a.find(".js-error-call").on("click",c),d.tipEl.show(),d.mainEl.hide()}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Base,n=j.Clazz,o=j.Component,p=j.Limit,q=k.Popup,r=k.Input,s=a("../../../../../action/remark"),t=c.exports=n.create();n.mix(t,o,{_template:["<div>",'<div class="pop-written-plan js-main" style="display:none;">','<div class="js-other-evaluate-home" style="display:none;">','<div class="pop-label-block">其他判题官评价</div>','<div class="js-other-evaluate"></div>',"</div>",'<div class="pop-label-block">我的评价</div>','<div class="js-my-evaluate"></div>',"</div>",'<div class="js-tip"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.mainEl=b.find(".js-main"),a.tipEl=b.find(".js-tip"),a.fetchData(function(b){a.initTextarea(),a.initRender(b),a.popup.fixPosition()})}}],show:d},{initTextarea:e,initRender:f,fetchData:g,submit:h,tip:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/cpn/popupTestMark",["nc","cpn","../../../../../action/remark","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};{var b=new q(a);o.wrap(b,{title:"单一题目评价",content:b.html(),width:600,okTxt:"确定",cancelTxt:"取消",noUnique:a.noUnique||!1,ok:function(){var c=i.trim(b.remarkIpt.val());return c?c.length>100?(b.remarkIpt.setErrorTips("备注不能超过100个字符"),!0):void p.addRemarkToTest({params:{userId:a.userId},body:{testId:a.testId,remark:c,questionId:a.questionId},call:function(){a.call&&a.call(c||""),o.tips("操作成功")},error:function(a){o.alert(a.msg)}}):(b.remarkIpt.setErrorTips("备注不能为空"),!0)}})}return b}function e(a){var b=this,c=b.rawConfig;p.getTestRemark({params:{userId:c.userId},query:{testId:c.testId,questionId:c.questionId},call:function(b){a&&a(b.data)},error:function(a){b.getEl().html('<div style="font-size:14px;text-align:center;">'+a.msg+"</div>")}})}function f(){var a=this,b=a.rawConfig,c=a.remarkIpt.inputEl;m.show({input:c,needReWidth:!0,listeners:{render:function(){this.getEl().css("min-width",c.outerWidth())}},reqList:function(a,c){p.searchRecentRemark({params:{userId:b.userId},query:{testId:b.testId,keyword:a},call:function(a){c&&c(a.data||[])},error:function(){c&&c()}})},getItem:function(a){return{text:a}},ok:function(b){a.remarkIpt.val(b.text),a.remarkIpt.setNone()}})}var g=a("nc"),h=a("cpn"),i=g.$,j=g.Component,k=g.Clazz,l=g.Base,m=(g.Str,g.KeyBoard,h.AttachSuggest),n=h.Input,o=h.Popup,p=a("../../../../../action/remark"),q=c.exports=k.create();k.mix(q,j,{_template:['<div class="letter-content clearfix">','<div style="font-size:14px;text-align:center;">加载中...</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.fetchData(function(b){var c=a.rawConfig,d=a.getEl(),e=l.id(c.userId),f=l.find(b,function(a){return l.id(a.uid)===e});d.html(['<div class="letter-item">','<label class="letter-label">备注</label>','<div class="btn-group js-remark-input"></div>',"</div>"].join("")),a.remarkIpt=new n({renderTo:d.find(".js-remark-input"),value:(f||{}).remark}),a.popup.fixPosition(),a.initSuggest()})}},{name:"click li.js-history-remark",handler:function(a){var b=this,c=i(a.currentTarget),d=i.trim(c.attr("data-content"));b.updateRemarkInfo(d)}}],show:d},{fetchData:e,initSuggest:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/detail",["nc","cpn","../cpn/navProject","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../component/department","../../../../util/switch","../../../../action/user","../../../../core/module"],function(a,b,c){function d(a){var b=this;b.projectData=a,new v({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b.resetParam({projectId:a}),b.refresh()}})}function e(a){var b=this,c=b.getParam(),d=b.getEl(),e=p.id(c.paperId),f=r.execTpl(['<div class="com-content">','<div class="menu-txt-box" style="padding-bottom:0;">','<ul class="menu-txt clearfix">','<li v-if="!isSubUser"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/allocation">判题分配</a></li><li v-if="!isSubUser" class="menu-pipe">|</li>','<li v-if="!isSubUser"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/index">判题进度</a></li><li v-if="!isSubUser" class="menu-pipe">|</li>','<li class="selected"><a href="javascript:void(0);">任务详情</a></li><li v-if="needSelf" class="menu-pipe">|</li>','<li v-if="needSelf"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/myWork">我的任务</a></li>',"</ul>","</div>",'<div class="com-cont-main">','<div class="js-oprt-bar" style="margin-bottom:10px;">','<div class="js-paper-list"></div>','<label style="font-size:14px;margin:0 5px 0 20px;line-height:34px;">考生</label><div class="js-student-department"></div>','<label v-if="!isSubUser" style="font-size:14px;margin:0 5px 0 20px;line-height:34px;">判题官</label><div v-if="!isSubUser" class="js-judge-department"></div>',"</div>",'<div class="js-detail"></div>',"</div>","</div>"],{isSubUser:C.can("paperOnlyJudger"),needSelf:C.can("paperMyWork")});d.append(f),b.listEl=d.find("div.js-detail"),b.tableCpn=new w({renderTo:b.listEl,needFixHeader:!0,pageChange:function(a){b.addParam({page:a}),b.fetchList()}});var g=d.find(".js-paper-list");if(a.length>0){var h=[{value:-1,text:"全部试卷",checked:!e}];p.forEach(a,function(a){var b=p.id(a.id);h.push({value:b,text:a.paperName,checked:e===b})}),new s({renderTo:g,renderBy:"replaceWith",size:"small",text:"筛选试卷",needSearch:!0,options:h,change:function(){var a=p.id(this.val());b.addParam({paperId:"-1"===a?null:a,page:null}),b.fetchList(),b.fetchSummary()}})}b.studentDepartmentCpn=new u({renderTo:d.find(".js-student-department"),renderBy:"replaceWith",size:"small",needSearch:!0,options:x.getOption(b.departmentData),change:function(){var a=this.val();b.addParam({studentDepartment:a,page:null}),b.fetchList(),b.fetchSummary()}}),c.studentDepartment&&b.studentDepartmentCpn.val(c.studentDepartment),C.can("paperOnlyJudger")||(b.judgeDepartmentCpn=new u({renderTo:d.find(".js-judge-department"),renderBy:"replaceWith",size:"small",needSearch:!0,options:x.getOption(b.departmentData),change:function(){var a=this.val();b.addParam({judgeDepartment:a,page:null}),b.fetchList(),b.fetchSummary()}}),c.judgeDepartment&&b.judgeDepartmentCpn.val(c.judgeDepartment))}function f(){var a=this,b=(a.getEl(),a.getUserId()),c=a.getParam(),d=a.getProjectId();a.tableCpn.renderWait(),z.getJudgingTests({params:{userId:b},query:{page:c.page,isDone:c.isDone,order:c.order,orderBy:c.orderBy,paperId:c.paperId,departmentIdList:a.studentDepartmentCpn.val(),judgeDepartmentIdList:a.judgeDepartmentCpn?a.judgeDepartmentCpn.val():void 0,projectIdList:d?d:B.getAllId(a.projectData)},call:function(b){var c=b.data;a.renderList(c.datas||[],c.currentPage,c.totalPage)},error:function(b){a.tableCpn.renderNone(b.msg)}})}function g(){var a=this,b=a.getEl(),c=a.getParam(),d=b.find(".js-oprt-bar"),e=a.getProjectId();d.find(".judge-result").remove(),z.getJudgingTaskSummary({params:{userId:a.getUserId()},query:{paperId:c.paperId,projectIdList:e?e:B.getAllId(a.projectData),departmentIdList:a.studentDepartmentCpn.val(),judgeDepartmentIdList:a.judgeDepartmentCpn?a.judgeDepartmentCpn.val():void 0},call:function(a){var b=r.execTpl(['<div class="judge-result" style="display:inline-block;margin:0 0 0 20px;">','<span class="result-item">总共分配(#{summary.assignedCount}份)</span>','<span class="result-item">已判题(#{summary.judgedCount}份)</span>','<span class="result-item">未判题(#{summary.unJudgedCount}份)</span>','<span v-if="!paperOnlyJudger" class="result-item">未分配(#{summary.unAssignedCount}份)</span>',"</div>"],{summary:a.data,paperOnlyJudger:C.can("paperOnlyJudger")});d.append(b)}})}function h(a,b,c){var d=this,e=d.getEl(),f=(d.listEl,d.getParam()),g=d.tableCpn;if(0===a.length)return g.renderNone();var h={head:[{text:"试卷",width:"20%"},{text:"姓名",width:"10%"},{text:"考生所属机构",width:"10%"},{text:"完成时间",width:"15%",order:"0"},"客观题","主观题",{text:"总分",order:"2"},{text:"判断人",width:"10%",order:"1"},{text:'<label class="checkbox js-status-chk '+(f.isDone===!1?"checked":"")+'"><span class="icons"></span>只看未判题</label>',width:"10%"}],list:[]};p.forEach(a,function(a){var b=a.done||!1,c=[{text:'<i class="'+(b>0?"icon-spot-green":"icon-spot-red")+'"></i><span>#{paperName}</span>',data:a,cls:"t-subject-title"},a.userName,a.ctsDepartment,q.form(new Date(a.finishTime),"yyyy-MM-dd HH:mm:ss"),(a.objectiveScore||0).toFixed(1),(a.subjectiveScore||0).toFixed(1),(a.totalScore||0).toFixed(1),a.judgeUserName,'<a href="javascript:void(0);" data-id="'+a.testId+'" class="btn btn-auto btn-xs '+(b?"btn-default":"btn-primary")+' js-go-score">'+(b?"已判题":"判题")+"</a>"];h.list.push({items:c})}),g.updateHtml(h,{totalPage:c,currentPage:b}),n(".js-rank").removeClass("selected"),n("div[data-order-by="+f.orderBy+"]").find(".js-rank[data-order="+f.order+"]").addClass("selected"),t.transform(e.find("label.js-status-chk"),{change:function(){var a=!!this.isChecked();d.addParam({isDone:a?!1:null,page:null}),d.fetchList()}})}function i(){var a=this,b=a.getParam(),c=p.id(b.projectId);return"0"!==c?c:void 0}function j(a,b){{var c=this;c.getParam().projectId}return c.departmentData?c.departmentData:void A.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getProjectId(),entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,p.isFunction(a)&&a(d)},error:function(a){p.isFunction(b)&&b(a.msg)}})}function k(a,b){A.getDepartmentTree({query:{},call:function(b){a&&a(b.data||[])},error:function(a){b&&b(a.msg)}})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=(l.Str,l.Base),q=l.Time,r=l.Node,s=m.Select,t=(m.Pager,m.CheckBox),u=m.SelectMult,v=a("../cpn/navProject"),w=a("../../../../component/table"),x=a("../../../../component/department"),y=a("../../../../core/module"),z=a("../../../../action/api"),A=a("../../../../action/user"),B=a("../../extend/bll/paper"),C=a("../../../../util/switch"),D=c.exports=o.create();o.mix(D,y,{style:"/stylesheets/styles/system/scoreManage.css",title:"任务详情",partSubJudge:!0,_template:'<div class="com-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl();a.getWin()}a.renderWait(b),B.checkProject({all:!0,simple:!0,isJudge:!0,projectId:a.getProjectId(),call:function(c,d){c="0"===p.id(c)?B.getAllId(d):c,B.getAllPaper({id:c,ext:{isJudge:!0},call:function(c){a.getDepartmentTree(function(e){a.departmentData=e,b.html(""),a.initNav(d),a.initContainer(c),a.fetchList(),a.fetchSummary()},function(c){a.renderNone(b,c)})}})}})}},{name:"click .js-go-score",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-id");if(d){var e=p.clone(b.getParam());delete e.action;var f=(+e.page||1)-1,g=c.closest("tr"),h=g.index()+20*Math.max(0,f);b.nav("paper",{action:"judge/score/index",testId:d,detailParam:e,projectIdList:b.getProjectId(),pos:h})}}},{name:"click a.js-rank",handler:function(a){var b=this,c=n(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,orderBy:e,order:f}),b.fetchList())}}]},{initNav:d,initContainer:e,fetchList:f,fetchSummary:g,renderList:h,getProjectId:i,getDepartment:j,getDepartmentTree:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/index",["nc","cpn","../cpn/navProject","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject","../../../../core/module","../../../../util/util","../../../../action/judge","../../../../component/table","../../../../component/selectAll","../../../../component/popupSub/popupJudgePaper","../../../../component/popupSub/popupSelect","./cpn/popupDepartSubJudgePro","./cpn/popupNotJudgePro","./util","../../../../util/switch"],function(a,b,c){function d(a){var b=this;b.projectData=a,new p({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b.resetParam({projectId:a}),b.refresh()}})}function e(){var a=this,b=a.getEl();b.append(['<div class="com-content">','<div class="menu-txt-box" style="padding-bottom:0;">','<ul class="menu-txt clearfix">','<li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/allocation">判题分配</a></li><li class="menu-pipe">|</li>','<li class="selected"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/index">判题进度</a></li><li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/detail">任务详情</a></li>',z.can("paperMyWork")?'<li class="menu-pipe">|</li><li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/myWork">我的任务</a></li>':"","</ul>",'<div class="check-btn-wrap" style="float:right">',z.can("isSubUser")?"":'<a href="javascript:void(0);" class="js-to-subAccount" style="margin-right:20px; color:#25bb9b">+添加判题账号</a>','<a href="javascript:void(0);" class="font-green js-export-detail" style="margin-right:20px;"><i class="icon-cloud-upload"></i>导出分配详情</a>',"</div>","</div>",'<div class="com-cont-main">','<div class="js-summary"></div>','<div class="js-content"></div>',"</div>","</div>"].join("")),a.listEl=b.find(".js-content"),a.tableCpn=new t({renderTo:a.listEl,needFixHeader:!0,pageChange:function(b){a.addParam({page:b}),a.fetchList()}})}function f(){var a=this,b=(a.getEl(),a.getUserId()),c=a.getParam(),d=o.id(c.page)||1,e=o.id(c.orderBy),f=o.id(c.order)||2,g=a.getProjectId();a.tableCpn.renderWait(),s.getByDepartment({params:{userId:b},query:{page:d,orderBy:e,order:f,projectIdList:g?g:y.getAllId(a.projectData)},call:function(b){a.renderList(b.data)},error:function(b){a.tableCpn.renderNone(b.msg)}})}function g(){var a=this,b=a.getEl(),c=a.getUserId(),d=a.getProjectId();r.getJudgingTaskSummary({params:{userId:c},query:{projectIdList:d?d:y.getAllId(a.projectData)},call:function(a){var c=(a.data,n.execTpl(['<div class="judge-result clearfix">','<span class="result-item"><a href="javascript:void(0);" class="js-not-judging">未判题 #{unJudgedCount}份</a></span>','<span class="result-item">未分配 #{unAssignedCount}份</span>',"</div>"].join(""),a.data));b.find(".js-summary").html(c)}})}function h(a){var b=this,c=b.getEl(),d=a.datas||[];if(0===d.length)return b.tableCpn.renderNone();b.listData=d;var e={head:[{text:"考生所属机构",width:"25%"},{text:"试卷总数",order:"3"},{text:"总任务",order:"0"},{text:"已判题",order:"1"},{text:"待判题",order:"2"},{text:"",width:"25%"}],list:[]};o.forEach(d,function(a){var b=[{text:'<i class="icon-spot-red"></i><a class="test-subject" href="javascript:void(0);">#{department}</a>',data:a,cls:"t-subject-title"},a.paperCount,a.allAssignCount,a.allJudgedCount,a.unJudgingOfDepartment,{text:'<a href="javascript:void(0);" class="btn btn-xs btn-auto btn-primary js-sub-user-judge" data-department-id="#{id}" data-department-name="#{department}">查看判题账号判题进度</a>',data:a}];e.list.push({items:b})}),b.tableCpn.updateHtml(e,{totalPage:a.totalPage,currentPage:a.currentPage});var f=b.getParam();c.find(".js-rank").removeClass("selected"),c.find("div[data-order-by="+f.orderBy+"]").find(".js-rank[data-order="+f.order+"]").addClass("selected")}function i(){var a=this,b=a.getParam(),c=o.id(b.projectId);return"0"!==c?c:void 0}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=j.Str,o=j.Base,p=(j.Time,k.Popup,k.Pager,a("../cpn/navProject")),q=a("../../../../core/module"),r=a("../../../../action/api"),s=a("../../../../action/judge"),t=a("../../../../component/table"),u=a("../../../../component/popupSub/popupJudgePaper"),v=a("./cpn/popupDepartSubJudgePro"),w=a("./cpn/popupNotJudgePro"),x=a("./util"),y=a("../../extend/bll/paper"),z=a("../../../../util/switch"),A=c.exports=m.create();m.mix(A,q,{style:"/stylesheets/styles/system/scoreManage.css",title:"判题进度",_template:'<div class="com-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl();a.getWin()}return z.can("paperOnlyJudger")?a.nav("paper",{action:"judge/detail"}):(a.renderWait(b),void y.checkProject({all:!0,simple:!0,projectId:a.getProjectId(),call:function(c,d){b.html(""),a.initNav(d),a.initContainer(),a.fetchSummary(),a.fetchList()}}))}},{name:"click a.js-show-paper",handler:function(){var a=this;u.show({userId:a.getUserId()})}},{name:"click a.js-add-subuser",handler:function(){var a=this;a.nav("account","index/index")}},{name:"click a.js-not-judging",handler:function(){var a=this,b=a.getProjectId();w.show({userId:a.getUserId(),projectIdList:b?b:y.getAllId(a.projectData)})}},{name:"click a.js-to-subAccount",handler:function(){var a=this;a.nav("account",{action:"authority/index/index"})}},{name:"click a.js-sub-user-judge",handler:function(a){var b=this,c=l(a.currentTarget),d=b.getProjectId();v.show({departmentId:c.attr("data-department-id"),departmentName:c.attr("data-department-name"),departmentData:b.listData,projectIdList:d?d:y.getAllId(b.projectData),userId:b.getUserId()})}},{name:"click a.js-rank",handler:function(a){var b=this,c=l(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,orderBy:e,order:f}),b.fetchList())}},{name:"click a.js-export-detail",handler:function(){var a=this,b=a.getProjectId();x.exportDetail({onlyAlloc:0,isAll:1,ids:[],projectIdList:b?b:y.getAllId(a.projectData)})}}]},{initNav:d,initContainer:e,fetchList:f,fetchSummary:g,renderList:h,getProjectId:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/myWork",["nc","cpn","../cpn/navProject","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../component/department","../../../../util/switch","../../../../action/user","../../../../core/module"],function(a,b,c){function d(a){var b=this;b.projectData=a,new w({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b.resetParam({projectId:a}),b.refresh()}})}function e(a){var b=this,c=b.getParam(),d=b.getEl(),e=p.id(c.paperId),f=r.execTpl(['<div class="com-content">','<div class="menu-txt-box" style="padding-bottom:0;">','<ul class="menu-txt clearfix">','<li v-if="!isSubUser"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/allocation">判题分配</a></li><li v-if="!isSubUser" class="menu-pipe">|</li>','<li v-if="!isSubUser"><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/index">判题进度</a></li><li v-if="!isSubUser" class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-url" data-module="paper" data-action="judge/detail">任务详情</a></li><li v-if="needSelf" class="menu-pipe">|</li>','<li class="selected" v-if="needSelf"><a href="javascript:void(0);">我的任务</a></li>',"</ul>","</div>",'<div class="com-cont-main">','<div class="js-oprt-bar" style="margin-bottom:10px;">','<div class="js-paper-list"></div>','<label style="font-size:14px;margin:0 5px 0 20px;line-height:34px;">考生</label><div class="js-student-department"></div>','<label v-if="!isSubUser" style="font-size:14px;margin:0 5px 0 20px;line-height:34px;">判题官</label><div v-if="!isSubUser" class="js-judge-department"></div>',"</div>",'<div class="js-detail"></div>',"</div>","</div>"],{isSubUser:D.can("paperOnlyJudger"),needSelf:D.can("paperMyWork")});d.append(f),b.listEl=d.find("div.js-detail");var g=d.find(".js-paper-list");if(a.length>0){var h=[{value:-1,text:"全部试卷",checked:!e}];p.forEach(a,function(a){var b=p.id(a.id);h.push({value:b,text:a.paperName,checked:e===b})}),new s({renderTo:g,renderBy:"replaceWith",size:"small",text:"筛选试卷",needSearch:!0,options:h,change:function(){var a=p.id(this.val());b.addParam({paperId:"-1"===a?null:a,page:null}),b.fetchList(),b.fetchSummary()}})}b.studentDepartmentCpn=new v({renderTo:d.find(".js-student-department"),renderBy:"replaceWith",size:"small",needSearch:!0,options:y.getOption(b.departmentData),change:function(){var a=this.val();b.addParam({studentDepartment:a,page:null}),b.fetchList(),b.fetchSummary()}}),c.studentDepartment&&b.studentDepartmentCpn.val(c.studentDepartment),D.can("paperOnlyJudger")||(b.judgeDepartmentCpn=new v({renderTo:d.find(".js-judge-department"),renderBy:"replaceWith",size:"small",needSearch:!0,options:y.getOption(b.departmentData),change:function(){var a=this.val();b.addParam({judgeDepartment:a,page:null}),b.fetchList(),b.fetchSummary()}}),c.judgeDepartment&&b.judgeDepartmentCpn.val(c.judgeDepartment))}function f(){var a=this,b=(a.getEl(),a.getUserId()),c=a.getParam(),d=a.getProjectId();a.renderWait(a.listEl),A.getJudgingTests({params:{userId:b},query:{page:c.page,isDone:c.isDone,order:c.order,orderBy:c.orderBy,paperId:c.paperId,departmentIdList:a.studentDepartmentCpn.val(),judgeDepartmentIdList:a.judgeDepartmentCpn?a.judgeDepartmentCpn.val():void 0,projectIdList:d?d:C.getAllId(a.projectData),onlySelf:!0},call:function(b){var c=b.data;a.renderList(c.datas||[],c.currentPage,c.totalPage)}})}function g(){var a=this,b=a.getEl(),c=a.getParam(),d=b.find(".js-oprt-bar"),e=a.getProjectId();d.find(".judge-result").remove(),A.getJudgingTaskSummary({params:{userId:a.getUserId()},query:{paperId:c.paperId,projectIdList:e?e:C.getAllId(a.projectData),departmentIdList:a.studentDepartmentCpn.val(),judgeDepartmentIdList:a.judgeDepartmentCpn?a.judgeDepartmentCpn.val():void 0},call:function(a){var b=r.execTpl(['<div class="judge-result" style="display:inline-block;margin:0 0 0 20px;">','<span class="result-item">总共分配(#{summary.assignedCount}份)</span>','<span class="result-item">已判题(#{summary.judgedCount}份)</span>','<span class="result-item">未判题(#{summary.unJudgedCount}份)</span>','<span v-if="!isSubUser" class="result-item">未分配(#{summary.unAssignedCount}份)</span>',"</div>"],{summary:a.data});d.append(b)}})}function h(a,b,c){var d=this,e=d.getEl(),f=d.listEl,g=d.getParam();if(a.length>0){var h={head:[{text:"试卷",width:"20%"},{text:"姓名",width:"15%"},{text:"考生所属机构",width:"15%"},{text:"完成时间",width:"15%",order:"0"},"客观题","主观题",{text:"总分",order:"2"},{text:"判断人",width:"15%",order:"1"},'<label class="checkbox js-status-chk '+(g.isDone===!1?"checked":"")+'"><span class="icons"></span>只看未判题</label>'],list:[]};p.forEach(a,function(a){var b=a.done||!1,c=[{text:'<i class="'+(b>0?"icon-spot-green":"icon-spot-red")+'"></i><a target="_blank">#{paperName}</a>',data:a,cls:"t-subject-title"},a.userName,a.ctsDepartment,q.form(new Date(a.finishTime),"yyyy-MM-dd HH:mm:ss"),(a.objectiveScore||0).toFixed(1),(a.subjectiveScore||0).toFixed(1),(a.totalScore||0).toFixed(1),a.judgeUserName,'<a href="javascript:void(0);" data-id="'+a.testId+'" class="btn btn-auto btn-xs '+(b?"btn-default":"btn-primary")+' js-go-score">'+(b?"已判题":"判题")+"</a>"];h.list.push({items:c})}),f.html(x.getHtml(h)),n(".js-rank").removeClass("selected"),n("div[data-order-by="+g.orderBy+"]").find(".js-rank[data-order="+g.order+"]").addClass("selected")}else d.renderNone(f);new t({renderTo:f,current:b,total:c,pageChange:function(a){d.addParam({page:a}),d.fetchList()}}),u.transform(e.find("label.js-status-chk"),{change:function(){var a=!!this.isChecked();d.addParam({isDone:a?!1:null,page:null}),d.fetchList()}})}function i(){var a=this,b=a.getParam(),c=p.id(b.projectId);return"0"!==c?c:void 0}function j(a,b){{var c=this;c.getParam().projectId}return c.departmentData?c.departmentData:void B.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getProjectId(),entityType:31},call:function(b){var d=b.data||[];c.departmentData=d,p.isFunction(a)&&a(d)},error:function(a){p.isFunction(b)&&b(a.msg)}})}function k(a,b){B.getDepartmentTree({query:{},call:function(b){a&&a(b.data||[])},error:function(a){b&&b(a.msg)}})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=(l.Str,l.Base),q=l.Time,r=l.Node,s=m.Select,t=m.Pager,u=m.CheckBox,v=m.SelectMult,w=a("../cpn/navProject"),x=a("../../../../component/table"),y=a("../../../../component/department"),z=a("../../../../core/module"),A=a("../../../../action/api"),B=a("../../../../action/user"),C=a("../../extend/bll/paper"),D=a("../../../../util/switch"),E=c.exports=o.create();o.mix(E,z,{style:"/stylesheets/styles/system/scoreManage.css",title:"任务详情",partSubJudge:!0,_template:'<div class="com-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl();a.getWin()}a.renderWait(b),C.checkProject({all:!0,simple:!0,isJudge:!0,projectId:a.getProjectId(),call:function(c,d){c="0"===p.id(c)?C.getAllId(d):c,C.getAllPaper({id:c,ext:{isJudge:!0},call:function(c){a.getDepartmentTree(function(e){a.departmentData=e,b.html(""),a.initNav(d),a.initContainer(c),a.fetchList(),a.fetchSummary()},function(c){a.renderNone(b,c)})}})}})}},{name:"click .js-go-score",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-id");if(d){var e=p.clone(b.getParam());delete e.action;var f=(+e.page||1)-1,g=c.closest("tr"),h=g.index()+20*Math.max(0,f);b.nav("paper",{action:"judge/score/index",testId:d,detailParam:e,projectIdList:b.getProjectId(),pos:h})}}},{name:"click a.js-rank",handler:function(a){var b=this,c=n(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f=c.hasClass("selected")?"1"===f?"2":"1":f,b.addParam({page:null,orderBy:e,order:f}),b.fetchList())}}]},{initNav:d,initContainer:e,fetchList:f,fetchSummary:g,renderList:h,getProjectId:i,getDepartment:j,getDepartmentTree:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/score/header",["nc","cpn","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../cpn/popupOverallEvaluate","../../../../../action/remark"],function(a,b,c){function d(){var a=this,b=a.rawConfig.test,c=(b.user||{},a.getEl()),d=b.categoryScores,e=f.map(f.keys(d),function(a){return a+": "+d[a]+"分"}).join("\n"),g='<li class="js-tips" title="'+e+'"><span class="rs-item rs-score">得分：</span><span class="rs-content">'+(b.score||0).toFixed(1)+"</span></li>",h=k.getUserInfo(b.signUpFields,b,b.userExt),l=b.judgingPermission;if(b.testUserNote&&h.push({title:"备注",val:b.testUserNote}),l){var m={"姓名":"canSeeCtsUserName","手机号码":"canSeeCtsUserPhone","邮箱":"canSeeCtsUserEmail"};h=f.filter(h,function(a){var b=m[a.title]||"canSeeCtsUserOtherInfo";return l[b]!==!1}),l.canSeeCtsUserHead===!1&&(b.headUrl=null),l.canSeeCtsUserScore===!1&&(g="")}var n=f.map(h,function(a){return'<span class="examinee-item">'+a.title+"："+(a.val||"没有信息")+"</span>"}).join(""),o=i.execTpl(['<div class="module-head clearfix">','<div class="module-head-oprt"><a href="javascript:void(0);" class="link-green js-go-back">返回</a></div>',"<h1>#{paperName} 测评结果</h1>","</div>",'<div class="module-body clearfix">','<div class="examinee-head"><img alt="头像" src="#{headImg}"></div>','<div class="examinee-box">#{info}</div>','<ul class="report-status">','<li><span class="rs-item rs-paper">考卷：</span><span class="rs-content">#{paperName}</span></li>',"#{score}",'<li><span class="rs-item rs-time">做题用时：</span><span class="rs-content">#{elapseTime}</span></li>','<li><span class="rs-item rs-times">跳出次数：</span><span class="rs-content">#{leaveCount}</span></li>','<li><a class="rs-remarks rs-item js-overall-evaluate" href="javascript:void(0);">整体评价</a></li>',"</ul>","</div>"].join(""),{info:n,paperName:b.paperName,score:g,elapseTime:j.second(b.elapseTime),leaveCount:b.leaveCount,headImg:b.headUrl||"//uploadfiles.nowcoder.com/images/20160723/56_1469258463201_F8D58201856E4DC632535F3424E9E822",remark:b.remark||"备注"});c.html(o)}var e=a("nc"),f=(a("cpn"),e.$,e.Base),g=e.Clazz,h=e.Component,i=e.Str,j=e.Time,k=a("../../../extend/bll/paper"),l=a("../cpn/popupOverallEvaluate"),m=c.exports=g.create();g.mix(m,h,{_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderContent()}},{name:"click .js-go-back",handler:function(){var a=this;a.fire("back")}},{name:"click .js-overall-evaluate",handler:function(){var a=this,b=a.rawConfig;l.show({userId:b.uid,testId:b.tid})}}]},{renderContent:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/score/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/api","../../../../../util/ajax","../../../../../component/navTab","./header","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../cpn/popupOverallEvaluate","../../../../../action/remark","./item","../cpn/popupTestMark"],function(a,b,c){function d(a){var b=this,c=b.getEl();z.getTest({params:{testId:b.getTestId()},type:"GET",call:function(c){b.test=c.data,a&&a()},error:function(a){b.renderNone(c,a.msg)}})}function e(a){var b=this,c=b.getEl();z.getTestQuestions({params:{testId:b.getTestId()},type:"GET",body:{isJudging:1},call:function(c){var d={};s.forEach(c.data,function(a){var b=a.questionCategoryMenu,c=s.id(b.categoryType),e=d[c]=d[c]||{items:[],scoreRight:0,scoreTotal:0};e.items.push(a),e.name=b.categoryTypeName,e.scoreRight=(e.scoreRight||0)+(a.doneQuestion.score||0),e.scoreTotal=(e.scoreTotal||0)+(a.doneQuestion.totalScore||0)}),s.forEach(d,function(a){var b={},c={},d=[];s.forEach(a.items,function(a){var e=a.question.id,f=a.question.parentId,g=f||e;g&&(b[f]=!!f,!c[g]&&d.push(g),c[g]=c[g]||[],c[g].push(a))});var e=0,f=[];s.forEach(d,function(a){e++,s.forEach(c[a],function(c,d){{var g=b[a];c.question}c.multiIndex=g?e+"-"+(d+1):e+"",f.push(c)})}),a.items=f}),b.data=d,a&&a()},error:function(a){b.renderNone(c,a.msg)}})}function f(){var a=this,b=a.getEl();a.headerCpn=new B({renderTo:b,uid:a.getUserId(),tid:a.getTestId(),test:a.test,listeners:{back:function(){a.goBack()}}})}function g(){var a=this,b=a.getEl(),c=r('<div class="module-body"></div>'),d=a.itemCpn=[];s.forEach(a.data,function(b,e){var f=r('<div class="js-type-container" data-type="'+e+'"></div>');c.append(f),s.forEach(b.items,function(b){var c=new C({renderTo:f,uid:a.getUserId(),tid:a.getTestId(),item:b,listeners:{cheat:function(a){s.forEach(d,function(b){b.cheat(a)})}}});d.push(c)})}),0===d.length&&c.html('<div style="padding:20px;font-size:14px;text-align:center;">该用户主观题均未作答，已记为0分</div>'),c.append(['<div class="scoring-btnbox">','<a class="btn btn-primary js-go-next" href="javascript:void(0);">保存并进入下一份</a>','<a class="btn btn-primary js-save-exit" href="javascript:void(0);">保存并退出</a>',"</div>"].join(""));var e=r('<div class="module-box"></div>');e.prepend(c),b.append(e)}function h(){function a(){i(b)}function b(){var a=g.scrollTop(),b=w.getPosTop(k,g),f=a>b;if(l[f?"show":"hide"](),f&&(l.outerWidth(k.outerWidth()),l.css("left",w.getPosLeft(k)),l.css("top",w.getPosTop(g)),m.length<2&&d(l,n),m[1].fixAngle()),e.itemCpn.length>1){if(0===j.length){var i=k.outerHeight();s.forEach(h,function(a){j.unshift(w.getPosTop(a,g)-i)})}var o=s.findIndex(j,function(b){return a>=b});-1!==o&&(o=j.length-o-1),-1===o&&(o=0),n[o]&&c(n[o].id)}}function c(a){s.forEach(m,function(b){b.select(a,!0)})}function d(a,b){var d=new A({renderTo:a,tabs:b,select:function(a){e.scroll2Type(a),c(a)}});m.push(d)}var e=this;if(0!==e.itemCpn.length){var f=e.getEl(),g=e.getSysWinEl(),h=f.find(".js-type-container"),i=v.frequency(50),j=[],k=r('<div style="padding:0 20px"></div>'),l=r('<div style="display:none;padding:0 20px;position:fixed;z-index:9;"></div>');e.headerCpn.getEl().after(k),e.headerCpn.getEl().after(l);var m=[],n=[];s.forEach(e.data,function(a,b){var c=(a.name||"未命名目录")+"("+a.scoreRight.toFixed(1)+"/"+a.scoreTotal.toFixed(1)+")";n.push({id:b,title:c})}),d(k,n),c((n[0]||{}).id),g.on("scroll",a),e.bindWinResize(a),e.listen("destroy",function(){g.unbind("scroll",a)}),a()}}function i(){var a=this,b=s.find(a.itemCpn,function(a){return!a.check()});return b&&(x.alert("判题分数错误"),w.scrollToEl({scrollEl:a.getSysWinEl(),el:b.getEl("div.scoring-item"),animation:!0})),!b}function j(a){var b=this,c=b.getEl();w.scrollToEl({scrollEl:b.getSysWinEl(),ext:-34,el:c.find(".js-type-container[data-type="+a+"]"),animation:!0})}function k(a,b,c){var d=this;d.check()&&!u.mark(a)&&z.judgeTestDone({params:{testId:d.getTestId()},body:d.val(),call:function(a){b&&b(a.data)},error:function(a){x.alert(a.msg),c&&c()},always:function(){u.clear(a)}})}function l(){var a=this,b=a.getParam(),c=b.detailParam||{},d=[],e=[],f=[],g=[];return s.forEach(a.itemCpn,function(a){var b=a.val();d.push(b.qid),e.push(b.doneQid),f.push(b.oldScore),g.push(b.newScore)}),{questionIds:d,doneQuestionIds:e,oldScores:f,newScores:g,pos:b.pos,order:c.order,isDone:c.isDone,orderBy:c.orderBy,paperId:c.paperId}}function m(){var a=this,b=a.getParam(),c=b.detailParam||{};c.action="judge/detail",a.nav("paper",c)}function n(){var a=this;return a.getParam().testId}function o(){var a=this,b=a.getParam(),c=s.extend({},b.detailParam,{action:"judge/detail"});return{crumb:[{title:"判题管理",module:"paper",param:c}]}}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Base,t=p.Clazz,u=p.Limit,v=p.Time,w=p.Dom,x=q.Popup,y=a("../../../../../core/module"),z=a("../../../../../action/api"),A=a("../../../../../component/navTab"),B=a("./header"),C=a("./item"),D=c.exports=t.create();t.mix(D,y,{style:"/stylesheets/styles/system/scoreReport.css",title:"判题",_template:'<div style="position:relative;"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;s.forEachAsync(["fetchTest","fetchQuestion"],function(b,c){a[b](s.bind(c,null,null))},function(){var b=a.getEl();b.html(""),a.initHeader(),a.initList(),a.initTab()})}},{name:"click .js-go-next",handler:function(a){var b=this,c=r(a.currentTarget);b.submit(c,function(a){var c=b.getParam();if(a){var c=b.getParam();c.testId=a,c.pos=(+c.pos||0)+(c.isDone===!1?0:1),b.nav("paper",c)}else b.goBack()})}},{name:"click .js-save-exit",handler:function(a){var b=this,c=r(a.currentTarget);b.submit(c,function(){b.goBack()})}},{name:"click .js-nav-type",handler:function(a){var b=this,c=r(a.currentTarget),d=c.attr("data-type");d&&b.scroll2Type(d)}}]},{fetchTest:d,fetchQuestion:e,initHeader:f,initList:g,initTab:h,check:i,scroll2Type:j,submit:k,val:l,goBack:m,getTestId:n,getCrumbConf:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/score/item",["nc","cpn","../../../../../action/remark","../../../../../util/ajax","../cpn/popupTestMark"],function(a,b,c){function d(a){var b=this;b.item=a.item,b.uid=a.uid,b.tid=a.tid}function e(){var a=this,b=a.getEl(),c=a.item,d=a.getItemHtml(c),e=['<div class="editor-img-bar js-image-bar" style="width:auto;">','<a href="javascript:void(0);" title="旋转" class="icon-repeat"></a>',"</div>"].join("");b.html(d+e)}function f(){function a(){var a=x.trim(e.val()),b=C.fix(a)||"0";e.val(b),b&&e[f>=+b?"removeClass":"addClass"]("error")}var b=this,c=b.item,d=b.getEl(),e=b.ipt=d.find(".js-score-input"),f=c.doneQuestion.totalScore||0;e.on("focus",function(){e.removeClass("error")}).on("blur",function(){a()}),a()}function g(){var a=this,b=(a.rawConfig,a.getEl("a.js-add-mark-cheat"));D.hover(b,function(){"0"!==b.attr("data-cheat")&&b.html('<i class="icon-lightbulb"></i>  取消作弊')},function(){"0"!==b.attr("data-cheat")&&b.html('<i class="icon-lightbulb"></i>  已作弊')}),b.on("click",function(){var c="0"===b.attr("data-cheat")?"1":"0",d="0"!==c;E.confirm(d?"确定要标记作弊":"确定要取消作弊",function(){G.artificialCheat({params:{userId:a.uid},body:{testId:a.tid,markCheat:c},call:function(){E.tips("操作成功"),a.cheat(d),a.fire("cheat",d)},error:function(a){E.alert(a.msg)}})})})}function h(){var a=this,b=a.getEl(),c=b.find(".js-image-bar"),d=null;c.on("click","a",function(){if(d){var a=(+d.attr("data-deg")||0)+1;d.css("transform","rotate("+90*a+"deg)"),d.attr("data-deg",a)}});var e=[].slice.call(b.find(".answer-main img"),0);e.push(c),D.hoverToggle({el:e,enter:function(a){if(a&&"img"===x(a).prop("tagName").toLowerCase()){a=x(a);var e=D.getPosLeft(a,b),f=D.getPosTop(a,b);c.css("left",e).css("top",f).show(),d=a}},leave:function(){d=null,c.hide()}})}function i(a){var b=this,c=b.getEl(),d=c.find("a.js-add-mark-cheat");a=a!==!1,d.html('<i class="icon-lightbulb"></i>  '+(a?"已作弊":"标记作弊")).attr("data-cheat",a?"1":"0"),D.cls(d,{selected:a})}function j(){var a=this,b=a.rawConfig.item;return{qid:x.trim(b.question.id),doneQid:x.trim(b.doneQuestion.id),oldScore:x.trim(b.doneQuestion.score),newScore:x.trim(a.ipt.val())}}function k(){var a=this,b=x.trim(a.ipt.val()),c=!!b;if(c){var d=+b||0,e=a.item,f=e.doneQuestion.totalScore||0;c=f>=d}return a.ipt[c?"removeClass":"addClass"]("error"),c}function l(a){var b=this,c=y.id(a.questionCategoryMenu.questionType),d={3:"getTKHtml",4:"getBCHtml",5:"getWDHtml"}[c],e=d?b[d](a):"",f=b.isUserNoAnswer(a);return e+=B.execTpl(['<div class="scoring-item">','<span class="score-label">第#{index}题得分</span>','<span class="scoring-txt">','<span class="#{tipsCls}" title="#{title}"><input class="js-score-input" #{disabled} type="text" value="#{score}" placeholder="#{totalScore}" /></span> 总分：#{totalScore}',"</span>",'<a href="javascript:void(0);" class="rs-item rs-remarks js-add-remark">备注</a>','<a href="javascript:void(0);" class="tag-cheat js-add-mark-cheat #{cheatCls}" data-cheat="#{cheat}"><i class="icon-lightbulb"></i>  #{markCheated}</a>',"</div>"].join(""),{index:a.multiIndex,tipsCls:f?"js-tips":"",disabled:f?"disabled":"",title:f?"考生答案为空，自动记0分":"",totalScore:a.doneQuestion.totalScore,score:a.doneQuestion.score,cheatCls:a.markCheat>0?"selected":"",markCheated:a.markCheat>0?"已作弊":"标记作弊",cheat:a.markCheat})}function m(a){var b=this,c="",d="";y.forEach(a.doneAnswers,function(a,b){c+="<div>("+(b+1)+'). <pre class="option-item">'+a.userContent+"</pre></div>",d+="<div>("+(b+1)+'). <pre class="option-item">'+a.content+"</pre></div>"});var e=x.trim(a.question.parentContent);return B.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">',e?['<div class="topic-item">','<span class="font-green">[#{score}分/#{totalScore}分|用时#{duration}]</span>','<div style="margin:10px 0;">#{parentContent}</div>',"<div>#{content}</div>","</div>"].join(""):'<div class="topic-item"><span class="font-green">[#{score}分/#{totalScore}分|用时#{duration}]</span> <span>#{content}</span></div>',"</div>","</div>",'<div class="answer-main">','<div class="answer-item"><span>他的回答：</span><div>#{answer}</div></div>','<div class="answer-item"><span>正确答案#{answerMode}：</span><div>#{right}</div></div>',"</div>",b.getReference(a),"</div>"].join(""),{index:a.multiIndex,score:b.getScore(a),totalScore:b.getTotalScore(a),duration:b.getCostTime(a.doneQuestion.duration),parentContent:e,content:b.getContent(a),answer:c,answerMode:a.question.discardAnswerOrder?"（顺序可不一致）":"",right:d})}function n(a){var b=this,c='<span>他的代码：</span><div class="coding-main">空</div>';if(a.doneAnswers&&a.doneAnswers.length>0){var d=y.map(a.doneAnswers,function(a){return'<div class="coding-main"><pre class="prettyprint">'+a.content+"</pre></div>"}).join(""),e=a.doneAnswers[0]||{};c=B.execTpl(["<span>他的代码：</span>",'<div class="coding-status">',"<span>提交时间：#{codingSubmissionDate}</span>","<span>语言：#{language}</span>","timeConsumption"in e?"<span>运行时间：#{timeConsumption}ms</span>":"","memoryConsumption"in e?"<span>占用内存：#{memoryConsumption}K</span>":"",'<span class="#{cls}">程序状态：#{status}</span>',"</div>",d].join(""),{codingSubmissionDate:e.codingSubmissionDate,language:e.language,timeConsumption:e.timeConsumption,memoryConsumption:e.memoryConsumption,cls:"答案正确"===e.status?"font-green":"font-red",status:e.status})}return B.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">','<span class="font-green">[#{score}/#{totalScore}分|用时#{duration}]</span>',"<div>#{content}</div>","</div>","</div>",'<div class="answer-main">','<div class="answer-item" style="margin:0;">',c,"</div>","</div>",b.getReference(a),"</div>"].join(""),{index:a.questionCategoryMenu.index,score:b.getScore(a),totalScore:b.getTotalScore(a),duration:b.getCostTime(a.doneQuestion.duration),content:b.getContent(a)})}function o(a){var b=this,c="",d="";return y.forEach(a.doneAnswers,function(a){c+="<p>"+a.userContent+"</p>",y.forEach(a.attachments,function(a){d+=B.execTpl('<div><div class="option-item">#{name}<a href="#{url}" target="_blank">下载</a></div></div>',a)})}),B.execTpl(['<div class="question-box">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item"><span class="font-green">[#{score}分/#{totalScore}分|用时#{duration}]</span><div>#{content}</div></div>',"</div>",'<div class="answer-main">','<div class="answer-item" style="margin:0;"><span>他的回答：</span>',c,d,"</div>","</div>",b.getReference(a),"</div>"].join(""),{index:a.questionCategoryMenu.index,score:b.getScore(a),totalScore:b.getTotalScore(a),duration:b.getCostTime(a.doneQuestion.duration),content:b.getContent(a)})}function p(a){var b=a.question.content;if(a.question.contents){b="";var c=a.question.contents.length;y.forEach(a.question.contents,function(a,d){b+=a,c>d+1&&(b+='<span class="blank-item">(<span class="blank-num">'+(d+1)+"</span>)</span>")})}return b}function q(a){var b=a.question.referenceAnswer;return b?['<div class="suggest-answer open">','<h2>参考答案：<span class="js-angle-action icon-angle-up" title="收起"></span><span class="js-angle-action icon-angle-down" title="展开"></span></h2>',"<div>"+b+"</div>","</div>"].join(""):""}function r(a){return(a.doneQuestion.score||0).toFixed(1)}function s(a){return(a.doneQuestion.totalScore||0).toFixed(1)}function t(a){var b=Math.floor(a/3600);a%=3600;var c=Math.floor(a/60);a%=60;var d=a||0;return(b?b+"小时":"")+(c?c+"分":"")+(d?d+"秒":"")}function u(a){var b=y.id(a.questionCategoryMenu.questionType);return"3"===b?y.every(a.doneAnswers,function(a){return!x.trim(a.userContent)}):"5"===b?y.every(a.doneAnswers,function(a){return!x.trim(a.userContent)&&0===(a.attachments||[]).length}):!1}var v=a("nc"),w=a("cpn"),x=v.$,y=v.Base,z=v.Clazz,A=v.Component,B=v.Str,C=v.Num,D=v.Dom,E=(v.Time,w.Popup),F=w.PopupImage,G=a("../../../../../action/remark"),H=a("../cpn/popupTestMark"),I=c.exports=z.create();z.mix(I,A,{_template:'<div class="module-box" style="position:relative;"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initContent(),a.initIpt(),a.initCheat(),a.initImageTool()}},{name:"click .js-angle-action",handler:function(a){var b=x(a.currentTarget),c=b.closest("div.suggest-answer");c[c.hasClass("open")?"removeClass":"addClass"]("open")}},{name:"click .answer-main img",handler:function(a){var b=x(a.currentTarget),c=x.trim(b.attr("src"));c&&F.show(c)}},{name:"click a.js-add-remark",handler:function(){var a=this;H.show({userId:a.uid,testId:a.tid,questionId:a.item.question.id})}}]},{initialize:d,initContent:e,initIpt:f,initCheat:g,initImageTool:h,cheat:i,val:j,check:k,getItemHtml:l,getTKHtml:m,getBCHtml:n,getWDHtml:o,getContent:p,getReference:q,getScore:r,getTotalScore:s,getCostTime:t,isUserNoAnswer:u})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/judge/util",["nc","cpn","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../util/ajax","../../../../action/judge"],function(a,b,c){function d(a){var b=window.win;if(b){var c=2,d="",e="";a=a||{},j.downloadAllocExcel({type:"POST",body:{onlyAlloc:a.onlyAlloc||0,isAll:a.isAll,ids:a.ids,projectIdList:a.projectIdList},call:function(a){d=a.data,d&&0!==d.length||(c=1),b.addTask({title:"导出分配详情_"+g.form(new Date,"yyyyMMddHHmmss"),waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){return 2!==c?a&&a(c):void i.getTaskProgress(!0,d,function(b){var d=b.end,f=b.content,g=b.error,h=b.progress;g?(c=1,a&&a(c,h)):d?(c=0,e=f,a&&a(c,h)):a&&a(c,h)})},getResult:function(){return{type:3,data:e}}})},error:function(a){h.alert(a.msg)}})}}var e=a("nc"),f=a("cpn"),g=(e.$,e.Base,e.Clazz,e.Component,e.Time),h=f.Popup,i=a("../../extend/bll/task"),j=a("../../../../action/judge");c.exports={exportDetail:d}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/choice",["nc","cpn","./report/gather","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../action/common","../../../../util/ajax","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../core/siteConfig","../../../../action/testMonit","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../extend/bll/serverTime","../../../../action/paper","../../extend/bll/monitor","../../extend/event","./report/present","../../../../component/preview","../../../../component/dateSelect","./echart","../../../../component/progress","./report/studentScore","./report/scoreDistribution","./report/studentDistribution","./report/cheatAnalysis","./invigilation/screenShot","./invigilation/questionType","./invigilation/curCode","./cpn/popupCode","./cpn/popupCase","../../../../action/user"],function(a,b,c){function d(){}function e(){var a=this;a.getEl().html(['<div class="menu-box">','<ul class="menu clearfix">','<li class="js-tab js-tab-1" data-type="1"><a href="javascript:void(0);">数据报告</a></li>','<li class="js-tab js-tab-2" data-type="2"><a href="javascript:void(0);">监考大厅</a></li>',"</ul>","</div>",'<div class="realtime-title clearfix js-realtime-title">','<span class="js-title-1" style="display:none;">','<h2 style="margin-right:20px;">笔试数据报告</h2>',"<div></div>","</span>",'<span class="js-title-2" style="display:none;">','<h2 style="margin-right:20px;">笔试监考大厅</h2>',"<div></div>","</span>","</div>",'<div class="js-fake-menu"></div>','<div class="realtime-data js-content-1" style="display:none;"></div>','<div class="realtime-data js-content-2" style="display:none;"></div>'].join(""))}function f(){function a(){b.fixMenu()}var b=this,c=b.scrollEl=r(v.getScrollParent(b.getEl()));c.on("scroll",a),b.listen("destroy",function(){c.unbind("scroll",a)})}function g(){var a=this,b=a.cpn={},c=a.rawConfig.parent,d=a.getProjectId(),e=c.getParam(),f=[{text:"全部项目",value:"0"}];s.forEach(a.project,function(a){f.push({text:a.name,value:s.id(a.id),checked:s.id(a.id)===d})}),(!d||"0"===d)&&(f[0].checked=!0),b.project=new w({renderTo:a.getEl(".js-title-1 div"),autoWidth:!0,needSearch:!0,options:f,change:function(){var b=this.val();c.addParam({projectId:b}),I.setCacheProjectId(b),c.getMonitor(function(b){a.projectPaper=b.papers,a.choiceRendered1?a.refreshReport():a.renderChoice("1")},function(a){x.alert(a.msg)},"0"===b?I.getAllId(a.projectData):b)}});var g=[];s.forEach(a.monit.papers,function(a,b){g.push({text:a.paperName,value:s.id(a.paperId),checked:e.paperId?s.id(a.paperId)===e.paperId:0===b})}),b.paper=new w({renderTo:a.getEl(".js-title-2 div"),autoWidth:!0,needSearch:!0,options:g,change:function(){c.addParam({paperId:this.val()}),a.refreshInvigilation(!0)}}),c.addParam({projectId:b.project.val(),paperId:b.paper.val()})}function h(a){var b=this;b.fixMenu(),b.monit=a,b.refreshInvigilation()}function i(){var a=this,b=a.cpn;s.forEach(a.choice1Cpn,function(c,d){b[d]&&s.isFunction(b[d].refresh)&&b[d].refresh(a.projectPaper,a.monit)})}function j(a){var b=this,c=b.cpn,d=b.rawConfig.parent;H.getPaperMonitor({params:{paperId:b.getPaperId(),userId:d.getUserId()},query:{},call:function(a){s.forEach(b.choice2Cpn,function(d,e){c[e]&&s.isFunction(c[e].refresh)&&c[e].refresh(a.data||{},b.monit)})},error:function(b){a&&x.alert(b.msg)}})}function k(a){var b=this,c=["1","2"],d=b.rawConfig.parent;d.addParam({tab:a}),s.forEach(c,function(c){var d=c===a;b.getEl(".js-tab-"+c)[d?"addClass":"removeClass"]("selected"),b.getEl(".js-title-"+c)[d?"show":"hide"](),b.getEl(".js-content-"+c)[d?"show":"hide"]()}),b["choiceRendered"+a]||b.renderChoice(a)}function l(a,b){var c=this,d=null,e=c.cpn,f=c.rawConfig.parent;if("1"===a){if(d=c.choice1Cpn={gathrt:y,present:z,studentScore:A,scoreDistribution:B,studentDistribution:C,cheatAnalysis:D},s.forEach(d,function(a,b){e[b]&&e[b].destroy()}),!c.projectPaper||0===c.projectPaper.length)return void f.renderNone(c.getEl(".js-content-1"),"该项目尚未创建试卷");c.getEl(".js-content-1").html(""),s.forEach(d,function(a,b){e[b]=new a({renderTo:c.getEl(".js-content-1"),module:c.rawConfig.parent,projectPaper:c.projectPaper,projectData:c.projectData,listeners:{paperChange:function(a){s.forEach(d,function(b,c){var d=e[c];d&&s.isFunction(d.switchPaper)&&d.switchPaper(a)})}}})}),c["choiceRendered"+a]=!0}"2"===a&&(d=c.choice2Cpn={screenShot:E,questionType:F,curCode:G},H.getPaperMonitor({params:{paperId:c.getPaperId(),userId:f.getUserId()},query:{},call:function(b){return s.forEach(d,function(a,b){e[b]&&e[b].destroy()}),c.getEl(".js-content-2").html(""),0===c.monit.papers.length?void f.renderNone(c.getEl(".js-content-2"),"尚未创建试卷"):(s.forEach(d,function(a,d){e[d]=new a({renderTo:c.getEl(".js-content-2"),module:c.rawConfig.parent,monit:c.monit,paperMonit:b.data||{}})}),void(c["choiceRendered"+a]=!0))},error:function(a){b||(s.forEach(d,function(a,b){e[b]&&e[b].destroy()}),f.renderNone(c.getEl(".js-content-2"),a.msg))}}))}function m(){var a=this,b=a.getEl(),c=a.scrollEl,d=a.getEl(".js-fake-menu"),e=a.getEl(".menu-box"),f=a.getEl(".realtime-title"),g=v.getPosTop(b,c),h=c.scrollTop(),i=b.width();return h>g?(d.height(e.height()+f.height()+22),e.addClass("fixed-menu-box"),f.addClass("fixed-realtime-title"),e.outerWidth(i),void f.outerWidth(i)):(e.removeClass("fixed-menu-box"),f.removeClass("fixed-realtime-title"),void d.height(0))}function n(){var a=this,b=a.rawConfig.parent,c=b.getParam();return s.id(c.projectId)}function o(){var a=this,b=a.rawConfig.parent,c=b.getParam();return s.id(c.paperId)}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Base,t=p.Clazz,u=p.Component,v=p.Dom,w=q.Select,x=q.Popup,y=a("./report/gather"),z=a("./report/present"),A=a("./report/studentScore"),B=a("./report/scoreDistribution"),C=a("./report/studentDistribution"),D=a("./report/cheatAnalysis"),E=a("./invigilation/screenShot"),F=a("./invigilation/questionType"),G=a("./invigilation/curCode"),H=a("../../../../action/testMonit"),I=a("../../extend/bll/paper"),J=(a("../../../../core/siteConfig"),c.exports=t.create());t.mix(J,u,{_template:['<div class="with-fixed-bar" style="margin-top:0px;"></div>'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{},c=b.parent,d=a.getProjectId();a.monit=b.monit,c.renderWait(a.getEl(),"加载中..."),I.checkProject({all:!0,simple:!0,projectId:d,call:function(b,e){a.projectData=e,c.getMonitor(function(b){a.projectPaper=b.papers,a.project=e,a.initContainer(),a.initEvent(),a.initCpn(),a.selectTab(c.getParam().tab||"1")},function(b){c.renderNone(a.getEl(),b.msg)},"0"===d?I.getAllId(e):d)}})}},{name:"click .js-tab",handler:function(a){var b=this,c=r(a.currentTarget),d=c.attr("data-type");b.selectTab(d)}}]},{initialize:d,initContainer:e,initEvent:f,initCpn:g,refresh:h,refreshReport:i,refreshInvigilation:j,selectTab:k,renderChoice:l,fixMenu:m,getProjectId:n,getPaperId:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/cpn/popupCase",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=new s(a);return b.popup=p.wrap(c,{content:c.html(),title:"测试用例通过情况",hasNoMove:!0,width:650,okTxt:"确定"}),c}function e(){}function f(){var a=this,b=a.rawConfig.data;b=l.isArray(b)?b:[],a.tableData=b}function g(){var a=this,b={renderTo:a.getEl(),head:a.getHeadConf(),list:a.getListConf()};new q(b)}function h(){var a=[{text:"测试用例"},{text:"运行结果"},{text:"占用时间"},{text:"占用内存"}];return a}function i(){var a=this,b=[];return l.forEach(a.tableData,function(a,c){var d={attr:{},style:{},items:[++c,r.codeError[a.s],(a.t||0)+"ms",o.byte2Size(1024*a.m,1)]};b.push(d)}),b}var j=a("nc"),k=a("cpn"),l=j.Base,m=j.Clazz,n=j.Component,o=(j.$,j.Num),p=k.Popup,q=a("../../../../../component/table"),r=a("../../../../../core/siteConfig"),s=c.exports=m.create();m.mix(s,n,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initTable(),a.popup.fixPosition()}}],show:d},{initialize:e,initData:f,initTable:g,getHeadConf:h,getListConf:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/cpn/popupCode",["nc","cpn"],function(a,b,c){function d(a){var b=new t(a);return s.wrap(b,{content:b.html(),title:"实时代码",hasNoMove:!0,width:650}),b}function e(){}function f(){var a=this,b=a.rawConfig;a.setData("index",b.index||0),a.setData("totalCount",b.totalCount||0)}function g(){var a=this,b=a.rawConfig,c=a.getData("index");p.isFunction(b.getData)&&b.getData(c,function(b){a.setData("base",b),a.refreshData(),a.renderInfo(),a.renderCode(),a.renderArrowBtn()})}function h(){var a=this,b=a.getData("base"),c=a.getData("index"),d=a.getData("totalCount"),e=p.isArray(b.info)?b.info:[],f=p.isArray(b.code)?b.code:[];a.setData("info",e),a.setData("code",f),a.setData("has-pre",c>0),a.setData("has-next",d-1>c)}function i(){var a=this,b=a.getData("info"),c="";p.forEach(b,function(a){p.isObject(a)&&(c+=['<span class="',a.cls,'">',a.title||"","：",a.content,"</span>"].join(""))}),a.getEl(".js-info").html(c)}function j(){var a=this,b=a.getData("code"),c="";p.forEach(b,function(a){p.isObject(a)&&(c+=[a.title?"<h3>"+a.title+"：</h3>":"",'<pre style="white-space:pre;">',a.content,"</pre>"].join(""))}),a.getEl(".js-code").html(c)}function k(){var a=this,b=["pre","next"];p.forEach(b,function(b){var c=a.getData("has-"+b);a.getEl(".js-"+b)[c?"show":"hide"]()})}function l(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function m(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var n=a("nc"),o=a("cpn"),p=n.Base,q=(n.$,n.Clazz),r=n.Component,s=o.Popup,t=c.exports=q.create();q.mix(t,r,{_template:['<div class="pop-code-wrap">','<div class="pop-coder-info js-info"></div>','<div class="pop-code-main js-code" style="height:300px;"></div>','<div class="pop-code-btn">','<a href="javascript:void(0);" class="btn btn-primary js-pre">上一份</a>','<a href="javascript:void(0);" class="btn btn-primary js-next">下一份</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.refresh()}},{name:"click .js-pre",handler:function(){var a=this,b=a.getData("index");a.setData("index",--b),a.refresh()}},{name:"click .js-next",handler:function(){var a=this,b=a.getData("index");a.setData("index",++b),a.refresh()}}],show:d},{initialize:e,initData:f,refresh:g,refreshData:h,renderInfo:i,renderCode:j,renderArrowBtn:k,getData:l,setData:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/echart",["nc","../../../../util/util","../../../../core/siteConfig","../../../../component/progress","cpn"],function(a,b,c){function d(a,b){var c=this,d=[],e=[],f=[],g=[];w.forEach(a,function(a){d.push(x.form(new Date(a.dayBegin),"yyyy-MM-dd")),e.push(a.useCount),f.push(a.openCount),g.push((a.openCount/a.useCount*100||0).toFixed(1))});var h=[],i=["邀请人数","到场人数","到场率"],j=["#e0a89b","#a3d0f4","#AFAFAF"],k=[1,1,0],l=["bar","bar","line"];w.forCount(3,function(a){h.push({name:i[a],type:l[a],data:[e,f,g][a],barGap:0,barMaxWidth:20,yAxisIndex:k[a],itemStyle:{normal:{color:j[a]}}})});var m={legend:{data:i},xAxis:[{type:"category",data:d}],yAxis:[{type:"value",name:"到场率",min:0,max:100,splitLine:{show:!1},axisLabel:{formatter:"{value}%"}},{type:"value",name:"人数",position:"right",minInterval:1,splitLine:{show:!1}}],tooltip:{trigger:"axis",formatter:function(a){if(0!==a.length){var b=a[0].name,c=["日期：",b,"<br>"].join("");return w.forEach(a,function(a){c+=[a.seriesName,"：",a.value,"到场率"===a.seriesName?"%":"人","<br>"].join("")}),c}},axisPointer:{type:"shadow"}},series:h};c.echart(m,b)}function e(a,b){var c=this,d=[],e=[];a.sort(function(a,b){return b.avgScore-a.avgScore}),w.forEach(a,function(a){d.push(a.paperName),e.push((a.avgScore||0).toFixed(1))});var f={xAxis:{name:"试卷",type:"category",data:d},yAxis:{name:"平均分",type:"value"},series:[{name:"平均分",type:"bar",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}}};c.echart(f,b)}function f(a,b){var c=this,d=[],e=[],f=0;w.forEach(a,function(a,b){d.push(b),e.push(a),f+=a});var g={xAxis:[{type:"category",name:"分数",data:d}],yAxis:[{type:"value",name:"人数",minInterval:1}],series:[{type:"bar",name:"人数",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=b.dataIndex,g=["分数：",d[c],"<br>人数：",e[c],"<br>所占比率：",(e[c]/f*100||0).toFixed(1),"%"].join("");return g},axisPointer:{type:"shadow"}}};c.echart(g,b)}function g(a,b){var c=this;a.sort(function(a,b){return b.avgScore-a.avgScore});var d=[],e=[];w.forEach(a,function(a){d.push(a.name),e.push(a.avgScore.toFixed(1))});var f={xAxis:[{type:"category",name:"学校",data:d}],yAxis:[{type:"value",name:"平均分"}],series:[{type:"bar",name:"平均分",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=(b.dataIndex,b.value),d=b.name,e=["学校：",d,"<br>平均分：",c].join("");return e},axisPointer:{type:"shadow"}}};c.echart(f,b)}function h(a,b){var c=this;a.sort(function(a,b){return b.avgScore-a.avgScore});var d=[],e=[];w.forEach(a,function(a){d.push(a.name),e.push(a.avgScore.toFixed(1))});var f={xAxis:[{type:"category",name:"学历",data:d}],yAxis:[{type:"value",name:"平均分"}],series:[{type:"bar",name:"平均分",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=(b.dataIndex,b.value),d=b.name,e=["学历：",d,"<br>平均分：",c].join("");return e},axisPointer:{type:"shadow"}}};c.echart(f,b)}function i(a,b){var c=this;a.sort(function(a,b){return b.avgScore-a.avgScore});var d=[],e=[];w.forEach(a,function(a){d.push(a.name),e.push(a.avgScore.toFixed(1))});var f={xAxis:[{type:"category",name:"职位",data:d}],yAxis:[{type:"value",name:"平均分"}],series:[{type:"bar",name:"平均分",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=(b.dataIndex,b.value),d=b.name,e=["职位：",d,"<br>平均分：",c].join("");return e},axisPointer:{type:"shadow"}}};c.echart(f,b)}function j(a,b){new z({renderTo:b,renderBy:"html",data:a,tipConf:{nameTip:"地区",countTip:"考生人数"}})}function k(a,b){var c=this,d=[],e=[];if(0===a.length){var f={noChart:!0};return f}a.sort(function(a,b){return a.count-b.count}),w.forEach(a,function(a){d.push(a.name),e.push({value:a.count,name:a.name})});var f={legend:{data:d},tooltip:{trigger:"item",formatter:"学历：{b}<br/>考生人数：{c}<br>所占比率：{d}%"},color:["#a3d0f4","#82AEDA","#5F96C9","#5fb7ff","#3381c1"],series:[{name:"学历分布",type:"pie",radius:["30%","50%"],center:["50%","58%"],label:{normal:{show:!0,position:"outside"},emphasis:{show:!0,textStyle:{fontSize:"15"}}},data:e}]};c.echart(f,b)}function l(a,b){new z({renderTo:b,renderBy:"html",data:a,tipConf:{nameTip:"学校",countTip:"考生人数"}})}function m(a,b){var c=this,d=[],e={multiCount:"多IP登陆",markCheatCount:"人工标记",similarCodeCount:"代码相似度过高",picAbnormalCount:"截图异常",leaveCount:"跳出次数过多"};w.forEach(e,function(b,c){d.push({modeName:b,cheatNum:a[c],rate:(a[c]/a.cheatCount*100||0).toFixed(1),totalRate:(a[c]/a.finishCount*100||0).toFixed(1)})});var f=[],g=[];d.sort(function(a,b){return b.cheatNum-a.cheatNum}),w.forEach(d,function(a){f.push(a.modeName),g.push(a.cheatNum)});var h={xAxis:[{type:"category",name:"作弊方式",data:f}],yAxis:[{type:"value",name:"人数",minInterval:1}],series:[{type:"bar",data:g,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0].dataIndex,c=d[b],e=["作弊方式：",c.modeName,"<br />","作弊人数：",c.cheatNum,"<br />","所占比率：",c.rate,"%<br />","总人数占比：",c.totalRate,"%"].join("");return e},axisPointer:{type:"shadow"}}};c.echart(h,b)}function n(a,b){var c=this,d=[],e=[];w.forEach(a.scores_distribution,function(a,b){d.push(b),e.push(a)});var f={xAxis:[{type:"category",name:"分数段",data:d}],yAxis:[{type:"value",name:"人数",minInterval:1}],series:[{type:"bar",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(b){var c=b[0].dataIndex,f=["分数段：",d[c],"<br />","人数：",e[c],"<br />","所占比率：",(e[c]/a.cheatCount*100||0).toFixed(1),"%"].join("");return f},axisPointer:{type:"shadow"}}};c.echart(f,b)}function o(a,b){new z({renderTo:b,renderBy:"html",data:a,tipConf:{nameTip:"学校",countTip:"作弊人数"}})}function p(a,b){var c=this,d=[];w.forEach(a.degree_user_count_distribution,function(b){d.push({education:b.name,cheatNum:b.count,rate:(b.count/a.cheatCount*100||0).toFixed(1)})});var e=[],f=[];d.sort(function(a,b){return b.cheatNum-a.cheatNum}),w.forEach(d,function(a){e.push(a.education),f.push({value:a.cheatNum,name:a.education})});var g={legend:{data:e},tooltip:{trigger:"item",formatter:"学历：{b}<br/>考生人数：{c}<br>所占比率：{d}%"},color:["#a3d0f4","#82AEDA","#5F96C9","#5fb7ff","#3381c1"],series:[{name:"学历分布",type:"pie",radius:["30%","50%"],center:["50%","58%"],label:{normal:{show:!0,position:"outside"},emphasis:{show:!0,textStyle:{fontSize:"15"}}},data:f}]};c.echart(g,b)}function q(a,b,c){var d=this,e=[],f=[];w.forEach(a,function(a){f.push(a.questionCategoryName),e.push(a.openCnt)});var g={xAxis:[{type:"category",name:"题型",data:f}],yAxis:[{type:"value",name:"人数",minInterval:1}],series:[{type:"bar",name:"人数",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],d=(b.dataIndex,b.value),e=(d/c*100||0).toFixed(1),f=b.name,g=["题型：",f,"<br>人数：",d,"<br>所占百分比：",e,"%"].join("");return g},axisPointer:{type:"shadow"}}};d.echart(g,b)}function r(a,b,c){var d=this,e=[],f=[];w.forEach(a,function(a){f.push(a.questionCategoryName),e.push(a.submitCnt)});var g={xAxis:[{type:"category",name:"题型",data:f}],yAxis:[{type:"value",name:"人数",minInterval:1}],series:[{type:"bar",name:"人数",data:e,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],d=(b.dataIndex,b.value),e=(d/c*100||0).toFixed(1),f=b.name,g=["题型：",f,"<br>人数：",d,"<br>所占百分比：",e,"%"].join("");return g},axisPointer:{type:"shadow"}}};d.echart(g,b)}function s(a,b){var c=this,d=[],e=[];w.forEach(a,function(a){var b=(a.avgTimeCnt/60||0).toFixed(1);d.push(b),e.push(a.questionCategoryName)});var f={xAxis:[{type:"category",name:"题型",data:e}],yAxis:[{type:"value",name:"用时/分"}],series:[{type:"bar",name:"用时",data:d,barMaxWidth:20,itemStyle:{normal:{color:"#a3d0f4"}},label:{normal:{show:!0,position:"top"}}}],tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=(b.dataIndex,b.value),d=b.name,e=["题型：",d,"<br>用时：",c].join("");return e},axisPointer:{type:"shadow"}}};c.echart(f,b)}function t(a,b){function c(){if(b=v(b),a&&0!==b.length){var c=window.echarts.init(b.get(0));c.setOption(a)}}return window.echarts?c():void y.loadEcharts(c)}var u=a("nc"),v=u.$,w=u.Base,x=u.Time,y=a("../../../../util/util"),z=a("../../../../component/progress");c.exports={present:d,studentScore:e,scoreDistribution:f,schoolScore:g,eduScore:h,jobScore:i,areaDistribution:j,eduDistribution:k,schoolDistribution:l,cheatMode:m,cheatScore:n,cheatSchool:o,cheatEdu:p,work:q,commit:r,time:s,echart:t}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","./overview","./choice","./report/gather","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../action/common","../../../../util/ajax","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","../../../../component/table","../../../../component/selectAll","../../../../action/testMonit","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../extend/bll/serverTime","../../../../action/paper","../../extend/bll/monitor","../../extend/event","./report/present","../../../../component/preview","../../../../component/dateSelect","./echart","../../../../component/progress","./report/studentScore","./report/scoreDistribution","./report/studentDistribution","./report/cheatAnalysis","./invigilation/screenShot","./invigilation/questionType","./invigilation/curCode","./cpn/popupCode","./cpn/popupCase","../../../../action/user"],function(a,b,c){function d(){var a=this;a.bindWinResize(function(){a.resize()})}function e(a){var b=this,c=b.getEl(),d=b.cpn={};c.html(""),d.overview=new o({renderTo:c,parent:b,monit:a,listeners:{refresh:m.bind(b.refresh,b)}}),d.overview.countDown(),d.choice=new p({renderTo:c,monit:a,parent:b})}function f(){function a(a){return c.monit=a,d?void m.forEach(c.cpn,function(b){b.refresh&&b.refresh(a)}):(c.sizeScroll(),c.initCpn(a),void(c._cpnInited=!0))}function b(a){!d&&c.renderNone(c.getEl(),a.msg)}var c=this,d=c._cpnInited;c.getMonitor(a,b)}function g(a,b,c){var d=this;q.getMonitor({params:{userId:d.getUserId()},query:{projectIdList:c},call:function(b){var c=b.data,e=[],f=[],g=[];m.forEach(c.papers,function(a){var b=d.getPaperStatus(a);(-1===b?e:0===b?f:g).push(a)}),c.papers=f.concat(e).concat(g),c.originPapers={unStart:e,start:f,end:g},a&&a(c)},error:b})}function h(){var a=this,b=k(window),c=b.width();a._lastWinWidth!==c&&(a._lastWinWidth=c,a._cpnInited&&m.forEach(a.cpn,function(b){b.refresh&&b.refresh(a.monit,!0)}))}function i(a){var b=(new Date).getTime(),c=b>=a.endTime,d=!c&&b>=a.beginTime;return d?0:c?1:-1}var j=a("nc"),k=(a("cpn"),j.$),l=j.Clazz,m=j.Base,n=a("../../../../core/module"),o=a("./overview"),p=a("./choice"),q=a("../../../../action/testMonit"),r=c.exports=l.create();l.mix(r,n,{style:"/stylesheets/styles/system/realTimeIndex-new2.css",showTask:!0,title:"数据报表",_template:["<div>",'<div style="padding:20px;font-size:14px;text-align:center;">加载中...</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a._lastWinWidth=k(window).width(),a.sizeScroll(),a.initResize(),a.refresh()}},{name:"beforeLeave",type:"custom",handler:function(){{var a=this;a.cpn||{}}m.forEach(a.cpn,function(a){m.isFunction(a.leave)&&a.leave()})}}]},{initResize:d,initCpn:e,refresh:f,getMonitor:g,resize:h,getPaperStatus:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/invigilation/curCode",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../cpn/popupCode","../cpn/popupCase","../../../../../action/paper","../../../../../action/user"],function(a,b,c){function d(a){var b=this;t.forEach((a||{}).signUpFields,function(a){return"key"===a.name?(b.keyName=a.title,t.BREAK):void 0});var c=b.rawConfig.module,d=b.getPaperId();H.getPaperCodingV2({params:{paperId:d},query:{},call:function(a){b.paperCoding=a.data||[],t.forEach(b.cpn,function(a){a&&a.destroy&&a.destroy()}),b.initContainer(),b.initFilter(),b.initPageSizeCpn(),b.search()},error:function(a){c.renderNone(b.getEl(".js-main"),a.msg)}})}function e(){var a=this;a.getEl(".js-main").html(['<div class="data-report-bd js-filter-home"></div>','<div class="js-pagesize-home" style="height:30px;">','<div class="result-info">','<span class="result-num">共有<span class="font-green paper-count js-paper-count"></span>次提交记录</span>',"<span>每页显示",'<span class="page-size js-pagesize-cpn" style="line-height:normal;"></span>',"</span>","</div>","</div>",'<div class="js-search-result" style="min-height:100px;"></div>','<div class="js-pager"></div>'].join(""))}function f(){var a=this,b=a.getParam(),c=[{text:"不限",value:"0"}];t.forEach(a.paperCoding,function(a){c.push({text:a.title,value:t.id(a.id)})});var d={id:"question",title:"题目",type:"select",conf:{options:c}},e=[{text:"不限",value:"0"}],f=x.getQuestionLang();t.forEach(f,function(a){e.push({value:a,text:x.getNameById(a)})});var g={id:"language",title:"使用语言",type:"select",conf:{options:e}},h=[{text:"不限",value:"-1"}];t.forEach(J.codeError,function(a,b){h.push({value:b,text:a})});var i={id:"result",title:"运行结果",type:"select",conf:{options:h}},j={id:"keyword",title:"考生",type:"search"},b=(a.cpn.filter=new D({renderTo:a.getEl(".js-filter-home"),submitTxt:"查询",line:[{border:!0,items:[d,g,i]},{border:!1,items:[j]}],clearAll:function(){a.val({})},listeners:{submit:function(){var b=a.val();a.addParam(t.extend(b,{page:1})),a.search()}}}),a.getParam());a.val(b)}function g(){var a=this,b=[20,50,100],c=a.getParam(),d=t.map(b,function(a,b){return{text:a,value:a,checked:c.pageSize?a===c.pageSize:0===b}});a.cpn.pageSize=new B({renderTo:a.getEl(".js-pagesize-cpn"),renderBy:"html",size:"xsmall",options:d,change:function(){a.addParam({pageSize:this.val(),page:1}),a.search()}})}function h(a){var b=this,c=b.cpn.filter,d=c.getItem("question"),e=c.getItem("language"),f=c.getItem("result"),g=c.getItem("keyword");return 0===arguments.length?{questionId:d.val(),language:e.val(),status:f.val(),keyword:g.ipt.val()}:(d.val(a.questionId?a.questionId:"0"),e.val(a.language?a.language:"0"),f.val(a.status?a.status:"-1"),g.ipt.val(a.keyword),void c.fire("change"))}function i(){var a=this,b=a.rawConfig.module,c=a.getEl();y.mark(c)||I.getCodeInfo({query:a.getCond(),call:function(b){a.getEl(".js-pagesize-home").show(),a.listData=b.data||{},a.renderList(),a.handlPopupCode()},error:function(c){a.getEl(".js-pagesize-home").hide(),b.renderNone(a.getEl(".js-search-result"),c.msg)},always:function(){y.clear(a.getEl())}})}function j(){function a(a){return((e.page||1)-1)*b.cpn.pageSize.val()+a}var b=this,c=(b.getEl(),b.getEl(".js-search-result")),d=b.rawConfig.module,e=b.getParam(),f=(b.keyName,b.listData);if(b.getEl(".js-paper-count").html(f.totalCount),0===f.totalCount)return b.getEl(".js-paper-count").html(0),b.getEl(".js-pager").html(""),d.renderNone(c,"暂无数据");var g={head:[{text:"提交ID",width:"5%",style:{"min-width":"55px"}},{text:"姓名",width:"10%",style:{"min-width":"55px"}},{text:b.keyName,width:"10%",style:{"min-width":"55px"}},{text:"试卷",width:"25%"},{text:"题目",width:"25%"},{text:"运行结果",width:"5%"},{text:"使用语言",width:"5%",style:{"min-width":"100px"}},{text:"占用时间",width:"2%"},{text:"占用内存",width:"2%"},{text:"通过的测试用例比例",width:"2%"},{text:"提交时间",width:"5%",style:{"min-width":"135px"}},{text:"操作",width:"5%"}],list:[]};t.forEach(f.datas,function(b,c){var d=(new Date).getTime(),e=(b.startTime<=d,b.endTime<=d,(100*b.rightCaseRate||0).toFixed(1)+"%"),f=[b.id,b.userName,b.userKey,b.paperName,b.questionName,J.codeError[b.status],x.getNameById(b.language),(b.timeConsumption||0)+"ms",w.byte2Size(b.memoryConsumption,1),{text:b.testCaseResults?'<a href="javascript:void(0)" class="js-popup-case" data-id="'+b.id+'">'+e+"</a>":e,attr:{title:b.testCaseResults?"查看详细数据":"无详细数据"}},z.form(new Date(b.createdDate||0)),'<a href="javascript:void(0)" class="btn btn-primary js-check-code" style="width:70px;" data-id="'+b.id+'">查看代码</a>'];g.list.push({items:f,attr:{"data-index":a(c)}})}),c.html(E.getHtml(g)),new C({renderTo:b.getEl(".js-pager"),renderBy:"html",current:f.currentPage,total:f.totalPage,pageChange:function(a){b.addParam({page:a}),b.search();var c=b.getEl(".js-search-result");A.scrollToEl({el:c,scrollEl:A.getScrollParent(c),ext:-102,animation:!0})}})}function k(){var a=this,b=a.popupCodeIndex,c=a.popupCodeCall;if(c){var d=a.getIndexByTotalIndex(b),e=(a.listData.datas||[])[d],f=[],g={userName:"姓名",userKey:a.keyName,questionName:"题目"};t.forEach(g,function(a,b){f.push({title:a,content:e[b]})});var h=e.content.replace(/&quot;/gi,'"'),i=t.json(h);if(12===e.language){var j=["html","css","js"],k=[];return t.forEach(j,function(a){k.push({title:a,content:i[a]})}),c&&c({info:f,code:k}),void(a.popupCodeCall=null)}var k=[{content:h}];c&&c({info:f,code:k}),a.popupCodeCall=null}}function l(){var a=this,b=a.getParam();return t.extend(a.val(),{page:b.page||1,pageSize:a.cpn.pageSize.val(),paperId:a.getPaperId()})}function m(){var a=this,b=a.rawConfig.module.getParam();return b.curCode||{}}function n(a){var b=this,c=b.rawConfig.module,d=b.getParam();d=t.extend(d,a),c.addParam({curCode:d})}function o(){var a=this,b=a.rawConfig.module,c=b.getParam().paperId;return c}function p(a){var b=this,c=b.getParam(),d=c.page||1,e=b.cpn.pageSize.val(),f=a-(d-1)*e;return f}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Base,u=q.Clazz,v=q.Component,w=q.Num,x=q.CodeLang,y=q.Limit,z=q.Time,A=q.Dom,B=r.Select,C=r.Pager,D=(r.Popup,a("../../../../../component/filter/filter")),E=a("../../../../../component/table"),F=a("../cpn/popupCode"),G=a("../cpn/popupCase"),H=a("../../../../../action/paper"),I=a("../../../../../action/user"),J=a("../../../../../core/siteConfig"),K=c.exports=u.create();u.mix(K,v,{_template:['<div class="data-form-mod clearfix">',"<h2>实时代码</h2>",'<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.cpn={},a.keyName="",a.refresh(a.rawConfig.paperMonit)}},{name:"click .js-check-code",handler:function(a){var b=this,c=s(a.target),d=b.getParam(),e=b.listData,f=+c.closest("tr").attr("data-index");F.show({index:f,totalCount:e.totalCount,getData:function(a,c){var e=d.page||1,f=b.cpn.pageSize.val(),g=a-(e-1)*f;return b.popupCodeIndex=a,b.popupCodeCall=c,g>=0&&f>g?b.handlPopupCode():(b.addParam({page:Math.ceil((a+1)/f)}),void b.search())}})}},{name:"click .js-popup-case",handler:function(a){var b=this,c=s(a.currentTarget),d=+c.closest("tr").attr("data-index"),e=b.getIndexByTotalIndex(d),f=(b.listData.datas||[])[e]||{};G.show({data:t.json(f.testCaseResults),parent:b})}}]},{refresh:d,initContainer:e,initFilter:f,initPageSizeCpn:g,val:h,search:i,renderList:j,handlPopupCode:k,getCond:l,getParam:m,addParam:n,getPaperId:o,getIndexByTotalIndex:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/invigilation/questionType",["nc","cpn","../echart","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/progress"],function(a,b,c){function d(a){var b=this;b.renderChart(a)}function e(a){var b=this,c=a.questionTypeLevel||[];0!==c.length&&(b.getEl(".js-module").show(),i.work(c,b.getEl(".js-chart-work"),a.totalActualPersonCount),i.commit(c,b.getEl(".js-chart-commit"),a.totalActualPersonCount),i.time(c,b.getEl(".js-chart-time")))}var f=a("nc"),g=(a("cpn"),f.$,f.Base,f.Clazz),h=f.Component,i=a("../echart"),j=c.exports=g.create();g.mix(j,h,{_template:['<div class="data-form-mod clearfix">',"<h2>","各题型完成度","</h2>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各题型做题人数</span>',"</div>",'<div class="data-main-bd js-chart-work" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各题型提交人数</span>',"</div>",'<div class="data-main-bd js-chart-commit" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各题型平均提交用时</span>',"</div>",'<div class="data-main-bd js-chart-time" style="height:222px;"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderChart(a.rawConfig.paperMonit)}}]},{refresh:d,renderChart:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/invigilation/screenShot",["nc","cpn","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/testMonit","../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;b.renderList(a)}function e(a){var b=this;b.refresh(a)}function f(a){var b=this,c=b.getParent(),d=b.getEl(),e=n.id(a.paperId),f=q.execTpl(['<li v-if="items.length === 0" class="no-screenshot"><img style="width:85px;height:80px;margin-top:49px;" src="//uploadfiles.nowcoder.com/images/20160324/56_1458796958175_FB5C81ED3A220004B71069645F112867"></li>','<li v-for="item in items" :title="getTitle(item)" class="js-tips">','<div class="user-img-wrap">','<a :href="getHref(item)" :target="paperId ? \'_blank\' : \'\'" :data-user="(item.user || {}).userKey || \'\'" :data-paper="paperId"><img :src="getUrl(item)"></a>',"</div>",'<div class="user-info-wrap">',"<span class=\"user-info-name\">#{!item.user || !item.user.name ? '牛客考生' : item.user.name}</span>",'<span class="user-progress">#{getProgress(item)}%</span>','<a :class="getCheatCls(item)" :data-pic-id="item.id" :data-cheat-status="item.markCheat" href="javascript:void(0);">#{getCheatName(item)}</a>',"</div>","</li>",'<li v-if="paperId && items.length !== 0" class="list-show-all"><a target="_blank" :href="allLink"><img class="view-more" src="//uploadfiles.nowcoder.com/images/20160726/view-more.png"><p class="view-more-font">查看全部</p></a></li>'],{paperId:e,items:a.latestPics||[],allLink:c.getNavUrl("paper",{action:"monit/scene",paperId:e}),getTitle:function(c){return b.getUserInfo(a.signUpFields,c).join("\\n")},getHref:function(a){return e?c.getNavUrl("paper",{action:"monit/pics",paperId:e,account:(a.user||{}).userKey}):"javascript:void(0);"},getUrl:function(a){return t.fixUrlProtocol(a.url)},getProgress:function(a){return Math.round(100*+a.doneQuestionProgress)||0},getCheatCls:function(a){return["tag-danger","tag-label","js-action-cheat",1===+a.markCheat?"show":""]},getCheatName:function(a){return 1===+a.markCheat?"已标记作弊":"标记作弊"}});d.find(".js-list").html(f),r.title(".js-tips")}function g(a,b){var c=this,d=c.getParent();u.markCheat({type:"PUT",params:{userId:d.getUserId()},body:{all:1,cheated:b,picId:a},call:function(){s.tips(1===b?"标记成功":"取消标记成功")}})}function h(){var a=this,b=a.rawConfig;return b.module}function i(a,b){var c=b.user||{},d=n.json(c.ext,{}),e=[];return b.createTime&&e.push(p.form(new Date(b.createTime),"yyyy-MM-dd HH:mm:ss")),n.forEach(a,function(a){var b=("key"===a.name?c.userKey:d[a.name])||"";b&&e.push(a.title+": "+b)}),e.push("做题进度: "+(Math.round(100*(+b.doneQuestionProgress||0))||0)+"%"),e}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=j.Base,o=j.Component,p=j.Time,q=(j.Str,j.Node),r=k.Tips,s=k.Popup,t=a("../../../../../util/util"),u=(a("../../../../../core/siteConfig"),a("../../../../../action/testMonit")),v=c.exports=m.create();m.mix(v,o,{_template:['<div class="data-form-mod">','<div class="screenshot-hd clearfix">',"<h2>考试实时截图",'<div class="btn-group js-paper-select"></div>',"</h2>","</div>",'<div class="screenshot-bd clearfix">','<ul class="screenshot-list clearfix js-list"></ul>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderList(a.rawConfig.paperMonit)}},{name:"click.prevent a.js-action-cheat",handler:function(a){var b=this,c=l(a.currentTarget),d=c.attr("data-pic-id"),e="0"===c.attr("data-cheat-status")?1:0;b.markCheat(d,e),c.attr("data-cheat-status",e)[1===e?"addClass":"removeClass"]("show"),c.html(e>0?"已标记作弊":"标记作弊")}}]},{refresh:d,paperChange:e,renderList:f,markCheat:g,getParent:h,getUserInfo:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/overview",["nc","cpn"],function(a,b,c){function d(){var a=this;a.leftSecond=o}function e(a){{var b=this;b.getEl()}return window.clearTimeout(b.countTimer),a===!1?(b.leftSecond=o,void b.showTime(o)):void(b.countTimer=window.setTimeout(function(){b.leftSecond--,b.leftSecond<=0&&(b.leftSecond=o,b.fire("refresh")),b.showTime(b.leftSecond),b.countDown()},1e3))}function f(a){var b=this,c=b.getEl();c.find(".js-left-time").html(a+"s")}function g(a){var b=this,c=b.getEl();a=a||{};var d=0;if(a){{var e=new Date,f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0).getTime();m.form(new Date,"yyyy-MM-dd")}j.forEach(a.papers,function(a){var b=+a.beginTime||1/0,c=+a.endTime||0;d+=f+864e5>=b&&c>=f?1:0})}var g=l.execTpl(['<div class="test-status-item">',"<h3>当前做题人数</h3>",'<a href="javascript:void(0);" class="test-status-num link-green">#{totalUnderwayCount}</a>','<p class="test-status-tip">#{todayPaperCnt}场考试</p>',"</div>",'<div class="test-status-item">',"<h3>今日最高同时做题人数</h3>",'<a href="javascript:void(0);" class="test-status-num link-green">#{openCnt}</a>','<p class="test-status-tip">#{topOpenTime}</p>',"</div>",'<div class="test-status-item">',"<h3>今日交卷人数</h3>",'<a href="javascript:void(0);" class="test-status-num link-green">#{submitCnt}</a>','<p class="test-status-tip">#{todayPaperCnt}场考试</p>',"</div>"].join(""),{totalUnderwayCount:a.totalUnderwayCount||0,paperCnt:(a.papers||[]).length,openCnt:a.topOpenCount||0,topOpenTime:a.topOpenTime?m.form(new Date(a.topOpenTime),"HH:mm:ss"):"00:00:00",submitCnt:a.todaySubmitPeopleCnt,todayPaperCnt:d});c.find(".js-head-container").html(g)}function h(){var a=this;window.clearTimeout(a.countTimer)}var i=a("nc"),j=(a("cpn"),i.$,i.Base),k=i.Clazz,l=i.Str,m=i.Time,n=i.Component,o=300,p=c.exports=k.create();k.mix(p,n,{_template:["<div>",'<div class="realtime-title clearfix">','<h2>今日做题概况（数据<a href="javascript:void(0);" class="link-green js-left-time">'+o+"s</a>后刷新）</h2>","</div>",'<div class="test-status clearfix js-head-container"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.refresh(b.monit)}}]},{initialize:d,countDown:e,showTime:f,refresh:g,leave:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/pics",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/testMonit","../../../../util/ajax","../../../../action/paper","../util"],function(a,b,c){function d(){var a=this;a.picsData=[]}function e(){var a=this,b=a.getSysWinEl(),c=a.getCrumb().getEl();b.addClass("with-fixed-bar"),c.outerWidth(b.width()).css("z-index",1),a.getEl(".js-report-hd").outerWidth(a.getEl(".js-user-info").outerWidth()).css("z-index",1)}function f(a){var b=this,c=b.getParam();C.getPaper({type:"GET",params:{paperId:c.paperId},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function g(a){var b=this;if(b._lastScrollCb&&b._lastScrollCb(),a!==!1){var c=b.getSysEl();b._lastScrollCb=u.scrollBottom(500,c.contentWin,c.content,function(){b.initScroll(!1);var a=b.picsData,c=a[a.length-1]||{};b.getListData(c.id,c.userId)})}}function h(){function a(a){b.markCheatCount=a.markCheat;var c="";t.forEach(a.signUpFields,function(b){var d=b.name;if("name"!==d){var e="key"===d||"name"===d,f=q.trim(e?a[d]||("key"===d?a.userKey:""):(a.ext||{})[d]);c+="<span>"+b.title+"："+(f||"没有信息")+"</span>"}}),c+="<span>参考地区："+(a.ipAddress||a.ip||"没有信息")+"</span>";var d=s.execTpl(['<div class="examinee-head"><img src="#{avatar}"></div>','<div class="examinee-detail">','<div class="examinee-name">#{name}#{cheat}</div>','<div class="examinee-items">#{info}</div>',"</div>"].join(""),{avatar:A.fixUrlProtocol(a.headUrl||G),name:q.trim(a.name)||"没有姓名信息",cheat:b.cheating?'<span class="handle-tips"><img src="//uploadfiles.nowcoder.com/images/20160727/56_1469590441564_F6AD4A78DC0EA960FBB7750F66B237E4">已作弊</span>':"",info:c});g.html(d),b.getEl(".js-student-name").html("："+a.name)}var b=this,c=b.getEl(),d=b.getParam(),e=d.paperId,f=q.trim(d.account),g=c.find("div.js-user-info");B.getUserInfo({query:{account:f},params:{paperId:e},call:function(b){a(b.data)},error:function(a){b.renderWait(g,a.msg)}})}function i(a,b){var c=this,d=(c.getEl(),c.getParam()),e=d.paperId,f=q.trim(d.account),g=d.word,h=!a;c.initScroll(!1),e&&B.queryPic({params:{userId:c.getUserId(),paperId:e},query:{account:f,prePicId:a,pageSize:F,preUid:b,word:g},call:function(a){var b=c.getParam();if(q.trim(b.account)===f){h&&(c.picsData.length=0);var d=a.data;c.picsData=c.picsData.concat(d.pics||[]),c.renderData(D.sortShotByDanger(d.pics),d.signUpFields,h),c.prepareArrow(d)}}})}function j(a,b,c){var d=this,e=d.getEl(),f=d.getParam(),g=(q.trim(f.account),f.paperId,""),h=['<li data-title="#{title}" class="js-tips#{dangerCls}" style="width:120px;height:90px;">','<span class="tag-danger tag-label #{cheatCls} js-action-cheat" data-pic-id="#{picId}" data-cheat-status="#{cheatStatus}" style="position:absolute;right:0;top:5px;cursor:pointer;">作弊</span>','<a href="#{url}" class="js-image" target="_blank"><img src="#{url}" /></a>',"</li>"].join("");t.forEach(a,function(a){var c=d.getUserInfo(a,b);g+=s.execTpl(h,{title:c.join("\\n"),dangerCls:D.isDanger(a)?" danger":"",url:A.fixUrlProtocol(a.url),progress:Math.round(100*+a.doneQuestionProgress)||0,cheatCls:1===a.markCheat?"show":"",picId:a.id,cheatStatus:a.markCheat})}),0===a.length&&c&&(g='<li class="no-screenshot"><img style="width:auto;height:auto;" src="//uploadfiles.nowcoder.com/images/20160324/56_1458796958175_FB5C81ED3A220004B71069645F112867"></li>'),c&&e.find(".js-user-avatar").html('<ul class="screenshot-list"></ul>'),e.find("ul.screenshot-list").append(g),a.length>=F&&d.initScroll(),w.title(".js-tips")}function k(a){var b=this,c=[{key:"preAccount",cls:".js-pre-btn"},{key:"nextAccount",cls:".js-next-btn"}];t.forEach(c,function(c){var d=b.getEl(c.cls),e=a[c.key]||"";d[e?"show":"hide"](),b[c.key]=e}),b.getEl(".js-cur-num").html([a.index||0,a.userCount||0].join("/"))}function l(a,b){var c=a.user||{},d=[];a.createTime&&d.push(v.form(new Date(a.createTime),"yyyy-MM-dd HH:mm:ss"));var e=t.json(c.ext,{});return t.forEach(b,function(a){var b=("key"===a.name?c.userKey:e[a.name])||"";b&&d.push(a.title+": "+b)}),d}function m(a,b){var c=this;B.markCheat({type:"PUT",params:{userId:c.getUserId()},body:{cheated:b,picId:a},call:function(){x.tips(1===b?"标记成功":"取消标记成功")}})}function n(){var a=this,b=a.paper,c=a.getParam(),d=q.trim(c.paperId),e=q.trim(c.account);return{crumb:[{title:"数据报表"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"monit/index",paperId:d,refresh:1}},{title:"全部用户截图",module:"paper",param:{action:"monit/scene",paperId:d}}],ext:[{input:{value:e,placeholder:"输入用户考号或名字, 回车搜索"},listeners:{ok:function(b){var c=q.trim(b.val());a.nav("paper",{action:"monit/scene",paperId:d,word:c})}}}]}}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Clazz,s=o.Str,t=o.Base,u=(o.Limit,o.Dom),v=o.Time,w=p.Tips,x=p.Popup,y=p.PopupImage,z=a("../../../../core/module"),A=a("../../../../util/util"),B=a("../../../../action/testMonit"),C=a("../../../../action/paper"),D=a("../util"),E=c.exports=r.create(),F=25,G="//uploadfiles.nowcoder.com/images/20160723/56_1469258463201_F8D58201856E4DC632535F3424E9E822";r.mix(E,z,{style:"/stylesheets/styles/system/realTimeIndex-new.css",title:"考生截图",_template:['<div style="padding-top:120px;">','<div class="report-box exam-cheat">','<div class="report-hd report-info-hd clearfix js-report-hd">','<div class="report-hd-oprt">','<span class="js-cur-num"></span>','<a href="javascript:void(0);" class="btn btn-primary btn-sm js-go-btn js-pre-btn" style="display:none;" data-direction="0">< 上一位</a>','<a href="javascript:void(0);" class="btn btn-primary btn-sm js-go-btn js-next-btn" style="display:none;" data-direction="1">下一位 ></a>',"</div>",'<h1>考生信息<span class="js-student-name"></span></h1>',"</div>",'<div class="report-bd">','<div class="examinee-info js-user-info clearfix"></div>',"</div>","</div>",'<div class="report-box exam-cheat">','<div class="report-hd clearfix"><h1>考试实时截图</h1></div>','<div class="report-bd clearfix js-user-avatar"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();return q.trim(c.account)?c.paperId?(a.initFixed(),a.bindWinResize(t.bind(a.initFixed,a)),a.renderWait(b.find("div.js-user-info")),a.renderWait(b.find("div.js-user-avatar")),void a.getPaper(function(){a.getUserData(),a.getListData()})):a.renderWait(b,"缺少参数"):a.nav("paper",{action:"monit/scene",paperId:c.paperId})}},{name:"beforeLeave",type:"custom",handler:function(){var a=this;a.initScroll(!1),a.getSysWinEl().removeClass("with-fixed-bar"),a.getCrumb().getEl().width("auto")}},{name:"click.prevent .js-action-cheat",handler:function(a){var b=this,c=q(a.currentTarget),d=c.attr("data-pic-id"),e="0"===c.attr("data-cheat-status")?1:0;b.markCheat(d,e),c.attr("data-cheat-status",e)[1===e?"addClass":"removeClass"]("show")}},{name:"click.prevent a.js-image",handler:function(a){var b=this,c=b.getParam();if(c.account){var d=q(a.currentTarget),e=q.trim(d.attr("href"));e&&!s.isJsHref(e)&&y.show(e)}}},{name:"click a.js-go-btn",handler:function(a){var b=this,c=q(a.currentTarget),d=c.attr("data-direction"),e=b["0"===d?"preAccount":"nextAccount"];e?(b.addParam({account:e}),b.getUserData(),b.getListData()):x.alert("缺少账号信息")}}]},{initialize:d,initFixed:e,initScroll:g,getPaper:f,getUserData:h,getListData:i,renderData:j,prepareArrow:k,getUserInfo:l,markCheat:m,getCrumbConf:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/cheatAnalysis",["nc","cpn","../../../../../component/preview","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../echart","../../../../../util/util","../../../../../component/progress","../../../../../action/testMonit"],function(a,b,c){function d(){}function e(){var a=this,b=a.cpn={};b.paper=new s({renderTo:a.getEl(".js-paper-home"),options:[],needSearch:!0,change:function(){a.search(),a.fire("paperChange",this.val())}}),a.fixPaper()}function f(a){var b=this;b.projectPaper=a,b.fixPaper(),b.search()}function g(){var a=this,b=a.rawConfig,c=a.cpn.paper.val()||"",d=b.module,e=a.getProjectId();d.renderWait(a.getEl(".js-main"),"加载中..."),w.getCheatUserDistribute({query:{projectIdList:"0"===e?u.getAllId(b.projectData):e,paperId:c},call:function(b){var c=b.data||{};a.renderContainer(c),a.renderPreview(c),a.renderChart(c)},error:function(b){d.renderWait(a.getEl(".js-main"),b.msg)}})}function h(a){var b=this;b.cpn.preview=new t({renderTo:b.getEl(".js-preview-home"),data:{topName:"作弊率",leftName:"交卷人数",rightName:"作弊人数",topData:(100*a.cheatRation||0).toFixed(1)+'<span style="font-size:24px;">%</span>',leftData:a.finishCount,rightData:a.cheatCount}})}function i(){var a=this,b=['<div class="form-bd clearfix">','<div class="js-preview-home"></div>','<div class="data-form-main js-module">','<div class="data-main-hd">','<span class="title">作弊方式分布</span>',"</div>",'<div class="data-main-bd js-chart-mode" style="height:222px;"></div>',"</div>","</div>",'<div class="data-main-mod two-mod js-module">','<div class="data-main-hd">','<span class="title">作弊学生分值分布</span>',"</div>",'<div class="data-main-bd js-chart-score" style="height:300px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">作弊学生学校分布</span>',"</div>",'<div class="data-main-bd js-chart-school" style="height:300px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">作弊学生学历分布</span>',"</div>",'<div class="data-main-bd js-chart-education" style="height:300px;"></div>',"</div>"].join("");a.getEl(".js-main").html(b)}function j(a){var b=this,c=(b.rawConfig.module,a.degree_user_count_distribution),d=a.school_user_count_distribution;v.cheatMode(a,b.getEl(".js-chart-mode")),v.cheatScore(a,b.getEl(".js-chart-score")),d&&0!==d.length&&(b.getEl(".js-chart-school").closest(".js-module").show(),v.cheatSchool(d,b.getEl(".js-chart-school"))),c&&0!==c.length&&(b.getEl(".js-chart-education").closest(".js-module").show(),v.cheatEdu(a,b.getEl(".js-chart-education")))}function k(){var a=this,b=[];p.forEach(a.projectPaper,function(a,c){b.push({text:a.paperName,value:a.paperId,checked:0===c})}),a.cpn.paper.replaceOptions(b)}function l(a){var b=this;b.cpn.paper.val(a,!0)}function m(){var a=this,b=a.rawConfig.module;return b.getParam().projectId}var n=a("nc"),o=a("cpn"),p=(n.$,n.Base),q=n.Clazz,r=n.Component,s=o.Select,t=a("../../../../../component/preview"),u=a("../../../extend/bll/paper"),v=a("../echart"),w=a("../../../../../action/testMonit"),x=c.exports=q.create();q.mix(x,r,{_template:['<div class="data-form-mod clearfix">',"<h2>",'作弊分析<div class="btn-group js-paper-home"></div>',"</h2>",'<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.projectPaper=a.rawConfig.projectPaper,a.initCpn(),a.search()}}]},{initialize:d,initCpn:e,refresh:f,search:g,renderPreview:h,renderContainer:i,renderChart:j,fixPaper:k,switchPaper:l,getProjectId:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/gather",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/testMonit","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/paper","../../../extend/bll/monitor","../../../extend/event"],function(a,b,c){function d(){}function e(){var a=this,b={id:"presentRate",title:"到场比率",type:"range"},c={id:"cheatRate",title:"作弊比率",type:"range"},d={id:"testTime",title:"试卷有效期",type:"duration",ext:{today:!0}},e={id:"paperName",title:"试卷名",type:"search"},f=a.cpn.filter=new I({renderTo:a.getEl(".js-filter-home"),submitTxt:"查询",line:[{border:!0,items:[b,c,d]},{border:!1,items:[e]}],clearAll:function(){a.val({})},listeners:{submit:function(){var b=a.val();a.addParam(z.extend(b,{page:1})),a.search()}}}),g=f.getItemEl("presentRate"),h=f.getItemEl("cheatRate");g.find(".js-cpn-start").after("<span>%</span>"),g.find(".js-cpn-end").after("<span>%</span>"),h.find(".js-cpn-start").after("<span>%</span>"),h.find(".js-cpn-end").after("<span>%</span>");var i=a.getParam();a.val(i)}function f(){var a=this,b=[5,20,50,100],c=a.getParam(),d=z.map(b,function(a,b){return{text:a,value:a,checked:c.pageSize?a===c.pageSize:0===b}});a.cpn.pageSize=new F({renderTo:a.getEl(".js-pagesize-cpn"),renderBy:"html",size:"xsmall",options:d,change:function(){a.addParam({pageSize:this.val(),page:1}),a.search()}})}function g(){var a=this,b=a.getEl(".js-table");a.cpn.selectAll=new K({change:function(a){b.find("td label.checkbox")[a?"addClass":"removeClass"]("checked")},toggle:function(a,c){b.find("tr[data-id="+a+"] label.checkbox")[c?"addClass":"removeClass"]("checked")}})}function h(){var a=this;a.search()}function i(a){var b=this,c=b.cpn.filter,d=c.getItem("presentRate"),e=c.getItem("cheatRate"),f=c.getItem("testTime"),g=c.getItem("paperName");return 0===arguments.length?{attendRationBegin:b.wrapRate(d.startIpt.val()),attendRationEnd:b.wrapRate(d.endIpt.val()),cheatRationBegin:b.wrapRate(e.startIpt.val()),cheatRationEnd:b.wrapRate(e.endIpt.val()),beginTime:b.wrapDuration(f.startIpt.val(),!0),endTime:b.wrapDuration(f.endIpt.val()),query:y.trim(g.ipt.val())}:(d.startIpt.val(b.parseRate(a.attendRationBegin)),d.endIpt.val(b.parseRate(a.attendRationEnd)),e.startIpt.val(b.parseRate(a.cheatRationBegin)),e.endIpt.val(b.parseRate(a.cheatRationEnd)),f.startIpt.val(b.parseDuration(a.beginTime)),f.endIpt.val(b.parseDuration(a.endTime)),f.todayChk.checked(!1),f.todayChk.fire("change"),g.ipt.val(a.query),void c.fire("change"))}function j(){var a=this,b=a.rawConfig.module,c=a.getEl();a.check()&&(C.mark(c)||L.searchPaperTestData({query:a.getCond(),call:function(b){a.getEl(".js-pagesize-home").show(),a.renderList(b.data||{})},error:function(c){a.getEl(".js-pagesize-home").hide(),a.getEl(".js-pager").html(""),b.renderNone(a.getEl(".js-table"),c.msg)},always:function(){C.clear(c)}}))}function k(){var a=this,b=a.val(),c=b.attendRationBegin,d=b.attendRationEnd,e=b.cheatRationBegin,f=b.cheatRationEnd;return c&&!d||!e&&f?(H.alert("请填写完整的到场比率信息"),!1):c&&!z.id(c)||d&&!z.id(d)?(H.alert("到场比率必须为数值"),!1):e&&!f||!e&&f?(H.alert("请填写完整的作弊比率信息"),!1):e&&!z.id(e)||f&&!z.id(f)?(H.alert("作弊比率必须为数值"),!1):c&&0>+c||d&&+d>100?(H.alert("到场比率只允许输入0到100之间的数"),!1):e&&0>+e||f&&+f>100?(H.alert("作弊比率只允许输入0到100之间的数"),!1):!0}function l(a){function b(a){if(a.simulation)return"模拟卷不统计";if(3===a.cheatTaskStatus)return a.cheatCount||0;var b="";return a.hasCtsPic===!0&&(b+=['<span class="icon-user" title="人脸检测进度"> ',c.parseRate(a.faceDetectedRation,1),"%</span>"].join("")),a.hasCodeQuestion===!0&&(b+=['<span class="icon-file-alt" title="代码查重进度"> ',c.parseRate(a.codeDetectedRation,1),"%</span>"].join("")),b||0}var c=this,d=(c.getEl(),c.getEl(".js-table")),e=c.rawConfig.module,f=c.getParam();if(c.getEl(".js-paper-count").html(a.totalCount),0===a.totalCount)return c.getEl(".js-pager").html(""),e.renderNone(d,"暂无数据");var g={head:[{text:"",width:"2%",cls:"with-checkbox-select txt-left"},{text:"试卷名",width:"16%",style:{"min-width":"200px"}},{text:"开始时间",width:"7%",style:{"min-width":"150px"},order:6},{text:"结束时间",width:"7%",style:{"min-width":"150px"},order:1},{text:"邀请人数",width:"5%"},{text:"通知人数",width:"5%"},{text:"参加人数",width:"5%"},{text:"到场率",width:"5%",order:2},{text:"提交人数",width:"5%"},{text:"提交比例",width:"5%",order:3},{text:"平均提交用时",width:"5%"},{text:"平均分",width:"5%",order:4},{text:"客观题平均分",width:"5%"},{text:"编程题平均分",width:"5%"},{text:"问答题平均分",width:"5%"},{text:"疑似作弊人数",width:"5%",style:{"min-width":"130px"}},{text:"作弊比例",width:"5%",order:5}],list:[]},h=[];z.forEach(a.data,function(a){var d=(new Date).getTime(),e=a.beginTime<=d,f=a.endTime<=d,i=[{chk:!0,cls:"txt-left"},a.paperName,D.form(new Date(a.beginTime),"yyyy-MM-dd HH:mm:ss"),a.forever?"不限":D.form(new Date(a.endTime),"yyyy-MM-dd HH:mm:ss"),a.userCount,'<a href="javascript:void(0);" class="link-green js-go-nav" title="查看考生名单" data-status="">'+a.noticeCount+"</a>",f?'<a href="javascript:void(0);" class="link-green js-go-nav" title="查看考生名单" data-status="2">'+a.openCount+"</a>":'<span title="该试卷尚未结束">'+a.openCount+"</span>",c.parseRate(a.attendRation,1)+"%",e?'<a href="javascript:void(0);" class="link-green js-go-nav" title="查看考生名单" data-status="3">'+a.finishCount+"</a>":'<span title="该试卷尚未开始">'+a.finishCount+"</span>",c.parseRate(a.finishRation,1)+"%",D.second(a.avgElapseTimeSeconds),a.avgScore.toFixed(1),a.avgObjectScore.toFixed(1),a.avgCodingScore.toFixed(1),a.avgDesignScore.toFixed(1),b(a),c.parseRate(a.cheatRation,1)+"%"];g.list.push({items:i,attr:{"data-id":z.id(a.paperId)}}),h.push(z.id(a.paperId))}),d.html(J.getHtml(g));var i=c.cpn.selectAll;d.find("th.with-checkbox-select").append(i.getEl()),i.refreshEl(),i.render(),i.tipsEl=c.getEl("div.js-tips"),i.loadPage(h,!0),i.changePageCount(a.totalPage),i.changeTotalCount(a.totalCount),new G({renderTo:c.getEl(".js-pager"),renderBy:"html",current:a.currentPage,total:a.totalPage,pageChange:function(a){c.addParam({page:a}),c.search();var b=c.getEl(".js-pagesize-home");E.scrollToEl({el:b,scrollEl:E.getScrollParent(b),ext:-102,animation:!0})}}),d.find(".js-rank").removeClass("selected"),d.find("div[data-order-by="+f.orderBy+"]").find(".js-rank[data-order="+(+f.sqlOrder+1)+"]").addClass("selected")}function m(){var a=this,b=a.getParam(),c=a.getProjectId(),d=a.rawConfig;return z.extend(a.val(),{page:b.page||1,pageSize:a.cpn.pageSize.val(),sqlOrder:b.sqlOrder,orderBy:b.orderBy,projectIdList:"0"===c?M.getAllId(d.projectData):c})}function n(){var a=this,b=a.rawConfig,c=a.cpn.selectAll,d=a.getProjectId();return z.extend(a.val(),{isAll:c.isSelectAll?1:2,ids:c.selectIds,projectIdList:"0"===d?M.getAllId(b.projectData):d})}function o(a){var b=y(a).closest("tr");return y.trim(b.attr("data-id"))}function p(){var a=this,b=a.rawConfig.module.getParam();return b.gather||{}}function q(a){var b=this,c=b.rawConfig.module,d=b.getParam();d=z.extend(d,a),c.addParam({gather:d})}function r(){var a=this,b=(a.rawConfig||{}).module;return(b.getParam()||{}).projectId}function s(a,b){return(a=y.trim(a))?(b=y.trim(b),b?(a/100).toFixed(b):a):void 0}function t(a,b){return a?a+(b?" 00:00:00":" 23:59:59"):void 0}function u(a,b){return(a=y.trim(a))?(b=y.trim(b),b?(100*a).toFixed(b):a):void 0}function v(a){return y.trim(a).split(" ")[0]}var w=a("nc"),x=a("cpn"),y=w.$,z=w.Base,A=w.Clazz,B=w.Component,C=w.Limit,D=w.Time,E=w.Dom,F=x.Select,G=x.Pager,H=x.Popup,I=a("../../../../../component/filter/filter"),J=a("../../../../../component/table"),K=a("../../../../../component/selectAll"),L=a("../../../../../action/testMonit"),M=a("../../../extend/bll/paper"),N=a("../../../extend/bll/monitor"),O=c.exports=A.create();A.mix(O,B,{_template:['<div class="data-report">','<div class="data-report-hd clearfix">',"<h2>试卷数据汇总</h2>","</div>",'<div class="data-report-bd">','<div class="js-filter-home"></div>','<div class="js-pagesize-home" style="height:25px;margin-bottom:8px">','<div class="result-info" style="margin-top:0px;line-height:25px;">','<span class="result-num">共有<span class="font-green paper-count js-paper-count"></span>张试卷</span>',"<span>每页显示",'<span class="page-size js-pagesize-cpn"></span>',"</span>","</div>",'<div class="real-oprt" style="height:25px;">','<a href="javascript:void(0);" class="link-green js-download" style="font-size:14px;line-height:25px;">下载报表</a>',"</div>","</div>",'<div class="js-tips" style="text-align:center;"></div>','<div class="js-table" style="overflow-x:auto;"></div>','<div class="js-pager"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.cpn={},a.initFilter(),a.initPageSizeCpn(),a.initSelectAll(),a.search()}},{name:"click td label.checkbox",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);c&&b.cpn.selectAll.toggle(c)}},{name:"click .js-download",handler:function(){var a=this,b=a.cpn.selectAll;return b.isSelectAll||b.selectIds&&0!==b.selectIds.length?void N.downloadExcel(a.getBatchCond()):void H.alert("请选择需要下载报表的试卷")}},{name:"click .js-go-nav",handler:function(a){var b=this,c=y(a.currentTarget),d=b.rawConfig.module,e=c.attr("data-status"),f=b.getLineId(c);d.nav("paper",{action:"notice/detail/index",paperId:f,testStatus:e?+e:void 0})}},{name:"click a.js-rank",handler:function(a){var b=this,c=y(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");e&&f&&(f="1"===f?"0":"1",b.addParam({page:1,orderBy:e,sqlOrder:f}),b.search())}}]},{initialize:d,initFilter:e,initPageSizeCpn:f,initSelectAll:g,refresh:h,val:i,search:j,check:k,renderList:l,getCond:m,getBatchCond:n,getLineId:o,getParam:p,addParam:q,getProjectId:r,wrapRate:s,wrapDuration:t,parseRate:u,parseDuration:v})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/present",["nc","cpn","../../../../../component/preview","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../echart","../../../../../util/util","../../../../../component/progress","../../../../../action/testMonit"],function(a,b,c){function d(){}function e(){var a=this,b=a.cpn={},c=(new Date).getTime()-154656e5,d=o.form(new Date(c),"yyyy-MM-dd");b.preview=new p({renderTo:a.getEl(".js-preview-home"),data:{topName:"平均到场率",leftName:"邀请",rightName:"到场"}}),b.date=new q({renderTo:a.getEl(".js-date-home"),noTime:!0,startDate:d,endDate:"now",change:function(b){b.startDate&&b.endDate&&a.search()}})}function f(){var a=this;a.cpn.date.val({}),a._previewRendered=!1,a.search()}function g(){var a=this,b=a.rawConfig,c=a.cpn.date.val(),d=!c.startDate||!c.endDate,e=b.module,f=a.getProjectId();e.renderWait(a.getEl(".js-chart-present"),"加载中..."),t.getAttendRation({query:{beginTime:d?void 0:c.startDate+" 00:00:00",endTime:d?void 0:c.endDate+" 23:59:59",projectIdList:"0"===f?r.getAllId(b.projectData):f},call:function(b){var c=b.data||{};a.renderPreview(c),a.renderChart(c)},error:function(b){e.renderWait(a.getEl(".js-chart-present"),b.msg)}})}function h(a){var b=this;b._previewRendered||(b.cpn.preview.renderTxt({topData:(100*(a.sumOpenCount/a.sumUserCount||0)).toFixed(1)+'<span style="font-size:24px;">%</span>',leftData:a.sumUserCount,rightData:a.sumOpenCount}),b._previewRendered=!0)}function i(a){var b=this,c=a.details,d=b.rawConfig.module,e=b.getEl(".js-chart-present");return c&&0!==c.length?void s.present(c,e):d.renderWait(e,"暂无数据")}function j(a){a=+a||0;var b=(new Date).getTime()-24*a*3600*1e3,c=o.form(new Date(b),"yyyy-MM-dd");return c}function k(){var a=this,b=a.rawConfig.module;return b.getParam().projectId}var l=a("nc"),m=(a("cpn"),l.$,l.Base,l.Clazz),n=l.Component,o=l.Time,p=a("../../../../../component/preview"),q=a("../../../../../component/dateSelect"),r=a("../../../extend/bll/paper"),s=a("../echart"),t=a("../../../../../action/testMonit"),u=c.exports=m.create();m.mix(u,n,{_template:['<div class="data-form-mod clearfix">',"<h2>到场率</h2>",'<div class="form-bd clearfix">','<div class="js-preview-home"></div>','<div class="data-form-main">','<div class="data-main-hd">','<span class="title">到场率时间分布</span>','<span class="js-date-home" style="float:right;"></span>',"</div>",'<div class="data-main-bd js-chart-present" style="height:222px;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn(),a.search()}}]},{initialize:d,initCpn:e,refresh:f,search:g,renderPreview:h,renderChart:i,getBeforeN:j,getProjectId:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/scoreDistribution",["nc","cpn","../../../../../component/preview","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../echart","../../../../../util/util","../../../../../component/progress","../../../../../action/testMonit"],function(a,b,c){function d(){}function e(){var a=this,b=a.cpn={};b.paper=new s({renderTo:a.getEl(".js-paper-home"),options:[],needSearch:!0,change:function(){a.search(),a.fire("paperChange",this.val())}}),a.fixPaper()}function f(a){var b=this;b.projectPaper=a,b.fixPaper(),b.search()}function g(){var a=this,b=a.rawConfig,c=a.cpn.paper.val()||"",d=b.module,e=a.getProjectId();d.renderWait(a.getEl(".js-main"),"加载中..."),w.getScoreDistribute({query:{projectIdList:"0"===e?u.getAllId(b.projectData):e,paperId:c},call:function(b){var c=b.data||{};a.renderContainer(c),a.renderPreview(c),a.renderChart(c)},error:function(b){d.renderWait(a.getEl(".js-main"),b.msg)}})}function h(){var a=this,b=['<div class="form-bd clearfix">','<div class="js-preview-home"></div>','<div class="data-form-main js-module">','<div class="data-main-hd">','<span class="title">总体分值分布</span>',"</div>",'<div class="data-main-bd js-chart-total" style="height:222px;"></div>',"</div>","</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">客观题分值分布</span>',"</div>",'<div class="data-main-bd js-chart-object" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">编程题分值分布</span>',"</div>",'<div class="data-main-bd js-chart-code" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各学校平均分</span>',"</div>",'<div class="data-main-bd js-chart-school" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各学历平均分</span>',"</div>",'<div class="data-main-bd js-chart-education" style="height:222px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="display:none;">','<div class="data-main-hd">','<span class="title">各职位平均分分布</span>',"</div>",'<div class="data-main-bd js-chart-position" style="height:222px;"></div>',"</div>"].join("");a.getEl(".js-main").html(b)}function i(a){var b=this;b.cpn.preview=new t({renderTo:b.getEl(".js-preview-home"),data:{topName:"打开人数",leftName:"提交人数",rightName:"做题用时(分钟)",topData:a.openCount,leftData:a.finishCount,rightData:(a.avgElapseTimeSeconds/60).toFixed(1)}})}function j(a){var b=this;v.scoreDistribution(a.scores_distribution||{},b.getEl(".js-chart-total")),a.object_scores_distribution&&(b.getEl(".js-chart-object").closest(".js-module").show(),v.scoreDistribution(a.object_scores_distribution,b.getEl(".js-chart-object"))),a.code_scores_distribution&&(b.getEl(".js-chart-code").closest(".js-module").show(),v.scoreDistribution(a.code_scores_distribution,b.getEl(".js-chart-code"))),a.school_scores_distribution&&0!==a.school_scores_distribution.length&&(b.getEl(".js-chart-school").closest(".js-module").show(),v.schoolScore(a.school_scores_distribution,b.getEl(".js-chart-school"))),a.degree_scores_distribution&&0!==a.degree_scores_distribution.length&&(b.getEl(".js-chart-education").closest(".js-module").show(),v.eduScore(a.degree_scores_distribution,b.getEl(".js-chart-education"))),a.job_scores_distribution&&0!==a.job_scores_distribution.length&&(b.getEl(".js-chart-position").closest(".js-module").show(),v.jobScore(a.job_scores_distribution,b.getEl(".js-chart-position")))}function k(){var a=this,b=[];p.forEach(a.projectPaper,function(a,c){b.push({text:a.paperName,value:a.paperId,checked:0===c})}),a.cpn.paper.replaceOptions(b)}function l(a){var b=this;b.cpn.paper.val(a,!0)}function m(){var a=this,b=a.rawConfig.module;return b.getParam().projectId}var n=a("nc"),o=a("cpn"),p=(n.$,n.Base),q=n.Clazz,r=n.Component,s=o.Select,t=a("../../../../../component/preview"),u=a("../../../extend/bll/paper"),v=a("../echart"),w=a("../../../../../action/testMonit"),x=c.exports=q.create();q.mix(x,r,{_template:['<div class="data-form-mod clearfix">',"<h2>",'成绩分布<div class="btn-group js-paper-home"></div>',"</h2>",'<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.projectPaper=a.rawConfig.projectPaper,a.initCpn(),a.search()}}]},{initialize:d,initCpn:e,refresh:f,search:g,renderContainer:h,renderPreview:i,renderChart:j,fixPaper:k,switchPaper:l,getProjectId:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/studentDistribution",["nc","cpn","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../echart","../../../../../util/util","../../../../../component/progress","../../../../../action/testMonit"],function(a,b,c){function d(){}function e(){var a=this,b=a.cpn={};b.paper=new r({renderTo:a.getEl(".js-paper-home"),options:[],needSearch:!0,change:function(){a.search(),a.fire("paperChange",this.val())}}),a.fixPaper()}function f(a){var b=this;b.projectPaper=a,b.fixPaper(),b.search()}function g(){var a=this,b=a.rawConfig,c=a.cpn.paper.val()||"",d=b.module,e=a.getProjectId();d.renderWait(a.getEl(".js-main"),"加载中..."),u.getTestUserDistribute({query:{projectIdList:"0"===e?s.getAllId(b.projectData):e,paperId:c},call:function(b){var c=b.data||{};a.renderContainer(c),a.renderChart(c)},error:function(b){d.renderWait(a.getEl(".js-main"),b.msg)}})}function h(){var a=this,b=['<div class="data-main-mod two-mod js-module" style="overflow:hidden;display:none;">','<div class="data-main-hd">','<span class="title">考生地区分布(前10)</span>',"</div>",'<div class="data-main-bd js-chart-area" style="height:300px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="overflow:hidden;hidden;display:none;">','<div class="data-main-hd">','<span class="title">考生学历分布</span>',"</div>",'<div class="data-main-bd js-chart-education" style="height:300px;"></div>',"</div>",'<div class="data-main-mod two-mod js-module" style="overflow:hidden;hidden;display:none;">','<div class="data-main-hd">','<span class="title">考生学校分布</span>',"</div>",'<div class="data-main-bd js-chart-school" style="height:300px;"></div>',"</div>"].join("");a.getEl(".js-main").html(b)}function i(a){var b=this,c=b.rawConfig.module,d=a.address_user_count_distribution,e=a.degree_user_count_distribution,f=a.school_user_count_distribution,g=0;d&&0!==d.length&&(b.getEl(".js-chart-area").closest(".js-module").show(),t.areaDistribution(d,b.getEl(".js-chart-area")),g++),e&&0!==e.length&&(b.getEl(".js-chart-education").closest(".js-module").show(),t.eduDistribution(e,b.getEl(".js-chart-education")),g++),f&&0!==f.length&&(b.getEl(".js-chart-school").closest(".js-module").show(),t.schoolDistribution(f,b.getEl(".js-chart-school")),g++),g||c.renderNone(b.getEl(".js-main"),"暂无数据")}function j(){var a=this,b=[];o.forEach(a.projectPaper,function(a,c){b.push({text:a.paperName,value:a.paperId,checked:0===c})}),a.cpn.paper.replaceOptions(b)}function k(a){var b=this;b.cpn.paper.val(a,!0)}function l(){var a=this,b=a.rawConfig.module;return b.getParam().projectId}var m=a("nc"),n=a("cpn"),o=(m.$,m.Base),p=m.Clazz,q=m.Component,r=n.Select,s=a("../../../extend/bll/paper"),t=a("../echart"),u=a("../../../../../action/testMonit"),v=c.exports=p.create();p.mix(v,q,{_template:['<div class="data-form-mod clearfix">',"<h2>",'考生分布<div class="btn-group js-paper-home"></div>',"</h2>",'<div class="js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.projectPaper=a.rawConfig.projectPaper,a.initCpn(),a.search()}}]},{initialize:d,initCpn:e,refresh:f,search:g,renderContainer:h,renderChart:i,fixPaper:j,switchPaper:k,getProjectId:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/report/studentScore",["nc","cpn","../../../../../component/preview","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../core/siteConfig","../../../../../action/paper","../echart","../../../../../util/util","../../../../../component/progress","../../../../../action/testMonit"],function(a,b,c){function d(){}function e(){var a=this,b=a.cpn={};b.preview=new s({renderTo:a.getEl(".js-preview-home"),data:{topName:"平均成绩",leftName:"试卷",rightName:"做题用时(分钟)"}}),b.paper=new q({renderTo:a.getEl(".js-paper-home"),options:[],needSearch:!0,text:"选择需要对比的试卷",change:function(){var b=this.val();if(b=n.isArray(b)?b:[],b.length>30){r.alert("对比试卷不能超过30张，建议您分多次查询更多试卷");var c=b.slice(0,30);return void this.val(c)}a.search()}}),a.fixPaper()}function f(a){var b=this;b.projectPaper=a,b._previewRendered=!1,b.fixPaper(),b.search()}function g(){var a=this,b=a.rawConfig,c=a.cpn.paper.val()||[],d=b.module,e=a.getProjectId();d.renderWait(a.getEl(".js-chart-home"),"加载中..."),u.getScore({query:{projectIdList:"0"===e?void 0:e,paperIdList:0===c.length?void 0:c},call:function(b){var c=b.data||{};a.renderPreview(c),a.renderChart(c)},error:function(b){d.renderWait(a.getEl(".js-chart-home"),b.msg)}})}function h(a){var b=this;b._previewRendered||(b.cpn.preview.renderTxt({topData:(a.totalAvgScore||0).toFixed(1),leftData:a.paperCount,rightData:(a.totalAvgElapseTimeSeconds/60||0).toFixed(1)}),b._previewRendered=!0)}function i(a){var b=this,c=a.detail,d=b.rawConfig.module,e=b.getEl(".js-chart-home");return c&&0!==c.length?void t.studentScore(c,e):d.renderWait(e,"暂无数据")}function j(){var a=this,b=[];n.forEach(a.projectPaper,function(a){b.push({text:a.paperName,value:a.paperId})}),a.cpn.paper.replaceOptions(b)}function k(){var a=this,b=a.rawConfig.module;return b.getParam().projectId}var l=a("nc"),m=a("cpn"),n=(l.$,l.Base),o=l.Clazz,p=l.Component,q=m.SelectMult,r=m.Popup,s=a("../../../../../component/preview"),t=(a("../../../extend/bll/paper"),a("../echart")),u=a("../../../../../action/testMonit"),v=c.exports=o.create();o.mix(v,p,{_template:['<div class="data-form-mod clearfix">',"<h2>考生成绩</h2>",'<div class="form-bd clearfix">','<div class="js-preview-home"></div>','<div class="data-form-main">','<div class="data-main-hd">','<span class="title">平均分对比</span>','<span class="js-paper-home" style="float:right;"></span>',"</div>",'<div class="data-main-bd js-chart-home" style="height:222px;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.projectPaper=a.rawConfig.projectPaper,a.initCpn(),a.search()}}]},{initialize:d,initCpn:e,refresh:f,search:g,renderPreview:h,renderChart:i,fixPaper:j,getProjectId:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/monit/scene",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/testMonit","../../../../util/ajax","../../../../action/paper"],function(a,b,c){function d(){var a=this;a.picsData=[]}function e(a){var b=this;if(b._lastScrollCb&&b._lastScrollCb(),a!==!1){var c=b.getSysEl();b._lastScrollCb=r.scrollBottom(500,c.contentWin,c.content,function(){b.initScroll(!1);var a=b.picsData,c=a[a.length-1]||{};b.getListData(c.userId)})}}function f(a){var b=this,c=b.getParam();y.getPaper({type:"GET",params:{paperId:c.paperId},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){b.renderWait(b.contentEl,a.msg)}})}function g(a){var b=this,c=b.getParam(),d=c.paperId,e=c.word,f=!a;return b.initScroll(!1),d?void x.getPicInfoV2({params:{userId:b.getUserId(),paperId:d},query:{pageSize:A,preUid:a,word:e},call:function(a){var c=(b.getParam(),a.data||{});b.picsData=b.picsData.concat(c.ctsPicList||[]),b.renderData(c.ctsPicList,c.signUpFields,f)}}):b.renderWait(b.contentEl,"缺少参数")}function h(a,b,c){var d=this,e=d.getEl(),f=d.getParam(),g=f.paperId,h=f.word,i=p.execTpl(['<li v-if="items.length === 0 && isFirst" class="no-screenshot"><img style="width:auto;height:auto;" src="//uploadfiles.nowcoder.com/images/20160324/56_1458796958175_FB5C81ED3A220004B71069645F112867"></li>','<li v-for="item in items" :title="getTitle(item)" class="js-tips">','<div class="user-img-wrap">','<a :href="getHref(item)" :target="paperId ? \'_blank\' : \'\'" :data-key="item.testUserKey || \'\'" :data-paper="paperId"><img :src="getUrl(item)"></a>',"</div>",'<div class="user-info-wrap">',"<span class=\"user-info-name\">#{!item.userName ? '牛客考生' : item.userName}</span>",'<span class="user-progress">#{getProgress(item)}%</span>','<a :class="getCheatCls(item)" :data-pic-id="item.id" :data-cheat-status="item.markCheat" href="javascript:void(0);">#{getCheatName(item)}</a>',"</div>","</li>"],{paperId:g,items:a||[],isFirst:c,getTitle:function(a){return d.getUserInfo(a,b).join("\\n")},getHref:function(a){return g?d.getNavUrl("paper",{action:"monit/pics",account:a.testUserKey,paperId:g,word:h}):"javascript:void(0);"},getUrl:function(a){return w.fixUrlProtocol(a.url)},getProgress:function(a){return Math.round(100*+a.doneQuestionProgress)||0},getCheatCls:function(a){return["tag-danger","tag-label","js-action-cheat",1===+a.markCheat?"show":""]},getCheatName:function(a){return 1===+a.markCheat?"已标记作弊":"标记作弊"}});c&&d.contentEl.html('<ul class="screenshot-list"></ul>'),e.find("ul.screenshot-list").append(i),a.length>=A&&d.initScroll(),t.title(".js-tips")}function i(a,b){var c=[];a.createTime&&c.push(s.form(new Date(a.createTime),"yyyy-MM-dd HH:mm:ss"));var d=a.ext||{};return q.forEach(b,function(b){var e=("key"===b.name?a.key||a.testUserKey:d[b.name])||"";e&&c.push(b.title+": "+e)}),c.push("做题进度: "+(Math.round(100*(+a.doneQuestionProgress||0))||0)+"%"),c}function j(a,b){var c=this;x.markCheat({type:"PUT",params:{userId:c.getUserId()},body:{cheated:b,picId:a,all:1},call:function(){u.tips(1===b?"标记成功":"取消标记成功")}})}function k(){var a=this,b=a.paper,c=a.getParam(),d=c.paperId;return{crumb:[{title:"数据报表"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"monit/index",paperId:d,refresh:1}}],ext:[{input:{value:n.trim(c.word),placeholder:"输入考号或名字，回车搜索"},listeners:{ok:function(b){var c=n.trim(b.val());a.nav("paper",{action:"monit/scene",paperId:d,word:c})}}}]}}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=(l.Str,l.Node),q=l.Base,r=(l.Limit,l.Dom),s=l.Time,t=m.Tips,u=m.Popup,v=a("../../../../core/module"),w=a("../../../../util/util"),x=a("../../../../action/testMonit"),y=a("../../../../action/paper"),z=c.exports=o.create(),A=25;o.mix(z,v,{style:"/stylesheets/styles/system/realTimeIndex-new.css",title:"全部用户截图",_template:["<div>",'<div class="report-box exam-cheat">','<div class="report-bd clearfix js-content"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();return a.contentEl=b.find("div.js-content"),c.paperId?(a.renderWait(a.contentEl),void a.getPaper(function(){a.getListData()})):a.renderWait(a.contentEl,"缺少参数")}},{name:"beforeLeave",type:"custom",handler:function(){var a=this;a.initScroll(!1)}},{name:"click.prevent .js-action-cheat",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-pic-id"),e="0"===c.attr("data-cheat-status")?1:0;b.markCheat(d,e),c.attr("data-cheat-status",e)[1===e?"addClass":"removeClass"]("show"),c.html(e>0?"已标记作弊":"标记作弊")}}]},{initialize:d,initScroll:e,getPaper:f,getListData:g,renderData:h,getUserInfo:i,markCheat:j,getCrumbConf:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/add1",["nc","cpn","../../../../../core/siteConfig","../../../extend/bll/money","../../../extend/bll/base","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../extend/bll/paper","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","./util/popupAddSucc","../../../../../component/department","../../../../../util/switch","../../../../../util/util","../../../../../action/user"],function(a,b,c){function d(a){var b=this;b.parent=a.parent,b.fieldMap=p.toMap(a.signUpFields,function(a){return{key:a.name,value:a}}),b.cpn=[]}function e(){var a=this,b=a.department=new y({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",departmentData:a.rawConfig.departmentData,tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理这些考生，包括查看成绩、分配判卷以及判卷操作"});b.getEl().width(450).css("margin","auto"),b.getEl(".control-label").width(135)}function f(a){var b=this,c=b.rawConfig,d=b.listEl,e=b.cpn,f=l(o.execTpl(['<div class="add-mod js-line" style="display:none;">','<div class="add-mod-head">','<h2><span class="js-name">考生#{index}</span>','<a href="javascript:void(0);" class="icon-trash js-trash"></a>',"</h2>","</div>",'<div class="add-mod-body js-field-list"></div>',"</div>"].join(""),{index:b.cpn.length+1}));d.append(f);var g=f.find(".js-field-list"),h={};p.forEach(c.signUpFields,function(a){var b="phone"===a.name||/手机/.test(a.title)?'<span class="icon-question-sign js-tips" title="国际手机号码请按照：+区号手机号码 的格式填写，中间不能出现空格" data-theme="white" style="cursor:pointer;"></span>':"",c="0"===p.id(a.edit)?"考生不可修改，"+(a.need?"必填项":"建议填写"):a.need?"必填项":"",d=l(['<div class="add-item">','<div class="form-group">','<label class="control-label">'+a.title+"</label>",'<div class="control-group js-ipt"></div>',b&&!c?b:"","</div>","</div>"].join(""));g.append(d);var e=d.find(".js-ipt"),f=0===a.valueType||0===(a.valueList||[]).length,i=f?r:1===a.valueType?t:u,j=new i({renderTo:e,noSelectAll:!0,options:f?void 0:p.map(a.valueList,function(a){return{value:a,text:a}})});c&&j.getEl().append('<span class="choose-tips" style="width:135px;">'+c+b+"</span>"),h[a.name]=j}),e.push(h),a?f.slideDown(120):f.show(),b.fixList()}function g(){var a=this,b={};return p.forEach(a.cpn,function(a){p.forEach(a,function(a,c){var d=a.val();b[c]=b[c]||[],b[c].push(l.trim(p.isArray(d)?d.join("_"):d))})}),b.departmentId=a.department.val(),b}function h(){var a=this,b=!0,c={},d=[],e=a.fieldMap;return p.forEach(a.cpn,function(a){p.forEach(a,function(a,f){var g=e[f],h=g.title,i=l.trim(a.val());if("key"===f&&0===d.length&&(c[i]=c[i]||[],c[i].push(a),c[i].length>1&&(d=c[i])),i||g.need){var j="";!i&&g.need?j=g.title+"不能为空":h.indexOf("手机")>=0&&!o.isTel(i)?j="手机号码格式错误":(h.indexOf("邮箱")>=0&&!o.isEmail(i)||h.indexOf("身份证")>=0&&!o.isPassport(i))&&(j="请填写正确的"+h),j&&(a.setErrorTips&&a.setErrorTips(j),!a.setErrorTips&&a.error&&a.error(),b=!1)}})}),d.length>0&&(b=!1,p.forEach(d,function(a){a.setErrorTips("不能填写重复的值")})),b}function i(){var a=this,b=a.listEl,c=a.cpn;b.find(".js-trash")[c.length>1?"show":"hide"](),p.forEach(b.find(".js-name"),function(a,b){l(a).html("考生"+(b+1))})}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=j.Str,p=j.Base,q=j.Limit,r=k.Input,s=k.Popup,t=k.Select,u=k.SelectMult,v=(a("../../../../../core/siteConfig"),a("../../../extend/bll/money")),w=a("../../../extend/bll/paper"),x=a("./util/popupAddSucc"),y=a("../../../../../component/department"),z=a("../../../../../action/paper"),A=c.exports=n.create();n.mix(A,m,{_template:["<div>",'<div class="import-add-main js-list"></div>','<div class="import-add-btn">','<a href="javascript:void(0);" class="js-add"><i class="icon-plus-sign"></i>添加考生</a>',"</div>",'<div class="js-department-home"></div>','<div style="margin-top:30px;text-align:center;">','<a class="btn btn-primary btn-lg js-submit" href="javascript:void">提交</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.listEl=b.find("div.js-list"),a.add(),a.initDepartment()}},{name:"click a.js-add",handler:function(){var a=this;a.add(!0)}},{name:"click .js-trash",handler:function(a){var b=this,c=(b.listEl,b.cpn),d=l(a.currentTarget),e=d.closest("div.js-line"),f=e.index();return 1===c.length?void d.hide():(c.splice(f,1),void e.slideUp(120,function(){e.remove(),b.fixList()}))}},{name:"click .js-submit",handler:function(a){var b=this,c=l(a.currentTarget),d=b.parent,e=d.getPaperId();b.check()&&(q.mark(c)||z.addUser({params:{paperId:e},body:p.extend(b.val(),{failOnExist:!0}),call:function(a){var b=p.map(a.data,function(a){return a.id});x.show({content:"已有"+b.length+"个考生成功添加！",listeners:{notify:function(){v.refreshMoney(),w.navNotice(e,{ids:b,isAll:2})},back:function(){v.refreshMoney(),d.nav("paper",{action:"notice/detail/index",paperId:e})}}})},statusCall:{1005:function(a){var c=a.details||{},d=b.fieldMap[c.parameterName]||{},e=d.title||c.parameterName;return s.alert(e+c.format||""),!1},1321:function(a){var c=a.details&&a.details.index;if(p.isNumber(c)){var d=b.cpn[c],e=d.key,f=+a.details.type,g=1===f?"该考生信息已被测试账号占用":"已经被"+(a.details.department?"机构"+a.details.department:"其他")+"的考生占用";e&&e.setErrorTips(g)}else s.alert("考生信息已经被使用");return!1},1101:function(a){var b='<div style="font-size:14px;padding:20px 0;">'+a.msg+"</div>";return new s({title:"余额不足",width:600,content:b,okTxt:"去充值",cancelTxt:"暂不导入",listeners:{ok:function(){d.getWin().nav("purchase",{action:"recharge"})},cancel:function(){}}}),!1}},error:function(a){s.alert(a.msg)},always:function(){q.clear(c)}}))}}]},{initialize:d,initDepartment:e,add:f,val:g,check:h,fixList:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/add2",["nc","cpn","../../../extend/bll/money","../../../extend/bll/base","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../../../core/siteConfig","../../../../../util/util","../../../extend/bll/paper","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","./util/popupAddSucc","../../../../../component/department","../../../../../util/switch","../../../../../action/user"],function(a,b,c){function d(a){var b=this;b.parent=a.parent}function e(){var a=this,b=a.parent,c=b.getPaperId(!0);a.initDepartment(),a.refreshSelect(c),a.initUpload()}function f(){var a=this,b=a.department=new C({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",departmentData:a.rawConfig.departmentData,marginLeft:"-55px",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理这些考生，包括查看成绩、分配判卷以及判卷操作"});b.getEl(".control-label").width(135)}function g(){var a=this,b=a.getEl(),c=b.find(".js-upload-file"),d=t.show({target:c,url:y.getUploadUrl(x.uploadType.file),fileType:"*.xlsx;",call:function(b){a.fileUrl=b.data,c.html("上传Excel文件【已上传】")}});a.pushChild(d)}function h(a,b,c){function d(c){j.close();var d=c.content,e=c.type;if(3===e){var f=JSON.parse(d),h=q.id(f.code),k=(f.msg||"").replace(/\n+/g,"<br />"),l="1308"===h,m="1304"===h,n="1101"===h;if(m||n)return new v({title:m?"提醒":"余额不足",width:600,content:'<div style="font-size:14px;padding:20px 0;text-align:center;">'+k+"</div>",okTxt:m?"我知道了":"去充值",cancelTxt:m?"继续导入":"暂不导入",listeners:{ok:function(){n&&i.nav("purchase",{action:"recharge"})},cancel:function(){m&&g.uploadExcel(a,b,{tooManyConfirm:1})}}});if(l){var o=g.getSignUpKeyField(),p=r.execTpl(['<div style="font-size:14px;padding:20px 0;line-height:2;">',"<div>#{successCount}名考生已经成功导入</div>",'<div v-if="failCount !== 0">#{failCount}名考生信息格式错误，无法导入，<a class="link-green" :href="errorFileUrl" target="_blank">点击下载错误名单</a></div>','<div v-if="duplicateCount !== 0 && duplicateFileUrl">','<div>#{duplicateCount}名考生已被多次邀请笔试，系统暂未导入，你也可以<a class="link-green js-force" href="javascript:void(0);">继续导入这些考生</a></div>','<div style="margin-top:20px;">','<table class="no-border-table need-hover">',"<thead><tr><th>考生姓名</th><th>#{keyName}</th><th>邀请次数</th><th>实际到场</th></tr></thead>",'<tbody><tr v-for="item in duplicateArray">',"<td>#{item.name}</td><td>#{item.userKey}</td><td>#{item.testUserCount}</td><td>#{item.openCount}</td>","</tr></tbody>","</table>","</div>","</div>",'<div v-else-if="duplicateCount !== 0">',"<div>#{duplicateCount}名考生已被多次邀请笔试，系统暂未导入</div>","</div>","</div>"].join(""),{keyName:(o||{}).title||"考生唯一识别号",successCount:f.successCount||0,failCount:f.failCount||0,duplicateCount:f.duplicateCount||0,errorFileUrl:f.errorFileUrl,duplicateFileUrl:f.duplicateFileUrl,duplicateArray:f.duplicateArray||[]});return void new v({title:"提醒",width:720,content:p,okTxt:"我知道了",listeners:{"click .js-force":{handler:function(){g.uploadExcel(a,f.duplicateFileUrl,{companyDuplicateConfirm:!0})}}}})}}v.alert(d)}function e(a){j.close(),w.refreshMoney(),g.fileUrl="";var b=g.getEl(".js-upload-file");b.html("上传Excel文件");var c=a.type;if(3===c){var d=JSON.parse(a.content)||[];return B.show({content:"已有"+d.length+"个考生成功添加！",listeners:{notify:function(){var a=h.getPaperId(!0);z.navNotice(a,{ids:d,isAll:2})},back:function(){h.nav("paper",{action:"notice/detail/index",paperId:h.getPaperId()})}}})}v.tips("操作成功",function(){h.nav("paper",{action:"notice/detail/index",paperId:h.getPaperId()})})}function f(a){j.getEl(".warning-word").html(a.content)}var g=this,h=g.parent,i=h.getWin(),j=i.showLoading("导入中...");D.uploadPaperUser({body:q.extend({paperIds:a,fileUrl:b,note:g.noteIpt?n.trim(g.noteIpt.val()):"",type:"add",departmentId:g.department.val()},c),call:function(a){A.getTaskProgress(!0,a.data,function(a){var b=a.content,c=a.error?d:a.end?e:b&&"暂无进度"!==b?f:null;c&&c(a)})},error:function(a){j.close(),v.alert(a.msg)}})}function i(){var a=this,b=a.parent,c=a.paperSelect.val(),d=c&&c.length&&c[0],e=c.join("&ids=");return d?"/v1/papers/"+d+"/sign_up.xlsx?access_token="+b.getToken()+"&ids="+e:"javascript:void(0);"}function j(a){function b(){d.find("a.js-download").attr("href",c.getExcelUrl())}var c=this,d=c.getEl(),e=c.paperSelect,f=e?e.val():[];f=f.concat(q.isArray(a)?a:[a]),f=q.map(f,function(a){return+a});var g=q.map(c.allPapers,function(a){return{value:a.id,text:a.paperName,checked:f&&f.length&&q.contains(f,a.id)}});e?(e.replaceOptions(g),e.open()):(c.paperSelect=new s({renderTo:d.find("span.js-tmp-paper"),renderBy:"replaceWith",options:g,needSearch:!0,change:function(){b()}}),b())}function k(){var a=this,b=a.rawConfig,c=b.signUpFields||[],d=q.find(c,function(a){return"key"===a.name});return d||{}}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Component,p=l.Clazz,q=l.Base,r=l.Node,s=m.SelectMult,t=m.AttachUpload,u=m.Input,v=m.Popup,w=a("../../../extend/bll/money"),x=a("../../../../../core/siteConfig"),y=a("../../../../../util/util"),z=a("../../../extend/bll/paper"),A=a("../../../extend/bll/task"),B=a("./util/popupAddSucc"),C=a("../../../../../component/department"),D=a("../../../../../action/paper"),E=c.exports=p.create();p.mix(E,o,{_template:['<div class="import-tips">','<dl class="import-tips-words" style="line-height:26px;">',"<dt>重要提醒</dt>","<dd>1.请先选择目标试卷，下载模板后严格按照模板格式进行考生名单添加；</dd>","<dd>2.添加考生信息时，内容、格式和顺序请严格遵循模板规范，少填或乱序均会造成解析失败，国际手机号码请严格按照：+区号手机号码 的格式填写，中间不能出现空格，如：+93701234567；</dd>","<dd>3.如同时导入多张试卷名单，需确保本批试卷考生信息设置完全一致，否则无法同时添加。填写时注意正确填写考试试卷的名字。</dd>","</dl>",'<div class="js-content">','<div class="import-tips-form">','<div class="form-group">','<label class="control-label">笔试试卷</label>','<span class="js-tmp-paper">','<input value="加载中..." readonly="" type="text"><span class="caret"></span>',"</span>",'<a href="javascript:void(0)" target="_blank" class="js-download tips-download link-green">','<i class="icon-download-alt"></i>下载该试卷模板',"</a>","</div>",'<div class="form-group">','<label class="control-label" for="inputNote">名单备注</label>','<div class="control-group js-note">','<input type="text" id="inputNote" placeholder="选填，可输入上传人或来源，用于区分考生">',"</div>","</div>",'<div class="js-department-home"></div>','<div class="form-group">','<label class="control-label"></label> <a href="javascript:void(0)" class="btn btn-info btn-lg js-upload-file">上传Excel文件</a>',"</div>",'<div class="form-group import-tips-btn">','<label class="control-label"></label> <a href="javascript:void(0)" class="btn btn-primary btn-lg  js-next">上传完毕，下一步</a>',"</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.parent.getPaperId(!0),c=a.getEl();a.noteIpt=u.transform(c.find(".js-note")),D.getSameSignUpsPapers({params:{paperId:b[0]},query:{},call:function(b){a.allPapers=b.data,a.initCpn()},error:function(){}})}},{name:"click .js-next",handler:function(){var a=this,b=n.trim(a.fileUrl);if(!b)return v.alert("请先上传Excel文件");var c=a.paperSelect.val()||[];return 0===c.length?v.alert("请选择需要上传名单的试卷"):void a.uploadExcel(c,b)}}]},{initialize:d,initCpn:e,initDepartment:f,initUpload:g,uploadExcel:h,getExcelUrl:i,refreshSelect:j,getSignUpKeyField:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/add3",["nc","cpn","../../../extend/bll/money","../../../extend/bll/base","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../../../core/siteConfig","../../../../../action/beisen","../../../extend/bll/paper","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","./util/popupAddSucc","../../../../../component/department","../../../../../util/switch","../../../../../util/util","../../../../../action/user"],function(a,b,c){function d(a){var b=this;b.cache={jobList:{},station:{},stationId:0},b.cpn={},b.parent=a.parent,b.uid=b.parent.getUserId(),b.pid=b.parent.getPaperId()}function e(a){function b(){var a=e.job.val(),b=e.station;return f.find(".js-station").show(),0===a.length?c("请先选择应聘职位"):(c(),void d.getStations({jobId:a,call:function(a){var d=a.length>0;c(d?!1:"没有面试站点"),a=s.map(a,function(a){return{text:a.text,value:a.value}}),d&&b.replaceOptions(a)},error:function(a){c(a||"出现错误，请重试")}}))}function c(a){var b=e.station;a===!1?(b.show(),g.find("input").val("加载中..."),g.hide()):(b.replaceOptions([]),b.hide(),g.find("input").val(a||"加载中..."),g.show())}var d=this,e=(d.parent,d.cpn),f=d.getEl(),g=f.find(".js-station-tips");d.initDepartment(),e.job=new v({renderTo:f.find(".js-job-temp"),renderBy:"replaceWith",needSearch:!0,noSelectAll:!0,options:s.map(a,function(a){return{text:[a.jobCode||"",a.department||"",a.jobTitle].join("_"),value:a.jobId}}),change:b}),e.station=new u({renderTo:f.find(".js-station-temp"),renderBy:"replaceWith",options:[]})}function f(){var a=this,b=a.cpn;b.department=new C({renderTo:a.getEl(".js-department-home"),renderBy:"replaceWith",departmentData:a.rawConfig.departmentData,marginLeft:"-55px",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理这些考生，包括查看成绩、分配判卷以及判卷操作"}),b.department.getEl(".control-label").width(135)}function g(){var a=this,b=a.cpn;return{jobIdList:b.job.val(),stationList:b.station.val(),paperId:a.pid,departmentId:b.department.val()}}function h(){var a=this,b=a.val();return 0===(b.jobIdList||[]).length?(w.alert("请先选择应聘职位"),!1):b.stationList?!0:(w.alert("请选择面试站点"),!1)}function i(a){function b(a){h.close();var b=a.content,c=a.type;if(3===c){var d=JSON.parse(b),f=s.id(d.code),i=(d.msg||"").replace(/\n+/g,"<br />"),j="1308"===f,k="1304"===f,l="1101"===f;if(k||l)return new w({title:k?"提醒":"余额不足",width:600,content:'<div style="font-size:14px;padding:20px 0;text-align:center;">'+i+"</div>",okTxt:k?"我知道了":"去充值",cancelTxt:k?"继续导入":"暂不导入",listeners:{ok:function(){l&&g.nav("purchase",{action:"recharge"})},cancel:function(){k&&e.submit({tooManyConfirm:1})}}});if(j){var m=e.getSignUpKeyField(),n=t.execTpl(['<div style="font-size:14px;padding:20px 0;line-height:2;">',"<div>#{successCount}名考生已经成功导入</div>",'<div v-if="failCount !== 0">#{failCount}名考生信息格式错误，无法导入，<a class="link-green" :href="errorFileUrl" target="_blank">点击下载错误名单</a></div>','<div v-if="duplicateCount !== 0 && duplicateFileUrl">','<div>#{duplicateCount}名考生已被多次邀请笔试，系统暂未导入，你也可以<a class="link-green" href="duplicateFileUrl" target="_blank">点击下载考生名单</a>，通过批量增加重新导入</div>','<div style="margin-top:20px;">','<table class="no-border-table need-hover">',"<thead><tr><th>考生姓名</th><th>#{keyName}</th><th>邀请次数</th><th>实际到场</th></tr></thead>",'<tbody><tr v-for="item in duplicateArray">',"<td>#{item.name}</td><td>#{item.userKey}</td><td>#{item.testUserCount}</td><td>#{item.openCount}</td>","</tr></tbody>","</table>","</div>","</div>",'<div v-else-if="duplicateCount !== 0">',"<div>#{duplicateCount}名考生已被多次邀请笔试，系统暂未导入</div>","</div>","</div>"].join(""),{keyName:(m||{}).title||"考生唯一识别号",successCount:d.successCount||0,failCount:d.failCount||0,duplicateCount:d.duplicateCount||0,errorFileUrl:d.errorFileUrl,duplicateFileUrl:d.duplicateFileUrl,duplicateArray:d.duplicateArray||[]});return void new w({title:"提醒",width:720,content:n,okTxt:"我知道了"})}}w.alert(b)}function c(a){h.close(),x.refreshMoney();var b=a.type;if(3===b){var c=JSON.parse(a.content)||[];return B.show({content:"已有"+c.length+"个考生成功添加！",listeners:{notify:function(){var a=f.getPaperId(!0);z.navNotice(a,{ids:c,isAll:2})},back:function(){f.nav("paper",{action:"notice/detail/index",paperId:f.getPaperId()})}}})}w.tips("操作成功",function(){f.nav("paper",{action:"notice/detail/index",paperId:f.getPaperId()})})}function d(a){h.getEl(".warning-word").html(a.content)}var e=this,f=e.parent,g=f.getWin();if(e.check()){var h=g.showLoading("导入中...");y.addTestUser({params:{uid:e.uid},body:s.extend(e.val(),a),call:function(a){A.getTaskProgress(!0,a.data,function(a){var e=a.content,f=a.error?b:a.end?c:e&&"暂无进度"!==e?d:null;f&&f(a)})},error:function(a){h.close(),w.alert(a.msg)}})}}function j(a){var b=this,c=b.cache,d=a.jobType||"2",e=c.jobList[d]||[];return e.length>0?a.call&&a.call(e):void y.getJobs({params:{uid:b.uid},query:{jobType:d},call:function(b){var d=b.data||[];c.jobList=d.slice(0),a.call&&a.call(d)},error:function(){a.error&&a.error()}})}function k(a){function b(b,c){h===d.stationId&&(c&&a.error&&a.error(b),!c&&a.call&&a.call(b))}var c=this,d=c.cache,e=(a.jobId||[]).sort(function(a,b){return a-b}),f=e.join("|"),g=d.station[f],h=d.stationId=d.stationId+1;return g?a.call&&a.call(g):void y.getStations({params:{uid:c.uid},query:{jobIdList:a.jobId},call:function(a){A.getTaskProgress(!0,a.data,function(a){if(a.end){if(a.error)return b(a.content,!0);var c=s.json(a.content)||[];c=s.map(c,function(a){var b=a;return{text:a,value:b}}),d.station[f]=c,b(c)}})},error:function(a){b(a.msg,!0)}})}function l(a){function b(){e.html(['<div style="font-size:14px;text-align:center;">','<div style="margin-bottom:20px;">',"<span>系统导入仅支持考试编号为“投递编号”的试卷，请修改本套试卷设置后再进行导入。</span>",'<a href="javascript:void(0);" class="link-green js-edit-paper">去修改</a>',"</div>",'<img src="//uploadfiles.nowcoder.com/images/20180724/56_1532439436333_41C94F0A904F212533C17933F6B6994C" style="width:805px;height:123px;" />',"</div>"].join(""))}var c=this,d=c.parent,e=c.getEl();y.checkPaper({type:"GET",params:{uid:c.uid},query:{paperId:c.pid},call:function(c){var d=!!c.data;d&&a&&a(),!d&&b()},error:function(a){d.renderNone(e,a.msg)}})}function m(a){var b=this,c=b.getEl(),d=c.find(".js-temp"),e=c.find(".js-content");return a===!1?(d.html("").hide(),void e.show()):(e.hide(),void b.parent.renderNone(d,a))}function n(){var a=this,b=a.rawConfig,c=b.signUpFields||[],d=s.find(c,function(a){return"key"===a.name});return d||{}}var o=a("nc"),p=a("cpn"),q=(o.$,o.Component),r=o.Clazz,s=o.Base,t=o.Node,u=p.Select,v=p.SelectMult,w=p.Popup,x=a("../../../extend/bll/money"),y=(a("../../../../../core/siteConfig"),a("../../../../../action/beisen")),z=a("../../../extend/bll/paper"),A=a("../../../extend/bll/task"),B=a("./util/popupAddSucc"),C=a("../../../../../component/department"),D=(a("../../../../../action/paper"),c.exports=r.create());r.mix(D,q,{_template:['<div class="import-tips">','<div class="js-temp"></div>','<div class="import-tips-form js-content" style="display:none;">','<div class="form-group">','<label class="control-label">应聘职位</label>','<span class="js-job-temp"><input value="加载中..." readonly="" type="text"></span>',"</div>",'<div class="form-group js-station" style="display:none;">','<label class="control-label">面试站点</label>','<span class="js-station-temp"><input value="加载中..." readonly="" type="text"></span>','<span class="js-station-tips"><input value="加载中..." readonly="" type="text"></span>',"</div>",'<div class="js-department-home"></div>','<div class="form-group import-tips-btn">','<label class="control-label"></label> <a class="btn btn-primary btn-lg js-submit" href="javascript:void">确定导入</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.getEl(),c=b.find(".js-temp");b.find(".js-content")}a.parent.renderWait(c),a.checkCond(function(){a.getJobList({call:function(b){a.renderNone(!1),a.initCpn(b)},error:function(b){a.renderNone(b)}})})}},{name:"click .js-edit-paper",handler:function(){var a=this,b=a.parent.getPaperId();a.parent.nav("paper",{action:"edit",id:b})}},{name:"click .js-submit",handler:function(){var a=this;a.submit()}}]},{initialize:d,initCpn:e,initDepartment:f,val:g,check:h,submit:i,getJobList:j,getStations:k,checkCond:l,renderNone:m,getSignUpKeyField:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/index",["nc","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../util/permission","../../../extend/bll/paper","cpn","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../../../../../action/user","./util/tabCpn"],function(a,b,c){function d(){var a=this;a.moduleCache={}}function e(a){var b=this,c=(b.getParam(),b.getPaperId(!0));return c.length>1?(b.paper={paperName:"多张试卷"},b.refreshCrumb(),a&&a()):void q.getPaper({params:{paperId:c[0]},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){b.renderNone(b.getEl(),a.msg)}})}function f(){var a=this,b=a.getPaperId(!0);if(b.length<=1){var c=[{text:"单个添加",value:"1"},{text:"批量增加",value:"2"}];return o.has("1002")&&c.push({text:"第三方简历系统导入",value:"3"}),a.tab=new s({options:c,renderTo:a.getEl("div.js-header"),renderBy:"replaceWith",change:function(b){a.renderItem(b)}}),void a.tab.val(m.id(a.getParam().type)||"1",!0)}a.renderItem("2")}function g(b){var c=this,d=(c.getEl(),c.moduleCache);m.forEach(d,function(a){a&&a.hide()}),c.addParam({type:b});var e=d[b];!e&&a.async("./add"+b,function(a){d[b]=new a({renderTo:c.bodyEl,departmentData:c.departmentData,parent:c,signUpFields:c.signUpFields})}),e&&d[b].show()}function h(a){var b=this,c=b.getParam().paperId;return c=m.isArray(c)?c:[c],c=m.filter(c,function(a){return!!a}),!a&&c.length<=1?c[0]:c}function i(a,b){var c=this;r.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getPaperId(),entityType:6},call:function(b){var d=b.data||[];c.departmentData=d,m.isFunction(a)&&a(d)},error:function(a){m.isFunction(b)&&b(a.msg)}})}function j(){var a=this,b=(a.getParam(),a.paper);return{crumb:[{title:"邀请考生",module:"paper",action:"notice/index"},{title:"笔试通知"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"notice/detail/index",paperId:a.getPaperId()}}]}}var k=a("nc"),l=(k.$,k.Clazz),m=k.Base,n=a("../../../../../core/module"),o=a("../../../../../util/permission"),p=a("../../../extend/bll/paper"),q=a("../../../../../action/paper"),r=a("../../../../../action/user"),s=a("./util/tabCpn"),t=c.exports=l.create();l.mix(t,n,{style:"/stylesheets/styles/system/importList.css",title:"添加考生",_template:['<div class="module-body">','<div class="import-add-people">','<div class="import-add-ways js-header"></div>','<div class="js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=(a.getParam(),a.getPaperId(!0));return a.bodyEl=b.find("div.js-body"),c.length<1?a.renderNone(b,"错误的参数"):(a.renderWait(a.bodyEl,"加载中..."),void a.getPaper(function(){a.getDepartment(function(){p.getSignUpFields(c[0],function(b){return 0===b.length?a.renderNone(a.bodyEl,"缺少考生字段"):(a.bodyEl.html(""),a.signUpFields=b,void a.initCpn())})},function(c){a.renderNone(b,c)})}))}}]},{initialize:d,getPaper:e,initCpn:f,renderItem:g,getPaperId:h,getDepartment:i,getCrumbConf:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/util/popupAddSucc",["nc","cpn"],function(a,b,c){function d(a){{var b=new k(a);j.wrap(b,{title:"导入成功",width:630,content:b.html(),hasNoFooter:!0})}return b}function e(a){return{content:a.content||""}}var f=a("nc"),g=a("cpn"),h=f.Component,i=f.Clazz,j=g.Popup,k=c.exports=i.create();i.mix(k,h,{_image:{},_template:['<div class="pop-content">','<div class="pop-interview">','<div class="ico-success"><i class="fui-check-inverted"></i></div>',"<p><span>#{content}</span></p>","</div>",'<div class="pop-btn-wrapper">','<a href="javascript:void(0);" class="btn btn-primary js-notify">通知考生</a>','<a href="javascript:void(0);" class="btn btn-primary js-to-list">返回列表</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.rawConfig,a.getEl()}}},{name:"click .js-notify",handler:function(){var a=this;a.fire("notify")}},{name:"click .js-to-list",handler:function(){var a=this;a.fire("back")}}],show:d},{_getData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/addUser/util/tabCpn",["nc","cpn"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.rawConfig,d="";k.forEach(c.options,function(a){d+=j.execTpl(['<label class="radio">','<span class="icons"></span>','<input type="radio" #{isChecked} value="#{value}" />#{text}',"</label>"].join(""),{text:a.text,value:a.value,isChecked:a.checked})}),b.html(d),a.checkgroup=l.mix({el:b.find("label.radio"),change:function(){c.change&&c.change(a.val())}})}function e(){var a=this;return a.checkgroup.val.apply(a.checkgroup,arguments)}var f=a("nc"),g=a("cpn"),h=(f.$,f.Component),i=f.Clazz,j=f.Str,k=f.Base,l=g.CheckGroup,m=c.exports=i.create();i.mix(m,h,{_template:'<div class="import-add-ways"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpn()}}]},{initCpn:d,val:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/detail/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=a.getEl().html(""),d=r.isArray(b.id)?b.id:[b.id],e=b.papers,f=b.notes,g=a.paperMap={},h=a.isFinished(),i=r.toMap(d,function(a){return{key:a,value:!0}}),j=[];r.forEach(e,function(a){var b=r.id(a.id);!!a.end===h&&j.push({value:b,text:a.paperName,checked:!!i[b]}),g[r.id(a.id)]=a});var k={id:"paper",title:"笔试试卷",type:"selectMult",conf:{needSearch:!0,options:j}},l={id:"mail",title:"邮件通知",type:"select",conf:{options:[{value:"-2",text:"不限",checked:!0},{value:"1",text:"接收中"},{value:"3",text:"接收成功"},{value:"4",text:"接收失败"},{value:"0",text:"未发送"}]}},m={id:"sms",title:"短信通知",type:"select",conf:{options:[{value:"-2",text:"不限",checked:!0},{value:"1",text:"接收中"},{value:"3",text:"接收成功"},{value:"4",text:"接收失败"},{value:"0",text:"未发送"}]}},n={id:"status",title:"确认状态",type:"select",conf:{options:[{value:"-2",text:"不限",checked:!0},{value:"0",text:"待确认"},{value:"1",text:"已确认"},{value:"3",text:"已拒绝"}]}},o={id:"local",title:"手机归属地",type:"select",conf:{options:[{value:"-2",text:"不限",checked:!0},{value:"0",text:"国内"},{value:"1",text:"国外"}]}},p={id:"date",title:"上传日期",type:"duration",ext:{today:!0}},q=[{text:"不限",checked:!0}];r.forEach(f,function(a){q.push({value:a,text:a})});var s={id:"note",title:"备注",type:"select",conf:{options:q}};if(!a.isNotStarted())var u={id:"testStatus",title:"状态",type:"select",conf:{options:[{text:"不限",value:0,checked:!0},{text:"未到场",value:1},{text:"已打开",value:2},{text:"已提交",value:3}]}};var v={id:"search",title:"关键词",type:"search",conf:{placeholder:"输入关键词搜索，多个关键词用空格分割"},ext:{chkTitle:"包含任意关键词",chkTips:"默认是搜索包含了所有关键字的考生，多个关键词用空格分割"}};a.filter=new t({renderTo:c,submitTxt:"查询",line:[{border:!0,items:[k]},{border:!0,fold:!0,items:[l,m,n,o]},{border:!0,fold:!0,items:a.isNotStarted()?[s,p]:[s,u,p]},{fold:!0,items:[v]}],clearAll:function(){a.val({})},listeners:{submit:r.bind(a.submit,a)}})}function e(){var a=this,b=a.val(),c=b.paperId;return 0===c.length?s.alert("请选择试卷"):(b.paperId=1===c.length?c[0]:c,void a.fire("submit",b))}function f(a){var b=this,c=b.filter,d=c.getItem("paper"),e=c.getItem("mail"),f=c.getItem("sms"),g=c.getItem("status"),h=c.getItem("local"),i=c.getItem("date"),j=c.getItem("note"),k=c.getItem("search");if(!b.isNotStarted())var l=c.getItem("testStatus");if(0===arguments.length){var m=o.trim(i.startIpt.val()),n=o.trim(i.endIpt.val()),p=e.val(),q=f.val(),s=g.val(),t=h.val(),u=d.val().sort(function(a,b){return a-b});return u=r.filter(u,function(a){return!!a}),{paperId:u,emailStatus:"-2"===p?void 0:p,smsStatus:"-2"===q?void 0:q,signStatus:"-2"===s?void 0:s,phoneNumberType:"-2"===t?void 0:t,beginTime:m||void 0,endTime:n||void 0,note:o.trim(j.val())||void 0,keywords:b.wrapVal(k.ipt.val().split(/\s+/)),keywordUnion:k.chk.isChecked()?1:0,testStatus:b.isNotStarted()?void 0:l.val()}}var u=r.map(r.isArray(a.paperId)?a.paperId:[a.paperId],function(a){return r.id(a)});d.val(u),e.val(r.id(a.emailStatus)||"-2"),f.val(r.id(a.smsStatus)||"-2"),g.val(r.id(a.signStatus)||"-2"),h.val(r.id(a.phoneNumberType)||"-2"),i.startIpt.val(a.beginTime||""),i.endIpt.val(a.endTime||""),j.val(a.note),k.chk.checked("1"===r.id(a.keywordUnion)),k.ipt.val((a.keywords||"").split("_").join(" ")),b.isNotStarted()||l.val(a.testStatus)}function g(){var a=this,b=a.findPaper();return b&&1===b.status}function h(){var a=this,b=a.findPaper();return b&&0===b.status}function i(){var a=this,b=a.findPaper();return b&&-1===b.status}function j(){var a=this,b=a.rawConfig,c=r.id((r.isArray(b.id)?b.id:[b.id])[0]),d=r.find(b.papers,function(a){return r.id(a.id)===c});return d}function k(a,b){return r.isArray(a)?(a=r.without(a,""),a.length>0?a.join("_"):b):r.isString(a)?o.trim(a)||b:a}function l(){var a=this,b=a.val(),c=b.paperId,d=a.paperMap,e=!0;return r.forEach(c,function(a){var b=d[a];e=e&&-1===b.status}),e}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Clazz,q=m.Component,r=m.Base,s=(m.Str,n.Popup),t=a("../../../../../component/filter/filter"),u=c.exports=p.create();p.mix(u,q,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initFilter(),a.val(b.param)}}]},{initFilter:d,submit:e,val:f,isFinished:g,isWorking:h,isNotStarted:i,findPaper:j,wrapVal:k,noOneStarted:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/detail/index",["nc","cpn","./filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/paper","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/notice","../../../../../component/table","../../../../../component/selectAll"],function(a,b,c){function d(){var a=this,b=a.getEl();a.filterModule=new F({renderTo:b.find("div.js-header"),id:a.getPaperId(),param:a.getParam(),papers:a.allPapers,notes:a.notes,listeners:{submit:function(b){b.page=null;var c=a.getPaperId(!0).join("|");a.addParam(b),a.tableCpn.selectAll.clear();var d=a.getPaperId(!0).join("|")===c;a[d?"renderList":"refresh"]()}}})}function e(){var a=this,b=!!a.paper.finished;a.infoEl.html(['<div class="import-tool clearfix">','<div class="import-census">','<div class="census-num">共有考生<span class="font-green js-user-count">0</span>人</div>','<div class="form-group js-page-count"><label class="control-label">每页显示</label><div class="control-group"></div></div>',"</div>",'<div class="import-tool-bar">','<a class="link-green js-batch-note" href="javascript:void(0);"><i class="icon-bookmark"></i>修改备注</a>',b?"":'<a class="link-green js-batch-notice" href="javascript:void(0);"><i class="icon-envelope-alt"></i>群发通知</a>',b?"":'<a class="link-green js-batch-edit" href="javascript:void(0);"><i class="icon-edit"></i>批量修改</a>','<a class="link-green js-batch-del" href="javascript:void(0);" style="display:none;"><i class="icon-trash"></i>批量删除</a>',b?"":'<a class="link-green js-batch-add" href="javascript:void(0);"><i class="icon-user"></i>添加名单</a>','<a class="link-green js-batch-export" href="javascript:void(0);"><i class="icon-cloud-upload"></i>导出数据</a>',"</div>","</div>"].join("")),a.pageSelect=new D({renderTo:a.infoEl.find("div.js-page-count div.control-group"),autoWidth:!0,size:"xsmall",options:[{text:20,value:20},{text:50,value:50},{text:100,value:100}],change:function(){a.addParam({pageSize:this.val(),page:null}),a.renderList()}}),a.pageSelect.val(a.getParam().pageSize||20)}function f(){{var a=this;a.getEl()}a.tableCpn=new K({renderTo:a.listEl,needSelect:!0,needFixHeader:!0,pageChange:function(b){a.addParam({page:b}),a.renderList()}})}function g(a){var b=this;return b.isMultPaper()?(b.paper={paperName:"多张试卷"},b.crumbTitle="笔试通知(多张试卷)",b.refreshCrumb(),a&&a()):void L.getPaper({params:{paperId:b.getPaperId()},query:{},statusCall:{1303:function(a){return b.renderNone(b.getEl(),a.msg),!1}},call:function(c){b.paper=c.data,b.crumbTitle="笔试通知("+b.paper.paperName+")",b.refreshCrumb(),a&&a()},error:function(a){b.renderNone(b.getEl(),a.msg)}})}function h(a){var b=this,c=b.getPaperId(!0);L.getTestUserNotes({type:"GET",params:{paperId:c[0]},query:{paperIds:c},call:function(b){a&&a(b.data)},error:function(a){b.renderNone(b.getEl(),a.msg)}})}function i(a){var b=this,c=b.getEl();return b.isMultPaper()?(b.signUpFields=[{title:"姓名",name:"name"},{title:"考号",name:"key"},{title:"邮箱",name:"email"},{title:"手机号码",name:"phone"}],a&&a()):void H.getSignUpFields(b.getPaperId(),function(d,e){return 0===d.length?b.renderNone(c,(e||{}).msg||"出现错误，请重试"):(b.signUpFields=d,void(a&&a()))})}function j(a){var b=this,c=b.getPaperId(!0),d=b.tableCpn;L.getTestUsers({type:"POST",params:{paperId:c[0]},body:B.extend({},b.getCond(),{paperIds:c}),call:function(c){if(c.isOrder){var e=c.data,f=e.totalCount||0;if(b.infoEl.show().find("span.js-user-count").html(f),0===f)return d.renderNone();a&&a(e)}},error:function(a){d.renderNone(a.msg)}})}function k(){function a(a){var c={head:[B.map(e,function(a){return{text:a.title}}),{text:"试卷"},{text:"邮件通知"},{text:"短信通知"},{text:"考生确认"},{text:"考试链接",width:"6%"},{text:"上传日期",width:"13%"},{text:"上传账号"},{text:"备注"},{text:d.paper.finished?"状态":"操作",width:"8%"}],list:[]},g={0:"待确认",1:"同意",3:"拒绝"};B.forEach(a.datas,function(a){var f=g[a.signStatus],h=z.trim(a.noSignReason),i=B.json(a.ext,{}),j=B.map([a.emailSentStatus,a.smsSentStatus],function(a){var b=J.getName(a);return(2===a||4===a||a>=100)&&(b='<a href="javascript:void(0);" class="js-tips js-solution" data-code="'+a+'" title="点击查看失败原因" style="color: red;">接收失败</a>'),b}),k=[B.map(e,function(b){var c="key"===b.name?"userKey":b.name,d="userKey"===c||"name"===c,e=z.trim((d?a:i)[c])||P;return e}),d.getPaperName(a.paperId),j[0],j[1],f?f+(h?"("+h+")":""):P,a.testUrl?'<a href="'+a.testUrl+'" target="_blank">点击打开</a>':P,a.createTime?C.form(new Date(a.createTime)):"",a.creatorHrName||"",a.note,{text:b(a.testStatus),cls:"table-btn"}];c.list.push({items:k,attr:{"data-id":a.id,"data-paperId":a.paperId}})}),f.updateHtml(c,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage})}function b(a){return d.paper.finished?1===a?"未到场":2===a?"已打开":"已提交":1!==a?['<a href="javascript:void(0);" class="icon-edit js-tips disabled" title="该考生已考试，无法进行此操作"></a>','<a href="javascript:void(0);" class="icon-bell-alt js-tips disabled" title="该考生已考试，无法进行此操作"></a>','<a href="javascript:void(0);" class="icon-trash js-tips disabled" title="该考生已考试，无法进行此操作"></a>'].join(""):['<a href="javascript:void(0);" class="icon-edit js-tips js-edit" title="修改"></a>','<a href="javascript:void(0);" class="icon-bell-alt js-tips js-notice" title="通知"></a>','<a href="javascript:void(0);" class="icon-trash js-tips js-del" title="删除"></a>'].join("")}function c(){var a=d.filterModule.noOneStarted();d.getEl(".js-batch-del")[a?"show":"hide"]()}var d=this,e=(d.getEl(),d.signUpFields),f=(d.listEl,d.paper,d.tableCpn);d.infoEl.hide(),f.renderWait(),d.fetchUsers(function(b){d.pageData=b,a(b),c(b)})}function l(){var a=this,b=a.getPaperId(!0);return b.length>1}function m(a){var b=this,c=b.getParam().paperId;return c=B.isArray(c)?c:[c],c=B.filter(c,function(a){return!!a}),!a&&c.length<=1?c[0]:c}function n(a){var b=this;return b._paperMap||(b._paperMap=B.toMap(b.allPapers,function(a){return{key:a.id,value:a}})),(b._paperMap[a]||{}).paperName}function o(a){var b=z(a).closest("tr");return z.trim(b.attr("data-id"))}function p(a){var b=z(a).closest("tr");return z.trim(b.attr("data-paperId"))}function q(a){var b=this;return a=B.id(a),B.find(b.pageData.datas,function(b){return B.id(b.id)===a})}function r(a){var b=this,c=b.getParam(),d=b.tableCpn.selectAll,e=b.filterModule.val();return a&&!d.isSelectAll?{isAll:2,ids:d.selectIds}:(e.beginTime&&(e.beginTime+=" 00:00:00"),e.endTime&&(e.endTime+=" 23:59:59"),e.page=c.page,e.pageSize=b.pageSelect.val()||20,B.forEach(e,function(a,b){null===a&&void 0===a&&delete e[b]}),a&&(delete e.page,delete e.pageSize,e.isAll=1,e.ids=d.selectIds),e)}function s(){var a=this,b=a.getWin(),c=a.paper,d=a.getCond(!0),e=a.getPaperId(!0);L.addDLTestUserForViewJob({params:{paperId:e[0]},body:B.extend({},d,{paperIds:e}),call:function(a){var d,e=a.data;b.addTask({title:"[导出考生名单]"+z.trim(c.paperName),waitTxt:"生成中...",okTxt:"已生成",getStatus:function(a,b){M.getTaskProgress(!1,e,function(c){var e=c.end,f=c.content,g=c.error,h=c.progress,i=e?g?1:0:2;b.okTxt=1===i?"失败":0===i?"点击下载":b.okTxt,d=0===i?f:d,a&&a(i,h)})},getResult:function(){return{type:1,data:d}}})},error:function(a){E.alert(a.msg)}})}function t(){function a(){N.ipt("修改考生备注信息","备注","输入考生的备注",function(a){L.updateNotes({type:"PUT",params:{paperId:d[0]},body:B.extend({newNote:a},b.getCond(!0),{paperIds:d}),call:function(){E.tips("操作成功",function(){b.refresh()})},error:function(a){E.alert(a.msg)}})})}var b=this,c=b.getWin(),d=b.getPaperId(!0),e=c.showLoading();L.getDistinctNotes({params:{paperId:d[0]},query:B.extend({},b.getCond(!0),{paperIds:d}),call:function(b){e.close();var c=b.data,d=c.distinctNotes[0],f=(c.distinctNotes||[]).length<=1;if(f&&!d)return a();var g=f?"选择的 "+c.count+" 名考生备注信息为："+d:"选择的 "+c.count+" 名考生备注信息不一致";new E({title:"确认考生信息",content:'<div class="confirm-content"><div class="warning-word">'+g+"</div></div>",ok:a,cancel:function(){}})},error:function(a){e.close(),E.alert(a.msg)}})}function u(){var a=this,b=a.tableCpn.selectAll;return b.isSelectAll?b.totalCount-b.selectIds.length:b.selectIds.length>0?b.selectIds.length:void 0}function v(){var a=this,b=a.tableCpn.selectAll;return b.isSelectAll||b.selectIds.length>0}function w(){var a=this;return{crumb:[a.paper?{title:"邀请考生",module:"paper",action:"notice/index"}:""]}}var x=a("nc"),y=a("cpn"),z=x.$,A=x.Clazz,B=(x.Str,x.Base),C=(x.Limit,x.Uri,x.Component,x.Time),D=(y.Input,y.AttachDate,y.Select),E=(y.Tips,y.Pager,y.Popup),F=a("./filter"),G=a("../../../../../core/module"),H=a("../../../extend/bll/paper"),I=a("../../../extend/bll/money"),J=a("../../../extend/bll/notice"),K=a("../../../../../component/table"),L=a("../../../../../action/paper"),M=a("../../../extend/bll/task"),N=a("../../../../../component/popupSub/popupCommon"),O=c.exports=A.create(),P="---";A.mix(O,G,{style:"/stylesheets/styles/system/importList.css",title:"笔试通知",showTask:!0,_template:['<div class="module-box" style="padding:0 0 50px;">','<div class="js-header"></div>','<div class="js-info" style="padding:0 20px;"></div>','<div class="js-body"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getPaperId();return a.infoEl=b.find(".js-info"),a.listEl=b.find(".js-body"),c?(a.renderWait(a.listEl),void a.fetchPaper(function(){a.fetchNotes(function(c){a.fetchSignUpFields(function(){H.checkProject({all:!0,simple:!0,call:function(d,e){d=H.getAllId(e),H.getAllPaper({id:d,call:function(d){return 0===d.length?a.renderNone(b,"没有试卷"):(a.listEl.html(""),a.notes=c,a.allPapers=d,a.initFilter(),a.isMultPaper()&&(a.paper.finished=a.filterModule.isFinished()),a.initInfo(),a.initTable(),void a.renderList())}})}})})})})):a.renderNone(b,"错误的参数")}},{name:"click .js-batch-add",handler:function(){var a=this;if(a.isMultPaper()){var b=a.getWin().showLoading(),c=a.getPaperId();H.isSameField({paperId:c,call:function(c){return b.close(),c?void a.nav("paper",{action:"notice/addUser/index",paperId:a.getPaperId()}):E.alert("对不起，您选中的试卷考生信息设置不一致，无法进行批量添加名单操作，请只筛选考生信息一致的试卷添加名单。")},error:function(a){b.close(),E.alert(a.msg)}})}else H.navAddUser(a.paper)}},{name:"click .js-batch-note",handler:function(){var a=this;return a.isSelected()?void a.editNote():E.alert("请先选择想批量修改备注的名单")}},{name:"click .js-batch-notice",handler:function(){var a=this;return a.isSelected()?void H.navNotice(a.getPaperId(),a.getCond(!0)):E.alert("请先选择想批量通知的名单")}},{name:"click .js-batch-edit",handler:function(){var a=this;if(!a.isSelected())return E.alert("请先选择想批量修改的名单");var b=a.getCond(!0);if(!a.isMultPaper())return a.nav("paper",{action:"notice/editUser/batch",paperId:a.getPaperId(),cond:b});var c=a.getWin().showLoading(),d=a.getPaperId(!0);L.checkUserSameSignUpField({params:{paperId:d[0]},body:B.extend({},b,{paperIds:d}),call:function(d){c.close();var e=!!d.data;e&&a.nav("paper",{action:"notice/editUser/batch",paperId:a.getPaperId(),cond:b}),!e&&E.alert("对不起，您选中的试卷考生信息设置不一致，无法进行批量修改名单操作，请只筛选考生信息一致的试卷修改名单。")},error:function(a){c.close(),E.alert(a.msg)}})}},{name:"click .js-batch-export",handler:function(){var a=this;return a.isSelected()?void a.addExportTask():E.alert("请先选择想批量导出的名单")}},{name:"click .js-edit",handler:function(a){var b=this,c=z(a.currentTarget),d=b.getLineId(c),e=b.getLinePaperId(c);b.nav("paper",{action:"notice/editUser/index",paperId:e,id:d})}},{name:"click .js-del",handler:function(a){var b=this,c=z(a.currentTarget),d=b.getLineId(c),e=b.getLinePaperId(c),f=b.getUserByLineId(d);return f&&f.started?E.alert("该考生已经开始考试，信息无法删除"):void(f&&H.delPaperUser({cond:{isAll:2,ids:d},paperId:e,paperName:b.getPaperName(e),selectCount:1,needCancelNotice:!0,needApiAlert:!0,apiRole:f.apiRole,call:function(){I.refreshMoney(),b.tableCpn.selectAll.clear(),b.renderList()}}))}},{name:"click .js-notice",handler:function(a){var b=this,c=z(a.currentTarget),d=b.getLineId(c),e=b.getUserByLineId(d);e&&H.navNotice(b.getPaperId(),{isAll:2,ids:[d]})}},{name:"click .js-solution",handler:function(a){var b=z(a.currentTarget),c=b.attr("data-code");c&&J.showReason(c)}},{name:"click .js-batch-del",handler:function(){var a=this;if(!a.isSelected())return E.alert("请先选择要批量删除的名单");var b=a.getPaperId(!0),c=b.length>5,d=a.getSelectLength(),e=[B.map(c?b.slice(0,5):b,function(b){return a.getPaperName(b)}).join("、"),c?"等"+b.length+"套试卷":""].join("");H.delPaperUser({cond:a.getCond(!0),paperId:b,paperName:b.length>1?"多张试卷":a.getPaperName(b[0]),alertPaperName:e,selectCount:d,needCancelNotice:!0,needApiAlert:!0,call:function(){a.tableCpn.selectAll.clear(),a.renderList()}})}}]},{initFilter:d,initInfo:e,initTable:f,fetchPaper:g,fetchNotes:h,fetchSignUpFields:i,fetchUsers:j,renderList:k,isMultPaper:l,getPaperId:m,getPaperName:n,getLineId:o,getLinePaperId:p,getUserByLineId:q,getCond:r,addExportTask:s,editNote:t,getSelectLength:u,isSelected:v,getCrumbConf:w})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/editUser/batch",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/paper"],function(a,b,c){function d(a){var b=this,c=b.getPaperId(!0);return c.length>1?(b.paper={paperName:"多张试卷"},b.refreshCrumb(),a&&a()):void u.getPaper({params:{paperId:c[0]},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){s.renderWait(b.bodyEl,a.msg)}})}function e(){{var a=this,b=a.bodyEl;a.getParam()}b.html(['<div style="text-align:center;">','<div class="import-tips-form">','<a href="javascript:void(0);" class="js-download tips-download link-green" style="margin-left:0;">','<i class="icon-download-alt"></i>下载考生信息',"</a>","</div>",'<div class="import-tips-btn">','<div style="display:inline-block;position:relative;">','<a href="javascript:void(0);" class="btn btn-primary btn-lg js-upload-excel">上传Excel文件</a>',"</div>","</div>","</div>"].join("")),a.initUpload()}function f(){var a=this,b=a.getEl(),c=p.show({target:b.find(".js-upload-excel"),url:s.getUploadUrl(r.uploadType.file),fileType:"*.xlsx;",call:function(b){var c=l.trim(b.data);a.uploadExcel(c)}});a.pushChild(c)}function g(a){var b=this,c=(b.getParam(),b.getWin());u.uploadUser({body:{fileUrl:a,type:"update"},call:function(a){var d=(a.data,c.showLoading("导入中..."));t.getTaskProgress(!0,a.data,function(a){var c=a.end,e=a.content,f=a.error;f?(d.close(),o.alert(e)):c&&(d.close(),o.tips(e,function(){b.nav("paper",{action:"notice/detail/index",paperId:b.getPaperId()})}))})},error:function(a){o.alert(a.msg)}})}function h(a){var b=this,c=b.getParam().paperId;return c=n.isArray(c)?c:[c],c=n.filter(c,function(a){return!!a}),!a&&c.length<=1?c[0]:c}function i(){var a=this,b=(a.getParam(),a.paper);return{crumb:[{title:"邀请考生",module:"paper",action:"notice/index"},{title:"笔试通知"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"notice/detail/index",paperId:a.getPaperId()}}]}}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=j.Base,o=(j.Limit,j.Uri,k.Input,k.Popup),p=k.AttachUpload,q=a("../../../../../core/module"),r=a("../../../../../core/siteConfig"),s=a("../../../../../util/util"),t=a("../../../extend/bll/task"),u=a("../../../../../action/paper"),v=c.exports=m.create();m.mix(v,q,{style:"/stylesheets/styles/system/importList.css",title:"批量修改考生信息",_template:['<div class="module-body">','<div class="import-tips">','<dl class="import-tips-words" style="line-height:26px;">',"<dt>重要提醒</dt>","<dd>1.修改考生信息时，内容、格式和顺序请严格遵循模板规范，少填或乱序均会造成解析失败；</dd>","<dd>2.如同时修改多张试卷名单，需确保本批试卷考生信息设置完全一致，否则无法同时添加。填写时注意正确填写考试试卷的名字。</dd>","</dl>",'<div class="js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=(a.getParam(),a.getPaperId());return a.bodyEl=b.find("div.js-body"),c?(s.renderWait(a.bodyEl,"加载中..."),void a.getPaper(function(){a.initCpn()})):s.renderWait(b,"错误的参数")}},{name:"click .js-download",handler:function(){var a=this,b=a.getWin(),c=a.paper,d=a.getParam().cond,e=a.getPaperId(!0);u.addDLTestUserJob({params:{paperId:e[0]},body:n.extend({},d,{paperIds:e}),call:function(a){var d,e=a.data;b.addTask({title:"[下载考生信息]"+l.trim(c.paperName),waitTxt:"生成中...",okTxt:"已生成",getStatus:function(a,b){t.getTaskProgress(!1,e,function(c){var e=c.end,f=c.content,g=c.error,h=c.progress,i=e?g?1:0:2;1===i?b.okTxt="失败":0===i&&(b.okTxt="点击下载",d=f),a&&a(i,h)})},getResult:function(){return{type:1,data:d}}})},error:function(a){o.alert(a.msg)}})}}]},{getPaper:d,initCpn:e,initUpload:f,uploadExcel:g,getPaperId:h,getCrumbConf:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/editUser/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","../../../../../action/user","../../../../../component/department","../../../../../util/switch"],function(a,b,c){function d(a){var b=this,c=b.getParam();x.getPaper({params:{paperId:c.paperId},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){b.renderWait(b.bodyEl,a.msg)}})}function e(a){var b=this,c=b.getParam();x.getUser({params:{paperId:c.paperId,id:c.id},query:{},call:function(c){b.editUser=c.data,a&&a()},error:function(a){b.renderWait(b.bodyEl,a.msg)}})}function f(){var a=this,b=a.editUser,c=a.bodyEl,d=a.cpn=a.cpn||{};a.fieldMap={},p.forEach(a.signUpFields,function(b){a.fieldMap[b.name]=b}),c.html(['<div class="add-mod">','<div class="add-mod-head">','<h2><span class="js-name">考生</span></h2>',"</div>",'<div class="add-mod-body js-field-list"></div>',"</div>",'<div class="js-department"></div>','<div style="margin-top:30px;text-align:center;">','<a class="btn btn-primary js-submit" href="javascript:void" style="width:180px;">提交</a>',"</div>"].join(""));var e=c.find(".js-field-list");p.forEach(a.signUpFields,function(a){var c=m(['<div class="add-item">','<div class="form-group">','<label class="control-label">'+a.title+"</label>",'<div class="control-group js-ipt"></div>',"</div>","</div>"].join(""));e.append(c);var f=c.find(".js-ipt"),g=0===a.valueType||0===(a.valueList||[]).length,h=g?t:1===a.valueType?u:v,i=new h({renderTo:f,noSelectAll:!0,options:g?void 0:p.map(a.valueList,function(a){return{value:a,text:a}})});a.need&&i.getEl().append(m('<span class="choose-tips" style="position:absolute;width:40px;top:7px;">必填项</span>')),d[a.name]=i;var j="key"===a.name?"userKey":a.name,k="userKey"===j||"name"===j,l=m.trim(k?b[j]:p.json(b.ext,{})[j])||"";i.val(h===v?l.split("_"):l)}),a.department=new A({renderTo:a.getEl(".js-department"),renderBy:"replaceWith",departmentData:a.departmentData,marginLeft:"-45px",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理这些考生，包括查看成绩、分配判卷以及判卷操作"}),a.department.getEl().width(450).css("margin","auto"),a.department.getEl(".control-label").width(135),a.department.val(p.id((a.editUser.ctsDepartment||{}).id))}function g(){var a=this,b={};return p.forEach(a.cpn,function(a,c){var d=a.val();b[c]=m.trim(p.isArray(d)?d.join("_"):d)}),b.departmentId=a.department.val(),b}function h(){var a=this,b=!0;return p.forEach(a.cpn,function(c,d){var e=a.fieldMap[d],f=e.title,g=m.trim(c.val());if(g||e.need){var h="";!g&&e.need?h=e.title+"不能为空":(f.indexOf("邮箱")>=0&&!o.isEmail(g)||f.indexOf("手机")>=0&&!o.isTel(g)||f.indexOf("身份证")>=0&&!o.isPassport(g))&&(h="请填写正确的"+f),h&&(c.setErrorTips&&c.setErrorTips(h),!c.setErrorTips&&c.error&&c.error(),b=!1)}}),b}function i(a,b){var c=this;y.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:c.getParam().paperId,entityType:6},call:function(b){var d=b.data||[];c.departmentData=d,p.isFunction(a)&&a(d)},error:function(a){p.isFunction(b)&&b(a.msg)}})}function j(){var a=this,b=a.getParam(),c=a.paper;return{crumb:[{title:"邀请考生",module:"paper",action:"notice/index"},{title:"笔试通知"+(c?"("+c.paperName+")":""),module:"paper",param:{action:"notice/detail/index",paperId:b.paperId}}]}}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Clazz,o=k.Str,p=k.Base,q=k.Limit,r=a("../../../../../core/module"),s=a("../../../extend/bll/paper"),t=l.Input,u=l.Select,v=l.SelectMult,w=l.Popup,x=a("../../../../../action/paper"),y=a("../../../../../action/user"),z=a("../../../../../core/siteConfig"),A=a("../../../../../component/department"),B=c.exports=n.create();n.mix(B,r,{style:"/stylesheets/styles/system/importList.css",title:"修改考生信息",_template:['<div class="module-body">','<div class="import-add-people">','<div class="import-add-main js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam(),d=p.id(c.paperId),e=p.id(c.id);return a.bodyEl=b.find("div.js-body"),d&&e?(a.renderWait(a.bodyEl,"加载中..."),void a.getPaper(function(){s.getSignUpFields(d,function(c){a.getUser(function(){a.getDepartment(function(){return a.editUser.started?a.renderWait(a.bodyEl,"该考生已经开始考试，无法修改考生信息"):(a.bodyEl.html(""),a.signUpFields=c,void a.initCpn())},function(c){a.renderNone(b,c)})})})})):a.renderWait(b,"错误的参数")}},{name:"click .js-submit",handler:function(a){var b=this,c=m(a.currentTarget);if(b.check()&&!q.mark(c)){var d=b.getParam();x.updateUser({type:"PUT",params:{paperId:d.paperId,id:d.id},body:b.val(),call:function(){w.tips("操作成功",function(){b.nav("paper",{action:"notice/detail/index",paperId:d.paperId})})},error:function(a){var b=a.code;w.alert(b===z.errorCode.testUserExist?"考生已经存在":a.msg)},always:function(){q.clear(c)}})}}}]},{getPaper:d,getUser:e,initCpn:f,val:g,check:h,getDepartment:i,getCrumbConf:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../component/table","../../../../component/selectAll","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../action/paper","../cpn/navProject","../../../../component/navProject"],function(a,b,c){function d(a){var b=this;b.projectData=a,new x({renderTo:b.getEl(),current:b.getProjectId(),items:a,change:function(a){b._needUpdateCount=!1,b.addParam({projectId:a}),b.fetchList()}})}function e(){var a=this,b=a.getEl();b.append(['<div class="menu-txt-box">','<ul class="menu-txt clearfix">','<li class="js-status" data-status="-1"><a href="javascript:void(0);">未开始(<span>0</span>)</a></li>','<li class="menu-pipe">|</li>','<li class="js-status" data-status="0"><a href="javascript:void(0);">进行中(<span>0</span>)</a></li>','<li class="menu-pipe">|</li>','<li class="js-status" data-status="1"><a href="javascript:void(0);">已结束(<span>0</span>)</a></li>',"</ul>","</div>",'<div class="js-content" style="margin-bottom:50px;"></div>'].join("")),a.listEl=b.find(".js-content")}function f(){var a=this,b=a.getEl(),c=a.listEl,d=a.getParam(),e=p.id(d.status)||"-1",f=a.getProjectId();a.renderWait(c),b.find(".js-status").removeClass("selected"),b.find(".js-status[data-status="+e+"]").addClass("selected"),w.getByStatus({params:{userId:a.getUserId()},query:{page:d.page||1,status:e,projectIdList:f?f:v.getAllId(a.projectData)},call:function(b){b.isOrder&&(a.renderList(b.data,e),a.updateCount())},error:function(b){a.renderNone(a.listEl,b.msg)}})}function g(a,b){var c=this,d=c._paperCache=c._paperCache||{};return d[a]?b(d[a]):void w.getPaper({type:"GET",params:{paperId:a},call:function(c){d[a]=c.data,b(c.data)},error:function(a){s.alert(a.msg)}})}function h(a,b){var c=this,d=c.getEl(),e=(c.getParam(),a.datas||[]);if(d.find(".js-status[data-status="+b+"] span").text(a.totalCount||0),0===e.length)return c.renderNone(c.listEl);var f=c.getListHtml(e);c.listEl.html(f),new r({renderTo:c.listEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){c.addParam({page:a}),c.fetchList()}})}function i(){var a=this,b=a.getEl(),c=["-1","0","1"],d=a.getParam(),e=a.getProjectId(),f=p.id(d.status)||"-1";a._needUpdateCount||(a._needUpdateCount=!0,p.forEach(c,function(c){c!==f&&w.getByStatus({params:{userId:a.getUserId()},query:{page:1,status:c,projectIdList:e?e:v.getAllId(a.projectData)},call:function(a){var d=a.data,e=d.totalCount||0;b.find(".js-status[data-status="+c+"] span").text(e)}})}))}function j(a){var b=this,c=b.getParam(),d=q.execTpl(['<a href="javascript:void(0);" class="icon-user js-tips js-nav-jump" data-type="detail" title="查看考生"></a>','<a v-if="ing" href="javascript:void(0);" data-type="addUser" class="icon-plus js-nav-jump js-tips" title="添加考生"></a>','<a v-if="ing" href="javascript:void(0);" data-type="editUser" class="icon-edit js-nav-jump js-tips" title="修改"></a>','<a v-if="ing" href="javascript:void(0);" data-type="send" class="icon-bell-alt js-nav-jump js-tips" title="发送通知"></a>'],{ing:"1"!==p.id(c.status)}),e={head:[{text:"试卷名称",width:"50%"},"邀请人数","确认人数","邮件发送","邮件发送成功","邮件发送失败","短信发送","短信发送成功","短信发送失败",{text:"名单操作",width:"22%"}],list:[]};return p.forEach(a,function(a){var b=[{text:'<a href="javascript:void(0);" class="js-nav-jump" data-type="detail">#{paperName}</a>',data:{paperName:a.paperName},cls:"t-subject-title"},a.totalCount,a.confirmCount,a.emailSentCount,a.emailSuccessCount>0?'<a class="js-notice-success-count" href="javascript:void(0);" data-status-name="emailStatus">'+a.emailSuccessCount+"</a>":0,a.emailFailCount>0?'<a class="js-notice-fail-count" href="javascript:void(0);" data-status-name="emailStatus" >'+a.emailFailCount+"</a>":0,a.smsSentCount,a.smsSuccessCount>0?'<a class="js-notice-success-count" href="javascript:void(0);" data-status-name="smsStatus">'+a.smsSuccessCount+"</a>":0,a.smsFailCount>0?'<a class="js-notice-fail-count" href="javascript:void(0);" data-status-name="smsStatus">'+a.smsFailCount+"</a>":0,{text:d,cls:"table-btn"}];e.list.push({items:b,attr:{"data-id":a.paperId}})}),u.getHtml(e)}function k(){var a=this,b=a.getParam(),c=p.id(b.projectId);return"0"===c?void 0:c}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=(l.Str,l.Base),q=l.Node,r=(m.Tips,m.Pager),s=m.Popup,t=a("../../../../core/module"),u=a("../../../../component/table"),v=a("../../extend/bll/paper"),w=a("../../../../action/paper"),x=a("../cpn/navProject"),y=c.exports=o.create();o.mix(y,t,{style:"/stylesheets/styles/system/importList.css",title:"邀请考生",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.renderWait(b),v.checkProject({all:!0,simple:!0,call:function(c,d){b.html(""),a.initNav(d),a.initContainer(),a.fetchList()}})}},{name:"click .js-status",handler:function(a){var b=this,c=n(a.currentTarget),d=n.trim(c.attr("data-status"));d&&(b.addParam({status:d,page:null}),b.fetchList())}},{name:"click .js-nav-jump",handler:function(a){var b=this,c=n(a.currentTarget),d=c.closest("tr"),e=n.trim(c.attr("data-type")),f=n.trim(d.attr("data-id"));if(f&&e){if("send"===e)return v.navNotice(f,{isAll:1});var g={detail:["paper",{action:"notice/detail/index",paperId:f}],addUser:["paper",{action:"notice/addUser/index",paperId:f}],editUser:["paper",{action:"notice/editUser/batch",paperId:f,cond:{isAll:1}}]}[e];"addUser"===e?b.fetchPaperById(f,function(a){v.navAddUser(a)}):g&&g.length>0&&b.nav.apply(b,g)}}},{name:"click .js-notice-fail-count",handler:function(a){var b=this,c=n(a.currentTarget),d=c.closest("tr"),e=n.trim(c.attr("data-status-name")),f=n.trim(d.attr("data-id")),g={action:"notice/detail/index",paperId:f};g[e]=4,f&&b.nav("paper",g)}},{name:"click .js-notice-success-count",handler:function(a){var b=this,c=n(a.currentTarget),d=c.closest("tr"),e=n.trim(c.attr("data-status-name")),f=n.trim(d.attr("data-id")),g={action:"notice/detail/index",paperId:f};g[e]=3,f&&b.nav("paper",g)}}]},{initNav:d,initContainer:e,fetchList:f,fetchPaperById:g,renderList:h,updateCount:i,getListHtml:j,getProjectId:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/menuNotice","../../../../../component/popupSub/popupTestSender","../../../../../action/user","../../../../../util/ajax","../../../../../action/paper","../../../../../action/interview","../../../../../action/common","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../extend/bll/paper","../../../extend/bll/serverTime","./msg","./util/util","./mail","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(){function a(a,b){g.initModule(b)}function b(){g.goBack()}function c(){D.show({type:"1",isOverSea:g.isOversea,paperIds:g.getPaperId(!0),call:function(a){f(e({ids:a}),"sendTestNotices","笔试测试通知")}})}function d(){g.checkVal()&&g.confirm(function(){f(e(),"sendNotices","",function(){g.goContinue()})})}function e(a){var b=g.getParam().cond,c=g.val(),d=g._valNav();d[M]&&(c.sendSms=!0),d[N]&&(c.sendEmail=!0);var e=!!g.isOversea,f=!!h.mix;return z.extend(c,b,{paperIds:g.getPaperId(!0),phoneNumberType:e?"1":f?void 0:"0"},a),c}function f(a,b,c,d){var e=g.getWin(),f=e.showLoading("发送中..."),h=g.getPaperId(!0);E[b]({body:a,params:{paperId:h[0]},call:function(a){f.close(),g.addSendTask(a.data,c),d&&d()},error:function(a){f.close(),A.alert(a.msg)}})}{var g=this,h=g.getParam();g.navModule=new C({renderTo:g.getEl(),renderBy:"prepend",items:[{id:L,name:"通知类型",items:[{id:M,name:"短信通知",checked:!0,hide:h.onlyEmail},{id:N,name:"邮件通知",checked:!0}]}],listeners:{edit:a,back:b,save:d,test:c}})}}function e(a){var b=this,c=b.getEl(),d=b.moduleCache=b.moduleCache||{};if(a===N||a===M){if(!d[a]){var e=a===N,f=e?J:I;d[a]=new f({renderTo:c.find(".js-content"),isOversea:b.isOversea,defaultVal:b.getDefault(a),variable:b.variable,paperName:b.paper.paperName,beganCount:+(b.countData||{}).beganCount||0,availableCount:b[e?"emailCount":"smsCount"]})}z.forEach(d,function(a){a&&a.hide()}),d[a].show()}}function f(a){var b=this;return b.defaultVal[a]}function g(){var a=this,b=a.moduleCache,c=a._valNav(),d=a.defaultVal,e={};if(c[M]){var f=b[M];e.smsContent=f?f.val():d[M].val}if(c[N]){var f=b[N],g=f?f.val():a.defaultVal[N];f||(g.val=g.val.replace(/\[\$\#\#\$\](.*?)\[\$\#\#\$\]/gi,function(a,b){return"#"+b+"#"})),e.mailSubject=g.title,e.mailContent=g.val}return e}function h(){var a=this;a.nav("paper",{action:"notice/detail/index",paperId:a.getPaperId()})}function i(){var a=this,b=a.getParam();return a.isOversea||!b.order?a.goBack():void A.tips("国内短信和邮件发送成功，即将发送国际短信和邮件",function(){b=z.extend({},b,{order:void 0,mix:void 0,oversea:!0}),a.nav("paper",b)})}function j(a){var b=this,c=b._valNav(),d=["本次发送的通知数量为："];c[M]&&d.push((b.isOversea?"国际短信":"国内短信")+"："+b.smsCount),c[N]&&d.push("邮件："+b.emailCount),d.push("是否确认发送？");var e=z.map(d,function(a){return'<p style="margin-bottom:10px;">'+a+"</p>"}).join("");new A({title:"发送确认",content:'<div style="font-size:14px;">'+e+"</div>",ok:a,cancel:function(){}})}function k(){var a=this,b=a.val(),c=!0,d="";return 0===z.size(b)?(c=!1,d="发送选项不能为空"):"smsContent"in b&&!b.smsContent?(c=!1,d="短信内容不能为空"):"mailSubject"in b&&!b.mailSubject?(c=!1,d="邮件标题不能空"):"mailContent"in b&&!b.mailContent&&(c=!1,d="邮件内容不能空"),!c&&d&&A.alert(d),c}function l(a){var b=this,c=b.getParam().paperId;return c=z.isArray(c)?c:[c],c=z.filter(c,function(a){return!!a}),!a&&c.length<=1?c[0]:c}function m(a){var b=this,c=b.getPaperId(!0);return c.length>1?(b.paper={paperName:"多张试卷"},b.refreshCrumb(),a(b.paper)):void E.getPaper({params:{paperId:c[0]},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a(b.paper)},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function n(a){var b=this,c=b.getPaperId(!0);E.noticeVariable({params:{paperId:c[0]},query:{},call:function(c){b.variable=c.data,a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function o(a){{var b=this,c=b.getParam();c.cond}H.getUserCount({paperId:b.getPaperId(),cond:c.cond,call:function(d){var e=b.isOversea,f=!!c.mix;b.countData=d,b.smsCount=d[e?"overseaCount":"nativeCount"],b.emailCount=f?d.emailOverseaCount+d.emailNativeCount:d[e?"emailOverseaCount":"emailNativeCount"],a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function p(a){var b=this,c=b.getPaperId(!0),d="";return E.mailTemplate({params:{paperId:c[0]},query:{},call:function(c){d=c.data||[].join(""),b.defaultVal.email.val=d,a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}}),d}function q(a){var b=this;F.getDefaultTemplate({type:"GET",params:{},query:{type:b.isOversea?1006:1004},call:function(c){var d=b.isOversea?"find more details in your email, good luck.":"在线笔试，如未收到邮件，可关注微信服务号：校招小管家随时查询。";d=c.data?z.json(c.data.templateContent).value.sms:d,b.defaultVal.phone.val=d,a&&a()},error:function(a){b.renderWait(b.getEl(),a.msg)}})}function r(a){var b=this;F.getDefaultTemplate({type:"GET",params:{},query:{type:1005},call:function(c){var d="#公司名称#邀请你参加在线笔试",e="";if(c.data){var f=z.json(c.data.templateContent).value;d=f.emailSubject,e=f.emailContent}b.defaultVal.email.title=d,e?(b.defaultVal.email.val=e,a&&a()):b.getMailTemplate(a)},error:function(){b.renderWait(b.getEl(),"出现错误")}})}function s(a,b){{var c=this,d=c.getWin(),e=c.paper;c.getPaperId()}d.addTask({title:"["+(b||"笔试通知")+"]"+x.trim(e.paperName),waitTxt:"发送中",okTxt:"已发送",getStatus:function(b,c){G.getTaskProgress(!1,a,function(a){var d=a.end,e=a.content,f=a.error,g=a.progress,h=d?f?1:0:2;c.waitTxt=e,b&&b(h,g)})},getResult:function(){return{type:2}}})}function t(){var a=this,b=a.getParam(),c=a.paper;return{crumb:[{title:"邀请考生",module:"paper",action:"notice/index"},{title:"笔试通知"+(c?"("+c.paperName+")":""),module:"paper",param:{action:"notice/detail/index",paperId:b.paperId}}]}}function u(){var a=this,b=a.navModule.val();return b[L]||{}}var v=a("nc"),w=a("cpn"),x=v.$,y=v.Clazz,z=v.Base,A=w.Popup,B=a("../../../../../core/module"),C=a("../../../../../component/menuNotice"),D=a("../../../../../component/popupSub/popupTestSender"),E=a("../../../../../action/paper"),F=a("../../../../../action/common"),G=a("../../../extend/bll/task"),H=a("../../../extend/bll/paper"),I=a("./msg"),J=a("./mail"),K=c.exports=y.create(),L="type",M="phone",N="email";y.mix(K,B,{style:"/stylesheets/styles/system/notice.css",title:"笔试通知设置",showTask:!0,_template:'<div class="notice-mod clearfix"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getParam();return a.getPaperId()?(a.renderWait(b,"数据加载中..."),a.isOversea=c.oversea,a.defaultVal={phone:{},email:{}},void a.getPaper(function(){a.getCount(function(){a.getVariable(function(){a.getSmsTemplate(function(){a.getEmailTemplate(function(){b.html('<div class="notice-page js-content"></div>'),a.contentEl=b.find("div.js-content"),a.initNav()})})})})})):a.renderWait(b,"错误的参数")}}]},{initNav:d,initModule:e,getDefault:f,val:g,goBack:h,goContinue:i,confirm:j,checkVal:k,getPaperId:l,getPaper:m,getVariable:n,getCount:o,getMailTemplate:p,getSmsTemplate:q,getEmailTemplate:r,addSendTask:s,getCrumbConf:t,_valNav:u})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/mail",["nc","cpn","./util/util","../../../../../action/common","../../../../../util/ajax","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(a){var b=this;b.variable=a.variable}function e(){var a=this,b=(a.rawConfig,a.getEl());a.editor=new q({renderTo:b.find("div.js-editor"),noCodeSelect:!0,noToolbarFixed:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,link,|,table,subscript,superscript,removeformat".split(",")}})}function f(a){var b=this,c=b.getEl(),d=c.find("div.js-mail");d.html(l.trim(a))}function g(a){var b=this,c=b.getEl(),d=c.find("input.js-title");if(0===arguments.length){var e=l.trim(d.val()),f=l.trim(b.editor?b.editor.text():""),g="";return f&&(g=b.editor&&b.editor.val(),g=p.html2val(b.variable,g)),{title:e,val:g}}var g=p.tpl2html(b.variable,a.val);b.editor.val(g),d.val(l.trim(a.title)),window.setTimeout(function(){b.editor.autoHeight()},1e3)}function h(){var a=this,b=a.getEl(),c=b.find("input.js-title"),d=l.trim(c.val()),e=l.trim(a.editor?a.editor.text():""),f="";return e&&(f=a.editor&&a.editor.val(),f=p.html2tpl(a.variable,f)),{title:d,val:f}}function i(a){var b=this,c="发送内容：《"+a.paperName+"》笔试通知",d="发送对象："+a.availableCount+"名考生"+(a.beganCount>0?"("+a.beganCount+"名考生已考试，不发通知)":""),e=p.getNameList(b.variable);return{title:c,countInfo:d,tags:e}}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Component,n=j.Clazz,o=j.Base,p=a("./util/util"),q=(k.CheckBox,a("../../../../../component/editorSub/hEditor/index")),r=c.exports=n.create();n.mix(r,m,{_template:['<div class="info-edit-box">','<div class="user-status"><label>#{title}</label></div>','<div class="user-status"><label>#{countInfo}</label></div>','<div class="form-group">','<label class="control-label">邮件标题：</label>','<div class="control-group">','<input class="js-title" type="text" placeholder="请输入邮件标题" value="">',"</div>","</div>",'<div class="notice-editor">','<div class="notice-tool-bar">','<a href="javascript:void(0);" class="js-save"><i class="icon-save"></i>保存为模板</a>','<a href="javascript:void(0);" class="js-load"><i class="icon-download"></i>载入已有模板</a>',"</div>",'<label class="control-label">邮件正文：</label>','<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>','<div class="page-tags">#{tags}</div>',"</div>",'<div class="editor-box js-editor"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();c.find(".js-paper-name").html("发送内容："+b.paperName+"笔试通知"),a.initEditor(),a.val(b.defaultVal)}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=l(a.currentTarget),d=l.trim(c.attr("data-name")),e=p.name2img(b.variable,d);e&&b.editor.waitCreated(function(){b.editor.getEditor().exec("insertimage",e)})}},{name:"click .js-save",handler:function(){var a=this,b=a.rawConfig,c=a.valTpl();p.saveTpl({uid:b.uid,msg:!1,interviewer:!!b.isHr,title:c.title,content:c.val})}},{name:"click .js-load",handler:function(){var a=this,b=a.rawConfig;p.getTpl({uid:b.uid,msg:!1,interviewer:!!b.isHr,variable:(b.variable||[]).slice(0),call:function(b){var c=o.json(b.templateContent).value;a.val({title:c.emailSubject||"",val:c.emailContent||""})}})}}]},{initialize:d,initEditor:e,valSender:f,val:g,valTpl:h,_getData:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/msg",["nc","cpn","./util/util","../../../../../action/common","../../../../../util/ajax"],function(a,b,c){function d(){}function e(a){var b=this,c=b.getEl(),d=c.find(".js-phone");d.html(j.trim(a))}function f(){{var a=this,b=a.getEl();a.rawConfig}return j.trim(b.find("textarea.js-msg").val())}function g(a){var b=a.isOversea,c='【牛客网】你好，<span class="font-green">#公司名称#</span>邀你<span class="font-green">#笔试时间#</span>参加';return b&&(c="【NOWCODER】#company# invite you to participate online test, #time#,  "),{tips:['<div class="user-status"><label>重要提示：'+(b?"此短信只能发送给国外手机用户":"此短信只能发送给国内手机用户")+"</label></div>",'<div class="user-status"><label>发送内容：《'+a.paperName+"》笔试通知</label></div>",'<div class="user-status"><label>发送对象：'+a.availableCount+(b?"名国际考生":"名国内考生")+(a.beganCount>0?"("+a.beganCount+"名考生已考试，不发通知)":"")+"</label></div>"].join(""),defaultStr:c,val:(a.defaultVal||{}).val}}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Component,l=h.Clazz,m=h.Base,n=(i.CheckBox,a("./util/util")),o=c.exports=l.create();l.mix(o,k,{_template:['<div class="info-edit-box">',"#{tips}",'<div class="notice-editor">','<div class="notice-tool-bar">','<a href="javascript:void(0);" class="js-save"><i class="icon-save"></i>保存为模板</a>','<a href="javascript:void(0);" class="js-load"><i class="icon-download"></i>载入已有模板</a>',"</div>",'<label class="control-label">短信内容：</label>','<div class="editor-box">','<div class="msg-example clearfix">','<div class="float-left">#{defaultStr}</div>',"</div>",'<textarea class="msg-textarea js-msg" style="line-height:1.8;">#{val}</textarea>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentIpt=b.find("textarea.js-msg")}},{name:"click .js-save",handler:function(){var a=this,b=a.rawConfig;n.saveTpl({uid:b.uid,msg:!0,oversea:b.isOversea,interviewer:!!b.isHr,content:a.val()})}},{name:"click .js-load",handler:function(){var a=this,b=a.rawConfig;n.getTpl({uid:b.uid,msg:!0,oversea:b.isOversea,interviewer:!!b.isHr,call:function(b){a.contentIpt.val(m.json(b.templateContent).value.sms)}})}}]},{initialize:d,valSender:e,val:f,_getData:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/popupPreview",["nc","cpn","../../../../../action/paper","../../../../../util/ajax"],function(a,b,c){function d(a){function b(){var b=g.trim(a.tagVal());b||a.reset()}a=a||{};var c=this,d=new k(a);return c.popup=j.wrap(d,{title:"发送至测试号",content:d.html(),width:630,ok:function(){var b=g.trim(d.tagIpt.val());return b?void a.tagVal(b):void j.alert("至少需要设置一个选项")},cancel:b,close:b}),d}var e=a("nc"),f=a("cpn"),g=e.$,h=e.Component,i=(e.Limit,e.Clazz),j=(e.Base,f.Popup),k=(f.Input,a("../../../../../action/paper"),c.exports=i.create());i.mix(k,h,{_template:["<div>",'<div class="tag-edit-input">',"<span>输入可选项：</span>",'<input class="w360 js-tag" type="text" placeholder="多个标签用空格隔开" maxlength="40">',"</div>",'<div class="pop-collect-tag">','<span class="pop-collect-label">我的常用选项：</span>','<div class="tags-box" style="height:50px;"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}}}],show:d},{})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/util/popupTplEdit",["nc","cpn","./util","../../../../../../action/common","../../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};{var b=new r(a);o.wrap(b,{title:"编辑"+(a.isMsg?"短信":"邮件")+"模板",noUnique:!0,content:b.html(),width:920,ok:function(){return b.check()?void(a.ok&&a.ok(b.val())):!0},cancel:function(){}})}return b}function e(a){var b=this;b.variable=a.variable}function f(b){var c=this,d=c.rawConfig,e=c.getEl(),f=e.find(".js-content");return c.nameIpt=p.transform(e.find(".js-name")),d.isMsg?(c.contentIpt=k('<textarea style="resize:none;border-radius:3px;height:120px;" placeholder="短信内容"></textarea>'),f.append(c.contentIpt),c.contentIpt.outerWidth(f.width()),c.popup.fixPosition(),void(b&&b())):(f.html(['<div class="form-group">','<label class="control-label">邮件标题</label>','<div class="control-group js-title">','<input type="text" placeholder="邮件标题">',"</div>","</div>",'<div class="notice-edit-tags">','<span class="notice-tag-label">插入:</span>',q.getNameList(c.variable),"</div>",'<div class="editor-box js-editor"></div>'].join("")),c.titleIpt=p.transform(f.find(".js-title")),void a.async("../../../../../../component/editorSub/hEditor/index",function(a){c.contentIpt=new a({width:f.width(),height:200,renderTo:f,noCodeSelect:!0,noToolbarFixed:!0,noAutoHeight:!0,keConf:{items:"source,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,|,table,subscript,superscript,removeformat".split(",")},render:function(){c.contentIpt=c.contentIpt||this,c.popup.fixPosition(),this.waitCreated(b)}})}))}function g(a){var b=this,c=b.rawConfig,d=!!c.isMsg;if(0===arguments.length){var e={templateContent:{name:k.trim(b.nameIpt.val()),value:{}}};return d?e.templateContent.value.sms=k.trim(b.contentIpt.val()):(e.templateContent.value.emailSubject=k.trim(b.titleIpt.val()),e.templateContent.value.emailContent=q.html2tpl(b.variable,k.trim(b.contentIpt.val()))),e.templateContent=JSON.stringify(e.templateContent),e}a=n.json(a.templateContent,{}),b.nameIpt.val(a.name),d?b.contentIpt.val(a.value.sms):(b.titleIpt.val(a.value.emailSubject),b.contentIpt.val(q.tpl2html(b.variable,a.value.emailContent)))}function h(){var a=this,b=a.rawConfig,c=a.val(),d=a.nameIpt,e=n.json(c.templateContent);if(!e.name)return void d.setErrorTips("名称不能为空");if(e.name.length>20)return void d.setErrorTips("名称最长为20个字符");var f=e.value||{};if(b.isMsg){if(!f.sms)return void o.alert("短信内容不能为空")}else{if(!f.emailSubject)return void a.titleIpt.setErrorTips("邮件标题不能空");if(!f.emailContent||a.contentIpt&&!a.contentIpt.text())return void o.alert("邮件正文不能为空")}return!0}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Limit,j.Popup),p=j.Input,q=a("./util"),r=c.exports=m.create();m.mix(r,l,{_template:['<div class="pop-mod-set" style="max-height:none;">','<div class="form-group">','<label class="control-label">模板名称</label>','<div class="control-group js-name"><input type="text" placeholder="模板名称"></div>',"</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initCpn(function(){b.data&&a.val(b.data)})}},{name:"click a.js-tag-info",handler:function(a){var b=this,c=k(a.currentTarget),d=k.trim(c.attr("data-name")),e=q.name2img(b.variable,d);e&&b.contentIpt&&b.contentIpt.waitCreated(function(){b.contentIpt.getEditor().exec("insertimage",e)})}}],show:d},{initialize:e,initCpn:f,val:g,check:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/notice/send/util/util",["nc","cpn","../../../../../../action/common","../../../../../../util/ajax"],function(a,b,c){function d(a,b){var c=o.find(a,function(a){return a.title===b});return(c||{}).picUrl}function e(a,b){var c=this;return b=b.replace(/\[\$\#\#\$\](.*?)\[\$\#\#\$\]/gi,function(b,d){var e=c.name2img(a,d);return e?'<img src="'+e+'" />':""})}function f(a,b){var c=this;return b=b.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(b,d,e,f){if("img"!==(f||"").toLowerCase())return b;var g=c.getAttrList(b),h=n.trim(g.src);if(!h)return b;var i=o.find(a,function(a){return h.indexOf(a.picUrl)>=0});return i?"[$##$]"+i.title+"[$##$]":b})}function g(a,b){var c=this;return b=b.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(b,d,e,f){if("img"!==(f||"").toLowerCase())return b;var g=c.getAttrList(b),h=n.trim(g.src);if(!h)return b;var i=o.find(a,function(a){return h.indexOf(a.picUrl)>=0});return i?"#"+i.name+"#":b})}function h(a){var b="";return o.forEach(a,function(a){b+='<a class="tag-label js-tag-info" data-name="'+a.title+'" href="javascript:void(0);">'+a.title+"</a>"}),b}function i(a){for(var b,c={},d=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g;b=d.exec(a);){var e=(b[1]||b[2]||b[4]||b[6]).toLowerCase();c[e]=(b[2]?b[3]:b[4]?b[5]:b[7])||""}return c}function j(b){var c=!!b.msg,d=!!b.oversea,e=b.title,f=b.content;return c||e?f?void a.async("../../../../../../component/popupSub/tpl/popupTplName",function(a){a.show({title:"保存考生"+(c?"短信":"邮件")+"模板",ok:function(a){var b={type:c?d?1006:1004:1005,isDefault:a.isDefault?1:0,content:{name:a.name,value:{}}};c?b.content.value.sms=f:(b.content.value.emailSubject=e,b.content.value.emailContent=f),b.content=JSON.stringify(b.content),p.addTemplate({type:"POST",body:b,call:function(){q.tips("操作成功")},error:function(a){q.alert(a.msg)}})}})}):q.alert(c?"短信内容不能为空":"邮件正文不能为空"):q.alert("邮件标题不能为空")}function k(b){var c=!!b.msg,d=!!b.oversea,e=!1,f=c?d?"1006":"1004":"1005";a.async("../../../../../../component/popupSub/tpl/popupTplList",function(g){g.show({uid:b.uid,reqType:f,isMsg:c,isOversea:d,isInterviewer:e,edit:function(d){a.async("./popupTplEdit",function(a){a.show({isMsg:c,isInterviewer:e,variable:b.variable,data:d.data,ok:d.ok})})},ok:b.call})})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=a("../../../../../../action/common"),q=m.Popup;c.exports={name2img:d,tpl2html:e,html2tpl:f,html2val:g,getNameList:h,getAttrList:i,saveTpl:j,getTpl:k}});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/preview/detail",["nc","cpn","./module","../add/data","../util","../../../../core/siteConfig","../../../../core/module","../../../../util/util","../../../../action/paper","../../../../util/ajax","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../extend/bll/serverTime","../../../../action/common","../../../../action/user"],function(a,b,c){function d(){var a=this;a.questionMap={},a.questionIds=[]}function e(){function a(a,f){if(e>=f.length)return b.renderWait("错误的参数");var g=f[e];b.fetchAllQuestion(g.questions,function(e){b.questionIds=e;var f=+d.questionIndex||0,g=f<=e.length?t.page(f,B):1;if(g=Math.max(g,1),b.renderList(g),b.initShare(c.find(".module-box"),a),f>0){var h=p(".js-item[data-index="+f+"]");h.length>0&&u.scrollToEl({scrollEl:b.getSysWinEl(),el:h})}})}var b=this,c=b.getEl(),d=b.getParam(),e=+d.index||0;b.getPaper(function(c){b.getDirData(function(b){a(c,b)})})}function f(a){var b=this;a=+a||1;var c=b.getEl(),d=b.questionMap,e=b.questionIds,f=t.page(e.length,B);a=Math.max(1,f>=a?a:f);var g=B*(a-1),h=(e||[]).slice(g,g+B),i=r.map(h,function(a,c){var e=d[a.id],f=g+c+1;if(!e||!a.isMulti)return b.getItemHtml(e,a,f);var h=b[a.isMulti?"getMultiItemHtml":"getItemHtml"](e,a,f);return a.isMulti&&r.forEach(a.sub,function(a,c){h+=b.getItemHtml(d[a.id],a,f+"-"+(c+1))}),h}).join("");c.html(['<div class="module-box">','<div class="module-body">','<div class="subject-oprt-bar">','<a href="javascript:void(0);" class="js-go-pre">&lt; 返回全部题型</a>',b.isExistUser?'<a href="javascript:void(0);" class="link-green float-right js-edit-paper"><i class="icon-copy"></i> 添加或替换题目</a>':"","</div>",'<div class="js-list">',i,'<div class="js-pager"></div>','<div class="exam-btn-wrap" style="margin-top:20px;"><a href="javascript:void(0);" class="btn btn-primary btn-auto js-go-pre">返回全部题型</a></div>',"</div>","</div>","</div>"].join("")),new v({renderTo:c.find(".js-pager"),current:a,total:f,pageChange:function(a){b.renderList(a)}}),b.goTop()}function g(a,b,c){var d=this;return s.execTpl(['<div class="question-box js-item" data-id="#{id}" data-index="#{index}" style="border-bottom:0;padding-bottom:0">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">',"<span>#{content}</span>",d.isExistUser?'<a href="javascript:void(0);" class="edit-subject js-edit">编辑</a>':"","</div>","</div>","</div>"].join(""),{id:a.id,index:c,content:d.getContent(a)})}function h(a,b,c){var d=this;if(!a)return s.execTpl(['<div class="question-box js-item" data-id="#{id}" data-index="#{index}">','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">',"<span>获取不到题目数据，题目id为 #{id}，请联系开发人员确认此问题</span>","</div>","</div>","</div>"].join(""),{id:b.id,index:c});var e=b.isMulti,f=!!a.parentId,g="2"===r.id(a.tikuType);return s.execTpl(['<div class="question-box js-item" data-id="#{id}" data-index="#{index}" #{style}>','<span class="question-number">#{index}</span>','<div class="question-main">','<div class="topic-item">',e?"":'<span class="font-green">【#{score}分】</span>','<span class="post-topic-des">#{content}</span>',g&&!f&&d.isExistUser?'<a href="javascript:void(0);" class="edit-subject js-edit">编辑</a>':"","</div>",e?"":"#{optionList}","</div>",e?"":"#{answer}",e?"":"#{reference}","</div>"].join(""),{id:a.id,index:c,style:f?'style="margin-left:30px;"':"",type:a.type,score:a.score,content:d.getContent(a),optionList:d.getOptionList(a),reference:d.getReference(a),answer:d.getAnswer(a)})}function i(a,b){var c=this,d=c.questionMap,e=[],f={},g=[],h={};return r.forEach(a,function(a){var b=r.id(a.id),c=a.parentId?r.id(a.parentId):null;if(b&&!d[b]&&!f[b]&&e.push(b),c&&!d[c]&&!f[c]&&e.push(c),f[b]=a,c){var i=h[c]=h[c]||[];0===i.length&&g.push({id:c,sub:i,isMulti:!0}),i.push({id:b})}else g.push({id:b})}),0===e.length?b&&b(g):void y.getQuestions({ids:e,call:function(a){r.forEach(e,function(b){var c=a[b];c&&(c.score=(f[b]||{}).score,d[b]=c)}),b&&b(g)}})}function j(a){var b=a.content;if(a.contents){b="";var c=a.contents.length;r.forEach(a.contents,function(a,d){b+=a,b+=d+1===c?"":'<span class="blank-num">'+(d+1)+"</span>"})}if("4"===r.id(a.type)){b="标题："+a.codingProblem.title+" | 时间限制："+a.codingProblem.timeLimit+"秒 | 内存限制："+Math.floor(a.codingProblem.memoryLimit/1024)+"M<br/>"+b;var d=a.codingProblem||{},e=r.json(d.testCasesExt).samples||[];b+=d.inputDesc?"<div><h5><b>输入描述:</b></h5><pre>"+d.inputDesc+"</pre></div>":"",b+=d.outputDesc?"<div><h5><b>输出描述:</b></h5><pre>"+d.outputDesc+"</pre></div>":"",b+=d.hint?"</br><h5><b>备注:</b></h5><pre>"+d.hint+"</pre>":"",r.forEach(e,function(a){b+=['<div class="question-oi">','<div class="question-oi-hd" style="font-size:14px;font-weight:bold;">示例',a.index,"</div>",'<div class="question-oi-bd">','<div class="question-oi-mod"><h2>输入</h2></div><div class="question-oi-cont"><pre>',s.encodeHTML(a.input),"</pre></div>",'<div class="question-oi-mod"><h2>输出</h2></div><div class="question-oi-cont"><pre>',s.encodeHTML(a.output),"</pre></div>",a.note?'<div class="question-oi-mod"><h2>说明</h2></div><div class="question-oi-cont"><pre>'+a.note+"</pre></div>":"","</div>","</div>"].join("")})}return b}function k(a){var b=r.id(a.type);if("1"!==b&&"2"!==b)return"";var c='<div class="option-list">';return r.forEach(a.answers,function(a,b){c+=s.execTpl('<div style="margin-bottom:10px;"><pre class="option-item"><span class="option-num">#{order}</span>#{content}</pre></div>',{order:A.charAt(b),content:a.content})}),c+="</div>"}function l(a){var b=p.trim(a.referenceAnswer);return b=b?'<div class="suggest-answer open"><h2>参考答案：<span class="js-angle-action icon-angle-up" title="收起"></span><span class="js-angle-action icon-angle-down" title="展开"></span></h2><div>'+b+"</div></div>":""}function m(a){var b=r.id(a.type),c="";if("1"===b||"2"===b){var d=[];r.forEach(a.answers,function(a,b){1===a.type&&d.push(A.charAt(b))}),c+='<div class="answer-main"><div class="answer-item"><span>正确答案：</span><span class="font-green">'+d.join("、")+"</span></div></div>"}else if("3"===b){var d=[];r.forEach(a.answers,function(a,b){d.push('<div><pre class="option-item">('+(b+1)+") "+a.content.replace(/\\\|\\\|\\\|/g," 或 ")+"</pre></div>")}),c+='<div class="answer-main"><div class="answer-item"><span>正确答案：</span>'+d.join("")+"</div></div>"}return c+=""}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Clazz,r=n.Base,s=n.Str,t=(n.Time,n.Num),u=n.Dom,v=o.Pager,w=o.Popup,x=a("./module"),y=a("../../extend/bll/paper"),z=a("../../../../action/user"),A="ABCDEFGHIJKLMNOPQRSTUVWXYZ",B=50,C=c.exports=q.create();q.mix(C,x,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderContent()}},{name:"click .js-go-pre",handler:function(){var a=this,b=a.getParam();a.nav("paper",{action:"preview/menu",id:b.id})}},{name:"click .js-edit-paper",handler:function(){var a=this;a.goEdit(2)}},{name:"click .suggest-answer",handler:function(a){var b=p(a.currentTarget);b[b.hasClass("open")?"removeClass":"addClass"]("open")}},{name:"click .js-edit",handler:function(a){var b=this,c=p(a.currentTarget),d=c.closest(".js-item"),e=p.trim(d.attr("data-id")),f=+p.trim(d.attr("data-index"))||0;e&&z.checkHasEntityDepartmentPermission({query:{entityId:e,entityType:3},call:function(a){if(!a.data)return w.alert("你没有权限编辑该题目");var c=r.clone(b.getParam());f&&(c.questionIndex=f),b.nav("question",{action:"edit/index",id:e,back:{module:"paper",action:c}})},error:function(a){w.alert(a.msg)}})}}]},{initialize:d,renderContent:e,renderList:f,getMultiItemHtml:g,getItemHtml:h,fetchAllQuestion:i,getContent:j,getOptionList:k,getReference:l,getAnswer:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/preview/index",["nc","cpn","./module","../add/data","../util","../../../../core/siteConfig","../../../../core/module","../../../../util/util","../../../../action/paper","../../../../util/ajax","../../../../util/switch"],function(a,b,c){function d(){function a(a,d){var e=a.setting||{};c.html(j.execTpl(['<div class="exam-cover">','<div class="ecom-info clearfix">','<a href="#{testUrl}" class="ecom-logo">','<img src="#{logo}" alt="#{paperName}">',"</a>",'<div class="ecom-main">','<h2 class="ecom-title">#{paperName}</h2>',"<p>考试时间：#{examTime}</p>","<p>考试题型：#{questionSummary}</p>","</div>",b.isExistUser?'<div class="exam-oprt"><a href="javascript:void(0);" class="link-green setting-exam js-edit"><i class="icon-cog"></i> 修改设置</a></div>':"","</div>",'<div class="exam-notice">','<div class="module-head clearfix"><h1>考试须知</h1></div>','<div class="module-body"><p>#{summary}</p></div>',"</div>",'<div class="exam-notice">','<div class="module-head clearfix"><h1>考试参数设置</h1></div>','<div class="module-body">#{setting}</div>',"</div>",'<div class="exam-btn-wrap"><a href="javascript:void(0);" class="btn btn-primary btn-auto js-go-next">题目预览</a></div>',"</div>"].join(""),{paperName:a.paperName,logo:e.logo,testUrl:e.testUrl,summary:(e.paperSummary||"").replace(/\n/gi,"<br />"),examTime:a.forever?"长期有效":[k.form(new Date(a.beginTime),"yyyy年MM月dd日 HH:mm:ss"),k.form(new Date(a.endTime),"yyyy年MM月dd日 HH:mm:ss")].join(" - ")+"（其余时段均不可作答）",questionSummary:i.map(d,function(a){return a.dirName+' <span class="font-green">'+a.questionCount+"</span> 道"}).join("，"),setting:b.getSettingHtml(a,d)}))}var b=this,c=b.getEl();b.getPaper(function(d){b.getDirData(function(e){a(d,e),b.initShare(c.find(".exam-cover"),d)})})}function e(a,b){var c=this,d=c.hasTypeQuestion(b,"4"),e=a.setting||{},f=[];e.allow_camera&&f.push("开启摄像头"),e.monitorPhone&&f.push("开启手机监控"),e.antiJumpOut&&f.push("禁止做题跳出页面（编程题除外）"),e.antiCodingJumpOut&&f.push("禁止编程题跳出页面"),e.question_disorder&&f.push("题目乱序"),e.option_disorder&&f.push("选择题选项乱序"),e.codePlayback&&f.push("代码回看"),e.reportPlatform&&f.push("开启举报平台");var g=["填空题","问答题","编程题"];i.forEach((e.not_need_judge_type||"").split("_"),function(a){var b={3:"填空题",4:"编程题",5:"问答题"}[a];b&&(g=i.without(g,b))});var h=[],k=[],m=[];return i.forEach(e.signUpFields,function(a){var b=i.id(a.edit);(({0:h,1:m,2:k})[b]||[]).push(a.title)}),j.execTpl(["<p><b>考试时长</b>：#{duration}分钟</p>","<p><b>防作弊机制</b>：#{cheat}</p>","<p><b>人工判题题型</b>：#{judge}</p>",d?"<p><b>限定编程语言</b>：#{limitLang}</p>":"","<p><b>试卷类型</b>：#{paperType}</p>","<p><b>在线客服窗口</b>：#{allowMessage}</p>","<p><b>排队发卷</b>：#{queueUp}</p>","<p><b>编程题计分规则</b>：#{codingScoreRule}</p>","<p><b>多选题计分规则</b>：#{chooseScoreRule}</p>",n.can("paperPassLine")?"<p><b>及格分数线</b>：#{passScoreLine}</p>":"",n.can("paperSimulation")?"<p><b>是否为模拟卷</b>：#{simulation}</p>":"","<p><b>考生录入的信息</b>：</p>",h.length>0?"<p>&nbsp;&nbsp;&nbsp;&nbsp;*HR导入：#{hrField}</p>":"",k.length>0?"<p>&nbsp;&nbsp;&nbsp;&nbsp;*考生填写-必填：#{needField}</p>":"",m.length>0?"<p>&nbsp;&nbsp;&nbsp;&nbsp;*考生填写-选填：#{optionalField}</p>":""].join(""),{duration:a.duration,cheat:0===f.length?"无":f.join("，"),judge:0===g.length?"无":g.join("，"),limitLang:d?e.languageLimit?i.map(e.languageList,function(a){return l.getNameById(a)}).join("，"):"否":"试卷没有包含编程题",paperType:e.allow_new?"公开，所有人可见":"私密，仅邀请可见",allowMessage:e.allow_message?"开启":"关闭",queueUp:e.noQueueUp?"关闭":"开启",codingScoreRule:"2"===i.id(e.codingScoreRule)?"每题以最后一次提交得分计分":"每题以多次提交中最高得分计分",chooseScoreRule:"1"===i.id(e.chooseScoreRule)?"少选错选不得分":"2"===i.id(e.chooseScoreRule)?"错选不得分，少选得1/2分":"错选不得分，少选得1/3分",passScoreLine:a.passScoreLine,simulation:e.simulation?"是":"否",hrField:0===h.length?"无":h.join("，"),needField:0===k.length?"无":k.join("，"),optionalField:0===m.length?"无":m.join("，")})}function f(a,b){var c=0;return b=i.id(b),i.forEach(a,function(a){i.id(a.questionType)===b&&(c+=(a.questions||[]).length)}),c>0}var g=a("nc"),h=(a("cpn"),g.$,g.Clazz),i=g.Base,j=g.Str,k=g.Time,l=g.CodeLang,m=a("./module"),n=a("../../../../util/switch"),o=c.exports=h.create();h.mix(o,m,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderContent()}},{name:"click .js-go-next",handler:function(){var a=this,b=a.getParam();a.nav("paper",{action:"preview/menu",id:b.id})}},{name:"click .js-edit",handler:function(){var a=this;a.goEdit(3)}}]},{renderContent:d,getSettingHtml:e,hasTypeQuestion:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/preview/menu",["nc","cpn","./module","../add/data","../util","../../../../core/siteConfig","../../../../core/module","../../../../util/util","../../../../action/paper","../../../../util/ajax"],function(a,b,c){function d(){function a(a,d){var e=a.setting||{},f=(!!e.randomQuestion,[]);e.allow_camera?f=["本目录页为本场考试的全部题型，你可从任一部分开始作答，进入后需作答完毕，提交该部分答案才可返回目录页，答案提交后无法返回修改。","答题过程中全程摄像头开启，并会记录你的做题路径。"]:e.antiJumpOut&&(f=["本目录页为本场考试的全部题型，你可从任一部分开始作答，进入后需作答完毕，提交该部分答案才可返回目录页，答案提交后无法返回修改。","所有的客观题不允许跳出页面，跳出三次以上将后台记录。"]);var g=h.map(f,function(a,b){return"<dd>"+(b+1)+". "+a+"</dd>"}).join("");g=g?'<dl class="exam-tip"><dt><i class="icon-exclamation-sign"></i>重要提醒</dt>'+g+"</dl>":"";var j=h.map(d,function(a){var b="";if("2"===a.questionType){var c=h.id(e.chooseScoreRule);b="1"===c?"少选错选不得分":"2"===c?"错选不得分,少选得1/2分":"错选不得分,少选得1/3分"}else if("4"===a.questionType){var d=h.id(e.codingScoreRule);b="2"===d?"每题以最后一次提交得分计分":"每题以多次提交中最高得分计分"}return i.execTpl(['<div class="tab-menu clearfix">','<div class="tab-menu-tit tab-menu-item">#{dirName}</div>','<div class="tab-menu-item">#{questionCount}题</div>','<div class="tab-menu-item">满分#{questionScore}分</div>',b?'<div class="tab-menu-item tab-menu-tips">'+b+"</div>":"",'<a href="javascript:void(0);" class="btn js-go-detail">题目查看</a>',"</div>"].join(""),a)}).join("");c.html(['<div class="module-box">','<div class="module-body">',g,"<div>",j,"</div>",b.isExistUser?'<a href="javascript:void(0);" class="link-green setting-exam js-edit"><i class="icon-cog"></i> 修改设置</a>':"",'<div class="exam-btn-wrap"><a href="javascript:void(0);" class="btn btn-primary btn-auto js-go-pre">返回上一步</a></div>',"</div>","</div>"].join(""))}var b=this,c=b.getEl();b.getPaper(function(d){b.getDirData(function(e){a(d,e),b.initShare(c.find(".module-box"),d)})})}var e=a("nc"),f=(a("cpn"),e.$),g=e.Clazz,h=e.Base,i=e.Str,j=(e.Time,a("./module")),k=c.exports=g.create();g.mix(k,j,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderContent()}},{name:"click .js-go-pre",handler:function(){var a=this,b=a.getParam();a.nav("paper",{action:"preview/index",id:b.id})}},{name:"click .js-go-detail",handler:function(a){var b=this,c=b.getParam(),d=f(a.currentTarget).closest("div.tab-menu"),e=d.index();b.nav("paper",{action:"preview/detail",id:c.id,index:e})}},{name:"click .js-edit",handler:function(){var a=this;a.goEdit(1)}}]},{renderContent:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/preview/module",["nc","cpn","../add/data","../util","../../../../core/siteConfig","../../../../core/module","../../../../util/util","../../../../action/paper","../../../../util/ajax"],function(a,b,c){function d(a){var b=this,c=a.win;b.isExistUser=!!c.isExistUser}function e(a,b){var c=this;if(a=m(a),c.isExistUser)a.css("position","relative"),a.append('<a href="javascript:void(0);" class="share-exam-link js-share">发送给他人预览</a>');else{var d="该链接为试卷预览链接，仅用于检查试卷参数与题目，请妥善保管，严禁漏题";d+=b&&b.previewOverdueTime?"，链接将于"+p.form(new Date(b.previewOverdueTime),"yyyy年MM月dd日HH:mm:ss")+"失效":"",a.before('<div class="nk-warning">'+d+"</div>")}}function f(a){function b(a){var b=c.getEl();b.html('<div class="module-box"><div class="module-body"></div></div>'),c.renderNone(b.find(".module-body"),a)}var c=this,d=c.getParam(),e=o.id(d.id);if(!e)return c.renderWait("参数错误，没有指定试卷");if(c.paperData)return a&&a(c.paperData);t.getPaper({params:{paperId:e},query:{},noIntercept:!0,statusCall:{401:function(){return b("本链接有效期已过，现已失效，请联系HR重新生成。"),!1},999:function(){return b("本链接有效期已过，现已失效，请联系HR重新生成。"),!1}},call:function(b){return c.paperData=b.data,a&&a(b.data)},error:function(a){b(a.msg)}})}function g(a){function b(a,b){var c=(a||{}).setting||{},d=!!c.randomQuestion,e=!!c.customCategory,f=r.add.getLoadDirData(a,!0);e||o.forEach(f,function(a){var b=(a.dirName||"").replace("题");b+="不定项"===b?"选择题":"题",a.dirName=b}),o.forEach(f,function(a){var b=0,c=0;d?(o.forEach(a.tags,function(a){b+=+a.inputCount||0}),c=b*(+a.dirScore||0)):(b=(a.questions||[]).length,o.forEach(a.questions,function(a){c+=a.score})),a.questionCount=b,a.questionScore=c}),b&&b(f)}function c(a,b,e,f){f=f||[],t.getPaperQuestion({type:"GET",params:{paperId:a.id},query:{page:b,pageSize:200},call:function(d){var g=d.data;f=f.concat(g.datas||[]),g.currentPage<g.totalPage?c(a,b+1,e,f):e&&e(f)},error:function(){d.renderWait("数据加载出错，请重试")}})}var d=this;d.getPaper(function(d){var e=(d||{}).setting||{},f=!!e.randomQuestion;f?b(d,a):c(d,1,function(c){e.extQuestions=c,b(d,a)})})}function h(a){var b=this,c=b.getParam(),d=o.id(c.id);a=o.id(a)||"1",b.getPaper(function(c){var e=c.beenTested;"1"===a?(e&&q.alert("该套试卷已有考生做题记录，目录配置不可修改。"),!e&&b.nav("paper",{action:"edit",id:d})):"2"===a?(e&&q.alert("该套试卷已有考生做题记录，不可添加或替换题目。"),!e&&b.nav("paper",{action:"edit",id:d,step:"2"})):"3"===a&&b.nav("paper",{action:"edit",id:d,step:e?null:"4"})})}function i(a){var b=this,c=b.getEl();c.html('<div style="font-size:14px;padding:20px;text-align:center">'+a+"</div>")}function j(){var a=this;q.confirm("预览链接供临时查看试卷参数和题目使用，链接72小时内有效，请谨慎传播，注意漏题风险，是否生成链接？",function(){var b=a.getParam();t.getTempPreview({params:{paperId:b.id},call:function(a){var b=a.data;new q({title:"试卷预览链接",hasNoFooter:!0,width:650,content:['<div class="pop-content">','<div class="pop-interview" style="width:auto;">','<div class="ico-success"><i class="fui-check-inverted"></i></div>',"<h2>生成预览链接成功</h2>","<p>"+b+"</p>","</div>",'<div class="pop-btn-wrapper">','<a href="'+b+'" target="_blank" class="btn btn-primary">查看</a>','<a href="javascript:void(0);" data-clipboard-text="'+b+'" class="btn btn-primary js-copy">复制链接</a>',"</div>","</div>"].join(""),listeners:{render:function(){u.copy(this.getEl(".js-copy"),function(){q.tips("复制成功")})}}})},error:function(a){q.alert(a)}})})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Clazz,o=k.Base,p=(k.Uri,k.Time),q=l.Popup,r=a("../add/data"),s=a("../../../../core/module"),t=a("../../../../action/paper"),u=a("../../../../util/util"),v=c.exports=n.create();n.mix(v,s,{style:"/stylesheets/styles/system/review-paper.css",title:"试卷预览",hideCrumb:!0,hideLeft:!0,canTempVisit:!0,_template:['<div class="clearfix" style="margin:20px auto;width:960px;">','<div style="font-size:14px;padding:20px;text-align:center">加载中...</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getSysWinEl().css("background","#eee")}},{name:"click .js-share",handler:function(){var a=this;a.showShare()}}]},{initialize:d,initShare:e,getPaper:f,getDirData:g,goEdit:h,renderWait:i,showShare:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/project/index",["nc","cpn","../../../../core/moduleSan","../../../../util/util","../../../../core/siteConfig","../../../../componentSan/none","../../../../componentSan/wait","../../../../action/paper","../../../../util/ajax","../../../../action/user","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../extend/bll/serverTime","../../../../action/common","../cpn/popupProject","../../../../component/department","../../../../util/switch"],function(a,b,c){function d(){var a=this,b=a.getParam(),c="1"===p.id(b.type);a.data.set("isClose",c),c&&(a.crumbTitle="已归档项目",a.refreshCrumb()),a.fetchList()}function e(a,b){var c=this;c.nav("paper",{action:"project/paperList",projectId:b.id})}function f(){var a=this;a.nav("paper",{action:"project/index",type:1})}function g(a,b){var c=this;o.Event(a).stopPropagation(),u.updateProjectStart({type:"PUT",params:{projectId:b.id},body:{star:b.star>0?0:1},call:p.bind(c.fetchList,c),error:function(a){q.alert(a.msg)}})}function h(a,b){var c=this;o.Event(a).stopPropagation(),q.confirm(b.status?"该项目已归档，还原后可查看详情。确定撤销归档，还原至正常项目？":"确定归档本项目吗？确定后项目将转移至归档文件夹中，项目中的试卷将不再出现在笔试相关操作中",function(){u.updateProjectClose({type:"PUT",params:{projectId:b.id},body:{status:b.status?0:1},call:p.bind(c.fetchList,c),error:function(a){q.alert(a.msg)}})})}function i(a,b){var c=this;o.Event(a).stopPropagation(),v.show({project:b,userId:c.getUserId(),call:p.bind(c.fetchList,c)})}function j(){var a=this;v.show({call:p.bind(a.fetchList,a),userId:a.getUserId()})}function k(){var a=this;u.getAllProject({type:"GET",call:function(b){var c=!!a.data.get("isClose"),d=[],e=0;p.forEach(b.data,function(a){var b=!!a.status;b===c&&d.push(a),b&&(e+=1)}),a.data.set("closeCount",e),a.data.set("items",d)},error:function(b){a.data.set("error",b.msg)}})}function l(){var a=this;return a.data.get("isClose")?{crumb:[{title:"笔试项目",module:"paper",param:{action:"project/index"}}]}:void 0}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Base,q=n.Popup,r=a("../../../../core/moduleSan"),s=a("../../../../componentSan/none"),t=a("../../../../componentSan/wait"),u=a("../../../../action/paper"),v=(a("../../../../action/user"),a("../../extend/bll/paper"),a("../cpn/popupProject"));c.exports=r.defineComponent({style:"/stylesheets/styles/system/paperManage.css",showTask:!0,title:"笔试项目",template:['<div class="module-box">','<div class="module-body">','<cpn-none s-if="error">{{error}}</cpn-none>','<cpn-wait s-else-if="!items">加载中...</cpn-wait>','<div s-else class="project-items">','<div s-for="item in items" on-click="actionNav($event, item)" class="p-item {{item.type === 1 ? \'p-sys-item\' : \'\'}}">','<div class="p-item-hd">','<span class="js-tips" data-theme="white" title="{{item.remark ? \'备注：\' + item.remark : \'\'}}" :title="remark(item)">{{item.name}}</span>','<a s-if="item.type === 1" href="javascript:void(0);" class="help-wrapper link-gray">','<i class="icon-question-sign"></i>','<div class="tooltip bottom tooltip-info">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">所有历史未归档及API调用创建项目，本项目不做重复判断。</div>',"</div>","</a>","</div>",'<div class="p-item-bd">','<ul class="p-item-info">','<li class="clearfix">','<span class="p-item-label"><i class="icon-user"></i>考生：</span>','<span class="p-item-num">{{item.testUserCount || 0}}</span>',"</li>",'<li class="clearfix">','<span class="p-item-label"><i class="icon-suitcase"></i>试卷：</span>','<span class="p-item-num">{{item.paperCount || 0}}</span>',"</li>","</ul>","</div>",'<div class="p-item-ft clearfix">','<a on-click="actionStart($event, item)" s-if="!isClose" href="javascript:void(0);" class="js-tips icon-star-empty {{item.star ? \'selected\' : \'\'}}" title="{{item.star ? \'取消置顶\' : \'置顶\'}}"></a>','<div class="p-item-oprt">',"<a on-click=\"actionFold($event, item)\" href=\"javascript:void(0);\" class=\"js-tips {{item.status ? 'icon-repeat' : 'icon-inbox'}}\" title=\"{{item.status ? '取消归档' : '项目归档'}}\"></a>",'<a on-click="actionEdit($event, item)" s-if="!isClose" href="javascript:void(0);" class="icon-edit js-tips" title="修改笔试项目"></a>',"</div>","</div>","</div>",'<template s-if="!isClose">','<div on-click="actionAdd" class="p-item"><div class="add-project-box"><i class="ico-plus">+</i><p class="add-project-font">新建笔试项目</p></div></div>','<div on-click="actionNavClose" class="p-item file-item"><div class="file-wrap"><div class="file-content">已归档项目<span>{{closeCount}}</span></div></div></div>',"</template>",'<cpn-none s-else-if="closeCount === 0">','<img slot="image" src="//uploadfiles.nowcoder.com/images/20151217/56_1450323797641_364BE8860E8D72B4358B5E88099A935A" />',"</cpn-none>","</div>","</div>","</div>"].join("")},{components:{"cpn-none":s,"cpn-wait":t},initData:function(){return{isClose:!1,closeCount:0,items:null,error:""}},attached:d,actionNav:e,actionNavClose:f,actionStart:g,actionFold:h,actionEdit:i,actionAdd:j,fetchList:k,getCrumbConf:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/project/paperList",["nc","cpn","../cpn/navProject","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../core/siteConfig","../../../../action/paper","../../../../component/navProject","../../../../core/moduleSan","../../../../util/util","../cpn/popupProjectList","../../../../componentSan/none","../../../../componentSan/wait"],function(a,b,c){function d(a){var b=new Date(a.beginTime),c=new Date(a.endTime),d=C.isSameDate(b,c);return C.form(b,"yy-MM-dd HH:mm")+" ~ "+C.form(c,d?"HH:mm":"yy-MM-dd HH:mm")}function e(a,b){return a.toFixed(b)}function f(a){var b=this;return B.addParam({theme:"tinyLeft"},b.getNavUrl("paper",{action:"preview/index",id:a.id}))}function g(){var a=this;I.checkProject({all:!0,simple:!0,projectId:a.getProjectId(),call:function(b,c){a.data.set("projects",c),a.initNav(c),a.initCountDown(),a.fetchList()}})}function h(){var a=this,b=a.data.get("projects");new F({renderTo:z(a.el).find(".js-project-nav"),renderBy:"replaceWith",current:a.getProjectId(),items:b,change:function(b){a.addParam({projectId:b}),a.fetchList()}})}function i(){function a(a){var c=b.data.get("items"),d=!1;A.forEach(c,function(c,e){if(!c.started){var f=c.beginTime<a;b.data.set("items["+e+"].leftTimeStart",f?"00:00:00":C.second((c.beginTime-a)/1e3)),d=d||f}}),d&&b.fetchList(!0)}var b=this;J.listen("nextTick",a),b.on("disposed",function(){J.unlisten("nextTick",a)})}function j(){var a=this;a.fetchList()}function k(a,b){var c=this;c.addParam({page:1,progress:b}),c.fetchList()}function l(a,b,c){var d=this,e=b.type;d.addParam({page:1,orderBy:e,order:c}),d.fetchList()}function m(){var a=this;a.nav("paper",{action:"addStep1"})}function n(a,b,c){var d=this;z.Event(a).stopPropagation();var e=A.id(b.id);if("notice"===c)return I.navNotice(e,{isAll:1});if("copy"===c)return I.changePorject({simple:!0,canClose:!0,call:function(a){return d.nav("paper",{action:"copy/edit/index",paperId:e,projectId:a})}});if("addUser"===c)return I.navAddUser(b);var f={edit:["paper",{action:"edit",id:e}],monit:["paper",{action:"monit/index",paperId:e}],candidate:["paper",{action:"candidate/index/index",paperId:e}],testAccount:["paper",{action:"testAccount/list/index",paperId:e}],addUser:["paper",{action:"notice/addUser/index",paperId:e}],users:["paper",{action:"notice/detail/index",paperId:e}]}[c];(f||[]).length>0&&d.nav.apply(d,f)}function o(a,b,c){z.Event(a).stopPropagation();var d=A.id(b.id);"pdf"===c&&I.downloadPdf(d,b.paperName),"score"===c&&I.downloadTestNew({paperIds:d,paperName:b.paperName})}function p(a,b){var c=this;z.Event(a).stopPropagation();var d=A.id(b.id);D.confirm("如果删除本试卷，该试卷做题记录将同时清除，是否确认删除？",function(){I.delPaper({paperId:d,paperName:b.paperName,call:function(){var d=z(a.target).closest(".js-list-item");d.fadeOut(500,function(){c.data.remove("items",b),c.updateList()})}})})}function q(a,b){var c=this;z.Event(a).stopPropagation();var d=A.id(b.id);L.show({ok:function(e){var f=A.id(e.id);return f===c.getProjectId()?D.alert("已经在本项目中"):void D.confirm("确定将“"+b.paperName+"”转移到“"+e.name+"”?",function(){K.movePaper2Project({params:{paperId:d},body:{projectId:f},call:function(){D.tips("操作成功");var d=z(a.target).closest(".js-list-item");d.fadeOut(500,function(){c.data.remove("items",b),c.updateList()})},error:function(a){D.error(a.msg)}})})}})}function r(a){var b=this,c=b.getParam(),d=+c.orderBy||P,e=+c.order||O,f=+c.progress||Q;A.forEach(b.data.get("progress"),function(c,d){a&&b.data.set("progress["+d+"].count",a[c.key]||0),b.data.set("progress["+d+"].checked",d===f)}),A.forEach(b.data.get("order"),function(a,c){b.data.set("order["+c+"].checked",a.type===d),b.data.set("order["+c+"].by",e)})}function s(){var a=this;a.nextTick(function(){a.pager&&a.pager.destroy(),a.pager=new E({renderTo:z(a.el).find(".js-pager"),current:a.data.get("currentPage"),total:a.data.get("totalPage"),pageChange:function(b){a.addParam({page:b}),a.fetchList()}})})}function t(){var a=this,b=a.data.get("totalPage"),c=a.data.get("currentPage"),d=0===(a.data.get("items")||[]).length;d&&b>1&&c===b&&a.addParam({page:c-1}),a.fetchList(!d)}function u(a){var b=this,c=b.getParam(),d=b.getProjectId();b.data.set("loading",!a),b.updateOrder(),H.getPapers({params:{userId:b.getUserId()},query:{query:z.trim(c.key),page:c.page||1,order:+c.order||O,orderBy:+c.orderBy||P,progressType:+c.progress||Q,projectIdList:"0"===d?I.getAllId(b.projectData):d,pageCount:24},call:function(a){if(a.isOrder){var c=a.data;b.data.set("items",c.datas||[]),b.data.set("currentPage",c.currentPage||0),b.data.set("totalPage",c.totalPage||0),b.updateOrder(c),b.updatePager()}},error:function(a){b.data.set("items",null),b.data.set("error",a.msg)},always:function(){b.data.set("loading",!1)}})}function v(){var a=this,b=a.getParam();return A.id(b.projectId)}function w(){var a=this,b=a.getParam();return{crumb:[{title:"笔试项目",module:"paper",action:"project/index"}],ext:[{input:{value:z.trim(b.key),placeholder:"输入试卷名，回车搜索"},listeners:{ok:function(b){var c=z.trim(b.val()),d=a.getParam();b.val(c);var e=c===z.trim(d.key);return e?a.addParam({key:c||null}):(a.addParam({key:c||null,page:null}),void a.fetchList())}}}]}}var x=a("nc"),y=a("cpn"),z=x.$,A=(x.Clazz,x.Base),B=x.Uri,C=x.Time,D=y.Popup,E=y.Pager,F=a("../cpn/navProject"),G=a("../../../../core/moduleSan"),H=a("../../../../action/api"),I=a("../../extend/bll/paper"),J=a("../../extend/bll/serverTime"),K=a("../../../../action/paper"),L=a("../cpn/popupProjectList"),M=a("../../../../componentSan/none"),N=a("../../../../componentSan/wait"),O=2,P=0,Q=0;c.exports=G.defineComponent({style:"/stylesheets/styles/system/paperManage.css",showTask:!0,title:"试卷列表",template:['<div class="module-box">','<div class="js-project-nav"></div>','<cpn-none s-if="!items && error">{{error}}</cpn-none>','<cpn-wait s-if="!items && loading"></cpn-wait>','<template s-if="items">','<div class="menu-box menu-line-box">','<ul class="menu clearfix">','<li s-for="item, index in progress" on-click="actionProgress($event, index)" class="{{item.checked ? \'selected\' : \'\'}}">','<a href="javascript:void(0);">{{item.name}} ({{item.count}}) </a>',"</li>","</ul>",'<div class="menu-oprtbar">','<span class="sort-label">排序方式：</span>','<div s-for="item in order" class="sort-type">{{item.title}}','<a on-click="actionRank($event, item, item.checked && item.by === 1 ? 2 : 1)" href="javascript:void(0);" class="sort-up {{item.checked && item.by === 1 ? \'selected\' : \'\'}}" title="升序"></a>','<a on-click="actionRank($event, item, item.checked && item.by === 2 ? 1 : 2)" href="javascript:void(0);" class="sort-down {{item.checked && item.by === 2 ? \'selected\' : \'\'}}" title="降序"></a>',"</div>",'<button on-click="actionAddPaper" class="btn btn-primary btn-xs">新增试卷</button>',"</div>","</div>",'<div class="module-body">','<div class="project-box new-project-box">','<div class="project-bd">','<cpn-none s-if="error">出现错误，<a on-click="actionReload" href="javascript:void(0);" class="link-green">点击重试</a></cpn-none>','<cpn-wait s-else-if="loading"></cpn-wait>','<cpn-none s-else-if="items.length === 0"></cpn-none>','<div s-else class="project-list">','<div s-for="item in items" class="p-list-item js-list-item">','<div class="list-item-hd"><a href="{{item.testUrl}}" target="_blank">{{item.paperName}}</a></div>','<div class="list-item-bd">','<div class="list-item-oprt">','<span s-if="item.forever">长期有效</span>',"<span s-else>{{item | formDuration}}</span>",'<span class="float-right">{{item.duration}}分钟</span>',"</div>","<div s-if=\"item.started || item.finished\" class=\"list-item-plan {{item.finished ? 'end-item-plan' : item.started ? '' : 'unstart-item-plan'}}\">","<span>邀请:{{item.presetUserCount || 0}}</span>","<span>打开:{{item.testCount || 0}}</span>","<span>完成:{{item.personTotal || 0}}</span>","<span>平均分:{{item.avgTotal | toFixed(1)}}</span>","</div>",'<div s-else class="list-item-plan unstart-item-plan countdown-item">',"<span>邀请:{{item.presetUserCount || 0}}</span>",'<span><template s-if="item.leftTimeStart"><i class="icon-time"></i> {{item.leftTimeStart}}</template></span>',"</div>",'<ul class="p-oprt-list">','<li on-click="actionNav($event, item, \'edit\')"><span class="icon-edit oprt-icon"></span><p>编辑</p></li>',"<li>",'<span class="icon-folder-close-alt oprt-icon"></span><p>预览</p>','<ul class="sub-oprt-list">','<li><a href="{{item | getPreviewUrl}}" target="_blank">预览试卷</a></li>',"<li on-click=\"actionNav($event, item, 'testAccount')\">预览答题页面</li>","</ul>","</li>","<li>",'<span class="icon-download-alt oprt-icon"></span><p>下载</p>','<ul class="sub-oprt-list">',"<li on-click=\"actionDownload($event, item, 'pdf')\">下载试卷PDF</li>","<li on-click=\"actionDownload($event, item, 'score')\">下载成绩报表</li>","</ul>","</li>",'<li on-click="actionDel($event, item)"><span class="icon-trash oprt-icon"></span><p>删除</p></li>',"<li>",'<span class="icon-list-ul oprt-icon"></span><p>更多</p>','<ul class="sub-oprt-list">',"<li on-click=\"actionNav($event, item, 'users')\">查看考生名单</li>",'<li s-if="!item.finished" on-click="actionNav($event, item, \'addUser\')">添加考生</li>','<li s-if="!item.finished" on-click="actionNav($event, item, \'notice\')">通知考生</li>',"<li on-click=\"actionNav($event, item, 'monit')\">查看数据报表</li>",'<li s-if="item.finished || item.started" on-click="actionNav($event, item, \'candidate\')">查看考生成绩</li>',"<li on-click=\"actionNav($event, item, 'copy')\">复制试卷</li>",'<li on-click="actionMove($event, item)">转移项目</li>',"</ul>","</li>","</ul>","</div>","</div>",'<div class="js-pager"></div>',"</div>","</div>","</div>","</div>","</template>","</div>"].join("")},{components:{"cpn-none":M,"cpn-wait":N},initData:function(){return{loading:!0,items:null,projects:null,error:"",currentPage:0,totalPage:0,progress:[{key:"allTotalCount",name:"全部",count:0},{key:"notStartedPaperCount",name:"未开始",count:0},{key:"testingPaperCount",name:"进行中",count:0},{key:"finishedPaperCount",name:"已结束",count:0}],order:[{type:1,title:"完成人数"},{type:2,title:"平均得分"},{type:0,title:"添加时间"},{type:3,title:"开始时间"}]}},filters:{formDuration:d,toFixed:e,getPreviewUrl:f},attached:g,initNav:h,initCountDown:i,actionReload:j,actionProgress:k,actionRank:l,actionAddPaper:m,actionNav:n,actionDownload:o,actionDel:p,actionMove:q,updateOrder:r,updatePager:s,updateList:t,fetchList:u,getProjectId:v,getCrumbConf:w})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/testAccount/add/index",["nc","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/paper","cpn","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper","./item","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price"],function(a,b,c){function d(){var a=this;a.moduleCache={}}function e(a){var b=this;o.getPaper({params:{paperId:b.getPaperId()},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){m.renderWait(b.getEl(),a.msg)}})}function f(){{var a=this;a.getEl()}new p({renderTo:a.bodyEl,parent:a,signUpFields:a.signUpFields})}function g(){var a=this;return k.id(a.getParam().paperId)}function h(){var a=this,b=a.paper;return{crumb:[{title:"测试账号"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"testAccount/list/index",paperId:a.getPaperId()}}]}}var i=a("nc"),j=(i.$,i.Clazz),k=i.Base,l=a("../../../../../core/module"),m=a("../../../../../util/util"),n=a("../../../extend/bll/paper"),o=a("../../../../../action/paper"),p=a("./item"),q=c.exports=j.create();j.mix(q,l,{style:"/stylesheets/styles/system/importList.css",title:"添加测试账号",_template:['<div class="module-body">','<div class="import-add-people">','<div class="js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getPaperId(!0);return a.bodyEl=b.find("div.js-body"),c?(m.renderWait(a.bodyEl,"加载中..."),void a.getPaper(function(){n.getSignUpFields(c,function(b){return 0===b.length?m.renderWait(a.bodyEl,"缺少考生字段"):(a.bodyEl.html(""),a.signUpFields=b,void a.initCpn())})})):m.renderWait(b,"错误的参数")}}]},{initialize:d,getPaper:e,initCpn:f,getPaperId:g,getCrumbConf:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/testAccount/add/item",["nc","cpn","../../../../../core/siteConfig","../../../extend/bll/money","../../../extend/bll/base","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../../../action/paper"],function(a,b,c){function d(a){var b=this;b.parent=a.parent,b.fieldMap={},o.forEach(a.signUpFields,function(a){b.fieldMap[a.name]=a}),b.cpn=[]}function e(a){var b=this,c=b.rawConfig,d=b.listEl,e=b.cpn,f=n.execTpl(['<div class="add-mod js-line" style="display:none;">','<div class="add-mod-head">','<h2><span class="js-name">测试账号#{index}</span><a href="javascript:void(0);" class="icon-trash js-trash"></a></h2>',"</div>",'<div class="add-mod-body">',o.map(c.signUpFields,function(a){return n.execTpl(['<div class="add-item">','<div class="form-group">','<label class="control-label">#{title}</label>','<div class="control-group js-ipt" data-title=#{title} data-type="#{name}" data-need="#{need}"></div>',"</div>","</div>"].join(""),a)}).join(""),"</div>","</div>"].join(""),{index:b.cpn.length+1}),g=k(f),h={};o.forEach(g.find("div.js-ipt"),function(a){a=k(a);var b=k.trim(a.attr("data-type")),c=!1,d=q.transform(a,c?{blur:function(){this.val((this.val()||"").replace(/[^\d]/g,""))}}:null),e="true"===d.getEl().attr("data-need");e&&d.getEl().append(k('<span class="choose-tips" style="position:absolute;width:40px;top:7px;">必填项</span>')),h[b]=d}),e.push(h),d.append(g),a?g.slideDown(120):g.show(),d.find(".js-trash")[e.length>1?"show":"hide"]()}function f(){var a=this,b={};return o.forEach(a.cpn,function(a){o.forEach(a,function(a,c){b[c]=b[c]||[],b[c].push(k.trim(a.val()))})}),b}function g(){var a=this,b=!0,c={},d=[];return o.forEach(a.cpn,function(e){o.forEach(e,function(e,f){var g=a.fieldMap[f],h=g.title,i=k.trim(e.val());"key"===f&&0===d.length&&(c[i]=c[i]||[],c[i].push(e),c[i].length>1&&(d=c[i])),(i||g.need)&&(!i&&g.need?(e.setErrorTips(g.title+"不能为空"),b=!1):h.indexOf("手机")>=0&&!n.isTel(i)?(e.setErrorTips("手机号码格式错误"),b=!1):(h.indexOf("邮箱")>=0&&!n.isEmail(i)||h.indexOf("身份证")>=0&&!n.isPassport(i))&&(e.setErrorTips("请填写正确的"+h),b=!1))})}),d.length>0&&(b=!1,o.forEach(d,function(a){a.setErrorTips("不能填写重复的值")})),b}function h(a,b){var c=this,d=c.parent,e=(c.rawConfig,d.getPaperId());if(!c.check())return a&&a();var f=c.val();f.userType=1,f.failOnExist=!0,b&&(f.confirm=!0),t.addUser({params:{paperId:e},body:f,call:function(a){s.refreshMoney(),r.tips("成功添加"+(a.data||[]).length+"个测试账号！",function(){d.nav("paper",{action:"testAccount/list/index",paperId:e})})},statusCall:{1005:function(a){var b=a.details||{},d=c.fieldMap[b.parameterName]||{},e=d.title||b.parameterName;return r.alert(e+b.format||""),!1},1006:function(){return r.confirm("每张试卷可免费添加<strong>10</strong>个测试账号，超过部分将扣费，当前试卷测试账号已超过10个，是否继续添加？",function(){c.submit(a,!0)}),!1},1321:function(a){var b=a.details&&a.details.index;if(o.isNumber(b)){var d=c.cpn[b],e=d.key,f=+a.details.type,g=0===f?"该测试账号信息已被正式考生账号占用":"已经被其他考生占用";e&&e.setErrorTips(g)}else r.alert("测试账号信息已经被使用");return!1},1101:function(a){var b='<div style="font-size:14px;padding:20px 0;">'+a.msg+"</div>";return new r({title:"余额不足",width:600,content:b,okTxt:"去充值",cancelTxt:"暂不导入",listeners:{ok:function(){d.getWin().nav("purchase",{action:"recharge"})},cancel:function(){}}}),!1}},error:function(a){r.alert(a.msg)},always:a})}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Str,o=i.Base,p=i.Limit,q=j.Input,r=j.Popup,s=(a("../../../../../core/siteConfig"),a("../../../extend/bll/money")),t=a("../../../../../action/paper"),u=c.exports=m.create();m.mix(u,l,{_template:["<div>",'<div class="import-add-main js-list"></div>','<div class="import-add-btn">','<a href="javascript:void(0);" class="js-add"><i class="icon-plus-sign"></i>添加测试账号</a>',"</div>",'<div style="margin-top:30px;text-align:center;">','<a class="btn btn-primary js-submit" href="javascript:void" style="width:180px;">提交</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.listEl=b.find("div.js-list"),a.add()}},{name:"click a.js-add",handler:function(){var a=this;a.add(!0)}},{name:"click .js-trash",handler:function(a){var b=this,c=b.listEl,d=b.cpn,e=k(a.currentTarget),f=e.closest("div.js-line"),g=f.index();return 1===d.length?void e.hide():(d.splice(g,1),void f.slideUp(120,function(){f.remove(),c.find(".js-trash")[d.length>1?"show":"hide"](),o.forEach(c.find(".js-name"),function(a,b){k(a).html("测试账号"+(b+1))})}))}},{name:"click .js-submit",handler:function(a){var b=this,c=k(a.currentTarget);p.mark(c)||b.submit(function(){p.clear(c)})}}]},{initialize:d,add:e,val:f,check:g,submit:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/testAccount/edit/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../../../util/ajax","../../../extend/bll/serverTime","../../../../../action/common","../../../../../action/paper"],function(a,b,c){function d(a){var b=this,c=b.getParam();x.getPaper({params:{paperId:c.paperId},query:{},call:function(c){b.paper=c.data,b.refreshCrumb(),a&&a()},error:function(a){b.renderWait(b.bodyEl,a.msg)}})}function e(a){var b=this,c=b.getParam();x.getUser({params:{paperId:c.paperId,id:c.id},query:{},call:function(c){b.editUser=c.data,a&&a()},error:function(a){b.renderWait(b.bodyEl,a.msg)}})}function f(){var a=this,b=a.editUser,c=a.bodyEl;a.fieldMap={},r.forEach(a.signUpFields,function(b){a.fieldMap[b.name]=b});var d=['<div class="add-mod">','<div class="add-mod-head">','<h2><span class="js-name">测试账号</span></h2>',"</div>",'<div class="add-mod-body">',r.map(a.signUpFields,function(a){var c="key"===a.name?"userKey":a.name,d="userKey"===c||"name"===c,e=o.trim(d?b[c]:r.json(b.ext,{})[c])||"";return q.execTpl(['<div class="add-item">','<div class="form-group">','<label class="control-label">#{title}</label>','<div class="control-group js-ipt" data-type="#{name}"><input type="text" value="#{value}" /></div>',"</div>","</div>"].join(""),{title:a.title,name:a.name,value:e})}).join(""),"</div>","</div>",'<div style="margin-top:30px;text-align:center;">','<a class="btn btn-primary js-submit" href="javascript:void" style="width:180px;">提交</a>',"</div>"].join("");c.html(d);var e=a.cpn=a.cpn||{};r.forEach(c.find("div.js-ipt"),function(a){a=o(a);var b=o.trim(a.attr("data-type")),c=t.transform(a);e[b]=c})}function g(){var a=this,b={};return r.forEach(a.cpn,function(a,c){b[c]=o.trim(a.val())}),b}function h(){var a=this,b=!0;return r.forEach(a.cpn,function(c,d){var e=a.fieldMap[d],f=e.title,g=o.trim(c.val());(g||"true"===e.need)&&(g||"true"!==e.need?(f.indexOf("邮箱")>=0&&!q.isEmail(g)||f.indexOf("手机")>=0&&!q.isTel(g)||f.indexOf("身份证")>=0&&!q.isPassport(g))&&(c.setErrorTips("请填写正确的"+f),b=!1):(c.setErrorTips(e.title+"不能为空"),b=!1))}),b}function i(a){var b=this;if(!b.check())return a&&a();var c=b.getPaperId(),d=b.getId(),e=b.val();e.userType=1,x.updateUser({type:"PUT",params:{paperId:c,id:d},body:e,call:function(){u.tips("操作成功",function(){b.nav("paper",{action:"testAccount/list/index",paperId:c})})},error:function(a){u.alert(1321===a.code?"测试账号已经存在":a.msg)},always:a})}function j(){var a=this;return r.id(a.getParam().paperId)}function k(){var a=this;return r.id(a.getParam().id)}function l(){var a=this,b=a.paper;return{crumb:[{title:"测试账号"+(b?"("+b.paperName+")":""),module:"paper",param:{action:"testAccount/list/index",paperId:a.getPaperId()}}]}}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Clazz,q=m.Str,r=m.Base,s=m.Limit,t=n.Input,u=n.Popup,v=a("../../../../../core/module"),w=a("../../../extend/bll/paper"),x=a("../../../../../action/paper"),y=c.exports=p.create();p.mix(y,v,{style:"/stylesheets/styles/system/importList.css",title:"修改测试账号信息",_template:['<div class="module-body">','<div class="import-add-people">','<div class="import-add-main js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getPaperId();return a.bodyEl=b.find("div.js-body"),c&&a.getId()?(a.renderWait(a.bodyEl,"加载中..."),void a.getPaper(function(){w.getSignUpFields(c,function(b){a.getUser(function(){return a.editUser.started?void a.renderWait(a.bodyEl,"该测试账号已经开始考试，无法修改测试账号信息"):(a.bodyEl.html(""),a.signUpFields=b,void a.initCpn())})})})):a.renderWait(b,"错误的参数")}},{name:"click .js-submit",handler:function(a){var b=this,c=o(a.currentTarget);s.mark(c)||b.submit(function(){s.clear(c)})}}]},{getPaper:d,getUser:e,initCpn:f,val:g,check:h,submit:i,getPaperId:j,getId:k,getCrumbConf:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/testAccount/list/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/selectAll","../../../../../component/table","../../../../../action/paper","../../../../../util/ajax","../../../extend/bll/paper","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../../../extend/bll/serverTime","../../../../../action/common","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price"],function(a,b,c){function d(){var a=this;a.selectAll=new z({change:function(b){a.listEl.find("td label.checkbox")[b?"addClass":"removeClass"]("checked")},toggle:function(b,c){a.listEl.find("tr[data-id="+b+"] label.checkbox")[c?"addClass":"removeClass"]("checked")}})}function e(){var a=this,b=!!a.paper.finished;a.infoEl.html(['<div class="import-tool clearfix">','<div class="import-census">','<div class="census-num">共有考生<span class="font-green js-user-count">0</span>人</div>','<div class="form-group js-page-count"><label class="control-label">每页显示</label><div class="control-group"></div></div>',"</div>",'<div class="import-tool-bar">',b?"":'<a class="link-green js-batch-add" href="javascript:void(0);"><i class="icon-user"></i>添加名单</a>','<a class="link-green js-batch-export" href="javascript:void(0);"><i class="icon-cloud-upload"></i>导出数据</a>',"</div>","</div>"].join("")),a.pageSelect=new v({renderTo:a.infoEl.find("div.js-page-count div.control-group"),autoWidth:!0,options:[{text:20,value:20},{text:50,value:50},{text:100,value:100}],change:function(){a.addParam({pageSize:this.val(),page:null}),a.renderList()}}),a.pageSelect.val(a.getParam().pageSize||20)}function f(a){var b=this;B.getPaper({type:"GET",params:{paperId:b.getPaperId()},statusCall:{1303:function(a){return b.renderWait(b.listEl,a.msg),!1}},call:function(c){b.paper=c.data,b.crumbTitle="测试账号("+b.paper.paperName+")",b.refreshCrumb(),a&&a()},error:function(a){b.renderWait(b.listEl,a.msg)}})}function g(a){var b=this;C.getSignUpFields(b.getPaperId(),function(c,d){return 0===c.length?b.renderWait(b.listEl,(d||{}).msg||"出现错误，请重试"):(b.signUpFields=c,void(a&&a()))})}function h(a){var b=this,c=b.getParam(),d={userType:1,page:c.page,pageSize:b.pageSelect.val()||20};B.getTestUsers({params:{paperId:b.getPaperId()},query:d,call:function(c){if(c.isOrder){var d=c.data,e=d.totalCount||0;b.infoEl.show().find("span.js-user-count").html(e),0===e&&b.renderNone(),e>0&&a&&a(d)}},error:function(a){b.renderWait(b.listEl,a.msg)}})}function i(){function a(a){var d={head:[{text:"",width:"2%",cls:"with-checkbox-select",style:{"text-align:":"left"}},t.map(g,function(a){return{text:a.title,width:30/g.length+"%"}}),{text:"考试链接"},{text:"生成日期",width:"15%"},{text:"状态",width:"10%"},{text:"操作",width:"15%"}],list:[]};t.forEach(a,function(a){var e=t.json(a.ext,{}),f=H;a.testUrl&&(f='<a href="'+a.testUrl+'" target="_blank">查看</a>&nbsp;&nbsp;',f+='<a href="javascript:void(0);" data-clipboard-text="'+a.testUrl+'" class="js-copy">复制</a>');var h=[{chk:!0,cls:"text-left"},t.map(g,function(b){var c="key"===b.name?"userKey":b.name;return r.trim(({userKey:1,name:1}[c]?a:e)[c])||H}),f,a.createTime?u.form(new Date(a.createTime)):"",b(a),{text:c(a.testStatus),cls:"table-btn"}];d.list.push({items:h,attr:{"data-id":a.id,"data-paperId":a.paperId}})}),h.html('<div class="js-select-tips"></div>'+A.getHtml(d)),t.forEach(h.find(".js-copy"),function(a){F.copy(a,function(){x.tips("复制成功")})})}function b(a){var b=a.testStatus;return 1===b?i.finished?"未到场":"未开始":2===b?"已打开":'<a href="'+f.getNavUrl("paper",{action:"candidate/result/index",testId:a.realTestId})+'" target="_blank">做题记录</a>'}function c(a){return i.finished?H:1!==a?['<a href="javascript:void(0);" class="icon-edit js-tips disabled" title="该考生已考试，无法进行此操作"></a>','<a href="javascript:void(0);" class="icon-trash js-tips disabled" title="该考生已考试，无法进行此操作"></a>'].join(""):['<a href="javascript:void(0);" class="icon-edit js-tips js-edit" title="修改"></a>','<a href="javascript:void(0);" class="icon-trash js-tips js-del" title="删除"></a>'].join("")}function d(a){new w({renderTo:h,current:a.currentPage,total:a.totalPage,pageChange:function(a){f.addParam({page:a}),f.renderList()}})}function e(a){var b=t.map(a.datas,function(a){return t.id(a.id)}),c=f.selectAll;h.find("th.with-checkbox-select").append(c.getEl()),c.refreshEl(),c.render(),c.tipsEl=h.find("div.js-select-tips"),c.loadPage(b,!0),c.changePageCount(a.totalPage),c.changeTotalCount(a.totalCount)}var f=this,g=(f.getEl(),f.signUpFields),h=f.listEl,i=f.paper;f.infoEl.hide(),f.renderWait(h),f.getUsers(function(b){f.pageData=b,a(b.datas),d(b),e(b)})}function j(){var a=this,b=['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">暂无数据</div>',"</div>"].join("");a.listEl.html(b)}function k(a){var b=r(a).closest("tr");return r.trim(b.attr("data-id"))}function l(a){var b=this;return a=t.id(a),t.find(b.pageData.datas,function(b){return t.id(b.id)===a})}function m(){var a=this;return t.id(a.getParam().paperId)}function n(){var a=this,b=a.selectAll;return b.isSelectAll||b.selectIds.length>0}function o(){var a=this,b=a.getWin(),c=a.selectAll,d={ids:c.selectIds,userType:1};d.isAll=c.isSelectAll?1:2,B.addDLTestUserForViewJob({params:{paperId:a.getPaperId()},body:d,call:function(c){var d,e=c.data;b.addTask({title:"[导出测试账号]"+r.trim(a.paper.paperName),waitTxt:"生成中...",okTxt:"已生成",getStatus:function(a,b){E.getTaskProgress(!1,e,function(c){var e=c.end,f=c.content,g=c.error,h=c.progress,i=e?g?1:0:2;b.okTxt=1===i?"失败":0===i?"点击下载":b.okTxt,d=0===i?f:d,a&&a(i,h)})},getResult:function(){return{type:1,data:d}}})},error:function(a){x.alert(a.msg)}})}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Clazz,t=p.Base,u=p.Time,v=(q.Input,q.AttachDate,q.Select),w=(q.Tips,q.Pager),x=q.Popup,y=a("../../../../../core/module"),z=a("../../../../../component/selectAll"),A=a("../../../../../component/table"),B=a("../../../../../action/paper"),C=a("../../../extend/bll/paper"),D=a("../../../extend/bll/money"),E=a("../../../extend/bll/task"),F=a("../../../../../util/util"),G=c.exports=s.create(),H="---";s.mix(G,y,{style:"/stylesheets/styles/system/importList.css",title:"测试账号",showTask:!0,_template:['<div class="module-box" style="padding:20px;">','<div style="background:#f1f1f1;padding:20px;">','<dl class="import-tips-words" style="margin-bottom:0;">',"<dt>重要提醒</dt>",'<dd style="color:#fe5000;">1.测试账号可以提前答题，请慎重添加，以防止试卷泄密；</dd>',"<dd>2.请按照提示要求录入账户信息，每张试卷可免费添加<strong>10</strong>个测试账号，超出的部分将按正常考生扣费；</dd>","<dd>3.测试账号不会被添加到考生名单，也不出现在成绩报表中；</dd>","<dd>4.测试账号在添加后30秒生效，请于30秒后再打开，即可进入试卷提前答题。</dd>","</dl>","</div>",'<div style="margin:20px 0;">','<div class="js-info"></div>','<div class="js-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.getPaperId();return a.infoEl=b.find(".js-info"),a.listEl=b.find(".js-body"),c?(a.renderWait(a.listEl),void a.getPaper(function(){a.getSignUpFields(function(){a.initInfo(),a.renderList()})})):a.renderWait(b,"错误的参数")}},{name:"click td label.checkbox",handler:function(a){var b=this,c=r(a.currentTarget),d=b.getLineId(c);d&&b.selectAll.toggle(d)}},{name:"click .js-batch-add",handler:function(){{var a=this;a.getWin().showLoading(),a.getPaperId()}a.nav("paper",{action:"testAccount/add/index",paperId:a.getPaperId()})}},{name:"click .js-batch-export",handler:function(){var a=this;return a.isSelected()?void a.addExportTask():x.alert("请先选择想批量导出的名单")}},{name:"click .js-edit",handler:function(a){var b=this,c=r(a.currentTarget),d=b.getLineId(c);b.nav("paper",{action:"testAccount/edit/index",paperId:b.getPaperId(),id:d})}},{name:"click .js-del",handler:function(a){var b=this,c=r(a.currentTarget),d=b.getLineId(c),e=b.getUserByLineId(d);if(e&&e.started)return x.alert("该考生已经开始考试，信息无法删除");1===e.apiRole?"该考生通过API创建，建议从自己的简历系统中删除该考生，是否继续删除":"确定将该考生从本场考试的计划名单中删除吗？";e&&C.delPaperUser({cond:{isAll:2,ids:d},paperId:b.getPaperId(),selectCount:1,needApiAlert:!0,apiRole:e.apiRole,call:function(){D.refreshMoney(),b.selectAll.clear(),b.renderList()}})}}]},{initialize:d,initInfo:e,getPaper:f,getSignUpFields:g,getUsers:h,renderList:i,renderNone:j,getLineId:k,getUserByLineId:l,getPaperId:m,isSelected:n,addExportTask:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/paper/util",["nc"],function(a,b,c){function d(a){var b=[],c=[],d=[],e=[];return j.forEach(a,function(a){return a=a||{},1===a.markCheat?b.push(a):a.faceNum>1?c.push(a):0===a.faceNum?d.push(a):void e.push(a)}),b.concat(c,d,e)}function e(a){return a=a||{},1===a.markCheat||a.faceNum>1||0===a.faceNum}function f(a,b){b=b||{};var c=(a||"").split(":"),d=i.trim(c[0]),e=i.trim(c[1]),f=i.trim(c[2])||b.type||"0",g=(c[3]||"").split("_"),h=i.trim(c[4])||b.edit||"0";return{name:d,format:e,type:f,options:g,isIpt:"0"===f,edit:h}}function g(a){var b=i.trim(a.name),c=i.trim(a.format),d=j.id(a.type)||"0",e=a.options||[],f=j.id(a.edit)||"0";return[b,c,d,"0"===d?"":e.join("_"),f].join(":")}var h=a("nc"),i=h.$,j=h.Base;c.exports={sortShotByDanger:d,isDanger:e,field2data:f,data2field:g}});
define("company/nowcoder/1.0.740/javascripts/site/main/purchase/index",["nc","cpn","../../../core/module","../../../util/util","../../../core/siteConfig","../../../action/purchase","../../../util/ajax"],function(a,b,c){function d(){var a=this;a.transType=0}function e(){function a(a){if(0===a.length)return f.html('<div style="font-size:14px;text-align:center;">没有数据</div>').show();var b,c='<table><tbody><tr><th width="350">时间</th><th width="260">金额</th><th width="280">备注</th></tr>';r.forEach(a,function(a){var d=new Date(a.createTime),e=t.form(d,"yyyy-MM")+"月";e!==b&&(c+='<tr class="month"><td colspan="3">'+e+"</td></tr>",b=e),c+=q.execTpl('<tr><td>#{time}</td><td><span class="#{color}">#{text}</span></td><td>#{note}</td></tr>',{time:t.form(d,"yyyy-MM-dd HH:mm:ss"),color:0===a.amount?"":a.amount>0?"font-green":"font-orange",text:a.amount,note:a.note})}),c+="</tbody></table>",f.html(c)}function b(a,b){b>1&&new x({renderTo:f,current:a,total:b,pageChange:function(a){c.addParam({page:a}),c.initListContent()}})}{var c=this,d=c.getEl(),e=d.find("div.js-purchase-pager"),f=d.find("div.js-purchase-list"),g=c.getParam(),h=+g.page||1;+g.type||0}c.renderWait(f),e.html("").hide(),z.getTransactions({params:{userId:c.getUserId()},query:{page:h,type:c.transType},call:function(c){var d=c.data;a(d.transactions),b(d.currentPage,d.totalPage)}})}function f(){function a(){var a=i.getUserByKey("invoiceAddress")||{};f.find("div.js-invoice-title").html(o.trim(a.title)),f.find("div.js-tax-num").html(o.trim(a.taxNumber)),f.find("div.js-invoice-email").html(o.trim(a.email)),f.find("div.js-invoice-name").html(o.trim(a.name)),f.find("div.js-invoice-phone").html(o.trim(a.phone)),k.children().hide(),f.show()}function b(){var a=i.getUserByKey("invoiceAddress")||{};l.title.val(o.trim(a.title)),l.taxNumber.val(o.trim(a.taxNumber)),l.email.val(o.trim(a.email)),l.name.val(o.trim(a.name)),l.phone.val(o.trim(a.phone)),k.children().hide(),g.show()}function c(){return{title:o.trim(l.title.val()),taxNumber:o.trim(l.taxNumber.val()),email:o.trim(l.email.val()),name:o.trim(l.name.val()),phone:o.trim(l.phone.val())}}function d(){var a=c(),b=!0;return a.title||(l.title.setErrorTips("请填写正确的发票抬头"),b=!1),a.taxNumber||(l.taxNumber.setErrorTips("请填写正确的税号"),b=!1),a.email&&q.isEmail(a.email)||(l.email.setErrorTips("请填写正确的接收邮箱"),b=!1),(!a.name||a.name.length<2)&&(l.name.setErrorTips("请填写正确的联系人"),b=!1),(!a.phone||a.phone.length<2)&&(l.phone.setErrorTips("请填写正确的联系电话"),b=!1),b}function e(){f=o(["<div>",'<div class="form-group">','<label class="control-label">发票抬头</label>','<div class="control-group js-invoice-title"></div>',"</div>",'<div class="form-group">','<label class="control-label">税号</label>','<div class="control-group js-tax-num"></div>',"</div>",'<div class="form-group">','<label class="control-label">接收邮箱</label>','<div class="control-group js-invoice-email"></div>',"</div>",'<div class="form-group">','<label class="control-label">联系人</label>','<div class="control-group js-invoice-name"></div>',"</div>",'<div class="form-group">','<label class="control-label">联系电话</label>','<div class="control-group js-invoice-phone"></div>',"</div>",'<a href="javascript:void(0);" class="btn btn-primary js-invoice-edit">修改</a>',"</div>"].join("")),k.append(f),g=o(["<div>",'<div class="form-group">','<label class="control-label">发票抬头</label>','<div class="js-invoice-title"><input type="text" placeholder="请输入公司名称或个人真实姓名"></div>',"</div>",'<div class="form-group">','<label class="control-label">税号</label>','<div class="js-tax-num"><input type="text" placeholder="请输入税号" /></div>',"</div>",'<div class="form-group">','<label class="control-label">接收邮箱</label>','<div class="js-invoice-email"><input type="text" placeholder="请输入接收邮箱" /></div>','<span class="icon-question-sign js-tips" data-theme="white" style="cursor:pointer;" data-title="电子发票将发送至此邮箱"></span>',"</div>",'<div class="form-group">','<label class="control-label">联系人</label>','<div class="js-invoice-name"><input type="text" placeholder="请输入联系人" /></div>',"</div>",'<div class="form-group">','<label class="control-label">联系电话</label>','<div class="js-invoice-phone"><input type="text" placeholder="请输入联系电话" /></div>',"</div>",'<a href="javascript:void(0);" class="btn btn-primary js-invoice-submit">确定</a>',"</div>"].join("")),k.append(g),l.title=v.transform(g.find(".js-invoice-title")),l.taxNumber=v.transform(g.find(".js-tax-num")),l.email=v.transform(g.find(".js-invoice-email")),l.name=v.transform(g.find(".js-invoice-name")),l.phone=v.transform(g.find(".js-invoice-phone"))}var f,g,h=this,i=h.getWin(),j=h.getEl(),k=j.find("div.js-invoice-body"),l={};e(),a(),k.on("click","a.js-invoice-edit",b),k.on("click","a.js-invoice-submit",function(){if(d()&&!s.mark(k)){var b=c();z.updateInvoice({type:"PUT",params:{userId:h.getUserId()},body:b,call:function(){w.tips("操作成功"),i.updateUser("invoiceAddress",b),a()},error:function(a){w.alert(a.msg)},always:function(){s.clear(k)}})}})}function g(){var a=this;z.getAccount({type:"GET",params:{userId:a.getUserId()},call:function(b){var c=r.isObject(b.data)?b.data:{},d="",e={contestCoupon:"笔试",interviewCoupon:"面试",resumeCoupon:"简历",smsCoupon:"短信",emailCoupon:"邮件"};r.forEach(e,function(a,b){var e=c[b];if(r.isObject(e)){var f=e.type;d+=["<li>","<span>",a,"折扣值：",(e.price||0).toFixed(1),"</span>",2===f||4===f?"<span>剩余折扣次数："+e.discountCount+"</span>":"",3===f||4===f?"<span>有效期："+t.form(new Date(e.validBeginTime))+" - "+t.form(new Date(e.validEndTime))+"</span>":"","</li>"].join("")}}),d&&(a.getEl(".js-discount-list").html(d),a.getEl(".js-discount-home").show())},error:function(b){a.renderWait(a.getEl(".js-discount-list"),b.msg)}})}function h(){var a=this,b=a.getWin(),c=b.getUserByKey("companyAccount")||{},d=c.availableInvoice||0;return a.money=c.money||0,a.realMoney=c.realMoney||0,a.availableInvoice=d||0,a.invoiceMoney=a.realMoney-a.availableInvoice,{money:c.money||0,realMoney:c.realMoney||0,availableInvoice:d||0,invoiceMoney:((c.realMoney||0)-(d||0)).toFixed(2),invoiceBtnStyle:d>0?"inline-block":"none"}}function i(){var a=this;z.getAccount({type:"GET",params:{userId:a.getUserId()},call:function(b){var c=b.data;a.money=c.money||0,a.realMoney=c.realMoney||0,a.availableInvoice=c.availableInvoice||0,a.renderData(c)}})}function j(a){var b=this,c=b.getEl();c.find("p.js-user-account").html("账户余额<span>"+(a.money||0)+"元</span>");var d=q.execTpl(['<div class="acc-total-info">已累计充值：<span>#{realMoney}</span>元</div>','<div class="acc-total-info">已开发票：<span>#{invoiceMoney}</span>元</div>','<div class="acc-total-info">可开发票：<span>#{availableInvoice}</span>元</div>','<a class="btn btn-primary js-invoice-btn" style="display:#{invoiceBtnStyle};" href="javascript:void(0);">开发票</a>'].join(""),{realMoney:a.realMoney||0,availableInvoice:a.availableInvoice||0,invoiceMoney:((a.realMoney||0)-(a.availableInvoice||0)).toFixed(2),invoiceBtnStyle:a.availableInvoice>0?"inline-block":"none"},!0);c.find("div.js-invoice-div").html(d)}function k(){var a=this,b=o("div.js-invoice-module");u.scrollToEl({scrollEl:a.getSysWinEl(),el:b,animation:!1}),u.highLight({el:b})}function l(a,b){var c=this,d=c.getWin();if(0===c.availableInvoice)return w.alert("您当前账户暂无金额可供开发票！");var e=d.getUserByKey("invoiceAddress")||{};return e.taxNumber&&e.email?(e.amount=c.availableInvoice,void w.confirm("根据本企业财务制度规定，每月发票的开具时间为1日-25日（含25日），25日后收到的发票申请顺延至下月月初开具，届时我们将为您开具电子发票，发送至您的接收邮箱。",function(){var a=q.execTpl(["发票开具信息：","发票金额：#{amount}","发票抬头：#{title}","发票税号：#{taxNumber}","接收邮箱：#{email}","联系人：#{name}","联系电话：#{phone}"].join("<br />"),e),d=w.confirm(a,function(){z.invoice({type:"POST",body:e,call:function(){w.tips("您已经成功申请发票，审核通过后将尽快开具电子发票（1日-25日当月开具，26日后顺延至下月月初开具），届时请注意查收邮件。",3e3),c.getAccount()},error:function(a){w.alert(a.msg),b&&b()}})}),f=d.getEl();f.find(".poptip-word").css("text-align","left"),f.find(".warning-ico").remove()})):w.alert("您的发票信息还未完善，发票开具后无法寄出，请先于发票设置模块完善信息后再申请开具吧！",function(){c.focusInvoiceInfo()})}var m=a("nc"),n=a("cpn"),o=m.$,p=m.Clazz,q=m.Str,r=m.Base,s=m.Limit,t=m.Time,u=m.Dom,v=n.Input,w=n.Popup,x=n.Pager,y=a("../../../core/module"),z=a("../../../action/purchase"),A=c.exports=p.create();p.mix(A,y,{style:"/stylesheets/styles/system/account.css",title:"账户详情",_template:["<div>",'<div class="module-box user-sum-box">','<div class="user-sum clearfix">','<a class="btn btn-primary js-recharge" href="javascript:void(0);">充值</a>','<p class="user-sum-num js-user-account">账户余额<span>#{money}元</span></p>',"</div>","</div>",'<div class="discount-info-box js-discount-home" style="display:none;">','<div class="discount-info">','<div class="discount-title">优惠信息</div>','<ul class="discount-list js-discount-list"></ul>',"</div>","</div>",'<div class="module-box">','<div class="module-head clearfix">',"<h1>交易记录</h1>",'<ul class="menu-txt clearfix">','<li class="js-deal-li selected">','<a href="javascript:void(0);" data-type="0">全部</a>',"</li>",'<li class="menu-pipe">|</li>','<li class="js-deal-li">','<a href="javascript:void(0);" data-type="1">充值</a>',"</li>",'<li class="menu-pipe">|</li>','<li class="js-deal-li">','<a href="javascript:void(0);" data-type="2">退款</a>',"</li>",'<li class="menu-pipe">|</li>','<li class="js-deal-li">','<a href="javascript:void(0);" data-type="3">消费</a>',"</li>","</ul>","</div>",'<div class="module-body">','<div class="js-purchase-list">','<div style="font-size:14px;text-align:center;">数据加载中...</div>',"</div>",'<div class="js-purchase-pager" class="display:none;"></div>','<div class="acc-total js-invoice-div">','<div class="acc-total-info">已累计充值：<span>#{realMoney}</span>元</div>','<div class="acc-total-info">已开发票：<span>#{invoiceMoney}</span>元</div>','<div class="acc-total-info">可开发票：<span>#{availableInvoice}</span>元</div>','<a class="btn btn-primary js-invoice-btn" style="display:#{invoiceBtnStyle};" href="javascript:void(0);">开发票</a>',"</div>","</div>","</div>",'<div class="module-box js-invoice-module">','<div class="module-head clearfix">',"<h1>发票设置</h1>","</div>",'<div class="module-body js-invoice-body"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getAccount(),a.initListContent(),a.initInvoice(),a.initDiscount()}},{name:"click a.js-recharge",handler:function(){var a=this;a.nav("purchase",{action:"recharge"})}},{name:"click .js-deal-li a",handler:function(a){function b(){var a=d.closest("ul").find("li");r.forEach(a,function(a){o(a).removeClass("selected")}),d.closest("li").addClass("selected")}var c=this,d=o(a.currentTarget),e=d.attr("data-type");c.transType=+e,c.addParam({page:1}),c.initListContent(),b()}},{name:"click a.js-invoice-btn",handler:function(){var a=this;a.gotoInvoice()}}]},{initialize:d,initListContent:e,initInvoice:f,initDiscount:g,gotoInvoice:l,_getData:h,renderData:j,getAccount:i,focusInvoiceInfo:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/purchase/recharge",["nc","cpn","../../../core/module","../../../util/util","../../../core/siteConfig","../../../action/purchase","../../../util/ajax"],function(a,b,c){function d(){var a=this;a.couponInfo={},a.purchasePrice=0,a.purchaseGiving=0}function e(){var a=this,b=a.getEl(),c=b.find("div.js-invoice-info");a.priceIpt=F.transform(b.find(".js-recharge-count"),{blur:function(){var b=a.valMoney();this.val(b||""),this.fire("change")}}),a.couponIpt=F.transform(b.find(".js-recharge-coupon")),a.invoiceTitleIpt=F.transform(b.find(".js-invoice-title")),a.invoiceAddressIpt=F.transform(b.find(".js-invoice-address")),a.invoiceNameIpt=F.transform(b.find(".js-invoice-name")),a.invoicePhoneIpt=F.transform(b.find(".js-invoice-phone")),a.useCouponChk=G.transform(b.find(".js-use-coupon")),a.sendInvoiceChk=G.transform(b.find(".js-send-invoice"),{change:function(){c[this.isChecked()?"show":"hide"](),a.renderPurchase()}})}function f(){function a(a,c){if(b.purchasePrice=+a||0,b.purchaseGiving=+c||0,b.renderPurchase(),!a)return e.html("").hide();var d="<span>";c>0&&(d+=" 赠"+c.toFixed(2)+"元"),d+=" 入账: "+(a+c).toFixed(2)+"元</span>",e.html(d).show()}var b=this,c=b.getEl(),d=c.find("div.js-price-info"),e=d.find("div.js-price-detail"),f=b.priceIpt;d.on("click","li.item",function(c){var d=u(c.currentTarget),e=d.attr("data-id"),g=b.getActivity(e);return g&&g.price>=0?(d.addClass("selected"),f.val(g.price),void a(g.price,g.originalPrice-g.price)):(f.val("").focus(),void a())});var g=A.frequency(100);f.listen("change",function(){g(function(){var c=b.getActivityByPrice(e),e=b.valMoney();c&&d.find("li.item[data-id="+c.id+"]").addClass("selected"),b.getGiving(e,function(c){var d=b.valMoney();e===d&&a(e,c)})})})}function g(){function a(){e.couponInfo;e.getCoupons(function(a){k=a||[],0!==a.length&&(d(k[k.length-1].id),j.checked(!0),j.fire("change"))})}function b(){var a=e.couponInfo;e.getCoupons(function(b){if(k=b||[],0===b.length)return void i.hide();var c="你有以下优惠劵可使用：";x.forEach(b,function(b){c+=w.execTpl('<span data-id="#{id}" class="#{cls}">#{discount}元</span>',{id:b.id,discount:b.discount,cls:a.id&&b.id===a.id?"selected":""},!0)}),i.html(c).show()})}function c(a){if(a&&0!==k.length)for(var b=0,c=k.length;c>b;b++)if(k[b].id===a)return k[b]}function d(a){var b=c(a);if(b)return e.couponInfo={id:b.id,discount:b.discount},j.fire("change"),e.renderPurchase(),!0}var e=this,f=e.getEl(),g=f.find("div.js-coupon-code"),h=f.find("div.js-coupon-detail"),i=f.find("div.discount-tags"),j=e.useCouponChk,k=[];a(),j.listen("change",function(){var a=e.couponInfo,c=!!this.isChecked();return g.hide(),h.hide(),i.hide(),c?(a.id?(h.html('<span class="discount-code">'+a.id+'</span><a href="javascript:void(0);" class="link-green">修改</a><span>可优惠'+a.discount+"元</span>"),h.show()):g.show(),void b()):(a.id&&e.couponIpt.val(),void(e.couponInfo={}))}),h.on("click","a.link-green",function(){h.hide(),g.show(),e.couponIpt.val(e.couponInfo.id),e.couponInfo={},b(),e.renderPurchase()}),g.on("click","button.btn-primary",function(){var a=e.couponIpt,b=u.trim(a.val());if(!b)return a.setErrorTips("优惠码不能为空");var c=d(b);!c&&a.setErrorTips("优惠券无效")}),i.on("click","span",function(a){var b=u(a.currentTarget);d(b.attr("data-id"))})}function h(a){function b(){new E({title:"充值",width:515,content:['<div style="padding:26px 0 70px;text-align:center;">','<a href="javascript:void(0);" class="btn btn-primary confirm-btn" style="margin-right:85px;">充值成功</a>','<a href="javascript:void(0);" class="btn btn-default cancle-btn">遇到问题</a>',"</div>"].join(""),hasNoFooter:!0,ok:function(){E.tips("操作成功",1500,function(){d.nav("purchase")})},cancel:function(){window.location.reload()}}),c()}function c(){var b=1e3;D.getOrderStatus({params:{id:a.id},query:{},call:function(a){var d=a.data;"FINISH"===d?E.tips("充值成功",function(){window.location.href=e}):"CLOSED"===d?(E.error("订单已关闭"),window.location.href=e):window.setTimeout(c,b)},error:function(){window.setTimeout(c,b)}})}var d=this,e=d.getNavUrl("purchase"),f=new E({title:"充值",width:515,content:w.execTpl(['<div style="padding:30px;text-align:center;">','<a style="width:340px;margin-bottom:20px;" href="#{href}" target="_blank" class="btn btn-primary confirm-btn">前往支付宝支付</a>','<a style="width:340px;margin-bottom:20px;" href="https://www.nowcoder.com/payment/wxpay/pay?orderId=#{orderId}" target="_blank" class="btn btn-primary confirm-btn">前往微信支付</a>',"</div>"].join(""),{href:a.url,orderId:a.id}),hasNoFooter:!0,ok:function(){f.close(),b()}})}function i(a){{var b=this;b.getWin()}return b._couponsList?a&&a(b._couponsList):void D.getCoupons({params:{userId:b.getUserId()},query:{itemType:C.couponType.cts},call:function(c){var d=x.filter(c.data,function(a){return!!a.valid});d.sort(function(a,b){return a.discount-b.discount}),b._couponsList=d,a&&a(d)}})}function j(a){for(var b=this,c=b.getWin(),d=c.getUserByKey("prices")||[],e=0,f=d.length;f>e;e++){var g=d[e];if(g.id+""===a)return g}}function k(a){var b=this,c=b.getWin();a=+a||0,c=b.getWin();for(var d=c.getUserByKey("prices")||[],e=0,f=d.length;f>e;e++){var g=d[e];if(g.price===a)return g}}function l(a,b){var c=this,d=c.getWin(),e=d.getUserByKey("prices")||[];if(a=+a,!a)return b&&b(0);var f=c._givingCache||{},g=a+"";if(c._givingCache=f,g in f)return b&&b(f[g]);for(var h=0,i=e.length;i>h;h++){var j=e[h];if(j.price===a)return f[g]=+(j.originalPrice-j.price).toFixed(0),b&&b(f[g])}D.getChargeActivity({params:{userId:c.getUserId()},query:{amount:a},call:function(a){var c=+(a.data||{}).giving||0;f[g]=c,b&&b(c)}})}function m(){var a=this,b=a.getEl(),c=b.find("div.js-purchase-detail"),d=b.find("a.js-purchase-submit"),e=a.isNeedPostage(),f=a.couponInfo,g=+a.purchasePrice||0,h=+(f||{}).discount||0,i=window.parseFloat(g-h+(e?I:0)).toFixed(2);if(0>=g)return c.hide(),void d.removeClass("btn-primary").addClass("btn-default");d.removeClass("btn-default").addClass("btn-primary");var j="<ul>";j+="<li>总金额：￥"+g.toFixed(2)+"</li>",j+=e?"<li>发票邮寄费：￥"+I+".00</li>":"",h>0&&(j+="<li>优惠劵抵扣：-￥"+h.toFixed(2)+"</li>"),j+="</ul>",j+='<div class="final-amount">应付金额：￥'+(0>i?0:i)+"</div>",c.html(j).show()}function n(){var a=this,b=a.getWin(),c=+a.purchasePrice||0,d=a.couponInfo||{},e=+d.discount||0,f=d.id||"",g={},h=(c-e+(a.isNeedPostage()?I:0)).toFixed(2);return g.itemType=C.couponType.cts,g.amount=h,g.coupon=f,g.needInvoice=!1,g.needInvoice&&(g.invoiceTitle=u.trim(a.invoiceTitleIpt.val()),g.invoiceAddress=u.trim(a.invoiceAddressIpt.val()),g.invoiceName=u.trim(a.invoiceNameIpt.val()),g.invoicePhone=u.trim(a.invoicePhoneIpt.val()),g.invoiceAmount=h),x.forEach(b.getUserByKey("prices"),function(a){c!==a.price&&(-1!==a.price||"itemId"in g)||(g.itemId=a.itemId)}),g}function o(){var a=this,b=u.trim(a.priceIpt.val()),c=Math.floor(+z.fix(b)||0);return Math.min(J,c)}function p(){{var a=this,b=a.val(),c=b.amount;+(a.couponInfo||{}).discount||0}if(0>=c)return void a.priceIpt.setErrorTips("请填写正确的充值金额");if(!b.itemId)return void E.alert("缺少价格id");if(b.needInvoice){var d=1;if(!b.invoiceTitle)return void a.invoiceTitle.setErrorTips("请填写正确的发票抬头");if(!b.invoiceAddress||b.invoiceAddress.length<d)return void a.invoiceAddressIpt.setErrorTips("请填写正确的邮寄地址");if(!b.invoiceName||b.invoiceName.length<d)return void a.invoiceNameIpt.setErrorTips("请填写正确的联系人");if(!b.invoicePhone||b.invoicePhone.length<d)return void a.invoicePhoneIpt.setErrorTips("请填写正确的联系电话")}return!0}function q(){var a=this,b=+a.purchasePrice||0,c=!!a.sendInvoiceChk.isChecked();return c&&500>b}function r(){var a=this,b=a.getWin(),c=b.getUserByKey("invoiceAddress")||{};return{discountList:"",invoiceTitle:c.title,invoiceAddress:c.address,invoiceName:c.name,invoicePhone:c.phone}}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Clazz,w=s.Str,x=s.Base,y=s.Limit,z=s.Num,A=s.Time,B=a("../../../core/module"),C=a("../../../core/siteConfig"),D=a("../../../action/purchase"),E=t.Popup,F=t.Input,G=t.CheckBox,H=c.exports=v.create(),I=20,J=99999999;v.mix(H,B,{style:"/stylesheets/styles/system/recharge.css",title:"充值",_template:['<div class="module-box">','<div class="module-body">','<div class="discount-wrap js-price-info">','<div class="form-group">','<label class="control-label">充值</label>','<div class="control-group js-recharge-count">','<input class="pay-input" type="text" />',"</div>",'<div class="discount-code-mod control-label js-price-detail" style="letter-spacing:normal;margin-left:10px;" style="display:none;"></div>',"</div>","</div>",'<div class="invoice-mod">','<div class="discount-item">','<label class="checkbox js-use-coupon">','<span class="icons"></span>使用优惠码',"</label>",'<div class="btn-group js-coupon-code">','<div class="control-group js-recharge-coupon"><input type="text" placeholder="请选择可用的优惠券" /></div>','<span class="input-group-btn"><button class="btn btn-primary">确定</button></span>',"</div>",'<div class="discount-code-mod js-coupon-detail"></div>',"</div>",'<div class="discount-tags" style="display:none;"></div>','<div style="font-size:14px;">',"*如需开具发票，请在充值完成后，去账户详情下方进行开发票操作，我们将为您开具电子发票","</div>",'<div class="js-invoice-info" style="display:none;">','<div class="form-group">','<label class="control-label">发票抬头</label>','<div class="control-group js-invoice-title"><input value="#{invoiceTitle}" type="text" placeholder="请输入公司名称或个人真实姓名" /></div>',"</div>",'<div class="form-group">','<label class="control-label">邮寄地址</label>','<div class="control-group js-invoice-address"><input value="#{invoiceAddress}" type="text" placeholder="请输入邮寄地址" /></div>',"</div>",'<div class="form-group">','<label class="control-label">联&nbsp;&nbsp;系&nbsp;&nbsp;人</label>','<div class="control-group js-invoice-name"><input value="#{invoiceName}" type="text" placeholder="请输入收件人" /></div>',"</div>",'<div class="form-group">','<label class="control-label">联系电话</label>','<div class="control-group js-invoice-phone"><input value="#{invoicePhone}" type="text" placeholder="请输入联系电话" /></div>',"</div>","</div>","</div>",'<div class="amount-detail">','<div class="js-purchase-detail"></div>','<a href="javascript:void(0);" class="btn btn-default js-purchase-submit">提交订单</a>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}a.initComponent(),a.initPriceAction(),a.initCouponAction(),a.useCouponChk.fire("change")}},{name:"click .js-purchase-submit",handler:function(a){var b=this,c=u(a.currentTarget);b.checkVal()&&(y.mark(c)||D.order({body:b.val(),call:function(a){var c=a.data;c.url?b.initPayAction(c):E.tips("操作成功",1500,function(){b.nav("purchase")})},always:function(){y.clear(c)}}))}}]},{initialize:d,initComponent:e,initPriceAction:f,initCouponAction:g,initPayAction:h,getCoupons:i,getActivity:j,getActivityByPrice:k,getGiving:l,renderPurchase:m,val:n,valMoney:o,checkVal:p,isNeedPostage:q,_getData:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/inOutCase/caseItem",["nc","cpn","../optionEditor","../../../../util/util","../../../../../../../../component/steps","../../../../../../../../core/siteConfig","../../../../../../../../action/tag","../../../../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;return b[0===arguments.length?"getVal":"setVal"](a)}function e(){var a=this,b=["input","output","note"],c={};return s.forEach(b,function(b){c[b]=a.getData("cpn-val-"+b)}),c}function f(a){var b=this,c=["input","output","note"],d=b.getData("is-edit");a=s.isObject(a)?a:{},s.forEach(c,function(c){b.setData("cpn-val-"+c,d?v.decodeHTML(a[c]||""):a[c]||""),b.renderVal(c)})}function g(){var a=this,b=a.rawConfig,c=["input","output","note"];a.setData("is-edit",b.isEdit),s.forEach(c,function(b){a.setData("cpn-val-"+b,"")})}function h(){var a=this;a.initTextarea()}function i(){var a=this,b=a.getEl(),c=["input","output","note"];s.forEach(c,function(c){var d;if("note"===c)d=new z({renderTo:b.find(".js-"+c),mode:"code",listeners:{draftChange:function(){var b=this.val();a.setData("cpn-val-"+c,b),a.fire("change")}}});else{var e=b.find(".js-"+c);d=new x({renderTo:e,type:"textarea",listeners:{render:function(){var a=this.getEl();a.outerWidth(e.width()),this.inputEl.outerWidth(a.width()),u.txtAutoHeight({el:this.inputEl})},change:function(){var b=this.val(),d=a.getData("cpn-val-"+c);b!==d&&(a.setData("cpn-val-"+c,b),a.fire("change",{needVerify:!0}))}}})}a.setData("cpn-"+c,d)})}function j(){var a=this,b=a.getEl(),c=["input","output","note"];s.forEach(c,function(c){var d=b.find(".js-"+c),e=d[0].offsetLeft,f=a.rawConfig.parent.getEl().width(),g=f-e-22;d.outerWidth(g)})}function k(){var a=this,b=!0;s.forEach(["input","output"],function(c){var d=a.getData("cpn-val-"+c);s.forEach(d,function(a){return b=b&&/[\u0020-\u007E\n]/.test(a),b||s.BREAK})}),a.setData("show-code-warning",!b),a.renderShow("code-warning")}function l(a){var b=this,c=b.getData("cpn-val-"+a),d=b.getData("cpn-"+a);d.val(c)}function m(a){var b=this;b.setData("show-trash",a),b.getEl(".js-trash")[a?"show":"hide"]()}function n(a){var b=this,c=b.getData("show-"+a);b.getEl(".js-"+a)[c?"show":"hide"]()}function o(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function p(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var q=a("nc"),r=a("cpn"),s=q.Base,t=(q.$,q.Clazz),u=q.Dom,v=q.Str,w=q.Component,x=r.Input,y=r.Popup,z=a("../optionEditor"),A=c.exports=t.create();t.mix(A,w,{_template:['<div style="padding-top:10px;">','<div class="inout-hd">输入输出样例 ','<a class="icon-trash js-trash" style="display:none;"></a>','<span class="code-warning js-code-warning" style="display:none;">','<i class="icon-exclamation-sign"></i>不同编程语言对中文的编码可能不一致，建议用例不要包含中文',"</span>","</div>",'<div class="inout-bd">','<div class="form-group inline-group">','<label class="control-label">输入样例</label>','<div class="js-input" style="display:inline-block;"></div>',"</div>",'<div class="form-group inline-group">','<label class="control-label">输出样例</label>','<div class="js-output" style="display:inline-block;"></div>',"</div>",'<div class="form-group inline-group">','<label class="control-label">说明</label>','<div class="js-note" style="display:inline-block;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initStyle(),a.initCpns()}},{name:"click .js-trash",handler:function(){var a=this;y.confirm("确认删除本组测试样例吗？",function(){a.fire("clickTrash")})}},{name:"change",type:"custom",handler:function(){var a=this;a.checkCode()}}]},{val:d,getVal:e,setVal:f,initData:g,initCpns:h,initTextarea:i,initStyle:j,checkCode:k,renderVal:l,renderTrash:m,renderShow:n,getData:o,setData:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/inOutCase/index",["nc","cpn","./caseItem","../optionEditor","../../../../util/util","../../../../../../../../component/steps","../../../../../../../../core/siteConfig","../../../../../../../../action/tag","../../../../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;return b[0===arguments.length?"getVal":"setVal"](a)}function e(){var a=this,b=a.getData("cpn_caseItems"),c=[],d=[];return r.forEach(b,function(a){var b=a.val();(b.input||b.output)&&d.push(a)}),r.forEach(d,function(a,b){var d=a.val(),e=r.extend(d,{index:++b});c.push(e)}),c}function f(a){var b=this;a=r.isArray(a)?a:[],b.setData("inOutCase",a),b.initCaseItems()}function g(){}function h(){var a=this;a.setData("cpn_caseItems",[])}function i(){}function j(){var a=this,b=a.getData("inOutCase");b=0===b.length?[{}]:b,a.clearCase(),r.forEach(b,function(b){var c=a.addCaseItem();c.val(b)})}function k(){var a=this,b=a.getData("cpn_caseItems"),c=new u({renderTo:a.getEl(".js-item"),parent:a,listeners:{clickTrash:function(){a.delCaseItem(this)},change:function(b){a.fire("change",b||{})}}});return b.push(c),a.renderTrash(),c}function l(a){var b=this,c=b.getData("cpn_caseItems"),d=r.indexOf(c,a);c.splice(d,1),a.destroy(),b.renderTrash(),b.fire("change")}function m(){var a=this,b=a.getData("cpn_caseItems"),c=b.length>1;r.forEach(b,function(a){a.renderTrash(c?!0:!1)})}function n(){var a=this,b=a.getData("cpn_caseItems");r.forEach(b,function(b){a.delCaseItem(b)})}function o(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function p(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var q=a("nc"),r=(a("cpn"),q.Base),s=(q.$,q.Clazz),t=q.Component,u=a("./caseItem"),v=c.exports=s.create();s.mix(v,t,{_template:['<div class="inout-wrap">','<div class="js-item"></div>','<div class="inout-ft">','<a href="javascript:void(0);" class="js-add-item"><i class="icon-plus-sign"></i> 新增样例</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns()}},{name:"click .js-add-item",handler:function(){var a=this;a.addCaseItem()}}]},{val:d,getVal:e,setVal:f,initialize:g,initData:h,initCpns:i,initCaseItems:j,addCaseItem:k,delCaseItem:l,renderTrash:m,clearCase:n,getData:o,setData:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/option",["nc","./optionEditor","../../../util/util","cpn","../../../../../../../component/steps","../../../../../../../core/siteConfig","../../../../../../../action/tag","../../../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;b.isRadio=!!a.isRadio}function e(){var a=this,b=a.getEl();a.editor=new o({renderTo:b.find(".js-option-txt"),listeners:{draftChange:function(){a.fire("change")}}})}function f(a){var b=this,c=b.getEl();c.find(".js-del-option")[a===!1?"hide":"show"]()}function g(a){{var b=this;b.getEl()}a=a!==!1,b.isRadio=a,b.chkEl.removeClass(a?"checkbox":"radio").addClass(a?"radio":"checkbox")}function h(a){var b=this;b.chkEl[a===!1?"removeClass":"addClass"]("checked")}function i(){var a=this;return a.chkEl.hasClass("checked")}function j(a){{var b=this;b.getEl()}return 0===arguments.length?{right:b.isChecked(),content:b.editor.val()}:(b.check(a.right===!0),void b.editor.val(a.content))}function k(a){var b=this,c=a<p.length?p[a]:"";b.orderEl.html(c)}var l=a("nc"),m=(l.$,l.Clazz),n=l.Component,o=(l.Base,l.Str,a("./optionEditor")),p="ABCDEFGHIJKLMNOPQRSTUVWXYZ",q=c.exports=m.create();m.mix(q,n,{_template:['<div class="bs-option-item js-option">','<label class="js-label">','<span class="icons"></span>','<span class="bs-option-num js-order">A</span>',"</label>",'<div class="form-editor w800 js-option-txt"></div>','<a href="javascript:void(0);" class="icon-trash js-del-option" title="删除"></a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.orderEl=b.find(".js-order"),a.chkEl=b.find("label.js-label"),a.initEditor()}},{name:"destroy",type:"custom",handler:function(){var a=this;a.editor.destroy()}},{name:"click .js-del-option",handler:function(){var a=this;a.fire("del")}},{name:"click .js-label",handler:function(){var a=this;a.fire("check")}}]},{initialize:d,initEditor:e,showDel:f,radio:g,check:h,isChecked:i,val:j,order:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/optionEditor",["nc","../../../util/util","cpn","../../../../../../../component/steps","../../../../../../../core/siteConfig","../../../../../../../action/tag","../../../../../../../util/ajax"],function(a,b,c){function d(a){var b=this,c=b.rawConfig,d=b.getEl(),e=d.find(".js-editor"),f=b.editor=new a({renderTo:e,hasNoToolbar:!0,noCodeSelect:!0,noToolbarFixed:!0,width:d.width()-4,height:c.height||40,keConf:n.getKeTinyConf(),draftChange:function(){b.fire("draftChange")}});b.editor.keEditor.indentChar="",f.waitCreated(function(){e.css("visibility","visible").css("height","auto").css("overflow-y","auto"),f.autoHeight()})}function e(){var a,b=this,c=b.getEl(),d=c.find(".js-tips");c.on("mouseenter",function(){window.clearTimeout(a),d.show()}).on("mouseleave",function(){window.clearTimeout(a),a=window.setTimeout(function(){d.hide()},100)})}function f(a){var b=this,c=b.rawConfig,d="code"===c.mode;if(0===arguments.length){a=b.editor.val();var e=/<b>|<strong>/gi.test(a),f=/<pre/gi.test(a),g=/<img/gi.test(a),h=/<sub/gi.test(a),i=/<sup/gi.test(a);if(g||h||i||d&&e||!d&&f)a=a.replace(/\n+/gi,"");else{a=b.editor.text(),a=a.replace(/^\n+|\n+$/g,""),a=a.replace(/\n{2,}/g,"\n\n");var k=m.map(a.split(/\n/),function(a){return j.trim(a)});a=k.join("<br>")}return a}b.editor.val(a)}function g(){var a=this;return a.editor.text.apply(a.editor,arguments)}function h(a){var b=(a.mode,'<span class="ke-outline" title="插入图片" data-name="image"><span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-image" style="cursor:pointer;"></span></span>'),c='<span class="ke-outline" title="下标" data-name="subscript"><span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-subscript" style="cursor:pointer;"></span></span>',d='<span class="ke-outline" title="上标" data-name="superscript"><span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-superscript" style="cursor:pointer;"></span></span>',e='<span class="ke-outline" title="插入公式" data-name="math"><span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-math" style="cursor:pointer;"></span></span>';return{action:[b,c,d,e].join("")}}var i=a("nc"),j=i.$,k=i.Clazz,l=i.Component,m=i.Base,n=(i.Str,i.Html,a("../../../util/util")),o=c.exports=k.create();k.mix(o,l,{_template:['<div style="position:relative;">','<div class="js-editor" style="visibility:hidden;height:40px;overflow-y:hidden;"></div>','<div class="js-tips tooltip bottom tooltip-info editer-tip-tool ke-container-nowcoder" style="position:absolute;background:none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">#{action}</div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;n.getHEditor(function(b){a.initEditor(b),a.initTips()})}},{name:"click .ke-outline",handler:function(a){var b=this,c=b.editor,d=j(a.currentTarget),e=j.trim(d.attr("data-name"));e&&c&&c.waitCreated(function(){var b=c.keEditor.toolbar;b.options.click.call(this,{stop:function(){a.preventDefault()}},e)})}}]},{initEditor:d,initTips:e,val:f,text:g,_getData:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/testCase/index",["nc","cpn","../../../../../../../../component/table","../../../../../../../../component/selectAll","../../../../../../../../util/util","../../../../../../../../core/siteConfig","../../../../../../../../action/paper","../../../../../../../../util/ajax","../../../../../../extend/bll/task","../../../../../../extend/bll/base","../../../../../../../../action/api","../../../../../../../../util/uploadOss","ncOss","../../../../../../../../action/common","../../../../util/util","../../../../../../../../component/steps","../../../../../../../../action/tag","./popupEditSample","./popupSampleSetting"],function(a,b,c){function d(a){var b=this;if(0===arguments.length)return{samplePackUrl:b.getData("url-sample-pack")||"",sampleCount:b.getData("count-sample")||0,sample:b.getData("sample"),checkerFileName:b.checkerFileName||"",setting:b.setting||{deleteBlankLine:!0,autoDeleteSpace:!0}};a=a||{};var c=z.isArray(a.sample)?a.sample:[];z.forEach(c,function(a){z.isObject(a)&&delete a.index}),b.setData("url-sample-pack",a.samplePackUrl),b.setData("count-sample",b.getAbsInt(a.sampleCount)),b.setData("sample",c),b.checkerFileName=a.checkerFileName,b.setting=a.setting,b.refreshRender()}function e(){var a=this,b=a.rawConfig;a.setData("url-upload",I.getUploadUrl(J.uploadType.file)),a.setData("warning-info",[]),a.setData("sample",[]),a.setData("is-edit",b.isEdit)}function f(){var a=this;a.renderWarning(),a.renderTable(),a.renderTableCaseSize()}function g(){var a=this;a.updateWarningMsg(),a.renderHtml("warning-msg"),a.getEl(".js-warning-msg")[a.getData("warning-msg")?"show":"hide"]()}function h(){var a=this,b=a.getData("count-sample"),c={head:[{text:"序号",style:{"text-align":"center"}},{text:"输入",style:{"text-align":"center"}},{text:"输出",style:{"text-align":"center"}},{text:"操作",style:{"text-align":"center"}}],list:[],footer:[{text:'<a href="javascript:void(0);" class="link-green js-add-sample" style="margin-right:10px;"> + 单个添加</a><a href="javascript:void(0);" class="link-green js-popup-pack"> <i class=" icon-upload-alt"></i>'+(b?"全部替换":"批量上传")+"</a>",attr:{colspan:4}}]};z.forCount(b,function(a){var b=[a+1,['<a href="javascript:void(0);" style="margin-right:10px;" title="下载" class="js-download-sample" data-index="',a,'" data-type="in">',a+1,".in</a>",'<div class="js-hover" style="display:inline-block;"><a href="javascript:void(0);" class="js-upload-sample link-green" data-index="',a,'" data-type="in">重新上传</a></div>','<span class="js-in-case-size js-in-case-size-',a,'" style="margin-left:10px;"></span>'].join(""),['<a href="javascript:void(0);" style="margin-right:10px;" title="下载" class="js-download-sample" data-index="',a,'" data-type="out">',a+1,".out</a>",'<a href="javascript:void(0);" class="js-upload-sample link-green" data-index="',a,'" data-type="out">重新上传</a>','<span class="js-out-case-size js-out-case-size-',a,'" style="margin-left:10px;"></span>'].join(""),['<a href="javascript:void(0);" class="icon-edit js-edit-sample" data-index="',a,'" style="margin-right:10px;"></a><a href="javascript:void(0);" class="icon-trash js-del-sample" data-index="',a,'"></a>'].join("")];c.list.push({items:b})}),a.getEl(".js-sample").html(G.getHtml(c)),a.updateUploadBtn()}function i(){var a=this;a.getCaseSize(function(b){z.forEach(b,function(b,c){var d=c.split("."),e=d[0]-1,f=d[1];a.renderCaseSize(e,f,b)})})}function j(){var a=this,b=a.getEl(),c=H.uploadDataFileUrl(),d=a._uploadBtnCpn=a._uploadBtnCpn||[];z.forEach(d,function(a){a&&a.destroy()}),d.length=0,z.forEach(b.find(".js-upload-sample"),function(b){b=A(b);var e=b.attr("data-type"),f=b.attr("data-index"),g=E.show({target:b,url:c,extData:a.val().setting,fileType:["*."+e,"out"===e?"*.ans;*.a":""].join(";"),call:function(b){g.rawConfig.url=c;var d=b.data||{},h=a.getData("sample"),i=a.getData("warning-info"),j=h[f]=h[f]||{};j[e+"Url"]=d.url,i[f]=d.containChinese,a.renderCaseSize(f,e,d.size),F.tips("上传成功！",function(){a.fire("change")})},error:function(b,c){a._fixUploadSpaceError(g,c,b)}});a.pushChild(g),d.push(g)})}function k(a){function b(b){var d=c.getData("count-sample"),f=c.getData("sample"),g=c.getData("warning-info");c.setData("count-sample",d-1),b.url&&c.setData("url-sample-pack",b.url),f.splice(a,1),g.splice(a,1),e&&e.close(),F.tips("操作成功",function(){c.refreshRender(),c.fire("change",{deleted:!0})})}var c=this,d=c.getData("url-sample-pack");if(!A.trim(d))return void b({});var e=F.mask("删除中...");H.deleteCaseJob({type:"DELETE",body:{dataFileUrl:c.getData("url-sample-pack"),deleteCaseIndex:+a+1},call:function(a){K.getTaskProgress(!0,a.data,function(a){var c=a.content;return a.error?(e.close(),void F.alert(c)):void(a.end&&(e.close(),b(z.json(c))))})},error:function(a){F.alert(a.msg)}})}function l(a,b){var c=this,d=c.getData("sample"),e=d[b]||{},f=c.getData("warning-info"),g=1===+a;N.show({samplePackUrl:c.getData("url-sample-pack"),index:g?b:c.getData("count-sample"),inUrl:e.inUrl,outUrl:e.outUrl,type:a,updateData:function(a){a=z.isObject(a)?a:{};var b=c.getData("count-sample");d[a.index]={inUrl:a.inUrl,outUrl:a.outUrl},f[a.index]=a.needWarning,c.renderWarning(),c.setData("count-sample",g?b:b+1),c.renderCaseSize(a.index,"in",a.inSize),c.renderCaseSize(a.index,"out",a.outSize),c.fire("change"),g||c.renderTable()},listeners:{popupPack:function(){c.popupPack()}}})}function m(){function a(a){var c=window.win,d=b.val().setting;H.uploadOnlineUrlDataFileJob({body:{url:a,autoDeleteSpace:d.autoDeleteSpace,deleteBlankLine:d.deleteBlankLine},call:function(a){c.showLoading("文件处理中，请稍等..."),K.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;if(f)c.showLoading(!1),F.alert(e);else if(d){c.showLoading(!1);var g=[];F.tips("上传成功！");var h=JSON.parse(e);b.checkerFileName=h.checkerFileName,b.setData("count-sample",h.caseCount),b.setData("url-sample-pack",h.url),b.setData("sample",[]),z.forEach(h.containChineseCases,function(a){g[a-1]=!0}),b.setData("warning-info",g),b.refreshRender(),b.fire("change")}})},error:function(a){F.alert(a.msg)}})}var b=this,c=new F({title:"测试数据压缩包上传说明",content:b.getPopupPackHtml(),hasNoFooter:!0}),d=E.show({target:c.getEl(".js-real-upload"),fileType:"*.zip",getFileTypeTips:function(){return'文件类型不正确，支持的类型：zip  ，建议使用<a href="https://sparanoid.com/lab/7z/" class="link-green" target="_blank">7-Zip</a>压缩成zip格式'},getUpload:function(a){var b=z.id(window.host||{}.cloudServer)||"0";return L.getAttachUpload({type:"0"===b?"ali":"tx",context:this,file:a})},call:function(b){a(b.data)},error:function(a){F.alert(a.msg)}});c.pushChild(d),c.getEl(".js-download-all").on("click",function(){b.downloadSample()})}function n(){var a=this,b=['<div class="pop-mod-set" style="overflow-y:hidden;">','<div class="pop-test-mod">','<p style="text-align:left;line-height:25px;">1.输入文件请以.in为后缀，输出文件请以.out、.ans或.a为后缀</p>','<p style="text-align:left;line-height:25px;">2.同一组测试用例，输入输出文件名必须一致，例：1.in 和1.out、1.ans或1.a</p>',a.getData("is-edit")?'<p style="text-align:left;line-height:25px;">点击<a href="javascript:void(0);" class="js-download-all link-green">下载列表中的测试数据</a>编辑后重新上传即可</p>':'<p style="text-align:left;line-height:25px;">点击<a href="javascript:void(0);" class="js-download-all link-green">下载上传模板</a>（模板以求a+b的和为例），编辑后重新上传即可</p>','<a href="javascript:void(0);" class="btn btn-primary js-real-upload">压缩包上传</a>',"</div>","</div>"].join("");return b}function o(){var a=this,b=a.getData("warning-info"),c=[],d=0;z.forEach(b,function(a,e){if(!a||e===b.length-1){var f=e-d+Number(!!a);1===f?c.push(d+1):2===f?c=c.concat([d+1,d+2]):f>2&&c.push([d+1,"-",d+f].join("")),d=e+1}});var e=0===c.length?"":["测试用例",c.join("、"),"包含中文字符"].join("");a.setData("warning-msg",e)}function p(a){var b=this,c=M.getDataFile(b.getData("url-sample-pack"));c&&H.getCaseSize({timeout:12e4,query:{dataFile:c},call:function(b){z.isFunction(a)&&a(b.data||{})},error:function(a){F.alert(a.msg)}})}function q(a,b,c){var d=this;d.getEl(".js-"+b+"-case-size-"+a).html(D.byte2Size(c))}function r(a){var b=this,c=b.getData(a);b.getEl(".js-"+a).html(c)}function s(a,b){var c=this,d=c.getData("sample")||[],e="";e=A.trim(a)&&b?d[a]&&d[a][b+"Url"]?d[a][b+"Url"]:H.downloadCaseFileV2Url({query:{name:A.trim(a)&&b?[a+1,b].join("."):void 0,dataUrl:c.getData("url-sample-pack")}}):c.getData("is-edit")?c.getData("url-sample-pack"):P,window.open(e,"_blank")}function t(a){return Math.abs(parseInt(+a||0,10))}function u(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function v(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function w(a,b,c){var d=c.msg;if(b&&d&&/有空格/.test(d)){a._popupTips&&a._popupTips.close();var e=F.alert(d+'，<a href="javascript:void(0);" class="js-auto-del js-close-popup link-green">点击自动删除空格，并继续上传</a>');e.getEl(".js-auto-del").on("click",function(){a.rawConfig.url=H.uploadDataFileWithAutoDelSpaceUrl(),a.upload(b)})}}var x=a("nc"),y=a("cpn"),z=x.Base,A=x.$,B=x.Clazz,C=x.Component,D=x.Num,E=(x.Uri,x.Str,y.AttachUpload),F=y.Popup,G=a("../../../../../../../../component/table"),H=a("../../../../../../../../action/paper"),I=a("../../../../../../../../util/util"),J=a("../../../../../../../../core/siteConfig"),K=a("../../../../../../extend/bll/task"),L=a("../../../../../../../../util/uploadOss"),M=a("../../../../util/util"),N=a("./popupEditSample"),O=a("./popupSampleSetting"),P="https://uploadfiles.nowcoder.com/ojdata/c6c7c87c27424b949cc4211224920ff0.zip",Q=c.exports=B.create();B.mix(Q,C,{_template:['<div class="form-group">','<label class="control-label">测试用例 ','<span class="icon-exclamation-sign code-warning js-warning-msg"></span>','<a href="javascript:void(0);" class="test-mod-setting js-popup-sample-setting"><i class="icon-cog"></i>更多设置</a>',"</label>",'<div class="js-sample"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}},{name:"click .js-download-sample",handler:function(a){var b=this,c=A(a.currentTarget),d=+c.attr("data-index"),e=c.attr("data-type");b.downloadSample(d,e)}},{name:"click .js-popup-pack",handler:function(a){var b=this;b.popupPack(a)}},{name:"click .js-edit-sample",handler:function(a){var b=this,c=A(a.currentTarget).attr("data-index");b.editItem(1,c)}},{name:"click .js-add-sample",handler:function(){var a=this;a.editItem(0)}},{name:"click .js-del-sample",handler:function(a){var b=this,c=A(a.currentTarget).attr("data-index");b.delItem(c)}},{name:"click .js-popup-sample-setting",handler:function(){var a=this;O.show({val:a.val().setting,listeners:{ok:function(b){a.setting=b.val,z.forEach(a._uploadBtnCpn,function(b){z.extend(b.rawConfig.extData,a.setting)}),a.fire("change",b)}}})}}]},{val:d,initData:e,refreshRender:f,renderWarning:g,renderTable:h,renderTableCaseSize:i,updateUploadBtn:j,delItem:k,editItem:l,popupPack:m,getPopupPackHtml:n,updateWarningMsg:o,getCaseSize:p,renderCaseSize:q,renderHtml:r,downloadSample:s,getAbsInt:t,setData:u,getData:v,_fixUploadSpaceError:w})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/testCase/popupEditSample",["nc","cpn","../../../../../../../../util/util","../../../../../../../../core/siteConfig","../../../../../../../../action/paper","../../../../../../../../util/ajax"],function(a,b,c){function d(a){var b=new E(a);b.popup=A.wrap(b,{title:"测试用例",content:b.html(),width:800,height:360,okTxt:"保存",ok:function(){return b.save()},cancel:function(){}})}function e(){}function f(){var a=this,b=x.isObject(a.rawConfig)?a.rawConfig:{};a.setData("conf",b),a.setData("index",a.getAbsInt(b.index)),a.setData("type",void 0===b.type?0:+b.type),a.setData("url-in",b.inUrl),a.setData("url-out",b.outUrl),a.setData("url-sample-pack",b.samplePackUrl),a.setData("cpn-val-input",""),a.setData("cpn-val-output","")}function g(){var a=this;a.initTextarea()}function h(){var a=this,b=["input","output"];x.forEach(b,function(b){var c=new B({renderTo:a.getEl(".js-"+b),renderBy:"html",type:"textarea",listeners:{change:function(){var c=this.val(),d="cpn-val-"+b;a.setData(d,c),a.fire("change",d)}}});a.setData("cpn-"+b,c)})}function i(){var a=this,b=a.getData("type");return 0===b?void a.switchContent("main"):void(1===b&&a.getContent(function(){a.renderVal(),a.switchContent("main")}))}function j(a){var b=this,c=b.getData("index");b.tip("加载中..."),D.parseCaseContent({timeout:12e4,query:{dataUrl:b.getData("url-sample-pack"),caseIndex:c+1,inUrl:b.getData("url-in"),outUrl:b.getData("url-out")},call:function(c){var d=x.isObject(c.data)?c.data:{};b.setData("cpn-val-input",d.input),b.setData("cpn-val-output",d.output),x.isFunction(a)&&a()},error:function(a){b.tip(a.msg,x.bind(b.getContent,b))}})}function k(){var a=this,b=["input","output"];x.forEach(b,function(b){var c=a.getData("cpn-val-"+b),d=a.getData("cpn-"+b);d.val(c)})}function l(){var a=this;return a.checkLength()?(a.checkCode(),a.uploadSample(function(){a.popup.close(),A.tips("保存成功",function(){var b=a.getData("conf"),c=a.getData("url-sample");x.isFunction(b.updateData)&&b.updateData({index:a.getData("index"),inSize:c.inSize,outSize:c.outSize,inUrl:c.inUrl,outUrl:c.outUrl,needWarning:a.getData("need-warning")})})}),!0):!0}function m(){var a=this,b=!0,c="",d=1e3,e=[{key:"input",name:"输入"},{key:"output",name:"输出"}];return x.forEach(e,function(e){var f=a.getData("cpn-val-"+e.key),g=1;return f?(x.forEach(f,function(a){"\n"===a&&g++}),g>d?(b=!1,c=["测试用例",e.name,"数据过大，不支持在线编辑，","已超出",g-d,"行"].join(""),x.BREAK):void 0):(b=!1,c="输入和输出均不能为空！",x.BREAK)}),b||A.alert(c),b}function n(){var a=this,b=!0;x.forEach(["input","output"],function(c){var d=a.getData("cpn-val-"+c);x.forEach(d,function(a){return b=b&&/[\u0020-\u007E\n]/.test(a),b||x.BREAK})}),a.setData("need-warning",!b)}function o(a){var b=this,c=b.popupMask("保存中...");D.uploadCaseContent({type:"POST",body:{input:b.getData("cpn-val-input"),output:b.getData("cpn-val-output")},call:function(c){var d=x.isObject(c.data)?c.data:{};b.setData("url-sample",d),x.isFunction(a)&&a()},error:function(a){A.alert(a.msg)},always:function(){c.close()}})}function p(a,b){var c=this,d=x.isFunction(b);C.renderWait(c.getEl(".js-tip"),[a,d?'<a href="javascript:void(0);" class="link-green js-tip-btn"> 重试</a>':""].join("")),c.setData("tip-call",b),c.switchContent("tip")}function q(a){var b=this,c=["main","tip"];x.forEach(c,function(c){b.getEl(".js-"+c)[a===c?"show":"hide"]()})}function r(a){return a=parseInt(+a||0,10),0>a?0:a}function s(a){return new A({noUnique:!0,hasNoTitle:!0,hasNoMove:!0,hasNoFooter:!0,width:500,content:['<div style="font-size:16px;text-align:center;padding:20px;">',a||"","</div>"].join(""),clickToHide:!1})}function t(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function u(a){var b=this,c=b.dataHome=b.dataHome||{};return c[a]}var v=a("nc"),w=a("cpn"),x=v.Base,y=(v.$,v.Clazz),z=v.Component,A=w.Popup,B=w.Input,C=a("../../../../../../../../util/util"),D=a("../../../../../../../../action/paper"),E=c.exports=y.create();y.mix(E,z,{_template:['<div class="pop-mod-set">','<div class="form-group js-main" style="display:none;">','<div class="pop-sample-hint">单个添加测试用例时，上传速度较慢，建议<a class="link-green js-popup-pack" href="javascript:void(0);">使用压缩包批量上传</a>。</div>','<div class="pop-input-out" style="display:block;">','<label class="control-label" style="width:60px;float:none;">输入</label>','<div class="js-input"></div>',"</div>",'<div class="pop-input-out" style="display:block;">','<label class="control-label" style="width:60px;float:none;">输出</label>','<div class="js-output"></div>',"</div>","</div>",'<div class="form-group js-tip" style="display:none;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.initVal()}},{name:"click .js-tip-btn",handler:function(){var a=this,b=a.getData("tip-call");x.isFunction(b)&&b()}},{name:"click .js-popup-pack",handler:function(){var a=this;a.fire("popupPack"),a.popup.close()}}],show:d},{initialize:e,initData:f,initCpns:g,initTextarea:h,initVal:i,getContent:j,renderVal:k,save:l,checkLength:m,checkCode:n,uploadSample:o,tip:p,switchContent:q,getAbsInt:r,popupMask:s,setData:t,getData:u})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/cpn/testCase/popupSampleSetting",["nc","cpn"],function(a,b,c){function d(a){var b=new v(a);b.popup=t.wrap(b,{title:"编程题设置",content:b.html(),width:630,ok:function(){return b.submit(),!0},cancel:function(){}})}function e(){var a=this,b=a.getEl(".js-group-item"),c=a.cpn={};o.forEach(b,function(a){a=p(a),c[a.attr("data-key")]=u.mix({el:a.find("label.radio")})})}function f(a){var b=this,c=b.cpn,d=c.autoDeleteSpace,e=c.deleteBlankLine;if(0===arguments.length)return{autoDeleteSpace:"1"===d.val(),deleteBlankLine:"1"===e.val()};a=a||{};o.id(a.autoDeleteSpace),o.id(a.deleteBlankLine);d.val(a.autoDeleteSpace?"1":"0"),e.val(a.deleteBlankLine?"1":"0")}function g(){function a(){b.ifChange()&&b.fire("ok",{val:c,needRepack:b.needRepack(),noNeedVerify:b.noNeedVerify()}),b.popup.close()}var b=this,c=b.val();c.autoDeleteSpace&&c.deleteBlankLine?a():t.confirm("判题系统对空格严格匹配判定，保留测试用例每行首尾的空格或测试用例首尾的空格空行，会导致考生因为输出空格与用例不同，出现格式错误，确定保存？",a)}function h(){var a=this,b=a.getInitVal(),c=a.val();return c.autoDeleteSpace!==b.autoDeleteSpace||c.deleteBlankLine!==b.deleteBlankLine}function i(){var a=this,b=a.getInitVal(),c=a.val();return c.autoDeleteSpace===!0&&b.autoDeleteSpace===!1||c.deleteBlankLine===!0&&b.deleteBlankLine===!1}function j(){var a=this,b=a.getInitVal(),c=a.val();return c.autoDeleteSpace===!1&&b.autoDeleteSpace===!0||c.deleteBlankLine===!1&&b.deleteBlankLine===!0}function k(){var a=this;return a.rawConfig.val||{autoDeleteSpace:!0,deleteBlankLine:!0}}function l(){var a=s.execTpl(['<div v-for="item in items" class="form-group">','<label class="control-label">#{item.text}</label>','<div v-if="item.checksetting" class="control-group" style="margin-left:53px;margin-right:0px;width:auto;">','<a href="https://www.nowcoder.com/discuss/84666" target="_blank" class="link-green" style="font-size:14px;">点击查看如何编写SPJ代码</a>',"</div>",'<div v-if="!item.checksetting" class="control-group js-group-item" :data-key="item.key" style="margin-right:0px;">','<label class="radio">','<span class="icons"></span>','<input type="radio" value="0">',"否","</label>",'<label class="radio checked">','<span class="icons"></span>','<input type="radio" value="1">',"是","</label>",'<a href="javascript:void(0);" class="help-wrapper link-gray tips-fade-left">','<i class="icon-question-sign js-tips" :title="item.title" data-theme="white"></i>',"</a>","</div>","</div>"],{items:[{key:"autoDeleteSpace",text:"是否忽略测试用例每行首尾的空格",title:"系统对空行空格严格匹配，如果测试用例每行首尾包含空格，考生会因为输出空格不同，导致格式错误，建议忽略测试用例每行首尾的空格。"},{key:"deleteBlankLine",text:"是否忽略测试用例首尾的空格空行",title:"系统对空行空格严格匹配，如果测试用例首尾包含空格空行，考生会因为输出空格空行不同，导致格式错误，建议忽略测试用例首尾的空格空行。"},{text:"编程题如何支持Special Judge",checksetting:!0}]});return{formGroup:a}}var m=a("nc"),n=a("cpn"),o=m.Base,p=m.$,q=m.Clazz,r=m.Component,s=m.Node,t=n.Popup,u=(n.Input,n.CheckGroup),v=c.exports=q.create();q.mix(v,r,{_template:['<div class="pop-subject-setting" style="padding-bottom:0px;">','<div class="pop-subject-tips">一般情况下不建议修改编程题默认设置，请慎重设置，有问题请咨询QQ：77963306</div>',"#{formGroup}","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig.val;a.initCpns(),b&&a.val(b)}}],show:d},{initCpns:e,val:f,submit:g,ifChange:h,needRepack:i,noNeedVerify:j,getInitVal:k,_getData:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/type",["nc","cpn","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;a.data=a.data||{},b.id=a.data.id||A.key(),b.cpn={},b.tags=[];var c=A.id(a.itemType);b.isNormal=!c,b.isSeries="1"===c,b.isSeriesSub="2"===c}function e(){var a=this,b=a.rawConfig,c=a.getEl(),d=a.cpn,e=a.isNormal,f=a.isSeries,g=e||f;if(g){var h=!b.noChangeType,i=[{text:"单选题",value:"1",checked:!0},{text:"不定项选择题",value:"2"},{text:"填空题",value:"3"}];e&&i.push({text:"编程题",value:"4"},{text:"问答题",value:"5"}),d.typeSelect=new D({size:"small",renderTo:c.find(".js-cpn-type"),renderBy:"replaceWith",disabled:!h,options:i,listeners:{change:function(){h&&(e&&a.renderType(this.val()),f&&(a.fire("change"),a.fire("changeType",b.index)))}}})}g&&(d.difficultySelect=new D({size:"small",renderTo:c.find(".js-cpn-difficulty"),renderBy:"replaceWith",options:[{text:"一星",value:"1"},{text:"二星",value:"2"},{text:"三星",value:"3",checked:!0},{text:"四星",value:"4"},{text:"五星",value:"5"}],listeners:{change:function(){a.fire("change")}}})),g&&(d.sourceIpt=new E({renderTo:c.find(".js-cpn-source"),placeholder:"备注(组卷用)，建议填写",clsIpt:"w150",listeners:{change:function(){a.fire("change")}}})),f||(d.scoreIpt=new E({renderTo:c.find(".js-cpn-score"),placeholder:"默认分值",clsIpt:"w150",listeners:{change:function(){a.fire("change")},blur:function(){this.val(C.fix(this.val()))}}}))}function f(){var a=this,b=a.getEl(),c=a.cpn,d=c.tagSelect;G.createTagSelect({tags:a.tags,renderTo:d?d.getEl():b.find(".js-cpn-tag"),renderBy:"replaceWith",call:function(a){c.tagSelect=a,d&&d.destroy()},change:function(b){a.tags.length=0,a.tags=b.slice(0),a.fire("change")},afterAddTag:function(b){a.tags.push({text:b.text,id:b.id}),a.fire("change"),a.fire("tagsChange")}})}function g(){}function h(a){var b=this,c=b.rawConfig;if(0===arguments.length){var d=b.valCommon(),e=A.extend({},c.data,d,b.fullInit()?b.valSelf():null);return e}b.valCommon(a),b.fullInit()?b.valSelf(a):A.extend(c.data,a)}function i(a){var b=this,c=b.cpn;if(0===arguments.length)return{id:b.id,type:c.typeSelect?c.typeSelect.val():"",difficulty:c.difficultySelect?c.difficultySelect.val():"",source:x.trim(c.sourceIpt?c.sourceIpt.val():""),defaultScore:c.scoreIpt?C.fix(c.scoreIpt.val()):"",tags:b.tags};var d=b.getEl();a.type&&c.typeSelect&&c.typeSelect.val(a.type),a.difficulty&&c.difficultySelect&&c.difficultySelect.val(a.difficulty+""),a.source&&c.sourceIpt&&c.sourceIpt.val(a.source),c.scoreIpt&&c.scoreIpt.val(C.fix(a.defaultScore)),b.isSeriesSub&&a.type&&d.find(".js-cpn-type").html(b.getTypeName(a.type)),b.tags=a.tags||[],b.changeTags(b.tags)}function j(){return{}}function k(a){var b=this,c=b.rawConfig,d=b.getEl();c.index=Math.max(0,a-1),d.find(".js-order").html(a)}function l(){}function m(a){var b=this,c=b.rawConfig,d=b.cpn,e=b.val(),f=c.index,g=c.data.type;if(g!==a){var h=c.getTypeClazz?c.getTypeClazz(a):null;if(!h)return d.typeSelect&&d.typeSelect.val(g),F.alert("暂不支持该题型");var i=b,j={1:!0,2:!0};j[g]&&j[a]?(b.changeType(a),b.isSeriesSub&&(e.type=a,b.valCommon(e))):(e.type=a,i=new h(A.extend(c,{renderTo:b.getEl(),renderBy:"after",data:e})),b.destroy()),i.fire("change"),i.fire("changeType",f)}}function n(){var a=this,b=a.cpn;b.tagSelect&&a.initTagSuggest()}function o(a){var b=this,c=b.cpn.tagSelect;if(a&&0!==a.length&&c){var d=A.map(a,function(a){return A.id(a.id)});c.val(d)}}function p(){var a=this,b=a.getEl();return b.hasClass("open")}function q(a,b){var c=this,d=c.rawConfig,e=c.getEl(),f=c.cpn,g=c.isOpen();if(a=a!==!1,a!==g||b){e[a?"addClass":"removeClass"]("open"),f.typeSelect&&f.typeSelect.disabled(!a||!!d.noChangeType),c.fire("open",a);var h=(c.val().content||"").replace(/<.*?>/gi,"");h=B.left(h,30),c.describeEl.html(h)}c.showError(!1)}function r(a){var b=this,c=b.getEl();c[a===!1?"removeClass":"addClass"]("show-error")}function s(a){var b=this;return 0===arguments.length?!!b._isFullInit:void(a===!0&&(b._isFullInit=!0))}function t(a){return{1:"单选题",2:"不定项选择题",3:"填空题",4:"编程题",5:"问答题"}[a]||""}function u(a){var b=this,c=b.isSeries,d=b.isSeriesSub,e=['<div class="subject-hd js-subject-hd">','<span class="exercise-order js-order"></span>','<span class="btn-group js-cpn-type" style="font-size:14px;line-height:34px;"></span>',a.noDel?"":'<a href="javascript:void(0);" class="icon-trash js-del-question" title="删除"></a>','<span class="txt-describe js-txt-describe js-fold"></span>','<div class="fold-bar js-fold">',a.noHeadFold?"":'<a href="javascript:void(0);" class="icon-angle-down">展开详情</a><a href="javascript:void(0);" class="icon-angle-up">收起</a>',"</div>","</div>",'<div class="new-subject">','<div class="filter-row">',d?"":'<div class="filter-item"><span class="js-cpn-difficulty"></span></div>',d?"":'<div class="filter-item"><span class="js-cpn-source"></span></div>',d?"":'<div class="filter-item"><span class="js-cpn-tag"></span></div>',c?"":'<div class="filter-item"><span class="js-cpn-score"></span></div>',"</div>",'<div class="js-container"></div>',"</div>"].join("");return{html:e}}var v=a("nc"),w=a("cpn"),x=v.$,y=v.Clazz,z=v.Component,A=v.Base,B=v.Str,C=v.Num,D=w.Select,E=(w.SelectMult,w.Input),F=(w.AttachSuggest,w.Popup),G=a("../../util/util"),H=c.exports=y.create();y.mix(H,z,{_template:'<div class="subject-panel">#{html}</div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.describeEl=c.find(".js-txt-describe"),a.containerEl=c.find("div.js-container"),a.initCommonCpn(),A.id(b.index)&&a.order(b.index+1),a.open(!!b.open,!0),a.val(b.data),a.fire("change"),c.on("click focus",function(){a.showError(!1)})}},{name:"open",type:"custom",handler:function(a){var b=this,c=b.rawConfig;a&&!b.fullInit()&&G.getHEditor(function(a){b.fullInit(!0),!b.isSeriesSub&&b.initTagSuggest(),b.initSelf(a),b.valSelf(c.data)})}},{name:"click .js-fold",handler:function(){var a=this;a.open(!a.isOpen())}},{name:"click .js-subject-hd",handler:function(a){var b=this,c=b.rawConfig;if(!c.noHeadFold){var d=x(a.target);d.hasClass("js-subject-hd")&&b.open(!b.isOpen())}}},{name:"click .js-del-question",handler:function(){var a=this;a.fire("del")}}]},{initialize:d,initCommonCpn:e,initTagSuggest:f,initSelf:g,val:h,valCommon:i,valSelf:j,order:k,changeType:l,renderType:m,resetTags:n,changeTags:o,isOpen:p,open:q,showError:r,fullInit:s,getTypeName:t,_getData:u})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/type1",["nc","cpn","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax","../../util/list","../../../../../../util/notify","./cpn/option","./cpn/optionEditor","./type"],function(a,b,c){function d(){var a=this;a.cpnOptions=[]}function e(){var a=this;a.containerEl.html(['<div class="form-group js-content"></div>','<div class="form-group js-warning" style="display:none;"></div>','<div class="form-group">','<label class="control-label">选项及答案</label>','<div class="bs-options js-option-list"></div>','<div class="new-subject-btn">','<a href="javascript:void(0);" class="add-options js-add-option">+ 新增选项</a>',"</div>","</div>",'<div class="form-group">','<label class="control-label">题目解析</label>','<div class="js-parse"></div>',"</div>"].join(""))}function f(a){var b=this,c=(b.getEl(),b.containerEl),d=c.find(".js-content");b.contentIpt=new a({renderTo:d,width:d.width(),placeholder:"请在此输入题目，填空题中的空格用()表示",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:r.getKeDefaultConf(),draftChange:function(){b.fire("change")}});var e=c.find(".js-parse");b.answerIpt=new a({renderTo:e,width:e.width(),placeholder:"本题解题思路，方便阅卷参考，选填。",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:r.getKeDefaultConf(),draftChange:function(){b.fire("change")}})}function g(a){var b=this,c=b.rawConfig;(c.data||{}).type=a;var d=b.isRadio(),e=!1;p.forEach(b.cpnOptions,function(a){a.radio(d);var b=a.isChecked();b&&d&&e&&a.check(!1),e=e||b})}function h(a,b){a=a||{};var c=this,d=(c.getEl(),c.cpnOptions);b=b||c.containerEl.find(".js-option-list");var e=new t({renderTo:b,listeners:{del:function(){var a=p.indexOf(d,this);d.length<=2?q.alert("至少存在两个选项"):(d.splice(a,1),this.destroy(),c.fire("change")),c.fixAction()},check:function(){c.isRadio()?(p.forEach(d,function(a){a.check(!1)}),this.check(!0)):this.check(!this.isChecked()),c.fire("change")},change:function(){c.fire("change")}}});e.radio(c.isRadio()),e.val({right:a.right,content:a.content}),d.push(e)}function i(a){var b=this,c=b.cpnOptions;if(0===arguments.length){var d=p.map(c,function(a){return a.val()});return{content:b.contentIpt.val(),answer:b.answerIpt.val(),option:d}}b.contentIpt.val(a.content),b.answerIpt.val(a.answer);var d=a.option||[];if(p.forEach(d,function(a){b.createOption(a)}),c.length<=1)for(var e=0,f=4-c.length;f>e;e++)b.createOption();var g=b.isRadio();if(g){var h=!1;p.forEach(c,function(a){var b=a.isChecked();b&&h&&a.check(!1),h=h||b})}b.fixAction()}function j(){var a=this,b=a.rawConfig;return"1"===p.id((b.data||{}).type)}function k(){var a=this,b=(a.getEl(),a.cpnOptions.length);n(".js-add-option").parent()[b>=26?"hide":"show"]();var c=b>2;p.forEach(a.cpnOptions,function(a,b){a.showDel(c),a.order(b)})}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Clazz,p=l.Base,q=(l.Str,m.Popup),r=a("../../util/util"),s=a("../../util/list"),t=a("./cpn/option"),u=a("./type"),v=c.exports=o.create();o.mix(v,u,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initTpl()}},{name:"click .js-add-option",handler:function(a){var b=this,c=b.getEl(),d=c.find(".js-option").length;n(a.currentTarget)[d>=26?"hide":"show"](),d>=26?q.alert("选项达到上限了"):b.createOption(),b.fixAction()}},{name:"change",type:"custom",handler:function(){var a=this,b=a.getEl(),c=s.warn(a.val()),d=0===c.length?"":p.map(c,function(a){return'<div class="code-warning" style="margin:10px 0;"><i class="icon-exclamation-sign"></i>'+a+"</div>"}).join("");b.find(".js-warning").html(d)[d?"show":"hide"]()}}]},{initialize:d,initTpl:e,initSelf:f,changeType:g,createOption:h,valSelf:i,isRadio:j,fixAction:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/type3",["nc","cpn","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax","../../util/list","../../../../../../util/notify","./type"],function(a,b,c){function d(){var a=this;a.cpnGaps=[]}function e(){var a=this;a.containerEl.html(['<div class="form-group js-content"></div>','<div class="form-group js-warning" style="display:none;"></div>','<div class="form-group">','<label class="control-label">答案(如一个空有多个参考答案，每个答案用|||分割，考生匹配任意一个答案即视为正确)','<span class="fn-important">*</span>',"</label>",'<div class="answer-raido-box js-order-type">','<span class="answer-raido-label">考生答案需和考题答案</span>','<label class="radio"><input type="radio" value="0">完全一致</label>','<label class="radio"><input type="radio" value="1">顺序可不一致</label>',"</div>",'<div class="js-gap-list" style="display:none;"></div>','<div class="js-gap-tips" style="font-size:14px;text-align:center;padding:20px 0;">题目中未设置填空，请在题目中输入（）表示需填空部分。</div>',"</div>",'<div class="form-group">','<label class="control-label">题目解析</label>','<div class="js-parse"></div>',"</div>"].join(""))}function f(a){var b=this,c=(b.getEl(),b.containerEl),d=c.find(".js-content");b.contentIpt=new a({renderTo:d,width:d.width(),placeholder:"请在此输入题目，填空题中的空格用()表示",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:p.getKeDefaultConf(),draftChange:function(){b.fire("change"),b.createGap()}}),b.orderTypeChk=o.mix({el:b.getEl(".js-order-type label.radio"),change:function(){b.fire("change")}});var e=c.find(".js-parse");b.answerIpt=new a({renderTo:e,width:e.width(),placeholder:"本题解题思路，方便阅卷参考，选填。",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:p.getKeDefaultConf(),draftChange:function(){b.fire("change")}})}function g(){var a=this,b=a.rawConfig,c=a.cpnGaps,d=a.getEl(),e=d.find(".js-gap-tips"),f=d.find(".js-gap-list"),g=p.countGap(a.contentIpt.val());if(g!==c.length){for(;c.length>g;){var h=c.pop();h.destroy()}if(0===g)return f.hide().html(""),void e.show();e.hide();var i=c.length;m.forCount(g-i,function(d){var e=['<div class="control-group with-input-list js-gap-ipt" style="margin-bottom:20px;">','<input type="text" class="per99" value="',((b.data.gap||[])[i+d]||"").replace(/\\\|/g,"|"),'" />',"</div>"].join(""),g=k(e);f.append(g);var h=n.transform(g,{change:function(){a.fire("change")}});c.push(h)}),f.show()}}function h(a){var b=this,c=b.rawConfig;if(0===arguments.length){var d=b.contentIpt.val(),e=c.data.gap||[];return m.forEach(b.cpnGaps,function(a,b){e[b]=k.trim(a.val())}),e.length=p.countGap(d),{content:d,answer:b.answerIpt.val(),gap:e,discardAnswerOrder:!!+b.orderTypeChk.val()}}b.contentIpt.val(a.content),b.answerIpt.val(a.answer),b.orderTypeChk.val(a.discardAnswerOrder?"1":"0"),b.createGap()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Clazz,m=i.Base,n=(i.Str,j.Input),o=(j.Popup,j.CheckGroup),p=a("../../util/util"),q=a("../../util/list"),r=a("./type"),s=c.exports=l.create();l.mix(s,r,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initTpl()}},{name:"change",type:"custom",handler:function(){var a=this,b=a.getEl(),c=q.warn(a.val()),d=0===c.length?"":m.map(c,function(a){return'<div class="code-warning" style="margin:10px 0;"><i class="icon-exclamation-sign"></i>'+a+"</div>"}).join("");b.find(".js-warning").html(d)[d?"show":"hide"]()}}]},{initialize:d,initTpl:e,initSelf:f,createGap:g,valSelf:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/type4",["nc","cpn","./type","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax","./cpn/inOutCase/index","./cpn/inOutCase/caseItem","./cpn/optionEditor","./cpn/testCase/index","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../action/paper","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","../../../../../../util/uploadOss","ncOss","../../../../../../action/common","./cpn/testCase/popupEditSample","./cpn/testCase/popupSampleSetting","../../../../../../util/notify"],function(a,b,c){function d(a){var b=this;if(0===arguments.length){var c=b.getVal();return c}b.setVal(a,!0)}function e(){var a=this,b=a.getData("is-edit"),c=a.getData("cpn-val-test-sample");x.forEach(c.sample,function(a,b){c.sample[b]=a=a||{},a.index=b+1});var d=v.trim(a.getData("cpn-val-memory-limit")),e={content:a.getData("cpn-val-question-description"),codeInfo:{title:a.getData("cpn-val-title"),timeLimit:a.getData("cpn-val-time-limit"),memoryLimit:d?Math.floor(1024*d):void 0,inputDesc:a.getData("cpn-val-input-description"),outputDesc:a.getData("cpn-val-output-description"),hint:a.getData("cpn-val-hint"),testCasesExt:JSON.stringify({samples:a.getData("cpn-val-in-out-case")||[]}),caseDataUrl:c.samplePackUrl,caseCount:c.sampleCount,cases:c.sample,verified:a.getData("verified"),checkerFileName:c.checkerFileName,setting:JSON.stringify(c.setting)}};return b||(e.codeInfo.latestAcceptedCodingSubmission={timeConsumption:a.getData("verified-time-limit"),memoryConsumption:a.getData("verified-memory-limit")}),e}function f(a,b){var c=this,d=c.getData("is-edit"),e=x.isObject(a.codeInfo)?a.codeInfo:{},f=e.latestAcceptedCodingSubmission||{},g=f.timeConsumption||0,h=f.memoryConsumption||0,i=f.language,j=e.timeLimit,k=void 0===e.memoryLimit?"":(e.memoryLimit/1024||0).toFixed(3),l=(x.json(e.testCasesExt)||{}).samples;c.setData("info-conf",a),c.setData("id-question",a.id+""),c.setData("cpn-val-title",d?y.decodeHTML(e.title||""):e.title||""),c.setData("cpn-val-time-limit",d?y.decodeHTML(j||1):j||1),c.setData("cpn-val-memory-limit",d?y.decodeHTML(k||32):k||32),c.setData("cpn-val-question-description",a.content||""),c.setData("cpn-val-input-description",e.inputDesc||""),c.setData("cpn-val-output-description",e.outputDesc||""),c.setData("cpn-val-hint",d?y.decodeHTML(e.hint||""):e.hint||""),c.setData("cpn-val-in-out-case",l),c.setData("verified",e.verified),c.setData("verified-time-limit",d?g/(2===i?1e3:2e3):g),c.setData("verified-memory-limit",d?h/(2===i?1024:2048):h),c.setData("cpn-val-test-sample",{samplePackUrl:e.caseDataUrl,sampleCount:e.caseCount,sample:e.cases||[],checkerFileName:e.checkerFileName,setting:x.json(e.setting)}),b&&c.refreshRender()}function g(){var a=this,b=x.isObject(a.rawConfig.data)?a.rawConfig.data:{};a.setData("info-conf",b),a.setData("is-edit","edit"===a.rawConfig.type),a.setData("is-step2_1","step2_1"===a.rawConfig.type),a.setData("verified",!0),a.setVal(b)}function h(){var a=this,b=E.getCodingQuestionSetting().totalTimeLimit;a.containerEl.html(['<div class="filter-row coding-title">','<div class="filter-item">',"<label>标题</label>",'<div class="js-title" style="display:inline-block;margin:0 5px;"></div>',"</div>",'<div class="filter-item">',"<label>时间限制</label>",'<div class="js-time-limit" style="display:inline-block;margin:0 5px;"></div>',"<label>秒</label>","</div>",'<div class="filter-item">',"<label>内存限制</label>",'<div class="js-memory-limit" style="display:inline-block;margin:0 5px;"></div>',"<label>M</label>",'<a href="javascript:void(0);" class="help-wrapper link-gray"><i class="icon-question-sign"></i>','<div class="tooltip bottom tooltip-info">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">程序启动需要耗费内存32MB，且非C/C++语言的运行时间和运行内存是设置的两倍！</div>',"</div>","</a>","</div>","</div>",'<div class="textarea-group">','<div class="form-group">','<label class="control-label">题目描述</label>','<div class="js-question-description"></div>',"</div>",'<div class="form-group">','<label class="control-label">输入描述</label>','<div class="js-input-description"></div>',"</div>",'<div class="form-group">','<label class="control-label">输出描述</label>','<div class="js-output-description"></div>',"</div>",'<div class="form-group">','<label class="control-label">备注</label>','<div class="js-hint"></div>',"</div>","</div>",'<div class="js-in-out-case"></div>','<div class="js-test-sample"></div>','<div style="font-size:14px;">','测试用例数目：<span class="font-green js-test-sample-num"></span>，总耗时：<span class="js-total-time-consuming"></span>秒 (时间限制 x 测试用例数)，总耗时不能超过'+b+"秒","</div>"].join(""))}function i(a){var b=this;b.initIpts(),b.initHEditor(a),b.initTextarea(),b.initInOutCase(),b.initTestCase(),b.renderTestSampleStatus()}function j(){var a=this,b=["title","time-limit","memory-limit"];x.forEach(b,function(b){var c=new C({renderTo:a.getEl(".js-"+b),listeners:{change:function(){if("time-limit"!==b&&"memory-limit"!==b){{var c=v.trim(this.val());a.getData("cpn-val-"+b)}a.setData("cpn-val-"+b,c),a.fire("change")}}}});("time-limit"===b||"memory-limit"===b)&&a.getEl(".js-"+b).find("input").on("change",function(){var c=a.getData("cpn-"+b),d=v.trim(c.val()),e=a.getData("verified-"+b);a.setData("cpn-val-"+b,d),+e>+d&&a.setData("verified",!1),"time-limit"===b&&a.renderTestSampleStatus(),a.fire("change")}),a.setData("cpn-"+b,c)})}function k(a){var b=this,c=["question-description"];x.forEach(c,function(c){var d=new a({renderTo:b.getEl(".js-"+c),width:"100%",height:250,keConf:E.getKeDefaultConf(),draftChange:function(){var a=this.val();b.setData("cpn-val-"+c,a),b.fire("change")}});b.setData("cpn-"+c,d)})}function l(){var a=this,b=["input-description","output-description","hint"];x.forEach(b,function(b){var c=new H({renderTo:a.getEl(".js-"+b),mode:"code",height:100,listeners:{draftChange:function(){var c=this.val();a.setData("cpn-val-"+b,c),a.fire("change")}}});a.setData("cpn-"+b,c)})}function m(){var a=this,b=new F({renderTo:a.getEl(".js-in-out-case"),isEdit:a.getData("is-edit"),listeners:{change:function(b){var c=this.val();b=b||{},c=x.isArray(c)?c:[],a.setData("cpn-val-in-out-case",c),b.needVerify&&a.setData("verified",!1),a.fire("change")}}});a.setData("cpn-in-out-case",b)}function n(){var a=this,b=new G({renderTo:a.getEl(".js-test-sample"),isEdit:a.getData("is-edit"),listeners:{change:function(b){{var c=x.isObject(this.val())?this.val():{};a.getData("info-conf")}if(a.setData("cpn-val-test-sample",c),a.renderTestSampleStatus(),b=b||{},b.deleted)return a.fire("change");a.setData("verified",!!b.noNeedVerify);var d=b.needRepack;return a.getData("is-edit")||a.getData("is-step2_1")||d?void a.rePackage(function(){a.fire("change")},d):void a.fire("change")}}});a.setData("cpn-test-sample",b),a.setData("cpn-val-test-sample",b.val())}function o(){var a=this,b=["title","time-limit","memory-limit","question-description","input-description","output-description","hint","in-out-case","test-sample"];x.forEach(b,function(b){var c=a.getData("cpn-"+b),d=a.getData("cpn-val-"+b);c.val(d)})}function p(){var a=this,b=E.getCodingQuestionSetting().totalTimeLimit,c=a.getData("cpn-val-time-limit")||0,d=a.getData("cpn-val-test-sample")||{},e=d.sampleCount||0,f=e*c||0,g=b>=f;a.getEl(".js-test-sample-num").html(e);var h=a.getEl(".js-total-time-consuming");h.html(f),A.cls(h,{"font-green":g,"font-red":!g})}function q(a,b){var c=this,d=c.getVal().codeInfo||{},e=d.caseDataUrl||"",f=x.clone(d.cases)||[];if(0===f.length&&!b)return void(x.isFunction(a)&&a({samplePackUrl:e,sample:f}));x.forEach(f,function(a,b){x.isObject(a)&&(a.index=b+1)}),J.fire("repacking",{questionId:c.getData("id-question")});var g=B.mask("更新数据中，请稍等..."),h=c.getData("cpn-val-test-sample"),i=h.setting;I.rePackage({type:"POST",body:{dataFileUrl:e,cases:JSON.stringify(f),deleteBlankLine:i.deleteBlankLine,autoDeleteSpace:i.autoDeleteSpace},call:function(b){var d=x.isObject(b.data)?b.data:{},e=c.getData("cpn-test-sample");h.samplePackUrl=d.url,h.sample=[],e&&e.val&&e.val({samplePackUrl:d.url,sample:[],sampleCount:h.sampleCount,checkerFileName:h.checkerFileName,setting:h.setting}),J.fire("repackDone",{questionId:c.getData("id-question")}),g.close(),x.isFunction(a)&&a({samplePackUrl:d.url,sample:[]})},error:function(a){B.alert(a.msg),z.clear(c.getEl())}})}function r(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function s(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Clazz,x=t.Base,y=t.Str,z=(t.Uri,t.Num,t.Limit),A=t.Dom,B=u.Popup,C=u.Input,D=a("./type"),E=a("../../util/util"),F=a("./cpn/inOutCase/index"),G=a("./cpn/testCase/index"),H=a("./cpn/optionEditor"),I=a("../../../../../../action/paper"),J=a("../../../../../../util/notify"),K=c.exports=w.create();w.mix(K,D,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initTpl()}}]},{valSelf:d,getVal:e,setVal:f,initData:g,initTpl:h,initSelf:i,initIpts:j,initHEditor:k,initTextarea:l,initInOutCase:m,initTestCase:n,refreshRender:o,renderTestSampleStatus:p,rePackage:q,getData:r,setData:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/type5",["nc","cpn","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax","./type"],function(a,b,c){function d(){var a=this;a.cpnGaps=[]}function e(){var a=this;a.containerEl.html(['<div class="form-group js-content"></div>','<div class="form-group">','<label class="control-label">题目解析</label>','<div class="js-parse"></div>',"</div>"].join(""))}function f(a){var b=this,c=(b.getEl(),b.containerEl),d=c.find(".js-content");b.contentIpt=new a({renderTo:d,width:d.width(),placeholder:"请在此输入题目，填空题中的空格用()表示",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:k.getKeDefaultConf(),draftChange:function(){b.fire("change")}});var e=c.find(".js-parse");b.answerIpt=new a({renderTo:e,width:e.width(),placeholder:"本题解题思路，方便阅卷参考，选填。",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:k.getKeDefaultConf(),draftChange:function(){b.fire("change")}})}function g(a){{var b=this;b.rawConfig}return 0===arguments.length?{content:b.contentIpt.val(),answer:b.answerIpt.val()}:(b.contentIpt.val(a.content),void b.answerIpt.val(a.answer))}var h=a("nc"),i=a("cpn"),j=(h.$,h.Clazz),k=(h.Base,h.Str,i.Input,i.Popup,a("../../util/util")),l=a("./type"),m=c.exports=j.create();j.mix(m,l,{listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initTpl()}}]},{initialize:d,initTpl:e,initSelf:f,valSelf:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/typeSeries/content",["nc","cpn","../../../util/util","../../../../../../../component/steps","../../../../../../../core/siteConfig","../../../../../../../action/tag","../../../../../../../util/ajax","../type"],function(a,b,c){function d(a){j.extend(a,{itemType:"1",noDel:!0})}function e(a){var b=this,c=(b.getEl(),b.containerEl);c.html(['<div style="font-size:14px;margin-bottom:10px;">',"系列题材料说明 ",'<span class="icon-question-sign js-tips" data-title="系列题中的每个题目均可见该材料说明" data-theme="white" style="cursor:pointer;"></span>',"</div>",'<div class="form-group js-content"></div>'].join(""));var d=c.find(".js-content");b.contentIpt=new a({renderTo:d,width:d.width(),placeholder:"请在此输入系列题材料说明",noCodeSelect:!0,noToolbarFixed:!0,height:200,keConf:k.getKeDefaultConf(),draftChange:function(){b.fire("change")}})}function f(a){var b=this;return 0===arguments.length?{isSeries:!0,content:b.contentIpt.val()}:void b.contentIpt.val(a.content)}var g=a("nc"),h=a("cpn"),i=(g.$,g.Clazz),j=g.Base,k=(g.Str,h.Input,h.Popup,a("../../../util/util")),l=a("../type"),m=c.exports=i.create();i.mix(m,l,{listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();b.find(".js-order").replaceWith('<span style="font-size:14px;">系列题题型</span>')}}]},{initialize:d,initSelf:e,valSelf:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/edit/typeSeries/index",["nc","cpn","../../../util/util","../../../../../../../component/steps","../../../../../../../core/siteConfig","../../../../../../../action/tag","../../../../../../../util/ajax","../../../util/type","../type1","../../../util/list","../../../../../../../util/notify","../cpn/option","../cpn/optionEditor","../type","../type3","../type4","../cpn/inOutCase/index","../cpn/inOutCase/caseItem","../cpn/testCase/index","../../../../../../../component/table","../../../../../../../component/selectAll","../../../../../../../util/util","../../../../../../../action/paper","../../../../../extend/bll/task","../../../../../extend/bll/base","../../../../../../../action/api","../../../../../../../util/uploadOss","ncOss","../../../../../../../action/common","../cpn/testCase/popupEditSample","../cpn/testCase/popupSampleSetting","../type5","./content"],function(a,b,c){function d(a){var b=this,c=a.data=a.data||{};c.content=t.extend({type:x.TYPE_DANXUAN},c.content),b.content=null,b.cpn=[]}function e(){var a=this,b=a.rawConfig,c=a.getEl(".js-content");a.content=new A({renderTo:c,data:b.data.content,listeners:{change:function(){a.content=a.content||this,this.showError(!1),a.fire("change")},changeType:function(){var b=this.val();t.forEach(a.cpn,function(a){a.renderType(b.type),a.open(!1)})},tagsChange:function(){this.resetTags&&this.resetTags()},open:function(b){b&&a.open(-1,!0)}}})}function f(){var a=this,b=a.rawConfig,c=b.data.items||[];t.forEach(c,function(b){a.createItem(b)}),0===c.length&&a.createItem(a.getDefaultItem()),a.open(-1)}function g(){var a=this;a.checkAll()&&(a.createItem(a.getDefaultItem()),a.openLast())}function h(a,b,c){var d=this,e=d.cpn,f=e.length,g=y.getEditClazz(a.type);if(g){var h=new g({renderTo:b||d.listEl,renderBy:c,index:f,data:a,itemType:"2",getTypeClazz:t.bind(y.getEditClazz,y),listeners:{change:function(){this.showError(!1),d.fire("change")},changeType:function(a){e[a]=this},open:function(a){a&&d.open(t.indexOf(e,this),!0)},del:function(){var b=this,c=t.indexOf(e,this);return a.paperTotal>0?w.alert("该题已出卷，无法删除"):void(c>=0&&w.confirm("确定删除题目？",function(){b.getEl().hide(120,function(){b.destroy(),e.splice(c,1),d.fire("del",b.id),d.order()})}))}}}),i=a.id?t.findIndex(e,function(b){return b.id===a.id}):-1;i>=0&&(e[i]=h),0>i&&e.push(h)}}function i(){var a=this,b=a.cpn;if(0===arguments.length){var c=a.valContent();return{content:c,items:t.map(b,function(a){var b=z.fixSeriesSubItem(a.val(),c);return b})}}}function j(a){var b=this,c=b.content;return 0===arguments.length?c.val():void c.val(a)}function k(a,b){var c=this,d=c.rawConfig,e=c.cpn.slice(0);e.unshift(c.content),a===!1?t.forEach(e,function(a){a.open(!1)}):t.isNumber(a)&&(a+=1,t.forEach(e,function(b,c){b.open(a===c)}),b&&v.scrollToEl({scrollEl:d.scrollEl,el:e[a].getEl(),animation:!0}))}function l(){var a=this,b=a.cpn;b.length>0&&a.open(b.length-1,!0)}function m(){var a=this;t.forEach(a.cpn,function(a,b){a.order(b+1)})}function n(a){var b=this,c=b.val(),d=z.check(c.content),e=-1;return d.right&&(e=t.findIndex(c.items,function(a){return d=z.check(a),!d.right})),d.right||(b.open(e,!0),(e>=0?b.cpn[e]:b.content).showError(),w.alert(d.msg)),a&&d.right&&c.items.length<2&&(d={right:!1,msg:"系列题至少存在两道子题目"},w.alert(d.msg)),!!d.right}function o(){return{type:x.TYPE_DANXUAN}}function p(){var a=this,b=a.valContent();return{type:b.type}}var q=a("nc"),r=a("cpn"),s=(q.$,q.Clazz),t=q.Base,u=q.Component,v=q.Dom,w=r.Popup,x=a("../../../util/util"),y=a("../../../util/type"),z=a("../../../util/list"),A=a("./content"),B=c.exports=s.create();s.mix(B,u,{_template:["<div>",'<div class="js-content"></div>','<div class="js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.listEl=b.find(".js-list"),a.initContent(),a.initList()}}]},{initialize:d,initContent:e,initList:f,addNewItem:g,createItem:h,val:i,valContent:j,open:k,openLast:l,order:m,checkAll:n,getDefaultContent:o,getDefaultItem:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/cpn/show/type",["nc","cpn","../../util/util","../../../../../../component/steps","../../../../../../core/siteConfig","../../../../../../action/tag","../../../../../../util/ajax","../../util/list","../../../../../../util/notify","../../util/checker"],function(a,b,c){function d(a){var b=this;b.id=a.data.id}function e(a){var b=this;b.orderEl.html(a)}function f(a){var b=s.warn(a);return b.length>0?'<div class="exercise-foot" style="border-bottom:1px solid #d4d4d4;">'+n.map(b,function(a){return'<div class="code-warning" style="margin:0;"><i class="icon-exclamation-sign"></i>'+a+"</div>"}).join("")+"</div>":void 0}function g(a){var b=n.id(a.type),c=a.content||"";if("1"===b||"2"===b)c="<dt>"+c+"</dt>",n.forEach(a.option,function(a,b){var d=a.right?"color:#00bc9b":"";c+='<dd class="clearfix" style="'+d+'"><span class="option-item" style="float:left;'+d+'">'+u[b]+'.</span> <div style="float:left;margin-left:10px;'+d+'">'+a.content+"</div></dd>"});else if("3"===b)c=r.fillGapContent(c,function(a){return'<span class="blank-num">'+(a+1)+"</span>"}),c="<dt>"+c+"</dt>";else if("4"===b){var d='<dd class="clearfix" style="border:0;padding:0;">',e=a.codeInfo||{},f=(n.json(e.testCasesExt)||{}).samples||[],e=a.codeInfo;if(!e)return;var f=n.json(e.testCasesExt).samples||[];d+=e.inputDesc?"</br><h5><b>输入描述:</b></h5><pre>"+e.inputDesc+"</pre></br>":"",d+=e.outputDesc?"</br><h5><b>输出描述:</b></h5><pre>"+e.outputDesc+"</pre>":"",d+=e.hint?"</br><h5><b>备注:</b></h5><pre>"+e.hint+"</pre>":"",n.forEach(f,function(a){a&&(d+=['<div class="question-oi">','<div class="question-oi-hd" style="font-size:14px;font-weight:bold;">示例',a.index,"</div>",'<div class="question-oi-bd">','<div class="question-oi-mod"><h2>输入</h2></div><div class="question-oi-cont"><pre>',q.encodeHTML(a.input),"</pre></div>",'<div class="question-oi-mod"><h2>输出</h2></div><div class="question-oi-cont"><pre>',q.encodeHTML(a.output),"</pre></div>",a.note?'<div class="question-oi-mod"><h2>说明</h2></div><div class="question-oi-cont"><pre>'+a.note+"</pre></div>":"","</div>","</div>"].join(""))}),d+=['<div class="validate-oprt js-verify-home">',e.verified?'<span class="validate-passed"><i class="icon-ok"></i>已验证</span>':'<a href="javascript:void(0);" class="btn btn-primary js-verify" style="display:inline-block;">验证题目</a><span class="code-warning"><i class="icon-exclamation-sign"></i>题目未验证，不能保存入库</span>',"</div>"].join(""),d+="</dd>",c=q.execTpl(['<div class="pop-questions">',"<h2>#{title}</h2>",'<dl><dt style="border:none;padding:0 0 10px 0;font-weight:normal;">#{content}</dt>#{ext}</dl>',"</div>"].join(""),{title:q.encodeHTML(e.title),content:c,ext:d})}else c="<dt>"+c+"</dt>";return c}function h(a){var b=n.id(a.type),c="1"===b||"2"===b,d="3"===b,e="";return c?e=n.filter(n.map(a.option,function(a,b){return a.right?u[b]:""}),function(a){return!!a}).join(""):d&&(e=n.map(a.gap,function(a,b){return a=a.replace(/\|\|\|/g," 或 "),'<span class="blank-num">'+(b+1)+"</span> "+q.encodeHTML(a)}).join("<br />")),e=e?'<div class="exercise-foot" style="border-bottom:1px solid #d4d4d4;"><span class="reference">答案: '+(d?"（"+(a.discardAnswerOrder?"顺序可不一致":"完全一致")+"）":"")+"</span><br />"+e+"</div>":""}function i(a){var b=n.id(a.type);return a.isSeries||"4"===b?"":['<div class="exercise-foot">题目解析: ',a.answer||"无","</div>"].join("")}function j(a){var b=this,c=[a?'<span class="validate-passed"><i class="icon-ok"></i>已验证</span>':'<a href="javascript:void(0);" class="btn btn-primary js-verify" style="display:inline-block;">验证题目</a><span class="code-warning"><i class="icon-exclamation-sign"></i>题目未验证，不能保存入库</span>'].join("");b.getEl(".js-verify-home").html(c)}function k(a){var b=this,c=a.data,d=n.id(c.type),e=!a.isSeries,f=!e&&c.isSeries,g=!e&&!c.isSeries,h=t.match(c.content),i=['<div class="exercise-head clearfix">','<div class="exercise-info">',f?"<span>系列题题型</span>":'<span class="exercise-order js-order">#{index}</span>','<span class="item">#{type}</span>',g?"":'<span class="item">难度: #{difficulty}</span>',g?"":'<span class="item">备注: #{source}</span>',g?"":'<span class="item">知识点: #{tags}</span>',f?"":'<span class="item">默认分数: #{defaultScore}</span>',h.match?"":'<span class="code-warning"><i class="icon-exclamation-sign"></i>'+t.getMatchTip(h.info)+"</span>","</div>",'<div class="exercise-ctrl">','<a href="javascript:void(0);" class="js-edit"><i class="icon-pencil"></i>编辑</a>',f?"":'<a href="javascript:void(0);" class="jd-del"><i class="icon-trash"></i>删除</a>',"</div>","</div>",'<dl class="exercise-body post-topic-des">#{content}</dl>',"#{warning}","#{right}","#{ref}"].join("");return{template:i,index:a.index+1,type:{1:"单选题",2:"不定项选择题",3:"填空题",4:"编程题",5:"问答题"}[d],difficulty:c.difficulty,source:c.source||"无",defaultScore:c.defaultScore||"无",tags:0===(c.tags||[]).length?"无":n.map(c.tags,function(a){return a.text}).join(", "),content:b.getContent(c),warning:b.getWarning(c),right:b.getRight(c),ref:b.getRef(c)}}var l=a("nc"),m=a("cpn"),n=(l.$,l.Base),o=l.Clazz,p=l.Component,q=l.Str,r=(m.Popup,a("../../util/util")),s=a("../../util/list"),t=a("../../util/checker"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",v=c.exports=o.create();o.mix(v,p,{_template:'<div class="include-exercise">#{template}</div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.orderEl=b.find(".js-order")}},{name:"click .js-edit",handler:function(){var a=this;a.fire("edit")}},{name:"click .jd-del",handler:function(){var a=this;a.fire("del")}},{name:"click .js-verify",handler:function(){var a=this;a.fire("verify")}}]},{initialize:d,order:e,getWarning:f,getContent:g,getRight:h,getRef:i,renderVerify:j,_getData:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/index",["nc","cpn","../../../../util/util","../../../../core/siteConfig","../../../../core/module","./util/util","../../../../component/steps","../../../../action/tag","../../../../util/ajax"],function(a,b,c){function d(a){var b=this,c=g(a.currentTarget),d=g.trim(c.attr("data-type")),e=d?{single:{action:"add/step2_1/index"},list:{action:"add/step2_4/index"},parse:"add/step2_3/index",batch:"add/step2_2/index"}[d]:"";e&&b.nav("question",e)}var e=a("nc"),f=a("cpn"),g=e.$,h=e.Clazz,i=(e.Str,e.Base,f.Attach,a("../../../../util/util"),a("../../../../core/module")),j=(f.Popup,a("./util/util")),k=c.exports=h.create();h.mix(k,i,{style:"/stylesheets/styles/system/includedExercise.css",title:"试题录入",_template:['<div class="steps-main">','<div class="js-steps-wrap"></div>','<div class="include-content">','<div class="include-intr js-online">','<div class="include-intr-pic intr-step1"></div>','<div class="include-intr-cont">',"<h4>在线录入</h4>","<p>适合带图片，代码格式等题目录入，支持编程题录入</p>","</div>",'<div class="include-intr-mask">','<a href="javascript:void(0);" class="icon-file-alt js-action-nav js-tips" data-type="single" data-title="每个题目单独存在，互不关联，可以同时录入多个题目" data-theme="white">单独题目</a>','<a href="javascript:void(0);" class="icon-list-alt js-action-nav js-tips" data-type="list" data-title="系列题适用于多个题目使用同一份材料的情况，类似阅读理解题目、材料分析题，每次只能录入一个系列题" data-theme="white">系列题目</a>',"</div>","</div>",'<div class="include-intr js-action-nav" data-type="parse">','<div class="include-intr-pic  intr-step2"></div>','<div class="include-intr-cont">',"<h4>文档智能解析</h4>","<p>可按标准格式批量解析word等文档</p>","<p>（暂不支持图片解析和编程题解析）</p>","</div>","</div>",'<div class="include-intr js-action-nav" data-type="batch">','<div class="include-intr-pic intr-step3"></div>','<div class="include-intr-cont">',"<h4>Excel模板上传</h4>","<p>通过Excel模板批量导入题目，图片、格式等属性解析不佳，不支持编程题</p>","</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();j.initSteps(b.find(".js-steps-wrap"),1)}},{name:"click .js-action-nav",handler:d}]},{})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_1/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../util/util","../../../../../component/steps","../../../../../action/tag","../../../../../util/ajax","../util/list","../../../../../util/notify","../util/type","../cpn/edit/type1","../cpn/edit/cpn/option","../cpn/edit/cpn/optionEditor","../cpn/edit/type","../cpn/edit/type3","../cpn/edit/type4","../cpn/edit/cpn/inOutCase/index","../cpn/edit/cpn/inOutCase/caseItem","../cpn/edit/cpn/testCase/index","../../../../../component/table","../../../../../component/selectAll","../../../../../action/paper","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/uploadOss","ncOss","../../../../../action/common","../cpn/edit/cpn/testCase/popupEditSample","../cpn/edit/cpn/testCase/popupSampleSetting","../cpn/edit/type5"],function(a,b,c){function d(){var a=this;a.cpn=[],a.db=new x(H.appDb.VerifyCode);var b=a.listData=D.createList();b.listen("dataChange",u.bind(a.initSummary,a)),b.listen("defaultChange",u.bind(a.changeDefault,a)),a.listen("beforeLeave",function(){b.listenVerify(!1),b.unlistenAll()})}function e(){var a=this,b=a.listData,c=b.getDefault(),d=a.getEl(),e=a.headCpn={};e.sourceIpt=new A({renderTo:d.find(".js-default-source"),placeholder:"默认备注(组卷用)",clsIpt:"w100",value:c.source||"",listeners:{change:function(){var a=s.trim(this.val());b.setDefault({source:a})}}}),e.scoreIpt=new A({renderTo:d.find(".js-default-score"),placeholder:"默认分值",clsIpt:"w100",value:c.score||"",listeners:{change:function(){b.setDefault({score:this.val()})},blur:function(){this.val(w.fix(this.val()))}}}),a.createHeadTagSelect()}function f(){var a=this,b=(a.getEl(),a.listData),c=b.getAllQuestion(),d=c.length;0===d&&c.push(a.getDefaultItem()),u.forEach(c,function(b){a.createItem(b)}),0===d&&a.openLast()}function g(){var a=this,b=a.listData.getAllQuestion(),c=b.length;a.countEl.html(c)}function h(a,b,c){var d=this,e=d.cpn,f=d.listData,g=e.length,h=F.getEditClazz(a.type);if(h){var i=new h({renderTo:b||d.listEl,renderBy:c,index:g,data:a,type:"step2_1",getTypeClazz:u.bind(F.getEditClazz,F),listeners:{change:function(){var a=this.val();this.showError(!1),f.addQuestion(a),"4"===u.id(a.type)&&d.refreshVerify(g)},changeType:function(a){e[a]=this,d.open(a)},tagsChange:function(){u.forEach(e,function(a){a.resetTags&&a.resetTags()}),d.createHeadTagSelect()},open:function(a){if(!a&&d.fire("change"),a){var b=u.indexOf(e,this);d.open(b,!0)}},del:function(){var a=this,b=u.indexOf(e,this);b>=0&&z.confirm("确定删除题目？",function(){a.getEl().hide(120,function(){a.destroy(),e.splice(b,1),f.delQuestion(a.id),d.order();var c=f.getAllQuestion();0===c.length&&window.setTimeout(function(){d.createItem(d.getDefaultItem()),d.open(0,!0)},250)})})}}}),j=a.id?u.findIndex(e,function(b){return b.id===a.id}):-1;j>=0&&(e[j]=i),0>j&&e.push(i)}}function i(a,b){var c=this,d=c.cpn;a===!1?u.forEach(d,function(a){a.open(!1)}):u.isNumber(a)&&a>=0&&(u.forEach(d,function(b,c){b.open(a===c)}),b===!0&&v.scrollToEl({scrollEl:c.getSysWinEl(),el:d[a].getEl(),animation:!0}))}function j(){var a=this,b=a.cpn;b.length>0&&a.open(b.length-1,!0)}function k(){var a=this;u.forEach(a.cpn,function(a,b){a.order(b+1)})}function l(){var a,b=this,c=b.listData.getAllQuestion(),d=u.findIndex(c,function(b){return a=D.check(b),!a.right});return d>=0&&(b.open(d,!0),b.cpn[d].showError(),z.alert(a.msg)),0>d}function m(){var a=this,b=a.listData,c=b.getDefault(),d=a.headCpn;C.createTagSelect({tags:c.tags,renderTo:d.tagSelect?d.tagSelect.getEl():a.getEl(".js-default-tags"),renderBy:"replaceWith",call:function(a){d.tagSelect&&d.tagSelect.destroy(),d.tagSelect=a,a.getEl().css("width","auto")},change:function(a){b.setDefault({tags:a})},afterAddTag:function(d){var e=c.tags||[];e.push(d),b.setDefault({tags:e}),a.createHeadTagSelect()}})}function n(){var a=this,b=a.getParam(),c=a.listData,d=c.getDefault(),e=c.getAllQuestion(),f=e.length;return{type:b.type||0!==f?b.type||e[f-1].type:C.TYPE_DANXUAN,source:d.source,tags:(d.tags||[]).slice(0),defaultScore:d.score||""}}function o(){var a=this,b=a.listData,c=b.getDefault(),d=b.getAllQuestion(),e=a.cpn,f=s.trim(c.source),g=s.trim(c.score),h=c.tags||[];u.forEach(d,function(a){a.source=f,a.tags=h.slice(0),a.defaultScore=g}),b.save(),u.forEach(e,function(a,b){var c=a.cpn;c.sourceIpt&&c.sourceIpt.val(f),c.scoreIpt&&c.scoreIpt.val(g),a.tags=d[b].tags,a.resetTags&&a.resetTags()})}function p(a){var b=this,c=b.listData,d=c.getAllQuestion(),e=d[a],f=e.codeInfo;if(f){var g=E.getDataFile(f.caseDataUrl),h={dataFile:g,timeLimit:+f.timeLimit||0,memoryLimit:s.trim(f.memoryLimit),caseCount:f.caseCount,title:f.title,content:e.content,inputDesc:f.inputDesc,outputDesc:f.outputDesc,inOutSample:u.json(f.testCasesExt).samples,mark:f.hint,checkerFileName:f.checkerFileName};b.db.set(e.id,h),G.fire("refreshVerify",{questionId:e.id})}}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Clazz,u=(q.Str,q.Base),v=q.Dom,w=q.Num,x=q.Db,y=q.Component,z=r.Popup,A=r.Input,B=a("../../../../../core/module"),C=a("../util/util"),D=a("../util/list"),E=a("../util/util"),F=a("../util/type"),G=a("../../../../../util/notify"),H=a("../../../../../core/siteConfig"),I=c.exports=t.create();t.mix(I,B,{style:"/stylesheets/styles/system/includedExercise.css",title:"试题录入",_template:['<div class="steps-main">','<div class="js-steps"></div>','<div class="include-content">','<div class="include-oprt clearfix js-summary" style="display:none;">','<span class="subject-count">共有题目 <span class="font-green js-question-count">0</span> 题</span>','<div class="form-group"><label class="control-label">本批题目备注</label><div class="control-group"><span class="js-default-source"></span></div></div>','<div class="form-group"><label class="control-label">默认知识点</label><div class="control-group"><span class="js-default-tags"></span></div></div>','<div class="form-group"><label class="control-label">默认分值</label><div class="control-group"><span class="js-default-score"></span></div></div>','<a href="javascript:void(0);" class="subject-clear font-green js-clear-all">清空题目</a>',"</div>",'<div class="js-list"></div>',"</div>",'<div class="include-btn-wrap js-action" style="display:none;">','<a href="javascript:void(0);" class="js-add btn btn-primary">新增一题</a>','<a href="javascript:void(0);" class="js-next btn btn-primary">录题完毕，下一步</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=b.find(".js-summary");a.listEl=b.find(".js-list"),a.countEl=c.find(".js-question-count"),a.sizeScroll(),C.initSteps(b.find(".js-steps"),2),a.renderWait(a.listEl),window.setTimeout(function(){C.getTags(function(){a.listEl.html(""),b.find("div.js-action").show(),a.initHead(),a.initContainer(),c.show(),a.initSummary()})},500)}},{name:"click .js-add",handler:function(){var a=this;a.checkAll()&&(a.createItem(a.getDefaultItem()),a.openLast())}},{name:"click .js-next",handler:function(){var a=this;a.checkAll()&&a.nav("question","add/step3/index")}},{name:"click .js-clear-all",handler:function(){var a=this;z.confirm("清空后所有题目无法恢复，是否确定将本次录入题目全部清空？",function(){a.listData.delAllQuestion(),y.recycle(a.listEl,!1),a.cpn.length=0,a.initContainer()})}}]},{initialize:d,initHead:e,initContainer:f,initSummary:g,createItem:h,open:i,openLast:j,order:k,checkAll:l,createHeadTagSelect:m,getDefaultItem:n,changeDefault:o,refreshVerify:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_2/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../core/url","../util/util","../../../../../component/steps","../../../../../action/tag","../../../../../util/ajax","../util/list","../../../../../util/notify"],function(a,b,c){function d(){var a=this;a.listData=t.createList()}function e(){var a=this,b=a.getEl();a.sourceIpt=n.transform(b.find(".js-source"))}function f(){var a=this,b=a.getEl();m.forEach([{cls:"js-upload-excel",name:"excel",isExcel:!0},{cls:"js-upload-zip",name:"zip"}],function(c){var d=c.name,e=c.cls,f=c.isExcel,g=b.find("."+e),c=a[d]=o.show({target:g,url:r.uploadQuestion,name:f?"file":"zip",fileType:f?"*.xlsx;":"*.zip;",getFileTypeTips:f?void 0:function(){return'文件类型不正确，支持的类型：zip  ，建议使用<a href="https://sparanoid.com/lab/7z/" class="link-green" target="_blank">7-Zip</a>压缩成zip格式'},beforeSend:function(a){window._ncAuthToken&&a.setRequestHeader("Authorization","Bearer "+window._ncAuthToken)},call:f?function(b){a.load(b.data||[])}:null,error:f?function(a){p.alert(a.msg)}:null});c.fileEl.on("change",function(){g.html(g.html().replace(/【已上传】/,""))}),c.upload=function(){window.setTimeout(function(){(c.fileEl.get(0).files||[])[0];g.html((f?"Excel上传":"题目图片打包上传（可选）")+"【已上传】")},0)},c.clear=function(){},a.pushChild(c)})}function g(){var a=this,b=a.excel,c=a.zip,d=(b.fileEl.get(0).files||[])[0],e=(c.fileEl.get(0).files||[])[0];if(!d)return p.alert("请先选择Excel");var f=a.excel.getUpload(),g=new FormData;g.append("file",d),e&&g.append("zip",e),f.uploadForm(g),m.forEach([b,c],function(a){o.prototype.clear.call(a);var b=a.rawConfig.target;b.html(b.html().replace(/【已上传】/,""))}),o.prototype.clear.call(b),o.prototype.clear.call(c)}function h(a){function b(){var a=c.listData;m.forEach(f,function(b){a.addQuestion(b)}),p.tips("已上传"+f.length+"道题",function(){c.nav("question","add/step3/index")})}var c=this;if(0===a.length)return p.alert("题目数量为空");var d=k.trim(c.sourceIpt.val()),e="",f=[];m.forEach(a,function(a,b){if(a.error)e+="<div>第"+(b+1)+"题解析失败，出错原因："+(a.msg||"未知")+"</div>";else if(a.question){a=a.question||{};var c=a.type,g=a.content||"",h=3===c,g=h?g.replace(/\[\$\#\#\$\]/g,"()"):g,i={type:c,content:g,difficulty:a.difficulty||3,source:d,answer:a.reference||"",discardAnswerOrder:a.discardAnswerOrder,defaultScore:a.defaultScore||"",tags:m.map(a.tags,function(a){return{id:a.id,text:a.name||""}}),option:m.map(a.options,function(a){return{content:a.content||"",right:!!a.right}}),gap:h?((a.options[0]||{}).content||"").split(/\[\$\#\#\$\]/):[]};f.push(i)}});var g=0===f.length;e&&g?p.alert(e):g?p.error("题目数量为空"):e?(e+="<div>是否忽略本题继续上传？</div>",p.confirm(e,b)):b()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Clazz,m=i.Base,n=(i.Str,j.Input),o=j.AttachUpload,p=j.Popup,q=a("../../../../../core/module"),r=(a("../../../../../core/siteConfig"),a("../../../../../core/url")),s=a("../util/util"),t=a("../util/list"),u=c.exports=l.create();l.mix(u,q,{style:"/stylesheets/styles/system/includedExercise.css",title:"试题录入",_template:['<div class="steps-main">','<div class="js-steps"></div>','<div class="include-content">','<div class="include-module">','<dl class="include-tips">',"<dt>重要提醒</dt>","<dd>1、请严格按照预设模板进行题目录入，保证所有单元格均为文本格式；</dd>","<dd>2、为防止解析出错，不同题型请放入不同的单元簿中；</dd>","<dd>3、如题目或选项中有图片，请按照模板示例在单元格中插入图片的标题，例如[选项图]；</dd>","<dd>4、题目描述、选项、答案均为必填项。</dd>","</dl>",'<div class="module-box">','<div class="module-head clearfix"><h1>除编程题之外的其他题型</h1></div>','<div class="module-body">','<div class="include-online">','<p class="online-tips">请<a href="http://ncstatic.oss-cn-hangzhou.aliyuncs.com/hr/excel/%e7%89%9b%e5%ae%a2%e5%87%ba%e9%a2%98%e8%a7%84%e8%8c%83V4%ef%bc%88%e4%b8%8d%e5%90%ab%e7%bc%96%e7%a8%8b%ef%bc%89.xlsx" class="link-green" target="_blank">下载出题模板</a>，按格式填好后再进行上传</p>','<div class="ctrl-ways">','<div style="margin:0 auto 15px;" class="control-group js-source">','<input type="text" placeholder="输入本批题目来源或用处" />',"</div>",'<a href="javascript:void(0);" class="btn btn-info js-upload-excel">Excel上传</a>','<a href="javascript:void(0);" class="btn btn-info js-upload-zip">题目图片打包上传（可选）</a>','<a href="javascript:void(0);" class="btn btn-primary js-load">上传完毕，下一步</a>',"</div>","</div>","</div>","</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();s.initSteps(b.find(".js-steps"),2),a.initCpn(),a.initUpload()}},{name:"click .js-load",handler:function(){var a=this;a.upload()}}]},{initialize:d,initCpn:e,initUpload:f,upload:g,load:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/main",["nc","cpn","./part/demo","./part/content/index","./part/content/editor","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","./util/line","./part/content/preview","./util/list","./util/parse","../../../../../../kit/md/markdown","./part/input"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=a.actionMap={};o.forEach(b.actions,function(b){var d=n('<a href="javascript:void(0);" class="btn btn-primary btn-sm">'+b.title+"</a>"),e=b.type;a.oprtEl.append(d),e&&(c[e]=d,d.on("click",function(b){b.preventDefault(),a.fire(e)}))})}function e(){var a=this,b=a.getInput(!0),c=b.val();return c.questions}function f(){var a=this,b=a.getInput(!0),c=b.val(),d=c.questions||[];if(0===d.length)return r.alert("录入的题目为空"),!1;var e=c.error||[];return e.length>0?(e=o.map(e,function(a){return a+1}),r.alert("第"+e.join(",")+"题有问题，请按提示检查"),!1):!0}function g(){var a=this;a.goDemo(!a.isDemo)}function h(a){var b=this,c=a!==!1;b.isDemo=c,b.demo=b.getDemo(c),b.input=b.getInput(!c),b.demo&&b.demo[c?"show":"hide"](),b.input&&b.input[c?"hide":"show"](),b.actionMap&&n(b.actionMap.demo).html(c?"返回输入":"查看样例"),b.resize()}function i(a){var b=this;return!b.demo&&a&&(b.demo=new s({renderTo:b.bodyEl})),b.demo}function j(a){var b=this,c=b.rawConfig;return!b.input&&a&&(b.input=new t({renderTo:b.bodyEl,content:c.content,listeners:{change:function(a){b.fire("change",a)}}})),b.input}function k(a,b){var c=this,d=c.getEl();a=c.width=a||c.width,b=c.height=b||c.height,d.outerHeight(b);var e=c.headEl.outerHeight(),f=b-e;c.bodyEl.outerHeight(f),c.demo&&c.demo.resize(a,f),c.input&&c.input.resize(a,f)}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=(l.Str,l.Component),r=m.Popup,s=a("./part/demo"),t=a("./part/input"),u=c.exports=p.create();p.mix(u,q,{_template:['<div class="online-coding" style="overflow:hidden;">','<div class="module-box js-main">','<div class="module-head clearfix js-head">','<div class="module-head-oprt js-oprt"></div>',"<h1>题目录入（编程题除外）</h1>",'<p class="module-head-tips">为保证页面流程，请一次性录入题目控制在50题内，如题目过多，可分批次录入。</p>',"</div>",'<div class="module-body js-body" style="overflow:hidden;"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.headEl=b.find(".js-head"),a.bodyEl=b.find(".js-body"),a.oprtEl=b.find(".js-oprt"),a.initOprt(),a.goDemo(!1)}},{name:"winResize",type:"custom",handler:function(a,b){var c=this;c.resize(a,b)}}]},{initOprt:d,val:e,check:f,toggleType:g,goDemo:h,getDemo:i,getInput:j,resize:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/part/content/editor",["ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","nc","cpn","../../util/line"],function(a,b,c){function d(){var a=this;a.initMode()}function e(){r.defineMode("questions",function(){return{startState:function(){return{}},token:function(a,b){if(b.isQuestionBegin)return b.isQuestionBegin=!1,a.skipToEnd(),null;var c=a.string,d=/^(\d+)[\.．。、\:：、\s\/\\\)）]*(?:\[|【)(.*?)(?:\]|】)(.*)$/.exec(c);return d||(d=/^(\d+)[\.．。、\:：、\s\/\\\)）]+(?:(?:\[|【)(.*?)(?:\]|】))?(.*)$/.exec(c)),d?(a.skipTo(c[d[1].length]),b.isQuestionBegin=!0,"nc-seq"):(a.skipToEnd(),null)}}})}function f(){var a=this,b=a.getEl(),c=a.editor=new r(b.get(0),{theme:"monokai",indentUnit:4,lineNumbers:!0,mode:"questions"});c.setOption("gutters",["CodeMirror-linenumbers",A]);var d=null;c.on("change",function(b,c){var e=b.getValue();if((!e||e===d)&&(a._lastDisplayLine=null),d=e,!a._noFireChange){a._changeFromFix=!1;var f=((c||{}).from||{}).line||0;a.fire("change",b,f)}});var e=x.frequency(250);c.on("scroll",function(b){e(function(){var c=b.getScrollInfo(),d=(c.top||0)+100,e=b.lineAtHeight(d,"local");a.createTips(),a.fire("scroll",e)})})}function g(a,b){var c=this,d=c.getEl();d.outerWidth(a).outerHeight(b),c.editor.setSize(a,b)}function h(a,b){var c=this,d=c.editor;return 0===arguments.length?d.getValue()||"":(b?c.keepNoChange(function(){d.setValue(a||"")}):d.setValue(a||""),void(c._lastDisplayLine=null))}function i(a){var b=this,c=b.editor,d=c.doc,e=d.lineCount(),f=a.length;b.keepNoChange(function(){if(e>f){var b=f-1,c=e-1;d.replaceRange("",{line:b,ch:d.getLine(b).length},{line:c,ch:d.getLine(c).length})}w.forEach(a,function(a,b){if(e>b){var c=d.getLine(b);a!==c&&d.replaceRange(a,{line:b,ch:0},{line:b,ch:c.length})}else{var f=e-1;d.replaceRange("\n"+a,{line:f,ch:d.getLine(f).length}),e++}})})}function j(a){var b=this,c=b.editor,d=c.doc,e=d.lineCount(),f={},g={},h=b._lastDisplayLine||[];w.forCount(Math.max(a.length,h.length,e),function(b){a[b]&&(f[a[b].line]=a[b]),h[b]&&(g[h[b].line]=h[b])}),w.forCount(e,function(a){var c=f[a],d=g[a];if(c){var e=d&&c.isSameMark(d);e&&c.hasMark()||b.clearLine(a),e||(c.mark&&b.addMark(c),c.ext.length>0&&b.addExt(c))}else b.clearLine(a)}),b.createTips(),b._lastDisplayLine=w.map(a,function(a){return a.clone()})}function k(a){var b=this,c=b.editor,d=a.mark||{},e=d.type,f={};if(f[z.mark.success]="icon-ok-sign",f[z.mark.error]="icon-exclamation-sign",f[z.mark.ignore]="icon-warning-sign",e&&f[e]){var g=C.cloneNode(),h=a.line;g.className=f[e]+" js-mark-tips",g.setAttribute("title",d.content||""),c.setGutterMarker(h,A,g),e===z.mark.ignore&&c.addLineClass(h,"text",e)}}function l(a){var b=this,c=b.editor,d=a.ext,e=a.line;w.forEach(d,function(a){var b=a.type;if(b===z.ext.seperator){var d=D.cloneNode();c.addLineWidget(e,d,{above:!0})}else{var f={};f[z.ext.error]={content:"!&nbsp;",cls:"error"},f[z.ext.warn]={content:"!&nbsp;",cls:"warn"},f[z.ext.info]={content:">&nbsp;",cls:"info"};var g=f[b];if(g){var h=B.cloneNode(!1);h.className="cm-nc-hint "+g.cls,h.innerHTML=g.content+a.content,c.addLineWidget(e,h)}}})}function m(){var a=this,b=a.editor,c=b.doc;w.forCount(c.lineCount(),function(b){a.clearLine(b)})}function n(a){var b=this,c=b.editor;c.setGutterMarker(a,A),c.removeLineClass(a,"text");var d=c.lineInfo(a);d.widgets&&(w.forReverse(d.widgets,function(a){a&&a.clear()}),d.widgets.length=0)}function o(a){var b=this;if(a){var c=b.editor,d=c.getScrollInfo();a&&a(),c.scrollTo(d.left,d.top)}}function p(a){var b=this,c=b.editor,d=c.doc,e=d.getCursor(),f=b._noFireChange;b._noFireChange=!0,a&&a(),b._noFireChange=f,c.doc.setCursor(e)}function q(){y.title(".js-mark-tips",{initConf:{noCenter:!0}})}a("ncPlugin/codemirror/style/codemirror.css"),a("ncPlugin/codemirror/style/theme/monokai.css");var r=a("ncPlugin/codemirror/codemirror"),s=a("nc"),t=a("cpn"),u=(s.$,s.Component),v=s.Clazz,w=s.Base,x=s.Time,y=t.Tips,z=a("../../util/line"),A="CodeMirror-nc-hintgutter",B=document.createElement("div"),C=document.createElement("span"),D=document.createElement("hr"),E=c.exports=v.create();v.mix(E,u,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initEditor(),a.val(b.value),a.resize(b.width||250,b.height||250)}}]},{initialize:d,initMode:e,initEditor:f,resize:g,val:h,valWithoutClear:i,display:j,addMark:k,addExt:l,clear:m,clearLine:n,keepTop:o,keepNoChange:p,createTips:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/part/content/index",["nc","cpn","./editor","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","../../util/line","./preview"],function(a,b,c){function d(){{var a=this;a.getEl()}a.editor=new n({renderTo:a.editEl,listeners:{change:j.bind(a.fire,a,"change"),scroll:function(b){var c=j.findIndex(a.indexs,function(a){return a[b]});if(c>=0&&a.preview){var d=a.preview.getItemDv(c);l.scrollToEl({el:d,scrollEl:a.previewEl,ext:-20})}}}})}function e(){{var a=this;a.getEl()}a.preview=new o({renderTo:a.previewEl})}function f(){var a=this;return a.editor.val.apply(a.editor,arguments)}function g(a){var b=this;b.indexs=j.map(a,function(a){return j.toMap(a,function(a){return{key:a,value:!0}})})}function h(a,b){var c=this,d=c.getEl();a/=2,d.outerHeight(b),c.editEl.outerWidth(a).outerHeight(b),c.previewEl.outerWidth(a).outerHeight(b),c.editor.resize(a,b)}var i=a("nc"),j=(a("cpn"),i.$,i.Base),k=i.Clazz,l=(i.Str,i.Dom),m=i.Component,n=a("./editor"),o=a("./preview"),p=c.exports=k.create();k.mix(p,m,{_template:['<div class="code-mod-bd" style="overflow:hidden;">','<div class="code-mod-main">','<div class="code-mod-detail" style="margin:0;">','<div class="edit-code-box js-edit" style="padding:0;"></div>','<div class="review-code-box js-preview" style="overflow-x:hidden;overflow-y:auto;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.editEl=b.find(".js-edit"),a.previewEl=b.find(".js-preview"),a.initEditor(),a.initPreview()}}]},{initEditor:d,initPreview:e,val:f,valIndexs:g,resize:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/part/content/preview",["nc","cpn"],function(a,b,c){function d(){}function e(a){var b=this,c=b.globalEl,d=b.confEl;if(!a||0===m.size(a))return c.hide(),void d.html("");var e="",f=[{key:"type",name:"题型"},{key:"difficulty",name:"难度"},{key:"tags",name:"知识点"},{key:"defaultScore",name:"分值"},{key:"source",name:"备注"}];m.forEach(f,function(b){var c=a[b.key],d=b.name;c="tags"===b.key?(c||[]).join(","):c,c&&(e+='<div class="detail-item"><span class="label">'+d+'：</span><div class="content">'+c+"</div></div>")}),d.html(e),c.show()}function f(a){var b=this;b.renderListFrequency=b.renderListFrequency||o.frequency(500),b.renderListFrequency(function(){var c=m.map(a,function(a,c){return b.getItemHtml(c+1,a)}).join("");b.contentEl.html(c)})}function g(a,b){var c=m.id(b.type),d={1:"单选",2:"不定项",3:"填空",4:"编程",5:"问答"}[c],e="3"===c,f="5"===c,g=m.map(b.content,function(a,c){return[a,e&&c+1!==b.content.length?'<span class="blank-num">'+(c+1)+"</span>":""].join("")}).join(""),h="";return f?h='<div class="detail-item"><span class="label">答案：</span><div class="content">'+(b.answer||"")+"</div></div>":e&&(h=m.map(b.answer,function(a,b){return n.execTpl('<div class="detail-item"><span class="blank-num">#{index}</span> <div class="content">#{{content}}</div></div>',{index:e?b+1:"",content:a.replace(/\|\|\|/g," 或 ")})}).join("")),n.execTpl(['<div class="question-box js-item">','<div class="question-main">','<div class="topic-item">','<span class="review-num">#{index}、</span>','<span class="">[#{type || 未指定}]</span>','<span class="code-tag">难度系数：#{difficulty || 未指定}</span>','<span class="code-tag">分值：#{defaultScore || 未指定}</span>','<span class="code-tag">知识点：#{{tags || 未指定}}</span>',"</div>",'<div class="detail-item">#{content}</div>',"#{options}","#{answer}",b.reference?'<div class="detail-item"><span class="label">解析：</span><div class="content">#{reference || 无}</div></div>':"","3"===c?'<div class="detail-item"><span class="label">答案形式：</span><div class="content">#{answerMode}</div></div>':"",b.source?'<div class="detail-item"><span class="label">备注：</span><div class="content">#{{source || 无}}</div></div>':"","</div>","</div>"].join(""),{index:a||1,type:d,tags:(b.tags||[]).join("、"),difficulty:b.difficulty?b.difficulty+"星":"",defaultScore:b.defaultScore||"",content:g,options:m.map(b.options,function(a,b){return n.execTpl(['<div class="detail-item #{cls}">','<span class="label">#{index}.</span><div class="content">#{content}</div>',"</div>"].join(""),{cls:a.right?"correct":"",index:p[b],content:a.content})}).join(""),answer:h,reference:b.reference,answerMode:"顺序可不一致"===b.answerMode?b.answerMode:"完全一致",source:b.source})}function h(a){var b=this;return j(b.contentEl.find(".js-item")[a])}var i=a("nc"),j=(a("cpn"),i.$),k=i.Component,l=i.Clazz,m=i.Base,n=i.Str,o=i.Time,p="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),q=c.exports=l.create();l.mix(q,k,{_template:["<div>",'<div class="module-box js-global" style="display:none;border-bottom:1px solid #dedede;">','<div class="module-head clearfix"><h1>全局设置(默认)</h1></div>','<div class="module-body js-conf"></div>',"</div>",'<div class="module-box">','<div class="module-head clearfix"><h1>题目预览</h1></div>','<div class="module-body js-question"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.globalEl=b.find(".js-global"),a.confEl=b.find(".js-conf"),a.contentEl=b.find(".js-question")}}]},{initialize:d,renderGlobal:e,renderList:f,getItemHtml:g,getItemDv:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/part/demo",["nc","cpn","./content/index","./content/editor","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","../util/line","./content/preview","../util/list","../util/parse","../../../../../../../kit/md/markdown"],function(a,b,c){function d(){var a=this,b=a.getEl();a.typeSelect=new n({renderTo:b.find(".js-type"),renderBy:"replaceWith",options:[{text:"单选",value:"1",checked:!0},{text:"不定项",value:"2"},{text:"填空",value:"3"},{text:"问答",value:"5"}],change:j.bind(a.refresh,a)}),a.explainSwitch=new o({renderTo:b.find(".js-explain"),renderBy:"replaceWith",checked:!0,change:j.bind(a.refresh,a)})}function e(){var a=this,b=a.list=new q,c=1/0,d=m.frequency(500),e=a.content=new p({renderTo:a.contentEl,listeners:{change:function(a,f){c=Math.min(f||0,c),d(function(){var d=c;c=1/0,b.parse(a.getValue(),d);var f=b.valParse(),g=[],h=[];j.forEach(f.data,function(a){g.push(a.question),h.push(a.index)}),e.preview.renderGlobal(f.global),e.preview.renderList(g)})}}});e.editor.editor.setOption("readOnly",!0)}function f(){var a=this,b=[{content:"题型：单选",tips:["设置默认题型，如果题目不指定则使用此默认值，支持如下题型：单选,不定项,填空,问答"]},{content:"难度：3",tips:["设置默认难度，如果题目不指定则使用此默认值，难度的范围：1~5，默认3"]},{content:"知识点：牛客,题目录入,测试",tips:["设置默认知识点，如果题目不指定则使用此默认值"]},{content:"分值：100",tips:["设置默认分值，如果题目不指定则使用此默认值"]},{content:"备注：牛客网智能解析例题",tips:"设置默认备注，备注在组卷时选择题目使用，建议填写"}],c={content:"难度：3",tips:"难度的范围：1~5，默认3"},d={content:"分值：10",tips:"设置分值，出卷时优先使用该分值"},e={content:"知识点：牛客,服务,在线笔试",tips:"题目考核的知识点，多个通过,分隔，可以不提供"},f={content:"备注：牛客网智能解析例题",tips:"组卷时选择题目使用，建议填写"},g=[{content:"1.[单选]最好的在线笔试产品是哪个？",tips:"题干以 数字开头. ，通过[ ]指定当前题目的 题型",method:["markSuccess","seperator"]},{content:"A.牛客网",tips:"选项以 字母. 开头，单选题选项的个数不能少于2个"},{content:"B.百度"},{content:"C.阿里巴巴"},{content:"D.腾讯"},{content:"答案：A",tips:"选择题的答案用选项的字母序号代表正确选项，必须提供<br />单选题答案的正确选项只能有一个"},{content:"解析：很明显是牛客网啊！",tips:"考生查答案时可显示该信息，达到学习的目的，可以不提供"},c,d,e,f],h=[{content:"1.[不定项]牛客网提供哪些服务？",tips:"题干以 数字开头. ，通过[ ]指定当前题目的 题型",method:["markSuccess","seperator"]},{content:"A.在线笔试",tips:"选项以 字母. 开头，单选题选项的个数不能少于2个"},{content:"B.在线面试"},{content:"C.课程学习"},{content:"D.实习求职"},{content:"答案：ABCD",tips:"选择题的答案用选项的字母序号代表正确选项，必须提供<br />不定项选择题至少存在一个正确选项"},{content:"解析：很明显全都有啊！",tips:"考生查答案时可显示该信息，达到学习的目的，可以不提供"},c,d,e,f],i=[{content:"1.[填空]最好的在线笔试产品是()，官网链接是()？",tips:"题干以 数字开头. ，通过[ ]指定当前题目的 题型<br />题干通过()指定填空<br />填空题至少存在一个填空",method:["markSuccess","seperator"]},{content:"答案1：牛客网|||nowcoder|||牛客",tips:"答案以 答案+序号 提供对应的答案，同一个空的多个参考答案可使用|||分割"},{content:"答案2：http://www.nowcoder.com"},{content:"解析：很明显是送分题啊！",tips:"考生查答案时可显示该信息，达到学习的目的，可以不提供"},{content:"答案形式：顺序可不一致",tips:"答案形式可填：完全一致、顺序可不一致，默认为[完全一致]"},c,d,e,f],k=[{content:"1.[问答]牛客网提供哪些服务？",tips:"题干以 数字开头. ，通过[ ]指定当前题目的 题型",method:["markSuccess","seperator"]},{content:"答案：在线笔试，在线面试，课程学习，实习求职等",tips:"问答题提供的答案仅作为判卷时的参考答案"},{content:"官网链接是：http://www.nowcoder.com"},{content:"解析：问答题没有解析，请将内容填写在答案中",method:["markIgnore"]},c,d,e,f],l=a.typeSelect.val(),m=a.explainSwitch.isChecked(),n=b.concat({1:g,2:h,3:i,5:k}[l]),o=[],p=[];j.forEach(n,function(a,b){if(o.push(a.content),a.method||m&&a.tips){var c=new r({line:b,data:{raw:a.content}});m&&a.tips&&c.info(a.tips),j.forEach(a.method,function(a){c[a]&&c[a]()}),p.push(c)}}),a.content.val(o.join("\n")),p.length>0&&a.content.editor.display(p)}function g(a,b){var c=this,d=c.getEl(),e=c.toolEl.outerHeight();d.outerHeight(b),c.content.resize(a,b-e)}var h=a("nc"),i=a("cpn"),j=(h.$,h.Base),k=h.Clazz,l=h.Component,m=h.Time,n=i.Select,o=i.Switch,p=a("./content/index"),q=a("../util/list"),r=a("../util/line"),s=c.exports=k.create();k.mix(s,l,{_template:['<div style="overflow:hidden;">','<div class="code-mod-hd js-tool">','<div class="code-item">','<label style="margin-right:10px;">样例</label>','<div class="btn-group js-type"></div>',"</div>",'<div class="code-item">说明<span class="js-explain"></span></div>',"</div>",'<div class="js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.toolEl=b.find(".js-tool"),a.contentEl=b.find(".js-content"),a.initCpn(),a.initContent(),a.refresh()}}]},{initCpn:d,initContent:e,refresh:f,resize:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/part/input",["nc","cpn","./content/index","./content/editor","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","../util/line","./content/preview","../util/list","../util/parse","../../../../../../../kit/md/markdown"],function(a,b,c){function d(){function a(b,c,d){var k=this;f=Math.min(c||0,f),g(function(){var c=f;if(f=1/0,e.parse(b.getValue(),c),!d){var g=e.valFix();if(g)return i=b.getScrollInfo(),j.editor.valWithoutClear(g),void a.call(k,b,c,!0)}i=i||b.getScrollInfo();var l=e.valParse(),m=[],n=[];h.forEach(l.data,function(a){m.push(a.question),n.push(a.index)}),j.preview.renderGlobal(l.global),j.preview.renderList(m),j.valIndexs(n);var o=e.checkAll();j.editor.display(o),i&&b.scrollTo(i.left,i.top),i=null})}var b=this,c=b.rawConfig,d=b.getEl(),e=b.list=new m,f=1/0,g=k.frequency(500),i=null,j=b.content=new l({renderTo:d,listeners:{change:function(c,d){b.fire("change",this.val()),a.call(this,c,d)}}});j.val(c.content||"")}function e(){var a=this,b=a.list,c=b.getError(),d=h.map(b.valParse().data,function(a){return a.question});return{error:c,questions:d}}function f(a,b){var c=this,d=c.getEl();d.outerHeight(b),c.content.resize(a,b)}var g=a("nc"),h=(a("cpn"),g.$,g.Base),i=g.Clazz,j=g.Component,k=g.Time,l=a("./content/index"),m=a("../util/list"),n=c.exports=i.create();i.mix(n,j,{_template:'<div style="overflow:hidden;" data-type="input"></div>',listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}a.initContent()}}]},{initContent:d,val:e,resize:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/util/line",["nc"],function(a,b,c){function d(a){var b=this;b.state=a.state||null,b.data=a.data||{raw:""},b.line=t.id(a.line)?a.line:null,b.mark=a.mark||null,b.ext=(a.ext||[]).slice(0)}function e(){var a=this;return a.state===u.state.question}function f(){var a=this;a.mark=null,a.ext.length=0}function g(a){var b=this;b.mark={type:u.mark.success,content:a||"该题信息完整"}}function h(){var a=this;r.trim(a.data.raw)&&(a.mark={type:u.mark.ignore,content:"未能解析当前行，做忽略处理"})}function i(a){var b=this;b.mark={type:u.mark.error,content:a||"该题存在错误"}}function j(a){var b=this;a=r.trim(a),a&&b.ext.push({type:u.ext.error,content:a})}function k(a){var b=this;a=r.trim(a),a&&b.ext.push({type:u.ext.info,content:a})}function l(a){var b=this;a=r.trim(a),a&&b.ext.push({type:u.ext.warn,content:a})}function m(){var a=this;a.ext.push({type:u.ext.seperator})}function n(){var a=this;return new u({state:a.state,data:t.extend({},a.data),line:a.line,mark:a.mark?t.extend({},a.mark):null,ext:t.map(a.ext,function(a){return t.extend({},a)})})}function o(){var a=this;return a.mark||a.ext.length>0}function p(a){function b(a,b){return!a&&!b||a&&b&&a.type===b.type&&a.content===b.content}var c=this;if(!b(c.mark,a.mark))return!1;if(c.ext.length!==a.ext.length)return!1;var d=!0,e=c.ext.slice(0),f=a.ext.slice(0);return e.sort(),f.sort(),t.forEach(e,function(a,c){return b(a,f[c])?void 0:(d=!1,t.BREAK)}),d}var q=a("nc"),r=q.$,s=q.Clazz,t=q.Base,u=c.exports=s.create();t.extend(u,{state:{question:1,option:2,ext:3},mark:{success:"success",ignore:"ignore",error:"error"},ext:{seperator:"seperator",error:"error",info:"info",warn:"warn"}}),t.extend(u.prototype,{initialize:d,isQuestion:e,clear:f,markSuccess:g,markIgnore:h,markError:i,error:j,info:k,warn:l,seperator:m,clone:n,hasMark:o,isSameMark:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/util/list",["nc","./line","./parse","../../../../../../../kit/md/markdown"],function(a,b,c){function d(){var a=this;a.line=[]}function e(){var a=this,b=a.valParse(),c=[];return t.forEach(b.data,function(b,d){var e=a.checkQuestion(b.question);e.right||c.push(d)}),c}function f(){var a=this,b=a.line,c=a.valParse();return t.forEach(c.data,function(c){var d=c.index,e=b[d[0]],f=a.checkQuestion(c.question);if(f.right)e.markSuccess("该题信息完整");else{var g="该题存在如下错误:\n"+f.msg;e.markError(g),f.ext&&e.error(g)}}),b}function g(a){var b="1"===a.type,c={msg:""};if(!a.type)return c.msg="请设置有效的题型："+["单选","不定项","填空","问答"].join(","),c.ext=!0,c;var d=(a.content||[]).join("\n");if(!d||!r.trim(d.replace(/<.*?>/gi,""))&&!/<img/gi.test(d))return c.msg="题目内容不能为空",c;if("1"===a.type||"2"===a.type){if((a.options||[]).length<2)return c.msg="至少存在两个选项",c;var e=0,f=0,g=0,h={};if(t.forEach(a.options,function(a){var b=r.trim(a.content);return e+=a.right?1:0,f+=b?0:1,g+=h.hasOwnProperty(b)?1:0,h[b]=!0,f>0||g>0?t.BREAK:void 0}),f>0)return c.msg="选项内容不能为空",c;if(g>0)return c.msg="存在重复选项",c;if(0===e||b&&1!==e)return c.msg=b?"单选题正确选项个数为一个":"不定项选择题至少存在一个正确选项",c}else if("3"===a.type){var i=(a.answer||[]).length,j=Math.max(0,a.content.length-1);if(0===j)return c.msg="至少存在一个填空项",c;var k=t.find(a.answer,function(a){return!r.trim(a)});if(k)return c.msg="答案内容不能为空",c;if(i!==j)return c.msg="答案的个数("+i+"个)与本题的填空数("+j+"个)不匹配",c}return c.right=!0,c}function h(){function a(a){var b=d(a),c=-1,e=-1;return t.forEach(b.content,function(b,d){return t.forEach(b,function(b,f){return b.line===a?(c=d,e=f,t.BREAK):void 0}),-1!==e?t.BREAK:void 0}),-1===e?null:{index:c,line:e}}function b(a){var b=d(a),c=-1,e=-1;return t.forEach(b.options,function(b,d){return t.forEach(b,function(b,f){return b.line===a?(c=d,e=f,t.BREAK):void 0}),-1!==e?t.BREAK:void 0}),-1===e?null:{index:c,line:e}}function c(a){var b=d(a),c=-1,e=-1;return t.forEach(b.answer,function(b,d){return t.forEach(b,function(b,f){return b.line===a?(c=d,e=f,t.BREAK):void 0}),-1!==e?t.BREAK:void 0}),-1===e?null:{index:c,line:e}}function d(a){var b=k[a];return i[b].line}function e(a,b,c,d){return a.substring(0,b)+d+a.substring(c)}var f=this,g=f.line,h=f.valParse(),i=h.data,j=(h.global,!1),k={},l={};t.forEach(i,function(a,b){t.forEach(a.index,function(a){k[a]=b});var c=Math.max.apply(Math,a.index);l[c]=b});var m=[];return t.forEach(g,function(d,f){var g,h=k[f],n=d.data,o=n.raw,p=t.id(h)?i[h]:null,q=p?p.question.type:null,s="1"===q,u="2"===q,v="3"===q;if(p)if(g=a(f))0===g.line&&(t.id(h+1)!==n.index&&(o=e(o,0,n.index.length,h+1),j=!0),/^\s+/.test(o)&&(o=o.replace(/^\s+/,""),j=!0));else if(g=b(f)){var x=n.order;if(0===g.line){if(1===p.line.options.length){var z=w.getItemContent(p.line.options).join(" ").split(/\s+(?:[A-Za-z])[\.．。、\:：、\s]+/),A=[];if(t.forEach(z,function(a){a=r.trim(a),a&&A.push(a)}),A.length>1)return t.forEach(A,function(a,b){m.push(y[b]+". "+a)}),void(j=!0)}y[g.index]!==x&&(o=e(o,0,o.indexOf(x)+x.length,y[g.index]),j=!0),/^\s+/.test(o)&&(o=o.replace(/^\s+/,""),j=!0)}}else if((g=c(f))&&0===g.line){var B=n.rawType,C="答案"+(v?g.index+1:"");B!==C&&(o=e(o,0,o.indexOf(B)+B.length,C),j=!0)}m.push(o),p&&t.id(l[f])&&l[f]+1!==i.length&&(s||u)&&p.line.options&&p.line.options.length>1&&(p.line.originalAnswer&&0!==p.line.originalAnswer.length||(m.push("答案："),j=!0))}),j?m:null}function i(){var a=this;if(a._parseId!==z){var b=a.valIndex(),c=a.line.slice(0),d=[],e={};t.forEach(b,function(b,f){var g=w.parse(c,b,e);g&&d.push(g),0!==f||g||(e=a.parseConfig(c,b))}),a._parseId=z,a._parseCache={data:d,global:e}}return a._parseCache}function j(){var a=this,b=a.line,c=[],d=[];return t.forEach(b,function(a,b){a.clear(),a.isQuestion()&&d.length>0&&(a.seperator(),c.push(d),d=[]),d.push(b)}),d.length>0&&c.push(d),c}function k(a,b){var c=this,d=a.split(/\n/),e=c.line;z++,b=+b||0,t.forEach(d,function(a,d){d>=b&&c.parseLine(d,a)}),e.length=d.length}function l(a,b){var c=this,d=c.parseCache=c.parseCache||{};if(!b)return void(c.line[a]=new v({state:null,data:{raw:b},line:a}));var e=[{name:"parseQuestion",state:v.state.question},{name:"parseOption",state:v.state.option},{name:"parseExt",state:v.state.ext}];t.forEach(e,function(e){var f=e.name;d[f]=d[f]||{},b in d[f]||(d[f][b]=c[f](b));var g=d[f][b],h=!!g;return c.line[a]=new v({state:h?e.state:null,data:h?g:{raw:b},line:a}),h?t.BREAK:null})}function m(a){var b=/^\s*(\d+)[\.．。、\:：、\s\/\\\)）]*(?:\[|【)(.*?)(?:\]|】)(.*)$/.exec(a);return b||(b=/^\s*(\d+)[\.．。、\:：、\s\/\\\)）]+(?:(?:\[|【)(.*?)(?:\]|】))?(.*)$/.exec(a)),b?{index:r.trim(b[1]),type:r.trim(b[2]),content:r.trim(b[3]),raw:a}:null}function n(a){var b=/^\s*([A-Za-z])[\.．。、\:：、\s]+(.*)$/.exec(a);return b?{order:r.trim(b[1]),content:r.trim(b[2]),raw:a}:null}function o(a){var b=/^\s*(答案\d*为?|解析|答案形式|难度|知识点|分值|备注)[\:：\s]+(.*)$/.exec(a);return b?{type:r.trim(b[1]).replace(/\d+/g,"").replace(/为/g,""),rawType:r.trim(b[1]),content:r.trim(b[2]),raw:a}:null}function p(a,b){var c={};return t.forEach(b,function(b){var d=a[b],e=/^\s*(题型|难度|知识点|分值|备注)[\:：\s]+(.*)$/.exec(d.data.raw);if(e){var f=r.trim(e[1]),g=r.trim(e[2]),h={"题型":"type","难度":"difficulty","知识点":"tags","分值":"defaultScore","备注":"source"}[f];if(c[h])d.warn("重复定义"+f+"，已经忽略此配置");else if(g)if("tags"===h){var i=t.map(g.split(/\s+|,|，|、/),function(a){return a});i.length>0&&(c[h]=i,d.clear())}else"defaultScore"===h?g&&g===u.fix(g)?(c[h]=g,d.clear()):d.error("分值请填写数字"):(c[h]=g,d.clear())}}),c}var q=a("nc"),r=q.$,s=q.Clazz,t=q.Base,u=q.Num,v=a("./line"),w=a("./parse"),x=c.exports=s.create(),y="ABCDEFGHIJKLMNOPQRST",z=0;t.extend(x.prototype,{initialize:d,getError:e,checkAll:f,checkQuestion:g,valFix:h,valParse:i,valIndex:j,parse:k,parseLine:l,parseQuestion:m,parseOption:n,parseExt:o,parseConfig:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/cpn/util/parse",["nc","../../../../../../../kit/md/markdown","./line"],function(a,b,c){function d(a,b,c){function d(a,b){a&&e[a]&&e[a](g,h,b.slice(0))}var e=this,f={index:b.slice(0),question:{},line:{}},g=f.question,h=f.line,i=a[b[0]],j=i.isQuestion(),k=j?e.getType(i.data.type?i.data.type:c.type):"";if(!j||!k)return u.forEach(b,function(b){a[b].markIgnore()}),j?f:null;g.type=h.type=k,g.difficulty=c.difficulty||3,g.tags=(c.tags||[]).slice(0),g.defaultScore=c.defaultScore||"",g.source=c.source||"";var l=x.state,m=e.getConf(k),n=0,o=[],p=null,q=!1;if(u.forEach(b,function(c,e){var f=a[c],g=f.data,h=f.state,i=m[n],j=m[n+1];if(i.tagStart&&i.tagEnd){var k=new RegExp("^"+i.tagStart),r=new RegExp(i.tagEnd+"\\s*$");0===e&&k.test(g.content)&&!r.test(g.content)&&(q=!0),q&&0!==e&&r.test(a[b[e-1]].data.raw)&&(q=!1)}if(j&&!q&&l[j.name]===h&&(d(i.parse,o),o.length=0,n++,i=j),l[i.name]===h){if(0===(i.items||[]).length||!i.key)return o.push([f]),void(p=null);var s=g[i.key],t=u.find(i.items,function(a){return a[i.key]===s});t?p?(d(p.parse,o),o.length=0,o.push([f])):o.push([f]):(f.markIgnore(),p&&o.length>0&&(d(p.parse,o),o.length=0)),p=t}else i.continuous||p&&p.continuous?o[o.length-1].push(f):f.markIgnore()}),o.length>0){var r=p?p.parse:m[n]?m[n].parse:"";d(r,o)}return f}function e(a,b,c){var d=this,e="3"===u.id(a.type),f=d.getItemContent(c).join(y);f=f.replace(new RegExp(z,"g"),"").replace(new RegExp(A,"g"),""),f=d.md2html(f);var g=e?(f||"").split(/(?:\(|（)\s*(?:\)|）)/):[f];a.content=g,b.content=c}function f(a,b,c){var d=this,e={},f=[],g=[];u.forEach(c,function(a){var b=a[a.length-1];if(f.length>26)return void b.warn("选项数量达到26个，已经忽略此选项");var c="",h=[];u.forEach(a,function(a,b){var d=0===b,e=a.data;d&&(c=e.order),h.push(e[d?"content":"raw"]||"")});var i=h.join(y);t.trim(i)?(e[i]=e[i]||[],e[i].push(b)):b.error("选项内容不能为空"),f.push({order:c,content:d.md2html(i)}),g.push(a)});var h=0;u.forEach(e,function(a){if(a.length>1){h++;var b="该选项与其他选项重复("+h+")";u.forEach(a,function(a){a.error(b)})}}),a.options=f,b.options=g}function g(a,b,c){var d=this,e=a.type,f=d.getItemContent(c).join(y),g=c[0][0];if(b.originalAnswer=c,"1"===e||"2"===e){var h="1"===e,i=u.filter(f.toUpperCase().split(/(?:\s|,|，|、|\.|。)*/),function(a){return a}),j=u.toMap(a.options,function(a){return{key:a.order,value:a}}),k=u.uniq(u.filter(i,function(a){return j[a]}));if(0===k.length||h&&1!==k.length)return void g.error("答案解析错误："+(h?"单选题正确选项个数为一个":"不定项选择题至少存在一个正确选项"));u.forEach(a.options,function(a){a.right=!1}),u.forEach(k,function(a){j[a].right=!0}),k.length!==i.length&&g.info("答案已帮您解析为："+k.join(",")),b.answer=c}else if("3"===e){var l=Math.max(0,(a.content||[]).length-1);a.answer=a.answer||[],b.answer=b.answer||[],a.answer.length<l?(a.answer.push(f),b.answer.push(c[0]),!t.trim(f)&&g.error("答案不能为空"),!t.trim(f)&&g.info("同一个空的多个参考答案可使用|||分割")):g.warn("答案的个数大于本题的填空数("+l+"个)，已忽略本行")}else"5"===e&&(a.answer=d.md2html(f),b.answer=c)}function h(a,b,c){var d=this,e=d.getItemContent(c);a.reference=d.md2html(e.join(y)),b.reference=c}function i(a,b,c){var d=this,e=d.getItemContent(c).join("");u.contains(["完全一致","顺序可不一致"],e)?a.answerMode=e:(a.answerMode="完全一致",d.forEachItem(c,function(a){a.warn("答案形式支持填写：完全一致、顺序可不一致"),a.info("答案形式默认设置：完全一致")})),b.answerMode=c}function j(a,b,c){var d=this,e=d.getItemContent(c).join("");({1:1,2:1,3:1,4:1,5:1})[e]?a.difficulty=e:(a.difficulty=a.difficulty||"3",d.forEachItem(c,function(b){b.warn("难度的范围：1, 2, 3, 4, 5"),b.info("难度采用默认设置："+a.difficulty)})),b.difficulty=c}function k(a,b,c){var d=this,e=d.getItemContent(c).join("");e&&e===v.fix(e)?a.defaultScore=e:(a.defaultScore=a.defaultScore||"",d.forEachItem(c,function(b){a.defaultScore?(b.warn("分值请填写数字"),a.defaultScore&&b.info("分值默认设置："+a.defaultScore)):b.error("分值请填写数字")})),b.defaultScore=c}function l(a,b,c){var d=this,e=t.trim(d.getItemContent(c).join(""));a.source=e||a.source||"",a.source||d.forEachItem(c,function(a){a.warn("组卷时选择题目用，建议填写")}),b.source=c}function m(a,b,c){var d=[];u.forEach(c,function(a){u.forEach(a,function(a){var b=a.data,c=b.content||"";u.forEach(c.split(/\s+|,|，|、/),function(a){a&&d.push(a)})})}),a.tags=u.uniq(d),b.tags=c}function n(a){var b={name:"question",parse:"parseContent",continuous:!0,tagStart:z,tagEnd:A},c={name:"option",parse:"parseOption",continuous:!0},d={type:"答案",parse:"parseAnswer",continuous:!1},e={type:"答案",parse:"parseAnswer",continuous:!0},f={type:"解析",parse:"parseReference",continuous:!0},g={type:"答案形式",parse:"parseAnswerMode",continuous:!1},h={type:"难度",parse:"parseDifficulty",continuous:!1},i={type:"分值",parse:"parseScore",continuous:!1},j={type:"备注",parse:"parseSource",continuous:!1},k={type:"知识点",parse:"parseTags",continuous:!1};return{1:[b,c,{name:"ext",key:"type",items:[j,d,f,h,i,k]}],2:[b,c,{name:"ext",key:"type",items:[j,d,f,h,i,k]}],3:[b,{name:"ext",key:"type",items:[j,d,f,g,h,i,k]}],5:[b,{name:"ext",key:"type",items:[j,e,h,i,k]}]}[a]}function o(a){var b=/^(单选|不定项(?:选择)?|填空|问答)题?$/.exec(a);return b?(a=b[1].replace("选择",""),{"单选":"1","不定项":"2","填空":"3","编程":"4","问答":"5"}[a]):null}function p(a){var b=this,c=[];return b.forEachItem(a,function(a,b,d){var e=a.data,f=e[b+d===0?"content":"raw"]||"";c.push(f||"")}),c}function q(a,b){u.forEach(a,function(a,c){u.forEach(a,function(a,d){b&&b(a,c,d)})})}function r(a){var b=[];return u.forEach(a.split("\n"),function(a){a=t.trim(a),a&&(a=a.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\s/g,"&nbsp;"),a=0===b.length?a:"<div>"+a+"</div>",b.push(a))}),b.join("")}var s=a("nc"),t=s.$,u=s.Base,v=(s.Str,s.Num),w=a("../../../../../../../kit/md/markdown"),x=a("./line"),y="\n",z="<content>",A="</content>";w.setOptions({sanitize:!0,breaks:!0}),c.exports={type:["单选","不定项","填空","问答"],parse:d,parseContent:e,parseOption:f,parseAnswer:g,parseReference:h,parseAnswerMode:i,parseDifficulty:j,parseScore:k,parseSource:l,parseTags:m,getConf:n,getType:o,getItemContent:p,forEachItem:q,md2html:r}});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_3/index",["nc","cpn","../util/util","../../../../../component/steps","../../../../../core/siteConfig","../../../../../action/tag","../../../../../util/ajax","./cpn/main","./cpn/part/demo","./cpn/part/content/index","./cpn/part/content/editor","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","./cpn/util/line","./cpn/part/content/preview","./cpn/util/list","./cpn/util/parse","../../../../../kit/md/markdown","./cpn/part/input","../util/list","../../../../../util/notify","../../../../../core/module","../../../../../util/util"],function(a,b,c){function d(){var a=this;a.listData=p.createList()}function e(){var a=this,b=a.listData,c=b.getParseContent();k.trim(c)||(c=["题型：单选","难度：3","分值：3","知识点：牛客题目录入样例","备注：牛客校招笔试试卷","1.[单选]请按照这个例题录入题目","其他题型录入样例右上角点击“查看样例”进行参考.","A.如果你的录入内容被错误解析，可以暂时删除解析出错的部分，在下一步进行修改处理","B.如果你录入的内容含图片，可以暂时删除图片，在下一步进行图片添加处理","C.本批题目全部解析正确后，点右上角进入下一步题目审核。\n为方便组卷，请一定要设置这批题目的备注哦。","D.所有选项都正确","答案：D"].join("\n"));var d=a.main=new o({renderTo:a.getEl(),content:c,actions:[{title:"查看样例",type:"demo"},{title:"下一步",type:"next"}],listeners:{demo:function(){d.toggleType()},next:function(){if(d.check()){var b=d.val();a.add2db(b)}},change:function(a){b.updateParseContent(a)}}})}function f(){var a=this;a.sizeFull(function(b,c){a.main.fire("winResize",b,c)})}function g(a){var b=this,c=b.listData,d=[];m.forEach(a,function(a){a.tags&&a.tags&&(d=d.concat(a.tags))}),d=m.uniq(d),b.fillTag(d,function(d){var e=[];m.forEach(a,function(a){var b=[];m.forEach(a.tags,function(a){d[a]&&b.push(d[a])});var f=m.key(),g=3===+a.type,h=5===+a.type,i=(h?a.answer:"")||a.reference,j={id:f,type:a.type,content:a.content.join("()"),difficulty:a.difficulty||3,source:a.source,answer:i,discardAnswerOrder:"顺序可不一致"===a.answerMode?!0:!1,defaultScore:a.defaultScore,tags:b,option:a.options,gap:g?(a.answer||[]).slice(0):[]};c.addQuestion(j),e.push(f)}),c.addParseId(e),b.nav("question",{action:"add/step3/index",from:"parse"})})}function h(a,b){var c=this;if(0===(a||[]).length)return b&&b({});var d=c.getWin(),e=d.showLoading("请稍等...");n.getTags(function(c){var d=m.toMap(c,function(a){return{key:a.text,value:a}}),f=m.filter(a,function(a){return a&&!d[a]});m.forEachAsync(f,function(a,b){n.addTag(a,function(a){d[a.text]=a,b()},b)},function(){e.close(),b(d)})})}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Clazz,m=i.Base,n=(j.Popup,a("../util/util")),o=a("./cpn/main"),p=a("../util/list"),q=a("../../../../../core/module"),r=c.exports=l.create();l.mix(r,q,{style:"/stylesheets/styles/system/onlineCoding.css",extStyle:["ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css"],title:"智能解析",_template:'<div class="cm-nc-tab-space-close"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.listData.delParseQuestion(),a.initMain(),a.initResize()}}]},{initialize:d,initMain:e,initResize:f,add2db:g,fillTag:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step2_4/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../util/util","../../../../../component/steps","../../../../../action/tag","../../../../../util/ajax","../util/list","../../../../../util/notify","../cpn/edit/typeSeries/index","../util/type","../cpn/edit/type1","../cpn/edit/cpn/option","../cpn/edit/cpn/optionEditor","../cpn/edit/type","../cpn/edit/type3","../cpn/edit/type4","../cpn/edit/cpn/inOutCase/index","../cpn/edit/cpn/inOutCase/caseItem","../cpn/edit/cpn/testCase/index","../../../../../component/table","../../../../../component/selectAll","../../../../../action/paper","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/uploadOss","ncOss","../../../../../action/common","../cpn/edit/cpn/testCase/popupEditSample","../cpn/edit/cpn/testCase/popupSampleSetting","../cpn/edit/type5","../cpn/edit/typeSeries/content"],function(a,b,c){function d(){var a=this,b=a.listData=o.createSeries();b.listen("dataChange",j.bind(a.initSummary,a)),a.listen("beforeLeave",function(){b.unlistenAll()})}function e(){var a=this,b=a.getEl(),c=a.listData,d=c.getAllSeriesQuestion();a.itemCpn=new p({renderTo:a.listEl,scrollEl:a.getSysWinEl(),addEl:b.find(".js-add"),data:d,listeners:{change:function(){var a=this.val();c.addQuestion(a.content),j.forEach(a.items,function(a){c.addQuestion(a)})},del:function(a){c.delQuestion(a)}}})}function f(){var a=this,b=a.itemCpn;if(b){var c=b.val();a.countEl.html(c.items.length)}}var g=a("nc"),h=a("cpn"),i=(g.$,g.Clazz),j=g.Base,k=g.Component,l=h.Popup,m=a("../../../../../core/module"),n=a("../util/util"),o=a("../util/list"),p=a("../cpn/edit/typeSeries/index"),q=c.exports=i.create();i.mix(q,m,{style:"/stylesheets/styles/system/includedExercise.css",title:"试题录入(系列题)",_template:['<div class="steps-main">','<div class="js-steps"></div>','<div class="include-content">','<div class="include-oprt clearfix js-summary" style="display:none;">','<span class="subject-count">本系列共有 <span class="font-green js-question-count">0</span> 题</span>','<a href="javascript:void(0);" class="subject-clear font-green js-clear-all">清空题目</a>',"</div>",'<div class="js-list"></div>',"</div>",'<div class="include-btn-wrap js-action" style="display:none;">','<a href="javascript:void(0);" class="js-add btn btn-primary">新增一题</a>','<a href="javascript:void(0);" class="js-next btn btn-primary">录题完毕，下一步</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=b.find(".js-summary");a.listEl=b.find(".js-list"),a.countEl=c.find(".js-question-count"),n.initSteps(b.find(".js-steps"),2),a.sizeScroll(),a.renderWait(a.listEl),window.setTimeout(function(){n.getTags(function(){a.listEl.html(""),b.find("div.js-action").show(),a.initContainer(),c.show(),a.initSummary()})},500)}},{name:"click .js-clear-all",handler:function(){var a=this;l.confirm("清空后所有题目无法恢复，是否确定将本次录入题目全部清空？",function(){a.listData.delAllQuestion(),k.recycle(a.listEl,!1),a.initContainer()})}},{name:"click .js-add",handler:function(){var a=this;a.itemCpn.addNewItem()}},{name:"click .js-next",handler:function(){var a=this;a.itemCpn.checkAll(!0)&&a.nav("question",{action:"add/step3/index",from:"series"})}}]},{initialize:d,initContainer:e,initSummary:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step3/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/paper","../../../../../util/ajax","../../../../../action/user","../../../../../util/notify","../util/util","../../../../../component/steps","../../../../../action/tag","../util/type","../cpn/edit/type1","../util/list","../cpn/edit/cpn/option","../cpn/edit/cpn/optionEditor","../cpn/edit/type","../cpn/edit/type3","../cpn/edit/type4","../cpn/edit/cpn/inOutCase/index","../cpn/edit/cpn/inOutCase/caseItem","../cpn/edit/cpn/testCase/index","../../../../../component/table","../../../../../component/selectAll","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/uploadOss","ncOss","../../../../../action/common","../cpn/edit/cpn/testCase/popupEditSample","../cpn/edit/cpn/testCase/popupSampleSetting","../cpn/edit/type5","../cpn/show/type","../util/checker","../cpn/edit/typeSeries/content","../../cpn/department","../../../../../component/department","../../../../../util/switch"],function(a,b,c){function d(a){var b=this,c=a.param;b.currentPage=0,b.db=new B(I.appDb.VerifyCode),b.isSeries="series"===c.from;var d=b.listData=M[b.isSeries?"createSeries":"createList"]();b.allQuestions=b.getAllQuestion(),b.items=[],b.unSave=[],d.listen("dataChange",function(){b.allQuestions=b.getAllQuestion(),b.initSummary()}),d.listen("verify",function(a){var c=a.id,d=w.find(b.items,function(a){return a.id===c});d&&d.renderVerify&&d.renderVerify(!0)}),b.listen("beforeLeave",function(){d.listenVerify(!1),d.unlistenAll()})}function e(){var a=this,b=a.allQuestions.length;a.countEl.html(a.isSeries?b-1:b)}function f(a){var b=this;b.departmentCpn=new P({renderTo:b.getEl(".js-department"),renderBy:"replaceWith",departmentData:a,val:b.getParam().department,listeners:{change:function(){b.addParam({department:this.val()})}}});var c=window.user.subUser&&window.user.roleList&&1===window.user.roleList.length&&2===window.user.roleList[0];c&&b.departmentCpn.val(w.id(a[0]||{}))}function g(a){var b=this,c=b.getSysWinEl(),d=(b.listData,b.allQuestions),e=x.page(d.length,Q);a=Math.min(Math.max(1,a),e),b.currentPage=a;var f=(a-1)*Q,g=d.slice(f,f+Q),h=c.scrollTop();A.recycle(b.listEl,!1),A.recycle(b.pagerEl,!1),b.items.length=0,b.unSave.length=0,w.forEach(g,function(a,c){var d=b.renderItem({data:a,index:f+c});b.items.push(d)}),c.scrollTop(h),b.pager=new E({renderTo:b.pagerEl,renderBy:"html",current:a,total:e,pageChange:function(a){b.renderList(a),c.scrollTop(0)}})}function h(a){var b=this,c=a.data,d=b.listData,e=b.isSeries;return b.unSave[a.index]=!1,new N({renderTo:a.renderTo||b.listEl,renderBy:a.renderBy,isSeries:b.isSeries,index:a.index-(e?1:0),data:c,listeners:{edit:function(){b.editItem(this,c,a.index)},del:function(){var a=this;return c.isSeries?D.alert("不能删除系列题材料说明"):void D.confirm("确定删除题目？",function(){d.delQuestion(c.id),a.getEl().hide(150,function(){a.destroy(),b.renderList(b.currentPage)})})},verify:function(){b.goVerify(a.index,c.id)}}})}function i(a,b,c){function d(a){h.addQuestion(a);var b=f.renderItem({renderTo:l.getEl(),renderBy:"after",data:a,index:c}),d=w.indexOf(g,l);d>=0&&(g[d]=b),l.destroy()}function e(a){var b={};return w.forEach(a,function(a,c){b[c]=w.isArray(a)?a.slice(0):a}),b}var f=this,g=f.items,h=f.listData,i=f.isSeries,j=b.isSeries?O:L.getEditClazz(b.type);if(!j)return D.alert("暂不支持编辑该题型");var k=e(b);f.unSave[c]=!0;var l=new j({renderTo:a.getEl(),renderBy:"after",data:b,index:c-(i?1:0),noHeadFold:!0,noChangeType:b.isSeries,noDel:!0,itemType:i?b.isSeries?"1":"2":void 0,getTypeClazz:w.bind(L.getEditClazz,L),listeners:{render:function(){var b=this.getEl();b.css("marginBottom",20),b.find(".js-fold.fold-bar").replaceWith(['<div class="fold-bar">','<a href="javascript:void(0);" class="js-save-cancel">取消</a>','<a href="javascript:void(0);" class="js-save-edit" style="margin-left:25px;">保存</a>',"</div>"].join(""));var c=w.indexOf(g,a);c>=0&&(g[c]=this),a.destroy(),this.open()},tagsChange:function(){this.resetTags()},"click .js-save-cancel":{handler:function(){d(k)}},"click .js-save-edit":{handler:function(){l=this;var a=l.val();i&&!b.isSeries&&M.fixSeriesSubItem(a,f.getContentItem());var e=M.check(a);return e.right?"4"!==a.type?(w.extend(b,a),void d(b)):void l.rePackage(function(e){w.extend(a.codeInfo,{caseDataUrl:e.samplePackUrl,cases:e.sample}),w.extend(b,a),d(b),f.refreshVerify(c)}):D.alert(e.msg)}}}})}function j(a){var b=this,c=x.page(a+1,Q);b.currentPage!==c&&b.renderList(c),a%=Q;var d=b.items[a],e=d.getEl();d&&y.scrollToEl({scrollEl:b.getSysWinEl(),el:e,animation:!0}),y.highLight({el:e})}function k(){var a=this,b=a.getParam(),c=b.from,d="series"===c?"add/step2_4/index":"parse"===c?"add/step2_3/index":"add/step2_1/index";a.nav("question",d)}function l(a,b){var c=this,d=window.location.host,d=C.addParam({theme:"tinyLeft"},c.getNavUrl("question",{action:"verify/index",id:b,dataLocation:"native"}));c.refreshVerify(a),window.open(d)}function m(a){var b=this,c=(b.listData,b.getAllQuestion()),d=c[a],e=d.codeInfo,f=K.getDataFile(e.caseDataUrl),g={dataFile:f,timeLimit:+e.timeLimit||0,memoryLimit:u.trim(e.memoryLimit),caseCount:e.caseCount,title:e.title,content:d.content,inputDesc:e.inputDesc,outputDesc:e.outputDesc,inOutSample:w.json(e.testCasesExt).samples,mark:e.hint,checkerFileName:e.checkerFileName};b.db.set(d.id,g),J.fire("refreshVerify",{questionId:d.id})}function n(a){var b=this,c=b.getAllQuestion();if(0===c.length)return D.alert("请先录入题目",function(){b.nav("question","add/index")}),a(!1);var d=w.findIndex(b.unSave,function(a){return a});if(d>=0)return D.alert("请先保存正在编辑的题目"),b.scroll2index(d),a(!1);if(d=w.findIndex(c,function(a){var b=M.check(a);return!b.right||"4"===a.type&&!a.codeInfo.verified}),d>=0){var e=c[d],f=(M.check(e)||{}).msg||"";"4"!==e.type||e.codeInfo.verified||(f='请使用标准程序<a href="javascript:void(0);" class="js-go-verify link-green" data-id="'+e.id+'" data-index="'+d+'">验证题目</a>,只有通过全部测试用例才能完成验证保存入库');var g=D.alert(f);return g.getEl(".js-go-verify").on("click",function(a){var c=u(a.currentTarget),d=c.attr("data-id"),e=c.attr("data-index");b.goVerify(e,d),g.close()}),b.scroll2index(d),a(!1)}if(b.isSeries&&c.length<=2)return D.alert("系列题至少存在两道子题目"),a(!1);var h=[];return w.forEach(c,function(a,b){"4"===a.type&&(+(a.codeInfo||{}).caseCount||0)<5&&h.push(b+1)}),h.length>0?D.show({content:"第"+h.join("、")+"题测试用例较少，为保证题目质量，建议添加5个以上测试用例",hasNoTitle:!0,okTxt:"返回",cancelTxt:"强制保存",cancel:function(){return a(!0)}}):void a(!0)}function o(){var a=this;return w.find(a.allQuestions,function(a){return a.isSeries})}function p(){var a=this,b=a.listData;if(a.isSeries){var c=b.getAllSeriesQuestion(),d=a.allQuestions=[];return c.content&&d.push(c.content),c.items&&d.push.apply(d,c.items),d}return b.getAllQuestion()}function q(){var a=this;return{crumb:[{title:"试题录入"+(a.isSeries?"(系列题)":""),module:"question",action:"add/step2_1/index"}]}}function r(a){var b=a.param,c="series"===b.from;return{summary:c?"本系列共有":"共有题目"}}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Clazz,w=s.Base,x=s.Num,y=s.Dom,z=s.Limit,A=s.Component,B=s.Db,C=s.Uri,D=t.Popup,E=t.Pager,F=a("../../../../../core/module"),G=a("../../../../../action/paper"),H=a("../../../../../action/user"),I=a("../../../../../core/siteConfig"),J=a("../../../../../util/notify"),K=a("../util/util"),L=a("../util/type"),M=a("../util/list"),N=a("../cpn/show/type"),O=a("../cpn/edit/typeSeries/content"),P=a("../../cpn/department"),Q=30,R=c.exports=v.create();v.mix(R,F,{style:"/stylesheets/styles/system/includedExercise.css",title:"题目审核",_template:['<div class="steps-main">','<div class="js-steps"></div>','<div class="include-content">','<div class="include-oprt clearfix">','<span class="subject-count">#{summary} <span class="font-green js-question-count">0</span> 题</span>','<a href="javascript:void(0);" class="subject-clear font-green js-clear-all">清空题目</a>',"</div>",'<div class="js-list"></div>','<div class="js-pager"></div>',"</div>",'<div class="js-department"></div>','<div class="include-btn-wrap">','<a href="javascript:void(0);" class="js-pre btn btn-default">返回上一步</a>','<a href="javascript:void(0);" class="js-next btn btn-primary">审核完毕，入库</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){function a(a){H.getSimpleFullDepartments({params:{userId:b.getUserId()},query:{},call:function(b){a&&a(b.data||[])},error:function(a){b.renderNone(c,a.msg)}})}var b=this,c=b.getEl();return b.listEl=c.find(".js-list"),b.pagerEl=c.find(".js-pager"),b.countEl=c.find(".js-question-count"),0===b.allQuestions.length?(c.html(""),D.alert("请先录入题目",function(){b.goBack()})):void a(function(a){b.sizeScroll(),K.initSteps(c.find(".js-steps"),3),b.renderList(1),b.initSummary(),b.initDepartment(a)})}},{name:"click .js-clear-all",handler:function(){var a=this;D.confirm("清空后所有题目无法恢复，是否确定将本次录入题目全部清空？",function(){a.listData.delAllQuestion(),a.nav("question","add/index")})}},{name:"click .js-pre",handler:function(){var a=this;a.goBack()}},{name:"click .js-next",handler:function(a){function b(){function a(a,b){a.length>0&&G[b]({body:{questions:JSON.stringify(a)},call:function(){k++,k>=l&&(e.close(),c())},error:function(a){e.close(),D.alert(a.msg)},always:function(){z.clear(g)}})}function b(a,b,c){G.addCodingQuestionsTitleRemind({type:"POST",body:{questions:JSON.stringify(a)},call:function(d){return d.data&&d.data.length>0?D.show({type:"alert",content:"标题"+w.map(d.data,function(a){return'"'+a+'"'}).join("、")+"已被其他编程题占用",okTxt:"返回修改",cancelTxt:"继续保存",cancel:function(){c&&c(a,b)}}):void(c&&c(a,b))},error:function(a){D.alert(a.msg)},always:function(){z.clear(g)}})}var e=D.mask("保存中"),h=[],i=[],j=d.departmentCpn.val();w.forEach(f,function(a){var b="4"===a.type;a.ctsDepartmentId=j,(b?h:i).push(M[b?"item2code":"item2data"](a))});var k=0,l=(0===h.length?0:1)+(0===i.length?0:1);w.forEach([i,h],function(c,d){var e=["createQuestions","addCodingQuestion"][d];1===d&&c.length>0?b(c,e,a):a(c,e)})}function c(){D.tips("操作成功",function(){var a={};w.forEach(f,function(b){a[b.type]=(+a[b.type]||0)+1}),a.action="add/step4/index",a.isSeries=!!d.isSeries,e.remove(),d.nav("question",a)})}var d=this,e=d.listData,f=d.getAllQuestion(),g=u(a.currentTarget);d.check(function(a){a&&!z.mark(g)&&b()})}}]},{initialize:d,initSummary:e,initDepartment:f,renderList:g,renderItem:h,editItem:i,scroll2index:j,goBack:k,goVerify:l,refreshVerify:m,check:n,getContentItem:o,getAllQuestion:p,getCrumbConf:q,_getData:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/step4/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../util/util","../../../../../component/steps","../../../../../action/tag","../../../../../util/ajax"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.getParam(),d=!!c.isSeries,e=[];d&&e.push("系列题: 1道 ("),i.forEach(k.questionTypeName,function(a,b){var f=c[b];f&&e.push("<span>"+a+": "+(f-(d?1:0))+"道</span>")}),d&&e.push(")"),e&&b.find(".js-count").html(e.join(" "))}function e(){var a=this,b=a.getWin(),c=b.isSubUser()&&"0"!==i.id(b.user.role);return{goBtn:[c?"":'<a class="btn btn-default js-back" href="javascript:void(0);">暂不组卷</a>','<a class="btn btn-primary js-add-question" href="javascript:void(0);">继续录题</a>',c?"":'<a class="btn btn-primary js-add-paper" href="javascript:void(0);">去组卷</a>'].join("")}}var f=a("nc"),g=a("cpn"),h=(f.$,f.Clazz),i=(f.Str,f.Base),j=(g.Popup,a("../../../../../core/module")),k=a("../../../../../core/siteConfig"),l=a("../util/util"),m=c.exports=h.create();h.mix(m,j,{style:"/stylesheets/styles/system/includedExercise.css",title:"试题录入",_template:['<div class="steps-main">','<div class="js-steps-wrap"></div>','<div class="include-content">','<div class="include-result">','<div class="result-head clearfix">','<div class="exercise-ctrl">',"</div>","</div>",'<div class="result-info">',"<h2>本批题目已保存在你的私人题库中</h2>",'<p class="result-detail js-count"></p>',"</div>","</div>",'<div class="include-btn-wrap">#{goBtn}</div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();l.initSteps(b.find(".js-steps-wrap"),4),a.initCount()}},{name:"click .js-back",handler:function(){var a=this;a.nav("paper")}},{name:"click .js-add-question",handler:function(){{var a=this;a.getParam()}a.nav("question",{action:"add/index"})}},{name:"click .js-add-paper",handler:function(){var a=this;a.nav("paper","addStep1")}}]},{initCount:d,_getData:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/util/checker",["nc"],function(a,b,c){function d(a){var b=[{id:"picture",trigger:["picture","下图","如图","图中","该图",/如下.{0,8}图/,"图表","图形",/\d*张图/],need:"<img"},{id:"underlined",trigger:["划线","underlined"],need:/<u>.+<\/u>/}],c=[];g.forEach(b,function(b,d){g.forEach(b.trigger,function(e){if(new RegExp(e).test(a)&&!new RegExp(b.need).test(a)){var f=c[d]=c[d]||{id:b.id,trigger:[]};f.trigger.push(e)}})}),c=g.filter(c,function(a){return!!a});var d=0===c.length;return{match:d,info:d?void 0:c}}function e(a){var b={picture:{trigger:"图片",tip:"上传图片"},underlined:{trigger:"下划线",tip:"录入下划线"}},c=[],d=[];return g.forEach(a,function(a){var e=b[a.id];e&&(c.push(e.trigger),d.push(e.tip))}),c.length?"题目中提到了"+c.join("、").replace(/(.+)、/,"$1和")+"，可能你忘了"+d.join("、").replace(/(.+)、/,"$1和"):""}var f=a("nc"),g=f.Base,h=f.Clazz,i=c.exports=h.create();g.extend(i,{match:d,getMatchTip:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/util/list",["nc","../../../../../util/notify","./util","cpn","../../../../../component/steps","../../../../../core/siteConfig","../../../../../action/tag","../../../../../util/ajax"],function(a,b,c){function d(a){var b=this;if(!C.contains([H.DB_LIST_QUESTION,H.DB_SERIES_QUESTION],a))throw new Error("缺少题目缓存名称");b.dbName=a,b.db=H.getDb(a),b.db.parse=b.db.parse||{content:"",id:[]};var c=b.db.defaultData=b.db.defaultData||{};c.tags=c.tags||[],b.db.itemMap=b.db.itemMap||{},b.db.items=b.db.items||[],b.listenVerify()}function e(a){var b=this;if(b.dbName===H.DB_LIST_QUESTION){var c=b._notifyVerifyCb=b._notifyVerifyCb||function(a){var c=C.find(b.getAllQuestion(),function(b){return b.id===a.questionId});c&&(C.extend(c.codeInfo,{verified:!0,latestAcceptedCodingSubmission:{timeConsumption:a.verifiedTime,memoryConsumption:a.verifiedMemory}}),b.addQuestion(c),b.fire("verify",c))};G.unlisten("verified",c),a!==!1&&G.listen("verified",c)}}function f(){var a=this;return a.db.parse.content||""}function g(a){var b=this;b.db.parse.content=a||"",b.save()}function h(a){var b=this,c=b.db.parse.id||[];a=C.isArray(a)?a:[a],c=C.uniq(c.concat(a)),b.db.parse.id=c,b.save()}function i(){var a=this;return a.db.defaultData}function j(a){var b=this;"score"in a&&(a.score=F.fix(a.score)),C.extend(b.db.defaultData,a),b.save(),b.fire("defaultChange")}function k(){var a=this,b=a.db.items,c=a.db.itemMap,d=[],e=[];return C.forReverse(b,function(a,f){var g=c[a];!g&&b.splice(f,1),g&&(g.isSeries?e:d).push(g)}),e.length>0&&d.push.apply(d,e),d.reverse()}function l(){var a=this,b=a.getAllQuestion(),c={},d=null;C.forEach(b,function(a){var b=a.isSeries,e=a[b?"id":"seriesId"];if(e){d=d||e;var f=c[e]=c[e]||{};f.items=f.items||[],b&&(f.content=a),!b&&L[a.type]&&f.items.push(a)}});var e=d?c[d]:null;return e&&!e.content&&(e.items||[]).length>0&&(e.content={type:e.items[0].type}),e||{}}function m(a){var b=this,c=b.db,d=b.dbName===H.DB_SERIES_QUESTION,e=a.id=a.id||C.key(),f=a.type=C.id(a.type);if(K[f]&&(!d||L[f])){if(a.isSeries=a.isSeries&&d,"defaultScore"in a&&(a.defaultScore=F.fix(a.defaultScore)),c.itemMap[e]=C.extend({},c.itemMap[e],a),f===H.TYPE_DANXUAN){var g=[];C.forEach(a.option,function(a,b){a.right&&g.push(b),a.right=!1}),1===g.length&&(a.option[g[0]].right=!0)}var h=C.contains(c.items,e);!h&&c.items.push(e),b.save(),b.fire("dataChange")}}function n(a){var b=this;delete b.db.itemMap[a],b.db.items=C.without(b.db.items,a),b.save(),b.fire("dataChange")}function o(){var a=this,b=a.db.parse.id||[],c=a.db.itemMap,d=a.db.items;C.forEach(b,function(a){delete c[a],d=C.without(d,a)}),a.db.parse.id=[],a.db.itemMap=c,a.db.items=d,a.save(),a.fire("dataChange")}function p(){var a=this;a.db.items.length=0,C.forEach(a.db.itemMap,function(b,c){delete a.db.itemMap[c]}),a.db.itemMap={},a.save(),a.fire("dataChange")}function q(){var a=this;H.setDb(a.dbName,a.db)}function r(){var a=this;H.clearDb(a.dbName)}function s(){return new I(H.DB_LIST_QUESTION)}function t(){return new I(H.DB_SERIES_QUESTION)}function u(a){var b=C.id((a||{}).type),c=a.content||"",d=[],e=b===H.TYPE_DANXUAN||b===H.TYPE_DUOXUAN,f=b===H.TYPE_TIANKONG;if(e||f){var g=/(?:上|下)(?:一|1)题/.exec(c);g&&d.push("题干包含“"+g[0]+"”的字样，在题目乱序时会出现误解，请换用其他说法")}return e&&C.find(a.option,function(a){var b=/以上(?:选项|说法)?都不?(?:对|正确|错误|是)/.exec(a.content);return b&&d.push("选项包含“"+b[0]+"”的字样，在题目乱序时会出现误解，请换用其他说法"),b}),d}function v(a){function b(a){return f.msg=a,f}function c(){var a=[];return C.forEach(s,function(b,c){!!B.trim(b.input)!=!!B.trim(b.output)&&a.push(++c)}),a}function d(){function a(c){var d=c.pop(),e=!1,f=[];C.forReverse(c,function(a,g){B.trim(a.input)===B.trim(d.input)&&(e||(b.push(f),f.push(d.index),e=!0),c.splice(g,1),f.push(a.index))}),c.length>1&&a(c)}var b=[],c=s.slice(0).reverse();return a(c),b}var e=C.id((a||{}).type),f={right:!1};if(!e)return b("不支持的类型");var g=a.content;if(!g||!B.trim(g.replace(/<.*?>/gi,""))&&!/<img/gi.test(g))return b("题目内容不能为空");if(!C.contains(J,C.id(a.difficulty)))return b("请选择正确的题目难度");if(a.isSeries)return{right:!0};if(e===H.TYPE_DANXUAN||e===H.TYPE_DUOXUAN){var h=e===H.TYPE_DANXUAN;if((a.option||[]).length<2)return b("至少存在两个选项");var i=0,j=0,k=0,l={};if(C.forEach(a.option,function(a){var b=B.trim(a.content);i+=a.right?1:0,j+=b?0:1,k+=l.hasOwnProperty(b)?1:0,l[b]=!0}),j>0)return b("选项内容不能为空");if(k>0)return b("存在重复选项");if(0===i)return b("请选择正确答案");if(i>1&&h)return b("只能选择一个正确选项")}else if(e===H.TYPE_TIANKONG){var m=a.gap||[];if(m.length<1)return b("至少存在一个填空项");if(m.length!==H.countGap(g))return b("题目内容和填空数量不匹配");for(var n=0,o=m.length;o>n;n++)if(!B.trim(m[n]))return b("答案不能为空")}else if(e===H.TYPE_BIANCHENG){var p=H.getCodingQuestionSetting(),q=a.codeInfo||{},r=B.trim(q.title),s=(C.json(q.testCasesExt)||{}).samples||[],t=+(q.caseCount||0),u=+q.timeLimit;if(r.length<1)return b("标题不能为空");if(r.length>50)return b("标题长度不能超过50个字符");if(B.trim(q.memoryLimit).length<1||isNaN(+q.memoryLimit))return b("内存限制不能为空且必须为数字");if(q.memoryLimit<32768||q.memoryLimit>1024*p.memoryLimit)return b("内存限制必须大于等于32MB且小于等于"+p.memoryLimit+"MB");if(!u||1>u||u!==Math.floor(u)||u>p.singleCaseTimeLimit)return b("时间限制只能为1-"+p.singleCaseTimeLimit+"的整数，如果时间限制需要大于"+p.singleCaseTimeLimit+"秒请致电：010-84873384");if(!B.trim(q.inputDesc))return b("输入描述不能为空");if(!B.trim(q.outputDesc))return b("输出描述不能为空");if(0===s.length)return b("输入输出样例不能为空");if(0===t)return b("测试用例不能为空");if(t*u>p.totalTimeLimit)return b("测试用例总耗时不能超过"+p.totalTimeLimit+"秒，请减少测试用例数量或降低时间限制，如有更多测试数据请致电：010-84873384");var v=c();if(v.length>0)return b(["第",v.join("、"),"组输入样例与输出样例不匹配"].join(""));var w=d();if(w.length>0)return b(C.map(w,function(a){return["第",a.join("、"),"组输入样例重复"].join("")}).join("，"))}return{right:!0}}function w(a,b){return a&&b&&(a.seriesId=b.id,a.type=b.type,a.difficulty=b.difficulty,a.source=b.source,a.tags=(b.tags||[]).slice(0)),a}function x(a){var b=C.id(a.type),c={content:a.content||"",type:+b,difficulty:+a.difficulty,reference:a.answer||"",whereFrom:a.source||"",defaultScore:+a.defaultScore||"",tags:C.map(a.tags,function(a){return+a.id}),ctsDepartmentId:a.ctsDepartmentId};return a.isSeries&&(c.multi=1),b===H.TYPE_DANXUAN||b===H.TYPE_DUOXUAN?c.options=C.map(a.option,function(a){return{content:a.content,type:a.right?1:0}}):b===H.TYPE_TIANKONG&&(c.content=H.fillGapContent(c.content,function(){return"[$##$]"}),c.discardAnswerOrder=a.discardAnswerOrder,c.options=[{content:(a.gap||[]).join("[$##$]"),type:1}]),c}function y(a){var b=a.codeInfo,c=B.trim(b.timeLimit),d=B.trim(b.memoryLimit),e=C.map(a.tags,function(a){return a.id});return{difficulty:+a.difficulty,whereFrom:a.source,tags:e,defaultScore:a.defaultScore,title:b.title,timeLimit:c?Math.floor(c):void 0,memoryLimit:d?d:void 0,content:a.content,inputDesc:b.inputDesc,outputDesc:b.outputDesc,testCasesExt:b.testCasesExt,setting:b.setting,dataFile:H.getDataFile(b.caseDataUrl),caseCount:b.caseCount,hint:b.hint,ctsDepartmentId:a.ctsDepartmentId,checkerFileName:b.checkerFileName}}function z(a){var b=C.id(a.type),c="3"===b;return{id:a.id,type:C.id(a.type),difficulty:a.difficulty,discardAnswerOrder:a.discardAnswerOrder,source:a.whereFrom||"",defaultScore:a.defaultScore||"",content:c?C.map(a.contents,function(a,b,c){return a+(b+1===c.length?"":"()")}).join(""):a.content,answer:a.referenceAnswer||"",tags:C.map(a.tagIds,function(a){return{id:a}}),option:"1"!==b&&"2"!==b?[]:C.map(a.answers,function(a){return{content:a.content,right:1===a.type}}),gap:c?C.map(a.answers,function(a){return a.content}):[],codeInfo:a.codingProblem,isSeries:!!a.multi,seriesId:a.parentId,ctsDepartmentId:a.ctsDepartmentId,paperTotal:a.paperTotal}}var A=a("nc"),B=A.$,C=A.Base,D=A.Clazz,E=A.Event,F=A.Num,G=a("../../../../../util/notify"),H=a("./util"),I=c.exports=D.create(),J=["1","2","3","4","5"],K=C.toMap([H.TYPE_DANXUAN,H.TYPE_DUOXUAN,H.TYPE_TIANKONG,H.TYPE_BIANCHENG,H.TYPE_WENDA],function(a){return{key:a,value:!0}}),L=C.toMap([H.TYPE_DANXUAN,H.TYPE_DUOXUAN,H.TYPE_TIANKONG],function(a){return{key:a,value:!0}});C.extend(I,{createList:s,createSeries:t,warn:u,check:v,fixSeriesSubItem:w,item2data:x,item2code:y,data2item:z}),C.extend(I.prototype,E,{initialize:d,listenVerify:e,getParseContent:f,updateParseContent:g,addParseId:h,getDefault:i,setDefault:j,getAllQuestion:k,getAllSeriesQuestion:l,addQuestion:m,delQuestion:n,delParseQuestion:o,delAllQuestion:p,save:q,remove:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/util/type",["nc","cpn","../cpn/edit/type1","./util","../../../../../component/steps","../../../../../core/siteConfig","../../../../../action/tag","../../../../../util/ajax","./list","../../../../../util/notify","../cpn/edit/cpn/option","../cpn/edit/cpn/optionEditor","../cpn/edit/type","../cpn/edit/type3","../cpn/edit/type4","../cpn/edit/cpn/inOutCase/index","../cpn/edit/cpn/inOutCase/caseItem","../cpn/edit/cpn/testCase/index","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../action/paper","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/uploadOss","ncOss","../../../../../action/common","../cpn/edit/cpn/testCase/popupEditSample","../cpn/edit/cpn/testCase/popupSampleSetting","../cpn/edit/type5"],function(a,b,c){function d(a){return a=f.id(a),a?{1:g,2:g,3:h,4:i,5:j}[a]:null}var e=a("nc"),f=(a("cpn"),e.Base),g=a("../cpn/edit/type1"),h=a("../cpn/edit/type3"),i=a("../cpn/edit/type4"),j=a("../cpn/edit/type5");c.exports={getEditClazz:d}});
define("company/nowcoder/1.0.740/javascripts/site/main/question/add/util/util",["nc","cpn","../../../../../component/steps","../../../../../core/siteConfig","../../../../../action/tag","../../../../../util/ajax"],function(a,b,c){function d(a,b){new y({renderTo:a,titles:["选择录题方式","录入题目","审核题目","题目入库完成"],current:b})}function e(){var a=window.win,b={memoryLimit:256,singleCaseTimeLimit:5,testCaseZipLimit:20,totalTimeLimit:60};return a?t.extend(b,a.getUserByKey("ctsUserQuestionSetting")):b}function f(a){var b=this,c=b._db=b._db||new v(z.appDb.addQuestion);return a=u.trim(a),a?c.get(a)||{}:c}function g(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function h(a){var b=this,c=b.getDb();a=u.trim(a),a&&c.remove(a)}function i(a){var b=this;return b._tags?a&&a(b._tags):(b._tagsCb=b._tagsCb||[],b._tagsCb.push(a),void(b._tagsCb.length>1||A.getAllTags({query:[],call:function(a){b._tags=[],t.forEach(a.data,function(a){0!==a.creatorId&&b._tags.push({id:t.id(a.id),text:a.name})})},error:function(){b._tags=null},always:function(){var a=b._tags;t.forEach(b._tagsCb,function(b){b&&b(a)}),b._tagsCb.length=0}})))}function j(a,b,c){var d=this;A.addTag({body:{name:a},call:function(a){var c=a.data;c={id:t.id(c.id),text:c.name},d._tags&&d._tags.push(c),b&&b(c)},error:c})}function k(a){var b=(a||"").match(/\(\)|（）/g)||[];return b.length}function l(a,b){var c=(a||"").split(/\(\)|（）/gi),d=c.length,e="";return t.forEach(c,function(a,c){e+=a,e+=c+1===d?"":b?b(c)||"()":"()"}),e}function m(a){var b=this;b.getTags(function(c){var d=t.toMap(a.tags,function(a){return{key:a.id}}),e={},f=[];t.forEach(c,function(a){var b=a.id;e[b]=a,f.push({text:a.text,value:b,checked:!!d[b]})});var g=new w({text:"知识点",size:"small",noSelectAll:!0,needSearch:!0,renderTo:a.renderTo,renderBy:a.renderBy,options:f,change:function(){var b=this.val(),c=[];t.forEach(b,function(a){e[a]&&c.push(e[a])}),a.change&&a.change(c)}}),h=g.attachSel.noneEl;h.html('<a class="link-green" href="javascript:void">+添加为新知识点</a>'),h.find("a").on("click",function(){var c=g.attachSel.searchIpt,d=u.trim(c.val());g.attachSel.attach.forceHide(),b.addTag(d,function(b){a.afterAddTag&&a.afterAddTag(b),x.tips("操作成功")},function(a){x.alert(a.msg)})}),a.call&&a.call(g)})}function n(a){return(/\/([-\w]+.zip)/.exec(a)||[])[1]}function o(b){var c=this;if(c._HEditor)return b&&b(c._HEditor);var d=c._HEditorCb=c._HEditorCb||[];d.push(b),1===d.length&&a.async("../../../../../component/editorSub/hEditor/index",function(a){c._HEditor=a,t.forEach(d,function(b){b&&b(a)}),d.length=0})}function p(){return{filterMode:!0,htmlTags:{div:[],p:[],strong:[],em:[],u:[],blockquote:[],ol:[],ul:[],li:[],thead:[],tbody:[],tfoot:[],tr:[],td:[],th:[],sub:[],sup:[],br:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],span:[".color"],table:["*","style"],img:["*","style"],a:["*"],pre:["class"]}}}function q(){return{items:[],filterMode:!0,htmlTags:{div:[],p:[],sub:[],sup:[],br:[],b:[],strong:[],img:["*","style"],pre:["class"]}}}var r=a("nc"),s=a("cpn"),t=r.Base,u=r.$,v=r.Db,w=s.SelectMult,x=s.Popup,y=a("../../../../../component/steps"),z=a("../../../../../core/siteConfig"),A=a("../../../../../action/tag");c.exports={DB_LIST_QUESTION:"DB_LIST_QUESTION",DB_SERIES_QUESTION:"DB_SERIES_QUESTION",TYPE_DANXUAN:"1",TYPE_DUOXUAN:"2",TYPE_TIANKONG:"3",TYPE_BIANCHENG:"4",TYPE_WENDA:"5",initSteps:d,getCodingQuestionSetting:e,getDb:f,setDb:g,clearDb:h,getTags:i,addTag:j,countGap:k,fillGapContent:l,createTagSelect:m,getDataFile:n,getHEditor:o,getKeDefaultConf:p,getKeTinyConf:q}});
define("company/nowcoder/1.0.740/javascripts/site/main/question/cpn/department",["nc","cpn","../../../../component/department","../../../../util/switch","../../../../util/util","../../../../core/siteConfig","../../../../action/user","../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.departmentCpn=new l({renderTo:a.getEl(".js-department"),renderBy:"replaceWith",options:m.getOption(a.departmentData,!0),size:"small",listeners:{change:function(){a.fire("change")}}})}function e(a){var b=this;b.ifSet=a,b.getEl(".js-choice").hide(),b.getEl(".js-choice-"+(a?"1":"0")).show()}function f(a){var b=this,c=b.departmentCpn.val();return 0===arguments.length?b.ifSet&&c&&c.length&&n.can("settingHasSubUser")?c:void 0:a&&0!==a.length?(b.fixSet(!0),void b.departmentCpn.val(a)):b.fixSet(!1)}var g=a("nc"),h=a("cpn"),i=g.$,j=(g.Base,g.Clazz),k=g.Component,l=h.Select,m=a("../../../../component/department"),n=a("../../../../util/switch"),o=c.exports=j.create();j.mix(o,k,{_template:['<div class="nk-warning" style="display:none;">','<p class="js-choice js-choice-0">本批题目入库后，公司的子账号均可见，<a href="javascript:void(0);" class="link-green js-choose" data-set="1">设置权限</a></p>','<div class="js-choice js-choice-1" style="display:none;">','<p>本批题目入库后，仅公司以下机构的子账号可见，<a href="javascript:void(0);" class="link-green js-choose" data-set="0">修改为所有人可见</a></p>','<div class="authority-mod">','<label style="line-height:34px;">公司机构</label> ','<div class="js-department"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.departmentData=b.departmentData,a.ifSet=!1,a.initDepartment(),b.val&&a.val(b.val),n.can("settingHasSubUser")&&a.getEl().show()}},{name:"click .js-choose",handler:function(a){var b=this,c=i(a.currentTarget);b.fixSet(!!+c.attr("data-set"))}}]},{initDepartment:d,fixSet:e,val:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/edit/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../extend/bll/paper","../../extend/bll/base","../../extend/bll/task","../../../../action/api","../../../../util/ajax","../../extend/bll/serverTime","../../../../action/common","../../../../action/paper","../add/util/list","../../../../util/notify","../add/util/util","../../../../component/steps","../../../../action/tag","../add/util/type","../add/cpn/edit/type1","../add/cpn/edit/cpn/option","../add/cpn/edit/cpn/optionEditor","../add/cpn/edit/type","../add/cpn/edit/type3","../add/cpn/edit/type4","../add/cpn/edit/cpn/inOutCase/index","../add/cpn/edit/cpn/inOutCase/caseItem","../add/cpn/edit/cpn/testCase/index","../../../../component/table","../../../../component/selectAll","../../../../util/uploadOss","ncOss","../add/cpn/edit/cpn/testCase/popupEditSample","../add/cpn/edit/cpn/testCase/popupSampleSetting","../add/cpn/edit/type5","../add/cpn/edit/typeSeries/index","../add/cpn/edit/typeSeries/content","../cpn/department","../../../../component/department","../../../../util/switch","../../../../action/user"],function(a,b,c){function d(a){function b(a){if(a.questionId===c.id){var b=c.itemCpn;b&&(b.setData("verified",!0),b.setData("verified-time-limit",a.verifiedTime),b.setData("verified-memory-limit",a.verifiedMemory)),c.codeData.verified=!0,c.renderVerifyWarning()}}var c=this,d=a.param;c.id=r.id(d.id),c.db=new t(C.appDb.VerifyCode),c.codeData={},B.listen("verified",b),c.listen("beforeLeave",function(){B.unlisten("verified",b)})}function e(a){var b=this;b.departmentCpn=new D({renderTo:b.getEl(".js-department"),renderBy:"replaceWith",departmentData:a})}function f(a,b){var c=this,d=(r.id(a.type),c.isSeries?A:z.getEditClazz(a.type));if(!d)return v.alert("暂不支持编辑该题型");var e=y.data2item(a),f=r.id(e.ctsDepartmentId);c.departmentCpn.val("0"===f?void 0:f),c.isCode&&(c.codeData.problem=e),c.isSeries&&(e={content:e,items:r.map(b,function(a){return y.data2item(a)})}),c.isCode&&(e.codeInfo.verified=!0),c.itemCpn=new d({renderTo:c.listEl,scrollEl:c.getSysWinEl(),renderBy:"html",data:e,index:0,noHeadFold:!0,noChangeType:!0,noDel:!0,type:"edit",listeners:{render:function(){this.open(c.isSeries?-1:!0)},tagsChange:function(){this.resetTags&&this.resetTags()},change:function(){if(c.isCode){var a=this.val();c.codeData.verified=a.codeInfo.verified,c.refreshVerify()}}}})}function g(a){function b(a){c.renderWait(c.listEl,a.msg)}var c=this,d=c.id;x.getQuestion({type:"GET",params:{questionId:c.id},call:function(c){var e=c.data;return e.multi?void x.getSubQuestion({query:{ids:d},call:function(b){a&&a(e,b.data)},error:b}):a&&a(e)},error:b})}function h(){var a=this;if(a.isCode){var b=a.codeData.verified,c=a.getEl(".js-verify-warning"),d=[b?'<span class="validate-passed"><i class="icon-ok"></i>已验证</span>':'<a href="javascript:void(0);" class="btn btn-primary js-verify" style="display:inline-block;">验证题目</a><span class="code-warning"><i class="icon-exclamation-sign"></i>题目未验证，不能保存入库</span>'].join("");c.html(d)}}function i(){var a=this;if(a.itemCpn){var b=a.itemCpn.val(),c=y.item2code(b),d=a.codeData.problem,e=d.codeInfo||{},f={dataFile:c.dataFile,timeLimit:+c.timeLimit||0,memoryLimit:c.memoryLimit,caseCount:c.caseCount,title:c.title,content:c.content,inputDesc:c.inputDesc,outputDesc:c.outputDesc,inOutSample:r.json(c.testCasesExt).samples,mark:c.hint,problemId:e.id,checkerFileName:c.checkerFileName};a.db.set(a.id,f),a.renderVerifyWarning(),B.fire("refreshVerify",{questionId:a.id})}}function j(a){var b=this;if(b.isSeries){var c=b.itemCpn.checkAll(!0);return c&&a&&a()}var d=b.itemCpn.val(),e=y.check(d);if(!e.right)return v.alert(e.msg);if(!b.isCode)return a&&a();if(!b.codeData.verified){var f={action:"verify/index",id:b.id,hasInBack:!0,dataLocation:"native"};b.codingProblemId&&(f.codingProblemId=b.codingProblemId);var g=v.alert('请使用标准程序<a class="link-green js-verify" href="javascript:void(0);">验证题目</a>,只有通过全部测试用例才能完成验证保存入库');return void g.getEl(".js-verify").on("click",function(){g.close(),b.goVerify()})}var h=y.item2code(d),i=h.caseCount>=5;i&&a&&a(),!i&&v.show({content:"测试用例较少，为保证题目质量，建议添加5个以上测试用例",hasNoTitle:!0,okTxt:"返回",cancelTxt:"强制保存",ok:function(){},cancel:a})}function k(a){var b=this,c=b.getParam(),d=c.back;d&&b.nav(d.module,d.action),!d&&a&&b.getWin().navDefault()}function l(){var a=this,b={action:"verify/index",id:a.id,hasInBack:!0,dataLocation:"native"};a.codingProblemId&&(b.codingProblemId=a.codingProblemId);var c=a.getNavUrl("question",b);c=u.addParam({theme:"tinyLeft"},c),window.open(c)}function m(){{var a=this;a.getParam()}return{crumb:[{title:"我的题库",module:"question",param:{action:"list/index"}}]}}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Clazz,r=n.Base,s=n.Limit,t=n.Db,u=n.Uri,v=o.Popup,w=a("../../../../core/module"),x=(a("../../extend/bll/paper"),a("../../../../action/paper")),y=a("../add/util/list"),z=a("../add/util/type"),A=a("../add/cpn/edit/typeSeries/index"),B=a("../../../../util/notify"),C=a("../../../../core/siteConfig"),D=a("../cpn/department"),E=a("../../../../action/user"),F=c.exports=q.create();q.mix(F,w,{style:"/stylesheets/styles/system/includedExercise.css",title:"编辑题目",_template:['<div class="steps-main">','<div class="js-steps"></div>','<div class="include-content">','<div class="js-list"></div>','<div class="validate-oprt js-verify-warning"></div>',"</div>",'<div class="js-department"></div>','<div class="include-btn-wrap js-action" style="display:none;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){function a(a){E.getSimpleFullDepartments({params:{userId:b.getUserId()},query:{},call:function(b){a&&a(b.data||[])},error:function(a){b.renderNone(c,a.msg)}})}var b=this,c=b.getEl(),d=b.id,e=b.listEl=c.find(".js-list");return d?(b.renderWait(e),void b.fetchItem(function(d,f){b.questionData=d,a(function(a){if("2"!==r.id(d.tikuType))return b.renderWait(e,"只能编辑私有题库中的题目，该题目不属于私有题库。");b.initDepartment(a);var g=r.id(d.type);b.isCode="4"===g,b.isSeries=!!d.multi,b.codingProblemId=(d.codingProblem||{}).id,b.renderItem(d,f),c.find(".js-action").html(['<a href="javascript:void(0);" class="btn btn-primary js-save">保存</a>',b.isSeries?'<a href="javascript:void(0);" class="btn btn-primary js-new">新增一题</a>':"",'<a href="javascript:void(0);" class="btn btn-default js-cancel">取消</a>'].join("")).show(),b.renderVerifyWarning()})})):b.renderWait(e,"错误的参数")}},{name:"click .js-save",handler:function(a){var b=this,c=b.getParam(),d=p(a.currentTarget);b.check(function(){function a(){x[g?"updateCodingQuestion":h?"updateMultiQuestion":"updateQuestion"]({type:"PUT",params:{questionId:c.id},body:g?i:h?{questions:JSON.stringify(j)}:{question:JSON.stringify(i)},call:function(){v.tips("操作成功",function(){b.goBack()})},error:function(a){v.alert(a.msg)},always:function(){s.clear(d)}})}function e(a,c){var e=b.questionData;x.updateCodingQuestionsTitleRemind({type:"GET",params:{questionId:e.id},query:{questionId:e.id,ctsDepartmentId:e.ctsDepartmentId,title:a.title},call:function(a){return a.data?v.show({type:"alert",content:"标题"+a.data+"已被其他编程题占用",okTxt:"返回修改",cancelTxt:"继续保存",cancel:c}):void(c&&c())},error:function(a){v.alert(a.msg)},always:function(){s.clear(d)}})}var f=b.itemCpn.val(),g=b.isCode,h=b.isSeries;if(!s.mark(d)){var i,j=[],k=b.departmentCpn.val();if(h){var l=y.item2data(f.content);l.id=f.content.id,l.ctsDepartmentId=k,j.push(l),r.forEach(f.items,function(a){var b=y.item2data(a);r.id(a.id)&&(b.id=a.id),b.ctsDepartmentId=k,j.push(b)})}else i=y[g?"item2code":"item2data"](f),i.ctsDepartmentId=k;g?e(i,a):a()}})}},{name:"click .js-new",handler:function(){var a=this;a.isSeries&&a.itemCpn&&a.itemCpn.addNewItem()}},{name:"click .js-cancel",handler:function(){var a=this;a.goBack(!0)}},{name:"click .js-verify",handler:function(){var a=this;a.goVerify()}}]},{initialize:d,initDepartment:e,renderItem:f,fetchItem:g,renderVerifyWarning:h,refreshVerify:i,check:j,goBack:k,goVerify:l,getCrumbConf:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/list/cpn/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=a.getEl().html(""),d=b.data,e={id:"type",title:"题型",type:"select",conf:{options:[{text:"全部题型",value:"-1",checked:!0},{text:"单选题",value:"1",checked:!1},{text:"不定项选择题",value:"2",checked:!1},{text:"填空题",value:"3",checked:!1},{text:"编程题",value:"4",checked:!1},{text:"问答题",value:"5",checked:!1}]}},f={id:"difficulty",title:"难度",type:"select",conf:{options:[{text:"全部难度",value:"-1",checked:!0},{text:"一星",value:"1",checked:!1},{text:"二星",value:"2",checked:!1},{text:"三星",value:"3",checked:!1},{text:"四星",value:"4",checked:!1},{text:"五星",value:"5",checked:!1}]}},g=[];l.forEach(d.tags,function(a){(0!==a.creatorId||a.tagQuestion)&&g.push({value:l.id(a.id),text:a.name,checked:!1})});var h={id:"tags",title:"知识点",type:"selectMult",conf:{needSearch:!0,options:g}},i=[{text:"不限",value:"-1",checked:!0}];l.forEach(d.notes,function(a){i.push({value:a,text:a,checked:!1})});var j={id:"notes",title:"备注",type:"select",conf:{needSearch:!0,options:i}},k={id:"key",title:"关键词",type:"input"},n={id:"creators",title:"上传者",type:"selectMult",conf:{options:l.map(d.creators,function(a){return{text:a.name,value:l.id(a.id)}})}};a.filter=new m({renderTo:c,submitTxt:"查询",needCond:!0,line:[{items:[e,f,h,j,n,k]}],clearAll:function(){a.val({})},listeners:{submit:l.bind(a.submit,a)}})}function e(){var a=this,b=a.val();a.fire("submit",b);var c=a.getParent();b=l.clone(b),b.tags&&(b.tags=b.tags.join(",")),b.creatorIds&&(b.creatorIds=b.creatorIds.join(",")),b.keyWord=b.keyWord||void 0,c.addParam(b)}function f(a){var b=this,c=b.filter,d=c.getItem("type"),e=c.getItem("difficulty"),f=c.getItem("tags"),g=c.getItem("notes"),h=c.getItem("creators"),j=c.getItem("key");if(0===arguments.length){var k=d.val(),l=e.val(),m=f.val(),n=h.val(),o=g.val();return{type:"-1"===k?void 0:k,difficulties:"-1"===l?void 0:l,tags:0===m.length?void 0:m,note:"-1"===o?void 0:o,creatorIds:0===n.length?void 0:n,keyWord:i.trim(j.val())}}d.val(a.type||"-1"),e.val(a.difficulties||"-1"),f.val(a.tags),g.val(a.note||"-1"),h.val(a.creatorIds),j.val(a.keyWord||"")}function g(){var a=this,b=a.rawConfig;return b.parent}var h=a("nc"),i=(a("cpn"),h.$),j=h.Clazz,k=h.Component,l=h.Base,m=(h.Str,a("../../../../../component/filter/filter")),n=c.exports=j.create();j.mix(n,k,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initFilter();var b=a.getParent(),c=b.getParam();a.val({type:c.type,difficulties:c.difficulties,tags:(c.tags||"").split(","),note:c.note,creatorIds:(c.creatorIds||"").split(","),keyWord:c.keyWord})}}]},{initFilter:d,submit:e,val:f,getParent:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/list/cpn/list",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/popupSub/popupQuestion","../../../../../action/paper","../../../../../util/ajax","../../../../../action/user"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=a.getParent(),d=c.getParam(),e=+d.pageSize||20;e=s.contains([20,50,100],e)?e:20,a.pageSelect=new v({size:"xsmall",renderTo:b.find(".js-page-select"),options:[{text:20,value:20,checked:20===e},{text:50,value:50,checked:50===e},{text:100,value:100,checked:100===e}],listeners:{change:function(){c.addParam({pageSize:this.val(),page:null}),a.load()}}}),a.tableCpn=new x({renderTo:a.contentEl,needSelect:!0,needFixHeader:!0,pageChange:function(b){c.addParam({page:b}),a.load(null,b)}})}function e(a){var b=this;b.table&&b.tableCpn.selectAll.clear(),b.load(a)}function f(a,b){var c=this;return a&&(c.condition=a),0===s.size(c.condition)?void c.tableCpn.renderNone("当前查询条件下暂无题目，你可以更换题型/难度/知识点试试。"):(c.tableCpn.renderWait(),void z.getQuestions({query:c.getCond(b),call:function(a){c.renderList(a.data)},error:function(a){c.tableCpn.renderNone(a.msg)}}))}function g(a){var b=this,c=b.getParent(),d=(c.getParam(),b.tableCpn);if(b.updateTotal(a.totalCount),0===(a.datas||[]).length)return d.renderNone();var e={head:[{text:"题目",width:"20%"},"题型","难度",{text:"知识点",width:"6%"},{text:"备注",width:"6%"},{text:"默认分值",width:"6%"},{text:'出卷次数<span class="icon-question-sign js-tips" style="cursor:pointer;" title="只统计当前系统中的试卷，已经删除的试卷不计入" data-theme="white"></span>',width:"6%"},{text:"做题人数",width:"6%"},"正确率",{text:"上传时间",order:"4",width:"15%"},"上传者",{text:"操作",width:"10%"}],list:[]},f={1:"单选",2:"不定项",3:"填空",4:"编程",5:"问答",6:"数据挖掘"},g=["","一","二","三","四","五"];s.forEach(a.datas,function(a){var b=(a.title||"").replace(/\[\$\#?\#?\$?\]?/g,"()"),c=a.multi?'<span class="tag-push js-tips" style="display:inline-block;margin:0 5px 0 0;" title="系列题：包含'+a.subQuestionCount+'个子题，点击查看">系列题</span>':"",d=[{text:'<a class="js-show" href="javascript:void(0);" data-is-title="1" data-type="'+a.type+'">'+c+b+"</a>",cls:"t-subject-title"},f[a.type],g[+a.difficulty||0]+"星",(a.tags||[]).join(","),a.whereFrom||"",a.defaultScore||"",a.paperTotal||0,a.personTotal||0,-1===a.passRatio?"--":0===a.passRatio?"0%":(100*(a.passRatio||0)).toFixed(1)+"%",u.form(new Date(a.createTime)),a.creatorHrName||"--",{text:'<a href="javascript:void(0);" class="js-tips icon-file-alt js-show" data-type="'+a.type+'" title="'+(4===a.type?"验题":"预览")+'"></a><a href="javascript:void(0);" class="js-tips icon-edit js-edit" title="编辑"></a><a href="javascript:void(0);" class="js-tips icon-trash js-del" title="删除"></a>',cls:"table-btn"}];e.list.push({items:d,attr:{"data-id":a.id}})}),d.updateHtml(e,{currentPage:a.currentPage,totalPage:a.totalPage,totalCount:a.totalCount})}function h(a){var b=this,c=b.getEl();c.find(".js-total").html(a)}function i(){var a=this;return a.rawConfig.parent}function j(a){var b=this,c=b.getParent(),d=c.getParam(),e=s.extend({},b.condition,{source:1,page:a||d.page||1,pageSize:b.pageSelect.val(),needExtInfo:1,sortBy:d.orderBy,order:d.order});return e}function k(a){var b=p(a).closest("tr");return p.trim(b.attr("data-id"))}function l(a,b){z.tryDelQuestions({query:a,call:function(a){var c=a.data,d=+c.canNotDeleteCount||0;return d>0?void w.confirm("您勾选的道题目中有"+d+"道已经组卷，无法删除"):void(b&&b())},error:function(a){w.alert(a.msg)}})}function m(a){var b=this;z.delQuestions({type:"DELETE",body:a,call:function(){w.tips("操作成功",function(){b.reload()})},error:function(a){w.alert(a.msg)}})}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Clazz,r=n.Component,s=n.Base,t=(n.Str,n.Uri),u=n.Time,v=o.Select,w=(o.Pager,o.Popup),x=(o.Tips,a("../../../../../component/table")),y=(a("../../../../../component/selectAll"),a("../../../../../component/popupSub/popupQuestion")),z=a("../../../../../action/paper"),A=a("../../../../../action/user"),B=c.exports=q.create();q.mix(B,r,{_template:["<div>",'<div class="import-tool clearfix" style="padding:10px;">','<div class="import-census">','<div class="census-num">共<span class="font-green js-total">0</span>条</div>','<div class="form-group">','<label class="control-label">每页显示</label>','<div class="control-group js-page-select"></div>',"</div>","</div>",'<div class="import-tool-bar">','<a class="link-green js-batch-del" href="javascript:void(0);"><i class="icon-trash"></i>批量删除</a>','<a class="link-green js-go-add" href="javascript:void(0);"><i class="icon-plus-sign"></i>新增试题</a>',"</div>","</div>",'<div class="js-content" style="padding-bottom:60px;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.contentEl=b.find(".js-content"),a.initCpn(),a.tableCpn.renderWait()}},{name:"click .js-go-add",handler:function(){var a=this,b=a.getParent();b.nav("question","add/index")}},{name:"click .js-batch-del",handler:function(){var a=this,b=a.tableCpn.selectAll;return!a.condition||!b.isSelectAll&&0===b.selectIds.length?w.alert("请先选择题目"):void w.confirm("确定删除后，你所勾选的全部题目将从题库中删除，并且永久不可恢复。",function(){var c=s.extend({},a.condition,{isAll:b.isSelectAll?1:2,ids:b.selectIds});a.tryDel(c,function(){a.del(c)})})}},{name:"click .js-show",handler:function(a){var b=this,c=p(a.currentTarget),d=b.rawConfig.parent,e=b.getLineId(a.currentTarget),f=+c.attr("data-type"),g=!!c.attr("data-is-title"),h=t.addParam({theme:"tinyLeft"},d.getNavUrl("question",{action:"verify/index",id:e,dataLocation:"back",hasInBack:!0}));return 4!==f||g?void(e&&y.show({id:e,verify:4===f?function(){window.open(h)}:void 0})):window.open(h)}},{name:"click .js-edit",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);c&&A.checkHasEntityDepartmentPermission({query:{entityId:c,entityType:3},call:function(a){if(!a.data)return w.alert("你没有权限编辑该题目");var d=b.getParent(),e=s.clone(d.getParam());d.nav("question",{action:"edit/index",id:c,back:{module:"question",action:e}})},error:function(a){w.alert(a.msg)}})}},{name:"click .js-del",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);c&&w.confirm("确认删除后，此题目将永久在题库中被删除，不可恢复。",function(){var a={isAll:2,ids:[c]};b.tryDel(a,function(){b.del(a)})})}},{name:"click .js-rank",handler:function(a){var b=this,c=p(a.currentTarget),d=c.parent(),e=d.attr("data-order-by"),f=c.attr("data-order");if(e&&f){var g=b.getParent();f=c.hasClass("selected")?"1"===f?"2":"1":f,g.addParam({page:1,orderBy:e,order:f}),b.load()}}}]},{initCpn:d,reload:e,load:f,renderList:g,updateTotal:h,getParent:i,getCond:j,getLineId:k,tryDel:l,del:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/list/index",["nc","cpn","./cpn/filter","../../../../component/filter/filter","../../../../component/filter/filterCond","../../../../component/filter/condUtil","../../../../action/common","../../../../util/ajax","../../../../component/popupSub/popupCommon","../../../../component/filter/popupCustomCond","./cpn/list","../../../../component/table","../../../../component/selectAll","../../../../util/util","../../../../core/siteConfig","../../../../component/popupSub/popupQuestion","../../../../action/paper","../../../../action/user","../../../../action/tag","../../../../core/module"],function(a,b,c){function d(){var a=this,b=a.data={};h.forEachAsync([function(a){k.getAllTags({type:"get",call:function(a){b.tags=a.data},always:a})},function(a){l.getAllNote({type:"get",call:function(a){b.notes=a.data},always:a})},function(a){l.getQuestionCreators({type:"get",call:function(a){b.creators=a.data},always:a})}],function(a,b){a(b)},function(){return b.tags&&b.notes&&b.creators?void a.initCpn():a.renderNone(a.getEl(),"出现错误")})}function e(){var a=this,b=a.getEl();b.html('<div class="js-filter"></div><div class="js-list"></div>'),a.list=new j({renderTo:b.find(".js-list"),parent:a}),a.filter=new i({renderTo:b.find(".js-filter"),data:a.data,parent:a,listeners:{render:function(){a.list.reload(this.val())},submit:function(b){a.addParam({page:null}),a.list.reload(b)}}})}var f=a("nc"),g=(a("cpn"),f.$,f.Clazz),h=f.Base,i=a("./cpn/filter"),j=a("./cpn/list"),k=a("../../../../action/tag"),l=a("../../../../action/paper"),m=a("../../../../core/module"),n=c.exports=g.create();g.mix(n,m,{style:"/stylesheets/styles/system/questionBank.css",title:"我的题库",_template:'<div class="module-box" style="padding:0"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderWait(a.getEl()),a.initData()}}]},{initData:d,initCpn:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/verify/example",["nc"],function(a,b,c){function d(a){return a=f.id(a),a?g[a]||[]:[]}var e=a("nc"),f=(e.$,e.Base),g={4:[{qid:"example4_0",score:0,type:4,title:"考试单行输入输出规范示例",content:"求a+b的和",ext:{codingProblemId:12445,codingType:"0",cTemplate:'#include <stdio.h>\nint main() {\n    int a, b;\n    while(scanf("%d %d", &a, &b) != EOF)//注意while处理多个case\n        printf("%d\\n", a+b);\n    return 0;\n}',cppTemplate:"#include <iostream>\nusing namespace std;\nint main() {\n    int a,b;\n    while(cin >> a >> b)//注意while处理多个case\n        cout << a+b << endl;\n}",cpp14Template:"#include <iostream>\nusing namespace std;\nint main() {\n    int a,b;\n    while(cin >> a >> b)//注意while处理多个case\n        cout << a+b << endl;\n}",csharpTemplate:"public class Program {\n  public static void Main() {\n    string line;\n    while ((line = System.Console.ReadLine ()) != null) {//注意while处理多个case\n      string[] tokens = line.Split();\n      System.Console.WriteLine(int.Parse(tokens[0]) + int.Parse(tokens[1]));\n    }\n  }\n}",javaTemplate:"import java.util.Scanner;\npublic class Main {\n    public static void main(String[] args) {\n        Scanner in = new Scanner(System.in);\n        while (in.hasNextInt()) {//注意while处理多个case\n            int a = in.nextInt();\n            int b = in.nextInt();\n            System.out.println(a + b);\n        }\n    }\n}",jsTemplate:"process.stdin.resume();\nprocess.stdin.setEncoding('ascii');\n\nvar input = \"\";\nvar input_array = \"\";\n\nprocess.stdin.on('data', function (data) {\n    input += data;\n});\n\nprocess.stdin.on('end', function () {\n    input_array = input.split(\"\\n\");\n    var nLine = 0;\n\n    while(nLine < input_array.length){\n        var line = input_array[nLine++].trim();\n        if(line === ''){\n            continue;\n        }\n        var input_arrays = line.split(' ');\n        var a = +input_arrays[0];\n        var b = +input_arrays[1];\n        console.log(a+b);\n    }\n});",pythonTemplate:"#coding=utf-8\nimport sys \nfor line in sys.stdin:\n    a = line.split()\n    print int(a[0]) + int(a[1])",python3Template:"#coding=utf-8\nimport sys \nfor line in sys.stdin:\n    a = line.split()\n    print(int(a[0]) + int(a[1]))",phpTemplate:'<?php   \nwhile (fscanf(STDIN, "%d%d", $a, $b) == 2) {  \n    printf("%d\\n",$a+$b);\n}',jsV8Template:'while(line=readline()){\n    var lines = line.split(" ");\n    var a = parseInt(lines[0]);\n    var b = parseInt(lines[1]);\n    print(a+b);\n}',rTemplate:'lines=readLines("stdin")\nfor(l in lines){\n    if(l == ""){\n        break;\n    }\n    ll = strsplit(l, " ")[[1]]\n    a=ll[1];\n    b=ll[2];\n    cat(as.numeric(a)+as.numeric(b));\n    cat("\\n");\n}',goTemplate:'package main\n\nimport (\n    "fmt"\n)\nfunc main() {\n    a:=0\n    b:=0\n    for {\n        n, _ := fmt.Scan(&a,&b)\n        if n == 0 {\n            break\n        } else {\n            fmt.Printf("%d\\n",a+b)\n        }\n    }\n}',rubyTemplate:'a, b = gets.split(" ").map {|x| x.to_i}\nputs (a + b)',swiftTemplate:'import Foundation\nwhile let line = readLine() {\n    let parts = line.split(separator: " ")\n    print(Int(parts[0])! + Int(parts[1])!)\n}',objCTemplate:'#import <Foundation/Foundation.h>\nint main(int argc,char * argv[])\n{\n    NSAutoreleasePool *pool=[[NSAutoreleasePool alloc] init];\n    int a,b;\n    while(scanf("%d %d",&a, &b) != EOF)\n        printf("%d",a+b);\n    [pool drain];\n    return 0;\n}',pascalTemplate:"var i, j : integer;\nbegin\n   while not eof do\n   begin\n      readln(i, j);\n      writeln(i + j);\n   end;\nend.",hint:"",inputDesc:"多组读入，每一行有两个数A， B。0 &lt; A, B &lt; 1000000",samples:[{input:"1 1",output:"2"}],inputSample:"",memoryLimit:32768,outputDesc:"每行输出一个结果",outputSample:"",supportLang:"java,cpp",timeLimit:1}},{qid:"example4_1",score:0,type:4,title:"考试多行输入输出规范示例",content:"给出n阶方阵里所有数,求方阵里所有数的和",ext:{codingProblemId:12832,codingType:"0",cTemplate:'#include <stdio.h>\n\nint main(){\n    int n, ans = 0;\n    scanf("%d", &n);\n    for(int i = 0; i < n; i++){\n        for(int j = 0; j < n; j++){\n            int x; \n            scanf("%d", &x);\n            ans += x;\n        }\n    }\n    printf("%d\\n", ans);\n    return 0;\n}',cppTemplate:'#include <iostream>\n#include <cstdio>\n\nusing namespace std;\n\nint main(){\n    //freopen("1.in","r",stdin);\n    int n,ans = 0;\n    cin >> n;\n    for(int i = 0; i < n; i++){\n        for(int j = 0; j < n; j++){\n            int x; scanf("%d",&x);\n            ans += x;\n        }\n    }\n    cout << ans << endl;\n    return 0;\n}',cpp14Template:'#include <iostream>\n#include <cstdio>\n\nusing namespace std;\n\nint main(){\n    //freopen("1.in","r",stdin);\n    int n,ans = 0;\n    cin >> n;\n    for(int i = 0; i < n; i++){\n        for(int j = 0; j < n; j++){\n            int x; scanf("%d",&x);\n            ans += x;\n        }\n    }\n    cout << ans << endl;\n    return 0;\n}',csharpTemplate:"using System;\npublic class Program {\n    public static void Main() {\n        int n = int.Parse(Console.ReadLine().Trim());\n        int ans = 0;\n        for(int i = 0; i < n; i++){\n            string[] inputs = Console.ReadLine().Trim().Split(' ');\n            for(int j = 0; j < n; j++){\n                ans += int.Parse(inputs[j]);\n            }\n        }\n        Console.WriteLine(ans);\n    }\n}",javaTemplate:"import java.util.Scanner;\n\npublic class Main {\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        int n = sc.nextInt();\n        int ans = 0, x;\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < n; j++){\n                x = sc.nextInt();\n                ans += x;\n            }\n        } \n        System.out.println(ans);\n    }\n}",jsTemplate:"var readline = require('readline');\nconst rl = readline.createInterface({\n    input: process.stdin,\n    output: process.stdout,\n    terminal:false\n});\n\nvar n = -1;// 初始状态为负数，表示还没开始读取\nvar ans = 0;\nvar cur_line = 0;\nrl.on('line', function(line){ // javascript每行数据的回调接口\n   if (n < 0) { // 测试用例第一行读取n\n       n = parseInt(line.trim())\n   } else {\n       // 矩阵数据读取\n          var tokens = line.split(' ');\n       for (var i = 0; i < tokens.length; ++i) {\n           // 题目逻辑求和，边读取边计算\n           ans += parseInt(tokens[i]);\n       }\n       // 记录当前读取的行数\n       cur_line += 1;\n   }\n    \n   // 读取行数结束，如果确定只有一行额外的数据输入，也可以通过cur_line === 1来判断\n   if (n === cur_line) {\n       // 输出结果\n       console.log(ans);\n       // 重新初始化相关变量\n       n = -1;\n       ans = 0;\n       cur_line = 0;\n   }\n});",pythonTemplate:'#coding=utf-8\nimport sys\n\nif __name__ == "__main__":\n    # 读取第一行的n\n    n = int(sys.stdin.readline().strip())\n    ans = 0\n    for i in range(n):\n        # 读取每一行\n        line = sys.stdin.readline().strip()\n        # 把每一行的数字分隔后转化成int列表\n        values = map(int, line.split())\n        for v in values:\n            ans += v\n    print ans',python3Template:'#coding=utf-8\nimport sys\nif __name__ == "__main__":\n    # 读取第一行的n\n    n = int(sys.stdin.readline().strip())\n    ans = 0\n    for i in range(n):\n        # 读取每一行\n        line = sys.stdin.readline().strip()\n        # 把每一行的数字分隔后转化成int列表\n        values = list(map(int, line.split()))\n        for v in values:\n            ans += v\n    print(ans)',phpTemplate:'<?php\nwhile(fscanf(STDIN, "%d", $n) == 1)  {\n    $ans=0;\n    for($i=0;$i<$n;$i++){\n        //read whole line\n        fscanf(STDIN, "%[^\\n]s", $line);\n        //split line to array\n        $numbers = explode(" ", trim($line));\n        foreach ($numbers as $number){\n            $ans = $ans + intval($number);\n        }\n    }\n    printf("%d\\n", $ans);\n}',jsV8Template:'var n = parseInt(readline());\nvar ans = 0;\nfor(var i = 0;i < n; i++){\n    lines = readline().split(" ")\n    for(var j = 0;j < lines.length; j++){\n        ans += parseInt(lines[j]);\n    }\n}\nprint(ans);',rTemplate:'lines=readLines("stdin")\nsum=0\nline_count=0\nline_index=1\nfor(l in lines){\n    if(l == ""){\n        break;\n    }\n    if(line_count == 0){\n        line_count = as.numeric(l);\n        next\n    }\n\n    if(line_index > line_count){\n        break\n    }\n    line_index = line_index + 1\n\n    ll = strsplit(l, " ")[[1]]\n    for(num in ll){\n        sum = sum + as.numeric(num);\n    }\n}\ncat(sum);\ncat("\\n");',goTemplate:'package main\n\nimport (\n    "fmt"\n)\nfunc main() {\n    n:=0\n    ans:=0\n\n    fmt.Scan(&n)\n    for i := 0; i < n; i++ {\n        for j := 0; j < n; j++ {\n            x:=0\n            fmt.Scan(&x)\n            ans = ans + x\n        }\n    }\n    fmt.Printf("%d\\n",ans)\n}',rubyTemplate:"num = gets.to_i\ni = 0\nsum = 0\nwhile i < num  do\n    line = gets\n    line.split().each do |token|\n      sum += token.to_i\n    end\n    i +=1\nend\nputs(sum)",swiftTemplate:'import Foundation\nlet n = Int(readLine()!)!\nvar ans = 0;\nfor _ in 0 ..< n {\n    if let line = readLine() {\n        let parts = line.split(separator: " ")\n        for part in parts {\n            ans += Int(part)!\n        }\n    }\n}\nprint(ans)',objCTemplate:'#import <Foundation/Foundation.h>\nint main(int argc,char * argv[])\n{\n    NSAutoreleasePool *pool=[[NSAutoreleasePool alloc] init];\n    int n, i , j, ans = 0;\n    scanf("%d", &n);\n    for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n            int x;\n            scanf("%d", &x);\n            ans += x;\n        }\n    }\n    printf("%d", ans);\n    [pool drain];\n    return 0;\n}',pascalTemplate:"var\n    n,ans,x,i,j:longint;\nbegin\n    while not eof do\n    begin\n        ans := 0;\n        readln(n);\n        for i:=1 to n do\n        begin\n            for j:=1 to n do\n            begin\n                read(x);\n                ans:=ans+x;\n            end;\n            readln();\n        end;\n         writeln(ans);\n     end;\nend.",hint:"",inputDesc:"输入有多个测试用例，每个测试用例第一行为一个整数n(n &le; 1000)，表示方阵阶数为n。接下来是n行的数字,每行n个数用空格隔开。",samples:[{input:"3\n1 2 3\n2 1 3\n3 2 1",output:"18"}],inputSample:"3\n1 2 3\n2 1 3\n3 2 1",memoryLimit:32768,outputDesc:"输出一个整数，表示n阶方阵的和",outputSample:"18",supportLang:"java,cpp",timeLimit:1}}]};c.exports={getByType:d}});
define("company/nowcoder/1.0.740/javascripts/site/main/question/verify/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../add/util/util","../../../../component/steps","../../../../action/tag","../../../../util/ajax","../../../../util/notify","./question","../../../../util/littleAction","../../../../component/editorSub/codeEditor/index","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","../../../../component/select","../../../../action/api","../../../../action/paper","./example"],function(a,b,c){function d(){var a=this,b=a.getWin(),c=a.getSysEl();c.contentWin.css("overflow","hidden"),a.listen("beforeLeave",function(){c.contentWin.css("overflow","auto")}),b.resize();var d=l('<div class="written-title">编程题验证,至少使用一种编程语言通过该题目才能完成验证</div>');l(".nowcoder-logo").after(d)}function e(){var a=this;a.bindWinResize(function(){n.forEach(a.questionHome,function(a){n.isFunction(a.resize)&&a.resize()})})}function f(){function a(a){n.forEach(e,function(b,c){if(a.questionId===c){var e=n.find(d.answerSheet,function(a){return a.id===c});return d.getQuestionData({id:e.id,dataLocation:e.dataLocation,call:function(a){n.isFunction(b.refresh)&&b.refresh(a)}}),n.BREAK}})}function b(a){n.forEach(e,function(b,c){return a.questionId===c?(d.refreshPopup(c,"更新数据中，请稍等..."),n.BREAK):void 0})}function c(a){n.forEach(e,function(b,c){return a.questionId===c?(d.refreshPopup(c),n.BREAK):void 0})}var d=this,e=d.questionHome;s.listen("refreshVerify",a),s.listen("repacking",b),s.listen("repackDone",c),d.listen("beforeLeave",function(){s.unlisten("refreshVerify",a),s.unlisten("repacking",b),s.unlisten("repackDone",c)})}function g(){function a(a){var d=arguments.callee;e[a.id]?b(a):c.getQuestionData({id:a.id,dataLocation:a.dataLocation,call:function(g){e[a.id]=new u({renderTo:c.getEl(),module:c,data:g,answerSheet:{data:f,change:d}}),b(a)}})}function b(a){n.forEach(e,function(b,d){return a.id===d?(b.getEl().show(),n.isFunction(b.resize)&&b.resize(),void(c.showQuestionId=d)):void b.getEl().hide()}),c.refreshPopup()}var c=this,d=c.getParam(),e=c.questionHome,f=c.answerSheet=n.map(v.getByType("4"),function(a,b){return{text:"例"+(b+1),id:a.qid,dataLocation:"example"}}),g={text:"1",id:d.id,dataLocation:d.dataLocation};f.push(g),a(g)}function h(a){var b=this,c=b.getParam(),d=a.id,e=a.dataLocation,f=a.call,g=null;if("example"===e){var h=v.getByType("4"),i=n.find(h,function(a){return a.qid===d}),j=i.ext;return f(i?{title:i.title,timeLimit:j.timeLimit,memoryLimit:j.memoryLimit,content:i.content,inputDesc:j.inputDesc,outputDesc:j.outputDesc,mark:j.hint,inOutSample:j.samples,id:d,problemId:j.codingProblemId.id,dataLocation:"example",ext:j}:{msg:"数据出现错误"})}if("native"===e){var k=b.db=b.db||new o(t.appDb.VerifyCode);return k.refresh(),g=k.get(d),f(g?n.extend(g,{id:d,dataLocation:"native",hasInBack:c.hasInBack}):{msg:"数据出现错误"})}"back"===e&&w.getQuestion({params:{questionId:d},query:{},call:function(a){var e=a.data||{},g=e.codingProblem;b.problemId=g.id,f({title:e.title,timeLimit:g.timeLimit,memoryLimit:g.memoryLimit,content:e.content,inputDesc:g.inputDesc,outputDesc:g.outputDesc,mark:g.hint,inOutSample:(n.json(g.testCasesExt)||{}).samples,dataFile:r.getDataFile(g.caseDataUrl),caseCount:g.caseCount,checkerFileName:g.checkerFileName,id:d,problemId:g.id,dataLocation:"back",hasInBack:c.hasInBack})},error:function(a){f({msg:a.msg})}})}function i(a,b){function c(){n.forEach(e,function(a,b){return b===d.showQuestionId?void(a.mask=p.mask(a.content)):void(a.mask&&a.mask.close())})}var d=this,e=d.popupHome=d.popupHome||{};if(a&&b)return e[a]=e[a]||{},e[a].content=b,c();if(a){var f=e[a].mask;return f&&f.close(),delete e[a],c()}c()}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=j.Base,o=j.Db,p=k.Popup,q=a("../../../../core/module"),r=a("../add/util/util"),s=a("../../../../util/notify"),t=a("../../../../core/siteConfig"),u=a("./question"),v=a("./example"),w=a("../../../../action/paper"),x=c.exports=m.create();m.mix(x,q,{style:"/stylesheets/styles/system/writtenTestCode.css",extStyle:["ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css"],title:"编程题验证",hideCrumb:!0,hideLeft:!0,_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.questionHome={},a.initEvent(),a.initAppearance(),a.initResize(),a.initQuestion()}}]},{initEvent:f,initAppearance:d,initResize:e,initQuestion:g,getQuestionData:h,refreshPopup:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/question/verify/question",["nc","cpn","../../../../util/util","../../../../core/siteConfig","../../../../util/littleAction","../../../../component/editorSub/codeEditor/index","ncPlugin/codemirror/style/codemirror.css","ncPlugin/codemirror/style/theme/monokai.css","ncPlugin/codemirror/codemirror","../../../../component/select","../../../../action/api","../../../../util/ajax","../../../../util/notify","../../../../action/paper"],function(a,b,c){function d(){var a=this,b=a.rawConfig,c=b.data,d=b.answerSheet;p.forReverse(c.inOutSample,function(a,b){q.trim(a.input)||q.trim(a.output)||q.trim(a.note)||c.inOutSample.splice(b,1)}),a.getEl(".js-left-part").html(s.execTpl(['<div class="js-left-top" style="overflow-y:auto;padding:0 10px;">','<div class="subject-title test-title">#{data.title}</div>','<div class="question-intr">',"时间限制：C/C++ #{data.timeLimit}秒，其他语言#{data.timeLimit * 2}秒<br />","空间限制：C/C++ #{memoryLimit}，其他语言#{otherMemoryLimit}<br />","</div>",'<div class="module-box subject-box">','<div class="module-head clearfix"><h1>题目描述</h1></div>','<div class="subject-main">','<div class="subject-content">','<div class="subject-question">#{data.content}</div>','<h2 v-if="data.inputDesc" style="font-size:14px;font-weight:bold;">输入描述:</h2>','<pre v-if="data.inputDesc">#{data.inputDesc}</pre>','<h2 v-if="data.outputDesc" style="font-size:14px;font-weight:bold;">输出描述:</h2>','<pre v-if="data.outputDesc">#{data.outputDesc}</pre>','<div v-for="item, index in data.inOutSample" class="question-oi">','<div class="question-oi-hd" style="font-size:14px;font-weight:bold;">示例#{index + 1}</div>','<div class="question-oi-bd">','<div class="question-oi-mod"><h2>输入</h2></div>','<div class="question-oi-cont"><pre>#{encode(data, item.input)}</pre></div>','<div class="question-oi-mod"><h2>输出</h2></div>','<div class="question-oi-cont"><pre>#{encode(data, item.output)}</pre></div>','<div v-if="item.note" class="question-oi-mod"><h2>说明</h2></div>','<div v-if="item.note" class="question-oi-cont"><pre>#{item.note}</pre></div>',"</div>","</div>",'<h2 v-if="data.mark" style="font-size:14px;font-weight:bold;">备注:</h2>','<pre v-if="data.mark">#{data.mark}</pre>',"</div>","</div>","</div>","</div>",'<div class="clearfix js-left-bottom" style="height: auto;">','<div class="answer-sheet-box js-pager open">','<ul class="answer-sheet-num clearfix" style="margin-top:0px;">','<li v-for="item, index in answerSheet" class="js-sheet" :data-index="index"><a href="javascript:void(0);" :class="cls(item)">#{item.text}</a></li>',"</ul>","</div>","</div>"],{data:c,memoryLimit:a.getFormatMemory(c.memoryLimit,3),otherMemoryLimit:a.getFormatMemory(2*c.memoryLimit,3),encode:function(a,b){return u.encodeHTML(b)},answerSheet:d.data,cls:function(a){return a.id===c.id?"answering-num":"example"===a.dataLocation?"answer-done":void 0}})),c.msg&&a.rawConfig.module.renderNone(a.getEl(".js-left-top"),c.msg)}function e(){function a(){var a={input:[],output:[]};return p.forEach(c.data.inOutSample,function(b){a.input.push(b.input),a.output.push(b.output)}),a}var b=this,c=b.rawConfig,d=c.data,e=b.getEl();e.find(".js-editor-home").html(s.execTpl(['<div class="js-code-container">','<div class="subject-content js-right-top" style="overflow:hidden">','<div class="js-code-editor"><div style="color:#fff;padding:20px 0;text-align:center;">编辑器加载中...</div></div>','<span class="icon-angle-down js-toggle-angle" style="cursor:pointer;"></span>',"</div>",'<div class="js-right-center subject-action clearfix" style="margin:0;">','<button v-if="!isExample" class="btn btn-blue btn-large btn-block js-run">保存并调试</button>','<button v-if="hasInBack" class="btn btn-primary btn-large js-load-previous" style="width:200px;">加载上次提交的代码</button>','<div class="subject-next">','<a v-if="isExample" href="javascript:void(0);" class="btn btn-primary js-go-verify">去验题</a>','<a v-else href="javascript:void(0);" class="btn btn-primary js-finish">结束验证</a>',"</div>","</div>",'<div class="passed-wrapper js-right-bottom" style="margin:0;padding:5px 10px;overflow:hidden;display:none;">','<div class="js-run-info" style="margin:0;overflow-y:auto;color:#00bc9b;"></div>',"</div>","</div>"],{isExample:b.isExample(),hasInBack:d.hasInBack}));var f=a(),g=b.codeEditor=z.initCodeEditor(A,{noAutoSize:!0,codeHint:"none",questionId:d.id,runExtParam:{dataFile:d.dataFile,timeLimit:d.timeLimit,memoryLimit:d.memoryLimit,caseCount:d.caseCount,problemId:d.problemId,checkerFileName:d.checkerFileName,sampleInput:f.input,sampleOutput:f.output},statusExtParam:{tagId:6},langTpl:b.isExample()?x.getTplByData("0",d.ext||{}):void 0,codeJudgeType:"0",submitCode:null,codeEl:e.find(".js-code-editor").html(""),runInfoEl:e.find(".js-run-info"),runCodeEl:e.find(".js-run")});b.fixCodeEditor(),g.listen("runCodeFinish",function(){}),g.listen("runCodeSuccess",function(a){b.verified=!0,B.fire("verified",{questionId:d.id,verifiedTime:(a.seconds||0)/1e3,verifiedMemory:(a.memory||0)/1e3})})}function f(){function a(a,k){var l=e.height(),m=g.outerHeight(),a=Math.max(60,a+k),n=l-m-a,o=j.outerHeight(),p=n-o;100>p&&(p=100,n=p+o,a=l-n-m),f.outerHeight(n),h.outerHeight(a),c.find(".js-run-info").outerHeight(h.height()),i.outerHeight(p),d&&d.setSize(null,p);var q=b.manager.chat;if(q){var r=a+m+o;q.getEl().css("bottom",r),q.holderEl.css("bottom",r)}}var b=this,c=b.getEl(),d=b.codeEditor;if(d){var e=c.find("div.coding-main"),f=c.find(".js-right-top"),g=c.find(".js-right-center"),h=c.find(".js-right-bottom"),i=c.find(".js-code-editor"),j=c.find(".js-toggle-angle");new w({drag:j,listeners:[{name:"start",handler:function(){!f.hasClass("open")||d&&d.isFullScreen||(this._bottomHeight=h.outerHeight(),j.attr(D,"1"))}},{name:"drag",handler:function(){if(!(!f.hasClass("open")||d&&d.isFullScreen)){var b=this._downY-this._moveY;a(this._bottomHeight,b)}}},{name:"drop",handler:function(){!f.hasClass("open")||d&&d.isFullScreen||(this._bottomHeight=null,window.setTimeout(function(){j.removeAttr(D)},0))}}]})}}function g(a){var b=this;b.rawConfig.data=a;var c=b.codeEditor.valCode(),d=b.codeEditor.valLangue();b.initQuestion(),b.initCodeEditor(),b.initDrag(),b.resize(),b.codeEditor.valLangue(d),b.codeEditor.valCode(c),b.codeEditor.fire("languageChange"),b.codeEditor.fire("codeChange")}function h(){var a=this,b=a.getEl(),c=a.rawConfig.module.getSysEl(),d=c.contentWin.height();b.outerHeight(d);var e=b.width(),d=b.height(),f=.35*e,g=b.find(".js-left-part"),h=b.find("div.coding-main");g.outerHeight(d),g.outerWidth(f);var i=b.find(".js-left-top"),j=b.find(".js-left-bottom");i.outerHeight(d-j.height()),h.outerHeight(d),h.css("marginLeft",f),a.resizeRight()}function i(){var a=this,b=a.getEl(),c=(b.find(".js-code-container"),a.codeEditor);if(!c||!c.isFullScreen){var d=b.find("div.coding-main"),e=b.find(".js-right-top"),f=b.find(".js-right-center"),g=b.find(".js-right-bottom"),h=b.find(".js-code-editor"),i=e.hasClass("open"),j=d.height(),k=f.outerHeight(),l=i?Math.max(.2*j,60):0;e.outerHeight(j-l-k),g.outerHeight(l)[i?"show":"hide"](),b.find(".js-run-info").outerHeight(g.height());var m=b.find(".js-toggle-angle").outerHeight(),n=Math.max(100,e.height()-m);h.outerHeight(n),c&&c.setSize(null,n)}}function j(a){var b=this,c=b.getEl(),d=c.find(".js-code-container"),e=d.find("div.subject-content"),f=e.hasClass("open");f&&a!==!1||!f&&a===!1||(e[a===!1?"removeClass":"addClass"]("open"),d.find(".js-toggle-angle").css("cursor",a===!1?"pointer":"ns-resize"),b.resizeRight())}function k(){var a=this,b=a.codeEditor;b&&(b.showResult=function(a,b){var c=this,d=c.rawConfig,e=d.tipEl;if(a=q.trim(a),!a)return e.html("").hide();e.css("color",b===!0?"#b6b79a":"#00bc9b");var f=b===!1?'<div class="ico-passed">通过</div>':b===!0?'<div class="ico-unpass">不通过</div>':"";f+="<div>"+a.replace(/\n/g,"<br />")+"</div>",e.html(f)},b.listen("beforeRunCode",function(){a.openTab()}),b.listen("fullScreen",function(b){!b&&a.resizeRight()}),a.resizeRight())}function l(){var a=this;return"example"===a.rawConfig.data.dataLocation}function m(a,b){a=+a||0,b=Math.max(0,+b||0);var c=[[1,"KB"],[2,"MB"],[3,"GB"],[4,"TB"]],d="";return p.forEach(c,function(c){var e=c[0],f=c[1];return a<Math.pow(1024,e)?(d=(a/Math.pow(1024,e-1)).toFixed(b)+f,p.BREAK):void 0}),d=d||a+"KB"}var n=a("nc"),o=a("cpn"),p=n.Base,q=n.$,r=n.Clazz,s=n.Node,t=n.Sys,u=n.Str,v=n.Component,w=n.DragDrop,x=n.CodeLang,y=o.Popup,z=(a("../../../../util/util"),a("../../../../util/littleAction")),A=a("../../../../component/editorSub/codeEditor/index"),B=a("../../../../util/notify"),A=a("../../../../component/editorSub/codeEditor/index"),C=(a("../../../../core/siteConfig"),a("../../../../action/paper")),D="data-drag",E=c.exports=r.create();r.mix(E,v,{_template:["<div>",'<div class="coding-side-bar js-left-part" style="overflow:hidden;padding:0;"></div>','<div class="coding-main js-editor-home" style="overflow:hidden;padding-bottom:0;margin-bottom:0;">',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initQuestion(),a.initCodeEditor(),a.initDrag(),a.resize()}},{name:"click .js-toggle-angle",handler:function(a){var b=this,c=b.getEl(),d=q(a.currentTarget);if("1"!==d.attr(D)){var e=c.find(".js-code-container"),f=e.find("div.subject-content"),g=f.hasClass("open");b.openTab(!g)}}},{name:"click .js-load-previous",handler:function(){var a=this;C.getLatestAcceptSelfSubmission({query:{problemId:a.rawConfig.data.problemId},call:function(b){var c=b.data;c&&(a.codeEditor.valLangue(c.language),a.codeEditor.fire("languageChange"),a.codeEditor.valCode(c.content),a.codeEditor.fire("codeChange"))},error:function(a){y.alert(a.msg)}})}},{name:"click .js-go-verify",handler:function(){var a=this,b=a.rawConfig.answerSheet;p.forEach(b.data,function(a){return"example"!==a.dataLocation?(p.isFunction(b.change)&&b.change(a),p.BREAK):void 0})}},{name:"click .js-finish",handler:function(){var a=this;return"back"===a.rawConfig.data.dataLocation||a.verified?void t.closeWin():void y.confirm("验证未通过,只有标准程序通过全部测试用例的编程题才能通过验证保存入库,是否结束验证?",function(){t.closeWin()})}},{name:"click .js-sheet",handler:function(a){var b=this,c=q(a.currentTarget).attr("data-index"),d=b.rawConfig.answerSheet;d.change&&d.change(d.data[c])}}]},{initQuestion:d,initCodeEditor:e,initDrag:f,refresh:g,resize:h,resizeRight:i,openTab:j,fixCodeEditor:k,isExample:l,getFormatMemory:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/cpn/candidateAnalyze",["nc","cpn","../../../../../action/deliverData","../../../../../util/ajax","../../../../../component/progress","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","./template","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/selectBtn","./echart","../../../../../util/util"],function(a,b,c){function d(){var a=this;a.rawConfig.module.bindWinResize(function(){a.address&&a.address.resize(),a.school&&a.school.resize(),a.graduation&&a.graduation.resize()})}function e(){var a=this,b=a.getEl();m.mark(b)||o.getDeliverUserStatistics({query:a.getCond(),call:function(b){var c=b.data||{};a.renderContainer(),a.renderProgress(c),a.renderEdu(c)},error:function(b){a.rawConfig.module.renderNone(a.getEl(".js-main"),b.msg)},always:function(){m.clear(b)}})}function f(){var a=this,b=[{key:"address",title:"地区分布（前10）"},{key:"edu",title:"学历分布"},{key:"school",title:"学校分布（前10）"},{key:"graduation",title:"毕业年份分布"}],c="";k.forEach(b,function(b){var d=b.key;a[d]&&k.isFunction(a[d].destroy)&&a[d].destroy(),c+=['<div class="data-main-mod two-mod js-module">','<div class="data-main-hd">','<span class="title">',b.title,"</span>","</div>",'<div class="data-main-bd js-chart-',b.key,'" style="height:222px;"></div>',"</div>"].join("")}),a.getEl(".js-main").html(c)}function g(a){var b=this,c={address:{nameTip:"地区",countTip:"投递人数"},school:{nameTip:"学校",countTip:"投递人数"},graduation:{nameTip:"毕业年份",countTip:"投递人数"}};k.forEach(c,function(c,d){b[d]=new p({renderTo:b.getEl(".js-chart-"+d),renderBy:"html",data:a["top_"+d+"_list"],tipConf:c})})}function h(a){var b=this,c=b.getEl(".js-chart-edu"),d=a.top_edu_list;return 0===d.length?void c.html(['<div style="text-align:center;font-size:14px;line-height:',c.height(),'px">暂无数据</div>'].join("")):void s.edu(d,c)}var i=a("nc"),j=a("cpn"),k=i.Base,l=(i.$,i.Clazz),m=i.Limit,n=j.Popup,o=a("../../../../../action/deliverData"),p=a("../../../../../component/progress"),q=a("../../../extend/bll/task"),r=a("./template"),s=a("./echart"),t=c.exports=l.create();l.mix(t,r,{_template:['<div class="data-form-mod clearfix">','<h2 style="display:inline-block;margin-right:40px;">应聘者分析</h2>','<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">部门</span>','<div class="js-department"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">职位</span>','<div class="js-job"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">是否内推</span>','<div class="js-recommend"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">投递日期</span>','<div class="js-date"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;">','<div class="js-date-check"></div>',"</div>",'<a href="javascript:void(0);" class="font-green js-download-report" style="float:right;font-weight:normal;"><i class="icon-download-alt"></i>下载报表</a>','<div class="form-bd clearfix js-main"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.initEvent(),a.search()}},{name:"click .js-download-report",handler:function(){var a=this;o.getDeliverUserStatisticsExcel({query:a.getCond(),call:function(b){var c=a.module.getWin(),d=2,e="";c.addTask({title:"应聘者分析报表",waitTxt:"下载中",okTxt:"点击下载",getStatus:function(a){return 2!==d?a&&a(d):void q.getTaskProgress(!1,b.data,function(b){var c=b.end,f=b.content,g=b.error,h=b.progress;g?(d=1,a&&a(d,h)):c?(d=0,e=f,a&&a(d,h)):a&&a(d,h)})},getResult:function(){return{type:3,data:e}}})},error:function(a){n.alert(a.msg)}})}}]},{initEvent:d,search:e,renderContainer:f,renderProgress:g,renderEdu:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/cpn/echart",["nc","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/progress","cpn"],function(a,b,c){function d(a,b){var c=this,d=[],e=[];j.forEach(a,function(a){a&&(d.push(k.form(new Date(a.day),"yyyy-MM-dd")),e.push(a.deliverCount||0))});var f={xAxis:[{type:"category",name:"日期",data:d}],yAxis:[{type:"value",name:"投递人数",minInterval:1}],series:[{type:"line",name:"投递人数",data:e}],itemStyle:{normal:{color:"#AFAFAF"}},tooltip:{trigger:"axis",formatter:function(a){var b=a[0],c=b.dataIndex,f=d[c],g=e[c],h=["日期：",f,"<br>投递人数：",g].join("");return h},axisPointer:{type:"shadow"}}};c.echart(f,b)}function e(a,b){var c=this,d=[],e=[],f={};j.forEach(a.subStages||[],function(a){if(j.isObject(a)){var b=(/(第\d轮)/.exec(a.subStageName)||[])[1];if(b){var c=f[b]=f[b]||{};c.deliverCount=(c.deliverCount||0)+(a.deliverCount||0);var g=(/(未开始|已通过|未通过)/.exec(a.subStageName)||[])[1]||"其他";return void(c[g]=(c[g]||0)+(a.deliverCount||0))}d.push(a.subStageName),e.push({value:a.deliverCount,name:a.subStageName})}}),j.forEach(f,function(a,b){d.push(b),e.push({value:a.deliverCount,name:b})});var g={legend:{data:d},tooltip:{trigger:"item",formatter:function(a){var b=f[a.name];return b?["轮次：",a.name,"（",a.value,"人）<br>未开始：",b["未开始"]||0,"人<br>已通过：",b["已通过"]||0,"人<br>未通过：",b["未通过"]||0,"人<br>其他：",b["其他"]||0,"人"].join(""):"状态："+a.name+"<br>投递人数："+a.value+"<br>所占比率："+a.percent}},color:["#a3d0f4","#82AEDA","#5F96C9","#5fb7ff","#3381c1"],series:[{name:"学历分布",type:"pie",radius:["30%","50%"],center:["50%","58%"],label:{normal:{show:!0,position:"outside"},emphasis:{show:!0,textStyle:{fontSize:"15"}}},data:e}]};c.echart(g,b)}function f(a,b){var c=this,d=[],e=[];j.forEach(a,function(a){d.push(a.name),e.push({name:a.name,value:a.count})});var f={legend:{data:d},tooltip:{trigger:"item",formatter:"学历：{b}<br/>投递人数：{c}<br>所占比率：{d}%"},color:["#a3d0f4","#82AEDA","#5F96C9","#5fb7ff","#3381c1"],series:[{name:"学历分布",type:"pie",radius:["30%","50%"],center:["50%","58%"],label:{normal:{show:!0,position:"outside"},emphasis:{show:!0,textStyle:{fontSize:"15"}}},data:e}]};c.echart(f,b)}function g(a,b){function c(){if(a&&0!==i(b).length){var c=window.echarts.init(b.get(0));c.setOption(a)}}return window.echartS?void c():void l.loadEcharts(c)}{var h=a("nc"),i=h.$,j=h.Base,k=h.Time,l=a("../../../../../util/util");a("../../../../../component/progress")}c.exports={dateToResume:d,progress:e,edu:f,echart:g}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/cpn/progressStatistics",["nc","cpn","../../../../../action/deliverData","../../../../../util/ajax","./echart","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/progress","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","./template","../../../../../component/dateSelect","../../../../../component/selectBtn"],function(a,b,c){function d(){var a=this;a.rawConfig.module.bindWinResize(function(){a.progressCpn&&a.progressCpn.resize()})}function e(){var a=this,b=a.getEl();n.mark(b)||p.getDeliverProgressStatistics({query:a.getCond(),call:function(b){var c=[],d=[];l.forEach(b.data||[],function(a){a.stage<7?c.push(a):d.push(a)}),a.searchData=d.concat(c),a.progressCpn&&a.progressCpn.destroy(),a.renderContainer(),a.renderChartLeft()},error:function(b){a.rawConfig.module.renderNone(a.getEl(".js-form-main"),b.msg)},always:function(){n.clear(b)}})}function f(){var a=this;a.getEl(".js-form-main").html(['<div class="data-main-bd full-box js-chart">','<div class="progress-left-box js-left"></div>','<div class="progress-right-box js-right">','<div class="progress-arrow js-arrow"></div>','<div class="full-box js-right-main">','<div class="full-box js-right-chart"></div>',"</div>","</div>","</div>"].join(""))}function g(){var a=this;a.progressCpn=new r({renderTo:a.getEl(".js-left"),data:l.map(a.searchData,function(a,b){var c=0;return l.forEach(a.subStages||[],function(a){c+=+a.deliverCount||0}),{index:b,name:a.stageName,count:c}}),tipConf:{nameTip:"阶段",countTip:"投递人数"},clickItem:function(b){a.selectIndex=b.index,a.renderChartRight(b)}})}function h(a){var b=this,c=b.getEl(".js-right-chart"),d=b.searchData[a.index];return d&&l.size(d.subStages)?(q.progress(d,c),void b.renderChartStyle()):(c.html(['<div style="text-align:center;font-size:14px;line-height:',c.height(),'px">暂无数据</div>'].join("")),void b.renderChartStyle())}function i(){function a(){var a=b.getEl(".js-left li"),c=a.height(),d=parseInt(a.css("margin-bottom"),10)||0,e=parseInt(b.getEl(".js-home").css("padding-top"),10)||0;return e+(b.selectIndex||0)*(c+d)+c/2-9}var b=this,c=b.getEl(".js-right-main"),d=b.getEl(".js-arrow");c.css("background-color","#f2f2f2");var e=a();d.css("top",e)}var j=a("nc"),k=a("cpn"),l=j.Base,m=(j.$,j.Clazz),n=j.Limit,o=k.Popup,p=a("../../../../../action/deliverData"),q=a("./echart"),r=a("../../../../../component/progress"),s=a("../../../extend/bll/task"),t=a("./template"),u=c.exports=m.create();m.mix(u,t,{_template:['<div class="data-form-mod clearfix">','<h2 style="display:inline-block;">简历进度统计</h2>','<div class="js-filter" style="display:inline-block;margin-left:40px;">','<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">部门</span>','<div class="js-department"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">职位</span>','<div class="js-job"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">是否内推</span>','<div class="js-recommend"></div>',"</div>","</div>",'<a href="javascript:void(0);" class="font-green js-download-report" style="float:right;font-weight:normal;"><i class="icon-download-alt"></i>下载报表</a>','<div class="form-bd clearfix">','<div class="data-form-main js-form-main" style="height:258px;margin-left:0;"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns({noDate:!0}),a.initEvent(),a.search()}},{name:"click .js-download-report",handler:function(){var a=this;p.getDeliverProgressStatisticsExcel({query:a.getCond(),call:function(b){var c=a.module.getWin(),d=2,e="";c.addTask({title:"简历进度统计报表",waitTxt:"下载中",okTxt:"点击下载",getStatus:function(a){return 2!==d?a&&a(d):void s.getTaskProgress(!1,b.data,function(b){var c=b.end,f=b.content,g=b.error,h=b.progress;g?(d=1,a&&a(d,h)):c?(d=0,e=f,a&&a(d,h)):a&&a(d,h)})},getResult:function(){return{type:3,data:e}}})},error:function(a){o.alert(a.msg)}})}}]},{initEvent:d,search:e,renderContainer:f,renderChartLeft:g,renderChartRight:h,renderChartStyle:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/cpn/resumeStatistics",["nc","cpn","../../../../../component/preview","./template","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/selectBtn","./echart","../../../../../util/util","../../../../../component/progress","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../util/ajax","../../../../../action/deliverData"],function(a,b,c){function d(){var a=this;a.previewCpn=new m({renderTo:a.getEl(".js-preview-home"),renderBy:"replaceWith",data:{topName:"简历总量",leftName:"今日投递",rightName:"待处理"}})}function e(){var a=this,b=a.getEl();k.mark(b)||q.getDeliverCountStatistics({query:a.getCond(),call:function(b){a.renderSearch(b.data||{})},error:function(b){a.rawConfig.module.renderNone(a.getEl(".js-chart"),b.msg)},always:function(){k.clear(b)}})}function f(a){var b=this,c=b.getEl(".js-chart");b.previewCpn.renderTxt({topData:a.totalDeliverCount,leftData:a.todayDeliverCount,rightData:a.notProcessedCount}),c.height(b.getEl(".js-form-main").height()-b.getEl(".js-filter").height()),o.dateToResume(i.isArray(a.details)?a.details:[],c)}var g=a("nc"),h=a("cpn"),i=g.Base,j=(g.$,g.Clazz),k=g.Limit,l=h.Popup,m=a("../../../../../component/preview"),n=a("./template"),o=a("./echart"),p=a("../../../extend/bll/task"),q=a("../../../../../action/deliverData"),r=c.exports=j.create();j.mix(r,n,{_template:['<div class="data-form-mod clearfix">','<h2>投递量统计<a href="javascript:void(0);" class="font-green js-download-report" style="float:right;font-weight:normal;"><i class="icon-download-alt"></i>下载报表</a></h2>','<div class="form-bd clearfix">','<div class="js-preview-home"></div>','<div class="data-form-main js-form-main" style="height:258px;">','<div class="js-filter">','<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">部门</span>','<div class="js-department"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">职位</span>','<div class="js-job"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">是否内推</span>','<div class="js-recommend"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<span class="title">投递日期</span>','<div class="js-date"></div>',"</div>",'<div class="data-main-hd" style="display:inline-block;margin-right:15px;">','<div class="js-date-check"></div>',"</div>","</div>",'<div class="data-main-bd js-chart" style="width:100%;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns(),a.initPreview(),a.search()}},{name:"click .js-download-report",handler:function(){var a=this;q.getDeliverCountStatisticsExcel({query:a.getCond(),call:function(b){var c=a.module.getWin(),d=2,e="";c.addTask({title:"投递量统计报表",waitTxt:"下载中",okTxt:"点击下载",getStatus:function(a){return 2!==d?a&&a(d):void p.getTaskProgress(!1,b.data,function(b){var c=b.end,f=b.content,g=b.error,h=b.progress;g?(d=1,a&&a(d,h)):c?(d=0,e=f,a&&a(d,h)):a&&a(d,h)})},getResult:function(){return{type:3,data:e}}})},error:function(a){l.alert(a.msg)}})}}]},{initPreview:d,search:e,renderSearch:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/cpn/template",["nc","cpn","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/selectBtn"],function(a,b,c){function d(a){var b=this;a=a||{},b.departmentCpn=new q({renderTo:b.getEl(".js-department"),renderBy:"replaceWith",size:"xsmall",needSearch:!0,options:[],change:function(){b.fixJob(),b.search()}}),b.jobCpn=new q({renderTo:b.getEl(".js-job"),renderBy:"replaceWith",size:"xsmall",needSearch:!0,options:[],change:function(){b.search()}}),b.recommendCpn=new q({renderTo:b.getEl(".js-recommend"),renderBy:"replaceWith",size:"xsmall",options:[{text:"不限",value:void 0,checked:!0},{text:"是",value:"1"},{text:"否",value:"0"}],change:function(){b.search()}}),a.noDate||(b.dateCpn=new r({renderTo:b.getEl(".js-date"),renderBy:"replaceWith",noTime:!0,startDate:b.getBeforeN(1e3),endDate:b.getBeforeN(),change:function(){var a=b.dateCpn.val();if(a.startDate&&a.endDate){var c=!1;a.endDate===b.getBeforeN()&&m.forEach(["3","7","30","1000"],function(d){return b.getBeforeN(d-1)===a.startDate?(b.dateCheck.val(d),c=!0,m.BREAK):void 0}),c||b.dateCheck.val(""),b.search()}}})),a.noDate||(b.dateCheck=new s({renderTo:b.getEl(".js-date-check"),renderBy:"replaceWith",title:"最近",btnData:[{value:"3",name:"3天"},{value:"7",name:"7天"},{value:"30",name:"30天"},{value:"1000",name:"全部"}],change:function(a){a&&(b.dateCpn.val({startDate:b.getBeforeN(a-1),endDate:b.getBeforeN()}),b.search())}})),b.fixDepartment(),b.fixJob(),a.noDate||b.dateCpn.val({startDate:b.getBeforeN(6),endDate:b.getBeforeN()}),a.noDate||b.dateCheck.val(7)}function e(a,b){var c=this;c.projectId=a,c.jobData=b||[],c.fixDepartment(),c.fixJob(),c.search()}function f(){}function g(){var a=this;a.jobMap={},a.jobAll=[],a.departmentCpn.replaceOptions([{text:"不限",value:void 0,checked:!0}].concat(m.map(a.jobData,function(b){var c=b.departmentName||"默认部门";return a.jobMap[c]=b.jobList||[],a.jobAll=a.jobAll.concat(b.jobList||[]),{text:c,value:c}})))}function h(){var a=this,b=a.departmentCpn.val(),c=[{text:"不限",value:void 0,checked:!0}].concat(m.map(b?a.jobMap[b]:a.jobAll,function(a){return{text:a.name,value:m.id(a.id)}}));a.jobCpn.replaceOptions(c)}function i(){var a=this,b=a.departmentCpn.val(),c=a.jobCpn.val(),d=a.dateCpn&&m.isFunction(a.dateCpn.val)&&a.dateCpn.val(),e={projectId:a.projectId,jobIds:c?c:m.map(b?a.jobMap[b]:a.jobAll,function(a){return a.id}),referral:a.recommendCpn.val()};return d&&m.extend(e,{deliverBegin:d.startDate+" 00:00:00",deliverEnd:d.endDate+" 23:59:59"}),e}function j(a){a=+a||0;var b=(new Date).getTime()-24*a*3600*1e3,c=p.form(new Date(b),"yyyy-MM-dd");return c}var k=a("nc"),l=a("cpn"),m=k.Base,n=(k.$,k.Clazz),o=k.Component,p=k.Time,q=l.Select,r=a("../../../../../component/dateSelect"),s=a("../../../../../component/selectBtn"),t=c.exports=n.create();n.mix(t,o,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.module=b.module,a.jobData=b.jobData||[],a.projectId=b.projectId}}]},{initCpns:d,refresh:e,search:f,fixDepartment:g,fixJob:h,getCond:i,getBeforeN:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/analyze/index",["nc","cpn","../../../../core/module","../../../../util/util","../../../../core/siteConfig","../../../../action/position","../../../../util/ajax","../../../../action/resumeDeliver","./cpn/resumeStatistics","../../../../component/preview","./cpn/template","../../../../component/dateSelect","../../../../component/selectBtn","./cpn/echart","../../../../component/progress","../../extend/bll/task","../../extend/bll/base","../../../../action/api","../../../../action/deliverData","./cpn/progressStatistics","./cpn/candidateAnalyze","../../extend/bll/resume","../../extend/event","../../extend/bll/money","../../../../action/purchase","../../../../action/price","../../../../action/resume","../../../../action/common"],function(a,b,c){function d(){var a=this;a.getEl().html(['<div class="project-types clearfix">','<div class="project-types-pic">','<img src="//uploadfiles.nowcoder.com/images/20170215/56_1487137391502_7060599B1E63FB274C2BA6B32CBD2AD6" />',"</div>",'<div class="project-types-main">','<div class="js-project"><input class="w130" type="text"></div>',"</div>","</div>",'<div class="realtime-mod">','<div class="realtime-title clearfix">','<h2 style="margin-right:20px;">简历数据统计</h2>',"</div>",'<div class="realtime-data js-main"></div>',"</div>"].join(""))}function e(a){var b=this,c=b.getParam().projectId;b.projectSelect=new n({renderTo:b.getEl(".js-project"),renderBy:"replaceWith",size:"small",autoWidth:!0,options:l.map(a,function(a,b){return{text:a.name,value:l.id(a.id),checked:c?c===l.id(a.id):0===b}}),change:function(){var a=b.projectId=this.val();b.addParam({projectId:a}),b.getJob(function(a){b.refreshCpn(a)},function(a){b.renderNone(b.getEl(".js-main"),a)})}}),c=b.projectId=b.projectSelect.val(),b.addParam({projectId:c})}function f(a){var b=this;b.resumeStatistics=new r({renderTo:b.getEl(".js-main"),module:b,projectId:b.projectId,jobData:a}),b.progressStatistics=new s({renderTo:b.getEl(".js-main"),module:b,projectId:b.projectId,jobData:a}),b.candidateAnalyze=new t({renderTo:b.getEl(".js-main"),module:b,projectId:b.projectId,jobData:a})}function g(a){var b=this;l.forEach(["resumeStatistics","progressStatistics","candidateAnalyze"],function(c){var d=b[c];l.isFunction(d.refresh)&&d.refresh(b.projectId,a)})}function h(a,b){p.listRecruitProject({query:{},call:function(b){var c=b.data||[];a&&a(u.filterStatus(c,0))},error:function(a){b&&b(a.msg)}})}function i(a,b){var c=this;q.getDeliverDepartment({query:{projectId:c.projectId},call:function(b){l.isFunction(a)&&a(b.data||[])},error:function(a){l.isFunction(b)&&b(a.msg)}})}var j=a("nc"),k=a("cpn"),l=j.Base,m=(j.$,j.Clazz),n=k.Select,o=a("../../../../core/module"),p=a("../../../../action/position"),q=a("../../../../action/resumeDeliver"),r=a("./cpn/resumeStatistics"),s=a("./cpn/progressStatistics"),t=a("./cpn/candidateAnalyze"),u=a("../../extend/bll/resume"),v=c.exports=m.create();m.mix(v,o,{style:"/stylesheets/styles/system/realTimeIndex-new2.css",title:"简历统计",_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getProject(function(b){a.initContainer(),a.initProjectSelect(b),a.getJob(function(b){a.initCpns(b)},function(b){a.renderNone(a.getEl(".js-main"),b)})},function(b){a.renderNone(a.getEl(),b)})}}]},{initContainer:d,initProjectSelect:e,initCpns:f,refreshCpn:g,getProject:h,getJob:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/browse/index/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../action/resume","../../util/util"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=(a.rawConfig,{id:"school",title:"学校",type:"school"}),d={id:"edu",title:"学历",type:"selectMult",conf:{cls:"filter-item-txt none",options:[{text:"博士",value:"博士"},{text:"硕士",value:"硕士"},{text:"本科",value:"本科"},{text:"专科",value:"专科"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="ico-level"></i>')}}}},e={id:"major",title:"专业",type:"input",conf:{placeholder:"多个用空格分隔",listeners:{render:function(){this.getEl().css("marginRight",10).append('<i class="icon-wrench"></i>')}}},ext:{chkTitle:"包含任一专业"}},f={id:"gender",title:"性别",type:"select",conf:{options:[{text:"不限",value:"不限",checked:!0},{text:"男",value:"男"},{text:"女",value:"女"}]}},g={id:"location",title:"所在地",type:"selectMult",conf:{cls:"filter-item-txt none",needSearch:!0,options:[{text:"北京",value:"北京"},{text:"上海",value:"上海"},{text:"广州",value:"广州"},{text:"深圳",value:"深圳"},{text:"杭州",value:"杭州"},{text:"南京",value:"南京"},{text:"西安",value:"西安"},{text:"武汉",value:"武汉"},{text:"哈尔滨",value:"哈尔滨"},{text:"长春",value:"长春"},{text:"成都",value:"成都"},{text:"长沙",value:"长沙"},{text:"合肥",value:"合肥"},{text:"其他",value:"其他"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="icon-map-marker"></i>')}}}},h=(new Date).getFullYear(),i={id:"graduate",title:"毕业年份",type:"selectMult",conf:{options:o.map(o.range(h-3,h+5,1).reverse(),function(a){return{text:a+"年",value:o.id(a)}})}},j={id:"tag",title:"标签",type:"selectMult",conf:{needSearch:!0,options:o.map(a.tagList,function(a){return{text:a,value:a}})}},k={id:"buy",title:"简历权限",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"已购买",value:"1"},{text:"未购买",value:"2"}]}},l={id:"range",title:"综合排名区间",type:"range",ext:{chkTips:"本排名综合用户的学籍、学历、成绩、实习经验、项目情况、获奖情况、论文、专利等情况，由牛客系统智能评级得出，帮助快速找到最优秀简历。"}},m={id:"search",title:"关键词",type:"search",conf:{placeholder:"姓名/手机/邮箱/ACM/实习信息等，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的简历，多个关键词用空格分割"}},n=a.filter=new p({renderTo:b.find(".manage-bd"),renderBy:"html",submitTxt:"查询",line:[{items:[c,d,e]},{fold:!0,items:[f,g,i]},{fold:!0,border:!0,items:[j,k,l]},{fold:!0,items:[m]}],clearAll:function(){a.val({})},getCondInfo:function(b,c){0===+b&&c&&c({key:a.getCondKey(),content:a.val()}),1===+b&&c&&c({key:a.getCondKey(),call:function(b){a.val(b)}})},listeners:{submit:o.bind(a.submit,a)}}),q=n.getItem("tag");0===a.tagList.length&&q.disabled()}function e(a){var b=this,c=b.rawConfig,d=b.filter,e=d.getItem("edu"),f=d.getItem("school"),g=d.getItem("major"),h=d.getItem("gender"),i=d.getItem("location"),j=d.getItem("graduate"),k=d.getItem("tag"),l=d.getItem("buy"),m=d.getItem("range"),n=d.getItem("search");if(0===arguments.length){var a={graduationYearList:r.wrapVal(j.val()),liveAddressList:r.wrapVal(i.val()),schoolList:r.wrapVal(f.getSchool()),eduLevelList:r.wrapVal(e.val()),majorList:r.wrapVal(r.split(g.ipt.val())),gender:{"男":"男","女":"女"}[h.val()]||void 0,tagList:r.wrapVal(k.val()),isBuy:"0"===r.wrapNum(l.val())?void 0:r.wrapNum(l.val()),keywordList:r.wrapVal(r.split(n.ipt.val())),rankStart:r.wrapVal(r.wrapNum(m.startIpt.val())),rankEnd:r.wrapVal(r.wrapNum(m.endIpt.val())),union:r.wrapNum(n.chk.isChecked()?1:0),majorUnion:r.wrapNum(g.chk.isChecked()?1:0),selectStatus:r.wrapNum(c.selectStatus),isCollected:"0"===o.id(c.isCollected)?void 0:r.wrapNum(c.isCollected)};return o.forEach(a,function(b,c){void 0===b&&delete a[c]}),a}var p=(a.schoolList||[]).join(",");f.val(p).getEl().attr("title",p),e.val(a.eduLevelList),g.ipt.val((a.majorList||[]).join(" ")),g.chk.checked("1"===o.id(a.majorUnion)),h.val(a.gender||"不限"),i.val(a.liveAddressList),j.val(a.graduationYearList),k.val(a.tagList||[]),l.val(o.id(a.isBuy)||"0"),m.startIpt.val(a.rankStart||""),m.endIpt.val(a.rankEnd||""),n.ipt.val((a.keywordList||[]).join(" ")),n.chk.checked("1"===o.id(a.union))}function f(){var a=this,b=a.filter,c=b.getItem("range"),d=a.val();return d.rankStart&&!d.rankEnd?(c.endIpt.setErrorTips("不能为空"),!1):!d.rankStart&&d.rankEnd?(c.startIpt.setErrorTips("不能为空"),!1):d.rankStart&&d.rankEnd&&+d.rankStart>+d.rankEnd?(c.startIpt.setErrorTips("值错误"),c.endIpt.setErrorTips("值错误"),!1):(c.startIpt.setNone(),c.endIpt.setNone(),!0)}function g(){var a=this,b=a.rawConfig;b.ok&&a.check()&&b.ok(a.val())}function h(a){{var b=this;b.rawConfig}q.getHrTags({query:{entityType:2001},call:function(c){b.tagList=c.data||[],a&&a()},error:function(a){b.renderWait(a.msg)}})}function i(){var a="ResumeBrowseCondition";return a}function j(a){var b=this,c=b.getEl();c.find(".manage-bd").html(a?'<div style="text-align:center;padding:20px;font-size:14px;">'+a+"</div>":"")}var k=a("nc"),l=a("cpn"),m=(k.$,k.Component),n=k.Clazz,o=k.Base,p=(l.Popup,a("../../../../../component/filter/filter")),q=a("../../../../../action/resume"),r=a("../../util/util"),s=c.exports=n.create();n.mix(s,m,{_template:['<div class="manage-box">','<div class="manage-bd"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderWait("条件加载中..."),a.getTagData(function(){a.initCpn(),a.submit()})}}]},{initCpn:d,val:e,check:f,submit:g,getTagData:h,getCondKey:i,renderWait:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/browse/index/index",["nc","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./filter","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../action/resume","../../util/util","./list","../../../../../component/selectAll","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../../../action/position","../util"],function(a,b,c){function d(){var a=this;a.page=0,a.pageCount=20}function e(){var a=this,b=a.getEl(),c=a.getParam(),d=j.id(c.selectStatus)||"0",e=j.id(c.isCollected)||"0";a.filterModule=new l({renderTo:b.find("div.js-filter"),win:a.getWin(),userId:a.getUserId(),selectStatus:d,isCollected:e,ok:function(b){var c=a.listModule;c&&c.reload(b)}})}function f(){var a=this,b=a.getEl(),c=a.getParam(),d=j.id(c.selectStatus)||"0",e=j.id(c.isCollected)||"0";a.listModule=new m({renderTo:b.find("div.js-list"),parent:a,selectStatus:d,isCollected:e})}var g=a("nc"),h=g.$,i=g.Clazz,j=g.Base,k=a("../../../../../core/module"),l=a("./filter"),m=a("./list"),n=c.exports=i.create();i.mix(n,k,{style:"/stylesheets/styles/system/resumeManage.css",title:"人才搜索",showTask:!0,_template:["<div>",'<div class="menu-box menu-line-box">','<ul class="menu clearfix">','<li class="js-tab-0">','<a href="javascript:void(0);" class="js-select-btn" data-status="0">全部</a>','<span class="msg-num js-unread-num" style="display: none;">0</span>',"</li>",'<li class="js-tab-1">','<a href="javascript:void(0);" class="js-select-btn" data-collect="1">已收藏</a>',"</li>",'<li class="js-tab-2">','<a href="javascript:void(0);" class="js-select-btn" data-status="1">不合适</a>',"</li>","</ul>","</div>",'<div class="js-filter"></div>','<div class="js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam(),c=j.id(b.selectStatus)||"0",d=j.id(b.isCollected)||"0",e=".js-tab-0";"1"===d?e=".js-tab-1":"1"===c&&(e=".js-tab-2"),a.getEl().find(e).addClass("selected"),a.initFilter(),a.initList()}},{name:"click a.js-select-btn",handler:function(a){var b=this,c=h(a.currentTarget),d=c.attr("data-status"),e=c.attr("data-collect");b.selectStatus=d,b.isCollected=e,b.nav("resume",{action:"browse/index/index",selectStatus:d,isCollected:e})}}]},{initialize:d,initFilter:e,initList:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/browse/index/list",["nc","cpn","../../../../../component/selectAll","../../../../../action/resume","../../../../../util/ajax","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../../../action/position","../../../../../action/common","../util","../../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this;b.parent=a.parent,b.allIds=[],b.selectAll=new E({dealId:function(a){return a},change:function(a){b.listEl.find("td label.checkbox")[a?"addClass":"removeClass"]("checked"),b.updatePreviewUrl()},toggle:function(a,c){b.listEl.find("tr[data-markId="+a+"] label.checkbox")[c?"addClass":"removeClass"]("checked"),b.updatePreviewUrl()}})}function e(){var a=this,b=a.getEl();a.pageSelect=new A({renderTo:b.find(".js-tmp-page"),renderBy:"replaceWith",size:"xsmall",options:[{text:"20",value:20,checked:!0},{text:"50",value:50},{text:"100",value:100}],change:function(){a.load()}}),a.unreadCb=B.transform(b.find(".js-unread-ck"),{change:function(){a.condition&&(a.condition.unread=this.isChecked()?1:0),a.load()}})}function f(a){var b=this;b.allIds.length=0,b.selectAll.clear(),b.unreadCb.checked(!1),b.load(a)}function g(a,b){var c=this;return a&&(c.condition=a),0===v.size(c.condition)?void c.renderNone():(c.renderWait(),void F.getMeetConditionResumes({params:{hrId:c.parent.getUserId()},body:c.getCond(b),call:function(a){a.isOrder&&c.renderList(a.data)},error:function(a){a.isOrder&&c.renderWait(a.msg)}}))}function h(a){var b=this,c=b.rawConfig,d=b.getEl(),e='共<span class="font-green">'+a.totalCount+'</span>份，已解锁<span class="font-green">'+a.hasBuyCount+"</span>份";d.find("span.js-count").html(e),"1"===v.id(c.isCollected)&&d.find(".js-batch-collect").html("批量取消收藏").attr("data-collect","0"),"1"===v.id(c.selectStatus)&&d.find(".js-batch-select").html("批量取消不合适").attr("data-status","0")}function i(a){var b=this,c=b.parent;if(0===(a.datas||[]).length)return b.renderNone();b.renderTotal(a);var d='<div class="js-select-tips"></div><table class="no-border-table">';d+=["<thead>","<tr>",'<th width="1%" class="with-checkbox-select text-left"></th>','<th width="5%">性别</th>','<th width="10%">学校</th>','<th width="10%">专业</th>','<th width="5%">最高学历</th>','<th width="10%">所在地</th>','<th width="5%">简历查看</th>',"</tr>","</thead>"].join(""),v.forEach(a.datas,function(a){d+=y.execTpl(['<tr data-id="#{id}" data-markId="#{mId}">','<td class="text-left"><label class="checkbox"><span class="icons"></span></label></td>',"<td>#{unread}#{gender}</td>","<td>#{school}</td>","<td>#{major}</td>","<td>#{edu}</td>","<td>#{location}</td>",'<td><a href="#{previewUrl}" target="_blank" class="js-preview btn btn-auto btn-primary btn-xs" data-bought="#{bought}">查看</a></td>',"</tr>"].join(""),{id:a.resumeId,mId:a.resumeId,unread:"0"===v.id(a.unread)?"1"===v.id(a.bought)?'<i class="icon-spot-green"></i>':"":'<i class="icon-spot-red"></i>',name:b.wrapStr(a.candidateName),gender:b.wrapStr(a.candidateGender),school:b.wrapStr(a.candidateSchool),major:b.wrapStr(a.candidateMajor),edu:b.wrapStr(a.candidateEduLevel),location:b.wrapStr(a.candidateLiveAddress),bought:a.bought,previewUrl:c.getNavUrl("resume",{action:"browse/preview/index",id:a.resumeId})})}),d+="</table>",b.actionEl.show(),b.listEl.html(d);var e=v.map(a.datas,function(a){return a.resumeId+""});b.saveIds(e,a.currentPage);var f=b.selectAll;b.listEl.find("th.with-checkbox-select").append(f.getEl()),f.refreshEl(),f.render(),f.tipsEl=b.listEl.find("div.js-select-tips"),f.loadPage(e,!0),f.changePageCount(a.totalPage),f.changeTotalCount(a.totalCount),new D({renderTo:b.listEl,current:a.currentPage,total:a.totalPage,pageChange:function(a){b.load(null,a)}})}function j(){var a=this,b=v.size(a.condition);a.renderTotal({totalCount:0,hasBuyCount:0}),a.actionEl.show(),a.listEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(b?"没有符合条件的简历":"请先选择条件后点击搜索按钮")+"</div>","</div>"].join(""))}function k(a){var b=this;b.actionEl.hide(),b.listEl.html(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">'+(a||"加载中...")+"</div>","</div>"].join(""))}function l(a){var b=this,c=v.extend({},b.condition,{currentPage:a||1,pageSize:b.pageSelect.val()});return c}function m(){var a=this,b=a.selectAll;return v.extend({},a.condition,{isAll:b.isSelectAll?1:2,ids:b.selectIds})}function n(a){var b=u(a).closest("tr");return u.trim(b.attr("data-id"))}function o(){var a=this,b=a.selectAll,c=a.parent,d=a.getEl(),e=d.find("a.js-batch-preview");if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return void e.attr("href","javascript:void(0);").removeAttr("target");var f="",g=!b.isSelectAll&&1===b.selectIds.length,f=c.getNavUrl("resume",{action:"browse/preview/index",id:g?b.selectIds[0]:null});e.attr("href",f).attr("target","_blank")}function p(a,b){return u.trim(a)||u.trim(b)||"---"}function q(a,b){var c=this,d=c.allIds,e=Math.max(b-1,0)*c.pageSelect.val();v.forEach(a,function(a,b){d[e+b]=a})}function r(a){function b(a,b){a=a||[];for(var c=0,d=a.length;d>c;c++)if(a[c]&&a[c]===b)return c;return-1}var c=this,d=20,e=c.selectAll,f=c.allIds,g=e.selectIds;if(!a)return 1;if(e.isSelectAll){var h=b(f,a);if(d>h)return 1;if((g||[]).length>0){var i={};v.forEach(g,function(a){i[a]=1});for(var j=h-1;j>=0;j--)h+=f[j]&&i[f[j]]?-1:0}return z.page(h+1,d)}var h=b(g,a);return-1===h?1:z.page(h+1,d)}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Base,w=s.Component,x=s.Clazz,y=(s.Db,s.Str),z=s.Num,A=t.Select,B=t.CheckBox,C=t.Popup,D=t.Pager,E=a("../../../../../component/selectAll"),F=a("../../../../../action/resume"),G=a("../../../extend/bll/task"),H=a("../../../extend/bll/resume"),I=a("../util"),J=c.exports=x.create();x.mix(J,w,{_template:['<div class="manage-box" style="padding-bottom:20px;">','<div class="manage-hd clearfix js-action">','<div class="menu-txt-box">','<ul class="menu-txt clearfix">','<li><a href="javascript:void(0);" class="js-batch-preview">批量查看简历</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-collect" data-collect="1">批量收藏</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-select" data-status="1">批量不合适</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-download">批量下载简历</a></li>','<li class="menu-pipe">|</li>','<li><a href="javascript:void(0);" class="js-batch-excel">导出excel</a></li>',"</ul>","</div>",'<div class="result-info">','<span class="result-num js-count"></span>','<span>每页显示 <div class="js-tmp-page"></div></span>','<label class="checkbox label-sm js-unread-ck" style="width:auto; margin-left:10px">','<span class="icons"></span>隐藏已查看的',"</label>","</div>","</div>",'<div class="manage-bd js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.actionEl=b.find("div.js-action"),a.listEl=b.find("div.js-list"),a.initCpn(),a.renderNone()}},{name:"click .js-batch-preview",handler:function(a){var b=this,c=b.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return a.preventDefault(),C.alert("请先选择简历");var d=b.parent;if(d){var e=b.getBatchCond();I.removeDb(I.DB_FILTER),I.setDb(I.DB_COND,e)}}},{name:"click .js-preview",handler:function(a){var b=this,c=b.parent,d=(b.selectAll,u(a.currentTarget)),e=b.getLineId(d);if(e&&c){I.removeDb(I.DB_FILTER),I.removeDb(I.DB_COND),d.attr("href",c.getNavUrl("resume",{action:"browse/preview/index",id:e}));var f=d.closest("tr").find(".icon-spot-red");"1"===d.attr("data-bought")?f.removeClass("icon-spot-red").addClass("icon-spot-green"):f.hide()}}},{name:"click .js-batch-download",handler:function(){var a=this,b=a.selectAll;if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return C.alert("请先选择简历");var c=a.getBatchCond();H.download(c)}},{name:"click .js-batch-excel",handler:function(){var a=this,b=a.selectAll;if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return C.alert("请先选择简历");var c=a.getBatchCond();H.downloadExcel(c)}},{name:"click .js-batch-select",handler:function(a){var b=this,c=b.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return C.alert("请先选择简历");var d=b.parent,e=d.getWin(),f=u(a.currentTarget),g=b.getBatchCond(),f=(d.getUserId(),u(a.currentTarget)),h=f.attr("data-status");g.updateSelectStatus=h,F.batchSelect({body:g,call:function(a){var c=e.showLoading("1"===h?"标记不合适中...":"撤销标记不合适中...");G.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),C.alert(e)):d&&(c.close(),C.tips("1"===h?"标记成功":"撤销标记成功",function(){b.load()}))})},error:function(a){C.alert(a.msg)}})}},{name:"click .js-batch-collect",handler:function(a){var b=this,c=b.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return C.alert("请先选择简历");var d=b.parent,e=d.getWin(),f=u(a.currentTarget),g=b.getBatchCond(),f=(d.getUserId(),u(a.currentTarget)),h=f.attr("data-collect");g.updateCollectStatus=h,F.batchCollect({body:g,call:function(a){var c=e.showLoading("1"===h?"收藏中...":"撤销收藏中...");G.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),C.alert(e)):d&&(c.close(),C.tips("1"===h?"收藏成功":"撤销收藏成功",function(){b.load()}))})},error:function(a){C.alert(a.msg)}})}},{name:"click td label.checkbox",handler:function(a){var b=this,c=b.getLineId(a.currentTarget);c&&b.selectAll.toggle(c)}}]},{initialize:d,initCpn:e,reload:f,load:g,renderTotal:h,renderList:i,renderNone:j,renderWait:k,getCond:l,getBatchCond:m,getLineId:n,updatePreviewUrl:o,wrapStr:p,saveIds:q,getIdPageIndex:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/browse/preview/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/event","../../viewResume/index","../../render/theme0","../../render/util","../../render/dataMenu","../../render/dataItem","../../../../../util/switch","../../../../../component/popupSub/popupResumeTag","../../../../../action/resume","../../../../../util/ajax","../../../extend/bll/resume","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/position","../../../../../action/common","../util"],function(a,b,c){function d(){var a=this;a.initEvent()}function e(){var a=this,b=function(){a.viewResume.initResume&&a.viewResume.initResume()};x.listen(B.RESUME_UPDATE,b),a.listen("destroy",function(){x.unlisten(B.RESUME_UPDATE,b)})}function f(){var a=this;a.viewResume=new C({renderTo:a.getEl(),module:a,nav:a.getNavConf(),resume:a.getResumeConf()})}function g(){var a=this,b={getNavData:w.bind(a.getNavData,a)};return b}function h(a,b,c){var d=this,e=d.getParam();if(!d.getCond()||e.id)return void(b&&b({data:[{id:e.id}],totalPage:1,currentPage:1,totalCount:1}));var f=w.extend({},d.getCond(),{currentPage:a||1,pageSize:20});f.operation="search",E.getMeetConditionResumes({body:f,call:function(a){var c=a.data.datas;w.isArray(c)&&(w.forEach(c,function(a){a.name=a.candidateName,a.id=a.resumeId,a.unread=a.unread,a.info=[a.candidateName,a.candidateSchool,a.candidateMajor]}),b&&b(a.data))},error:function(a){c&&c(a.msg)}})}function i(){var a=this,b={tagTypeConf:{entityType:2001,sceneType:0},getResumeData:w.bind(a.getResumeData,a),getFooterConf:w.bind(a.getFooterConf,a)};return b}function j(a,b,c){E.getResume({params:{resumeId:a.id},query:{entityType:2001},call:function(a){var c=a.data;c.name=c.resumeName,b&&b(c)},error:function(a){c&&c(a.msg)}})}function k(a){{var b=this;b.getEl()}return b.resumeData=a,[].concat(b.getLeftFooter(),b.getRightFooter())}function l(){var a=this,b=a.resumeData,c=[{name:"下载简历",side:"left",cls:"",call:function(){var a=D.getCondById(b.id);D.download(a,{count:1})}}];return u.trim(b.email)||u.trim(b.phone)||c.push({name:"查看联系方式",side:"left",cls:"",call:function(){D.showContact(b.id)}}),c}function m(){var a=this,b=a.resumeData,c=(b.selectStatus,a.viewResume),d=!!b.selectStatus,e=b.collectStatus,f=[{name:d?"已不合适":"不合适",hoverName:d?"取消不合适":void 0,side:"right",cls:d?"btn btn-default":"btn btn-primary",call:function(){a.markSelect(d?0:1)}},{name:e?"已收藏":"收藏",hoverName:e?"取消收藏":void 0,side:"right",cls:e?"btn btn-default":"btn btn-primary",call:function(){a.markCollect(e?0:1)}},(d||e)&&c.hasNextResume()?{name:"下一份 >",side:"right",cls:"link-green",call:function(){c.changeResume("next")}}:null];return f}function n(a){var b=this,c=b.getEl(),d=b.resumeData;y.mark(c)||E.markSelect({body:{entityType:2001,entityId:d.id,status:a},call:function(){d.selectStatus=a,b.viewResume.renderResumeFooter(),z.tips("操作成功")},error:function(a){z.alert(a.msg)},always:function(){y.pause(c)}})}function o(a){var b=this,c=b.getEl(),d=b.resumeData;y.mark(c)||E.saveCollectedResume({body:{entityType:2001,resumeId:d.id,status:a},call:function(){d.collectStatus=!!a,b.viewResume.renderResumeFooter(),z.tips("操作成功")},error:function(a){z.alert(a.msg)},always:function(){y.pause(c)}})}function p(){var a=this,b=a.getParam();return w.id(b.id)||a.getCond()?!0:(a.nav("resume"),!1)}function q(){return F.getDb(F.DB_COND)}function r(){return{crumb:[{title:"人才搜索",module:"resume",action:"browse/index/index"}]}}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Clazz,w=s.Base,x=s.Event,y=s.Limit,z=t.Popup,A=a("../../../../../core/module"),B=a("../../../extend/event"),C=a("../../viewResume/index"),D=a("../../../extend/bll/resume"),E=a("../../../../../action/resume"),F=a("../util"),G=c.exports=v.create();v.mix(G,A,{style:"/stylesheets/styles/system/resumeManage.css",title:"查看简历",showTask:!0,_template:['<div class="manage-box"></div>'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;window.setTimeout(function(){a.check()&&(a.initViewResume(),a.sizeFull(function(b,c){a.viewResume&&a.viewResume.reHeight(c)}))},250)}}]},{initialize:d,initEvent:e,initViewResume:f,getNavConf:g,getNavData:h,getResumeConf:i,getResumeData:j,getFooterConf:k,getLeftFooter:l,getRightFooter:m,markSelect:n,markCollect:o,check:p,getCond:q,getCrumbConf:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/browse/util",["nc","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b._db=b._db||new i(j.appDb.DoneVTestResume);return h.trim(a)?c.get(a)||{}:c}function e(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function f(a){var b=this,c=b.getDb();b._db.refresh(),c.remove(a)}var g=a("nc"),h=(g.Base,g.$),i=g.Db,j=a("../../../../core/siteConfig");c.exports={DB_COND:"DB_RESUME_COND",DB_FILTER:"DB_RESUME_FILTER",getDb:d,setDb:e,removeDb:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/batchInterview/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/resumeDeliver","../../../../../util/ajax","../../../../../component/steps","../../../../../component/dateSelect","../../../../../component/table","../../../../../component/selectAll","./popupSucc","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(){var a=this;a.getEl().html(['<div class="js-step"></div>','<div class="set-time-wrap">','<div class="set-time-item">每<span class="js-minute"></span>分钟安排<span class="js-person"></span>人</div>','<a href="javascript:void(0);" class="js-add-time"><i class="icon-plus-sign"></i>添加时段</a>','<div class="submit-btn-wrap"><a href="javascript:void(0);" class="btn btn-primary btn-sm js-submit">确定</a></div>',"</div>",'<div class="set-time-wrap">','<div class="set-time-item js-tip"></div>',"</div>",'<div class="joblist-data" style="display:none;">','<div class="result-info">','<span class="result-num">共 <span class="font-green js-result-count"></span>份 </span>','<span>每页显示<span class="js-page-size"></span></span>','<div class="time-setting-oprt">','<a href="javascript:void(0);" class="link-green js-batch-offline">批量设置面试方式</a>',"</div>","</div>",'<div class="js-table"></div>','<div style="text-align:center;margin-top:50px;">','<a href="javascript:void(0);" class="btn btn-default js-go-back" style="margin-right:50px;">取消</a>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-go-next">设置完毕，下一步</a>',"</div>","</div>"].join(""))}function e(){var a=this,b=a.getParam();a.stepCpn=new C({renderTo:a.getEl(".js-step"),renderBy:"replaceWith",current:1,titles:["设置预约时间","完成"]}),a.minuteCpn=new u({renderTo:a.getEl(".js-minute"),renderBy:"replaceWith",tag:"span",listeners:{change:function(){a.addParam({minute:this.val()})}}}),a.minuteCpn.val(b.minute),a.minuteCpn.inputEl.addClass("w50"),a.personCpn=new u({renderTo:a.getEl(".js-person"),renderBy:"replaceWith",tag:"span",listeners:{change:function(){a.addParam({person:this.val()})}}}),a.personCpn.val(b.person),a.personCpn.inputEl.addClass("w50"),b.timeItem?p.forEach(b.timeItem,function(b){a.addTimeItem().val(b)}):a.addTimeItem(),a.pagesizeCpn=new v({renderTo:a.getEl(".js-page-size"),renderBy:"replaceWith",size:"xsmall",options:[{text:20,value:20,checked:!0},{text:50,value:50},{text:100,value:100}],change:function(){a.page=1,a.renderList()}})}function f(){var a=this,b=a.dateCpnHome=a.dateCpnHome||{},c=a.dateCpnId=a.dateCpnId||1,d=q(['<div class="set-time-item js-time-item" data-id="',c,'" style="margin-bottom:10px;">',"面试时间段",'<div class="js-date"></div>','<a href="javascript:void(0);" class="icon-trash js-del-time"></a>',"</div>"].join(""));return a.getEl(".js-add-time").before(d),b[c]=new D({renderTo:d.find(".js-date"),renderBy:"replaceWith",startDate:t.form(new Date,"yyyy-MM-dd"),change:function(){var c=[];p.forEach(b,function(a){c.push(a.val())}),a.addParam({timeItem:c})}}),a.dateCpnId++,a.fixTrash(),b[c]}function g(){var a=this,b=!0;return p.forEach([a.minuteCpn,a.personCpn],function(a){var c=q.trim(a.val());return c?/^\d+$/.test(c)&&+c>0?void 0:(b=!1,a.errorTips("请填入大于0的整数")):(b=!1,a.errorTips("不能为空"))}),p.forEach(a.dateCpnHome,function(a){var c=a.val();return c.startDate&&c.startTime&&c.endDate&&c.endTime?new Date([c.startDate,c.startTime].join(" ")).getTime()>new Date([c.endDate,c.endTime].join(" ")).getTime()?(b=!1,a.errorTips("结束时间不能早于开始时间")):(new Date).getTime()>new Date([c.startDate,c.startTime].join(" ")).getTime()?(b=!1,a.errorTips("开始时间不能早于现在")):void 0:(b=!1,a.errorTips("请填写完整的时间段"))}),b}function h(a){function b(){var b=[],f=[];p.forEach(c.dateCpnHome,function(a){var c=a.val();(c.startDate||c.startTime||c.endDate||c.endTime)&&(b.push([c.startDate,c.startTime].join(" ")),f.push([c.endDate,c.endTime].join(" ")))});var g={projectId:c.projectId,arrangeInterviewProjectId:c.arrangeInterviewProjectId,toArrangeDeliverIdSet:c.toArrangeDeliverId,isReferral:c.isReferral};0===b.length||p.extend(g,{beginList:b}),0===f.length||p.extend(g,{endList:f}),d&&p.extend(g,{minutes:d}),e&&p.extend(g,{concurrentPersonCount:e}),B.arrangeInterview({type:"POST",body:g,call:function(b){var d=x.mask("请稍等...");G.getTaskProgress(!0,b.data,function(b){var e=b.end,f=b.content,g=b.error;g?(d.close(),x.alert(f)):e?(d.close(),c.resultData=p.json(f),c.page=1,c.fixTip(),"noDisable"===a||c.disableForm(),c.renderList()):"暂无进度"===f||d.getEl(".pop-content div").html(f)})},error:function(a){x.alert(a.msg)}})}var c=this,d=+c.minuteCpn.val(),e=+c.personCpn.val(),f=Math.ceil(c.needSetCount/e)*d,g=0;return p.forEach(c.dateCpnHome,function(a){var b=a.val();g+=Math.floor((new Date([b.endDate,b.endTime].join(" ")).getTime()-new Date([b.startDate,b.startTime].join(" ")).getTime())/1e3/60)}),f>g?x.confirm("面试总时长不够，还有部分考生无法预约，请延长面试时间段或手动填写预约时间",b):void b()}function i(){var a=this,b=a.resultData,c=a.pagesizeCpn.val(),d=a.page||1,e=b.slice((d-1)*c,d*c);if(a.getEl(".joblist-data").show(),a.getEl(".js-result-count").html(b.length),0===b.length)return a.renderNone(a.getEl(".js-table"),"暂无数据");var f=0;p.forEach(e,function(a){f=Math.max(p.size(a.rounds),f)});var g=[];p.forCount(f,function(a){g.push({text:"第"+(a+1)+'轮预约时间<a href="javascript:void(0);" class="font-green icon-refresh js-reset-time" data-index="'+a+'" style="margin-left:5px;"></a>',width:"5%",style:{"text-align":"center","min-width":"200px"}},{text:"面试方式",width:"5%",style:{"text-align":"center"}})});var h={head:[{text:"投递编号",width:"2%",style:{"text-align":"center","min-width":"110px"}},{text:"姓名",width:"2%",style:{"text-align":"center","min-width":"4em"}},{text:"手机",width:"2%",style:{"text-align":"center","min-width":"85px"}},{text:"邮箱",width:"10%",style:{"text-align":"center"}},{text:"面试职位",width:"10%",style:{"text-align":"center"}}].concat(g,[{text:"操作",width:"5%",style:{"text-align":"center"}}]),list:[]};p.forEach(e,function(a,b){var c=[a.deliverId,a.intervieweeName,a.intervieweePhone,a.intervieweeEmail,a.job];p.forCount(f,function(d){var e=(a.rounds||[])[d];return e?(c.push('<span class="js-time-'+b+"-"+d+'"></span>'),void c.push('<span class="js-offline-'+b+"-"+d+'"></span>')):c.push("","")}),c.push('<a href="javascript:void(0);" class="link-green js-remove-interview">取消预约</a>'),h.list.push({items:c,attr:{"data-index":b}})}),a.getEl(".js-table").html(E.getHtml(h)),p.forEach(e,function(b,c){p.forCount(f,function(d){var e=(b.rounds||[])[d];if(e){var f=e.bookTime?t.form(new Date(e.bookTime)).split(" "):[];new D({renderTo:a.getEl(".js-table .js-time-"+c+"-"+d),renderBy:"replaceWith",onlyStart:!0,startDate:t.form(new Date,"yyyy-MM-dd"),val:{startDate:f[0],startTime:f[1]},change:function(a){e.bookTime=new Date([a.startDate,a.startTime].join(" ")).getTime()}}),new v({renderTo:a.getEl(".js-table .js-offline-"+c+"-"+d),renderBy:"replaceWith",size:"small",options:[{text:"视频",value:0,checked:0===e.offline},{text:"线下",value:1,checked:1===e.offline}],change:function(){e.offline=+this.val()}})}})}),new w({renderTo:a.getEl(".js-table"),current:d,total:Math.ceil(b.length/c),pageChange:function(b){a.page=b,a.renderList()}})}function j(a){var b=this;b.getEl(".js-submit").html(a===!1?"确定":"修改"),b.getEl(".js-del-time")[a===!1?"show":"hide"](),b.getEl(".js-add-time")[a===!1?"show":"hide"](),b.minuteCpn.disabled(a),b.personCpn.disabled(a),p.forEach(b.dateCpnHome,function(b){b.disabled(a)}),a===!1&&b.fixTrash(),b.formDisabled=a!==!1}function k(){var a=this;a.getEl(".set-time-wrap .icon-trash")[p.size(a.dateCpnHome)>1?"show":"hide"]()}function l(){var a=this,b=+a.minuteCpn.val(),c=+a.personCpn.val(),d=Math.ceil(a.needSetCount/c)*b,e=Math.floor(d/60),f=d%60;a.getEl(".js-tip").html('本次将为<span class="font-green">'+a.needSetCount+'</span>人安排面试，根据设置至少需要面试总时长<span class="font-green">'+(e?e+"小时":"")+(f?f+"分钟":"")+"</span>")}function m(){var a=this;return{crumb:[{title:"应聘管理",module:"resume",action:"deliver/index/index",projectId:a.projectId}]}}var n=a("nc"),o=a("cpn"),p=n.Base,q=n.$,r=n.Clazz,s=n.Db,t=n.Time,u=o.Input,v=o.Select,w=o.Pager,x=o.Popup,y=o.CheckGroup,z=a("../../../../../core/module"),A=a("../../../../../core/siteConfig"),B=a("../../../../../action/resumeDeliver"),C=a("../../../../../component/steps"),D=a("../../../../../component/dateSelect"),E=a("../../../../../component/table"),F=a("./popupSucc"),G=a("../../../extend/bll/task"),H=c.exports=r.create();r.mix(H,z,{style:"/stylesheets/styles/system/settingInterviewTime.css",title:"设置预约时间",_template:'<div class="steps-main"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getParam(),c=a.db=s.create(A.appDb.BatchInterview);return a.projectId=p.id(b.projectId),a.arrangeInterviewProjectId=p.id(b.arrangeInterviewProjectId),a.needSetCount=b.needSetCount,a.toArrangeDeliverId=c.get("toArrangeDeliverId")||[],a.isReferral=b.isReferral,a.projectId&&a.arrangeInterviewProjectId&&a.needSetCount&&0!==a.toArrangeDeliverId.length?(a.initContainer(),a.initCpns(),void a.submit("noDisable")):a.renderNone(a.getEl(),"数据出现错误")}},{name:"click .js-add-time",handler:function(){var a=this;a.addTimeItem()}},{name:"click .js-del-time",handler:function(a){var b=this,c=q(a.currentTarget).closest(".js-time-item"),d=c.attr("data-id");c.remove(),delete b.dateCpnHome[d],b.fixTrash()}},{name:"click .js-submit",handler:function(){var a=this;return a.formDisabled?a.disableForm(!1):void(a.check()&&a.submit())}},{name:"click .js-remove-interview",handler:function(a){var b=this,c=q(a.currentTarget).closest("tr"),d=c.attr("data-index");b.needSetCount--,b.resultData.splice(d,1),b.toArrangeDeliverId.splice(d,1),b.fixTip(),c.remove()}},{name:"click .js-reset-time",handler:function(a){var b=this;x.confirm("重置后所有预约时间将清空，确认重置？",function(){var c=q(a.currentTarget).attr("data-index");p.forEach(b.resultData,function(a){var b=a.rounds[c];b&&(b.bookTime=null)}),b.renderList()})}},{name:"click .js-batch-offline",handler:function(){var a=this,b=q(['<div><div class="form-group" style="line-height:42px;text-align:center;margin-bottom:0px;">','<label class="control-label" style="width:150px;">选择要设置的面试方式</label>','<label class="radio" style="margin-right:20px;"><input type="radio" value="0">视频面试</label>','<label class="radio"><input type="radio" value="1">线下面试</label>',"</div></div>"].join("")),c=new x({title:"设置面试方式",content:b.html(),width:500,cancelTxt:"取消",ok:function(){var b=+d.val();p.forEach(a.resultData,function(a){a.offline=!!b,p.forEach(a.rounds,function(a){a.offline=b})}),a.renderList()}}),d=y.mix({el:c.getEl("label.radio")});d.val("0")}},{name:"click .js-go-back",handler:function(){var a=this;a.nav("resume",{action:"deliver/index/index",projectId:a.projectId,stage:a.isReferral?"9":"3"})}},{name:"click .js-go-next",handler:function(){function a(){B.atsAddInterviews({type:"POST",body:{projectId:b.projectId,arrangeInterviewProjectId:b.arrangeInterviewProjectId,interviews:JSON.stringify(b.resultData),isReferral:b.isReferral},call:function(a){var c=x.mask("请稍等...");G.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),x.alert(e)):d?(c.close(),F.show({module:b,projectId:b.arrangeInterviewProjectId,close:function(){b.nav("resume",{action:"deliver/index/index",projectId:b.projectId,stage:b.isReferral?"9":"3"})}})):"暂无进度"===e||c.getEl(".pop-content div").html(e)})},error:function(a){x.alert(a.msg)}})}var b=this,c=0;return p.forEach(b.resultData,function(a){p.forEach(a.rounds,function(a){return a.bookTime?void 0:(c++,p.BREAK)})}),c?void x.show({content:c+"名候选人预约时间为空，是否继续创建？",type:"confirm",okTxt:"返回修改",cancelTxt:"继续创建",ok:function(){},cancel:a}):a()}}]},{initContainer:d,initCpns:e,addTimeItem:f,check:g,submit:h,renderList:i,disableForm:j,fixTrash:k,fixTip:l,getCrumbConf:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/batchInterview/popupSucc",["nc","cpn"],function(a,b,c){function d(a){a=a||{};var b=new k(a);return j.wrap(b,{title:"创建面试任务",width:630,content:b.html(),hasNoFooter:!0,close:function(){b.goNotice||b.goList||i.isFunction(a.close)&&a.close()}}),b}var e=a("nc"),f=a("cpn"),g=(e.$,e.Component),h=e.Clazz,i=e.Base,j=f.Popup,k=c.exports=h.create();h.mix(k,g,{_template:["<div>",'<div class="pop-interview">','<div class="ico-success">','<i class="fui-check-inverted"></i>',"</div>","<h2>面试任务已成功创建！</h2>","</div>",'<div class="pop-btn-wrapper">','<a href="javascript:void(0);" class="btn btn-primary js-go-notice">发送通知</a>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-go-list">查看面试任务</a>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.rawConfig}}},{name:"click .js-go-notice",handler:function(){var a=this,b=a.rawConfig;a.goNotice=!0,b.module.nav("interview",{action:"notice/index",projectId:b.projectId})}},{name:"click .js-go-list",handler:function(){var a=this,b=a.rawConfig;a.goList=!0,b.module.nav("interview",{action:"group/index",projectId:b.projectId})}}],show:d},{})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/checkAll/cpn/position",["nc","cpn"],function(a,b,c){function d(){var a=this;a.items=[]}function e(){var a=this;q.forCount(1,function(){a.createItem()})}function f(a){var b=this;a=a||{},b.positionCount=void 0===a.positionCount?b.positionCount:a.positionCount,b.jobCount=void 0===a.jobCount?b.jobCount:a.jobCount,b.limitCount=Math.min(b.positionCount||9999,b.jobCount),b.stageList=a.stageList||b.stageList,b.clear(),b.initCreate(),b.fix()}function g(a){var b=this,c=b.items;if(0===arguments.length){var d={};return q.forEach(c,function(a,b){var c=a.cpn,e=c.stage.val();d[b+1]={stage:e,subStage:c.status.val()}}),d}for(var e=q.size(a);c.length<e;)b.createItem();for(;c.length>e;){var f=c.pop();q.forEach(f.cpm,function(a){a.destroy()}),f.dv.remove()}q.forEach(a,function(a,b){b-=1;var d={stage:"stage",subStage:"status"},e=c[b]&&c[b].cpn;q.forEach(a,function(a,b){"stage"===b&&(a=a||100),e[d[b]].val(a)})}),b.fire("change")}function h(){var a=this,b=a.items;if(!(b.length>=a.limitCount)){var c=[{text:"不限",value:100,checked:!0}];q.forEach(a.stageList,function(a){100!==a.stage&&c.push({text:a.name,value:a.stage})});var d=n(['<div class="filter-item">','<span class="item-space js-name">第',b.length+1,"志愿</span>",'<div class="js-stage"></div>','<div class="js-status"></div>','<a href="javascript:void(0);" class="icon-trash js-delete"></a>',"</div>"].join(""));a.addEl.before(d);var e=new s({renderTo:d.find(".js-status"),renderBy:"replaceWith",size:"small",options:[],listeners:{change:function(){a.fire("change")}}});e.getEl().hide();var f=new r({renderTo:d.find(".js-stage"),renderBy:"replaceWith",size:"small",options:c,listeners:{change:function(){e.getEl().show(),a.fixStatus(this.val(),e),a.fire("change")}}});f.getEl().css("margin-right","10px"),a.items.push({dv:d,cpn:{stage:f,status:e}}),a.fix()}}function i(){var a=this;q.forEach(a.items,function(a){q.forEach(a.cpn,function(a){a.destroy()}),a.dv.remove()}),a.items=[]}function j(){var a=this,b=a.items;q.forEach(b,function(a,b){a.dv.find(".js-name").html("第"+(b+1)+"志愿")});var c=b.length>=a.limitCount;a.addEl[c?"hide":"show"]()}function k(a,b){var c=this,d=q.find(c.stageList,function(b){return q.id(b.stage)===q.id(a)});b.replaceOptions(q.map(d.subStageList,function(a){return{text:a.subName,value:a.subStage,checked:!0}}))}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Component,p=l.Clazz,q=l.Base,r=(l.Str,m.Select),s=m.SelectMult,t=(m.Input,c.exports=p.create());p.mix(t,o,{_template:['<div class="filter-cont">','<div class="filter-item js-add"><a href="javascript:void(0);" class="add-item-icon"><i class="icon-plus-sign"></i> 添加状态</a></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.positionCount=c.positionCount,a.jobCount=c.jobCount,a.limitCount=Math.min(a.positionCount||9999,a.jobCount),a.stageList=c.stageList,a.addEl=b.find(".js-add")}},{name:"click .js-add",handler:function(){var a=this;a.createItem(),a.fire("change")}},{name:"click .js-delete",handler:function(a){var b=this,c=b.items,d=n(a.currentTarget),e=d.closest("div.filter-item"),f=-1;q.find(c,function(a,b){a.dv.get(0)===e.get(0)&&(f=b)});var g=c[f];q.forEach(g.cpn,function(a){a.destroy()}),g.dv.remove(),c.splice(f,1),b.fix(),b.fire("change")}}]},{initialize:d,initCreate:e,update:f,val:g,createItem:h,clear:i,fix:j,fixStatus:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/checkAll/cpn/toolBar",["nc","cpn","../../../../extend/bll/resumeDeliver","../../../../extend/event","../../../../extend/bll/base","../../../../extend/bll/money","../../../../../../action/purchase","../../../../../../util/ajax","../../../../../../action/price","../../../../extend/bll/task","../../../../../../action/api","../../../../../../action/resumeDeliver","../../../../../../action/common","../../../../../../util/switch","../../../../../../util/util","../../../../../../core/siteConfig","../../util"],function(a,b,c){function d(){var a=this,b=a.module,c=b.getParam();a.pageSizeCpn=new q({renderTo:a.getEl(".js-pagesize"),renderBy:"replaceWith",size:"xsmall",options:n.map([20,50,100],function(a,b){return{text:a,value:a,checked:c.pageSize?a===c.pageSize:0===b}}),change:function(){var c=this.val();b.addParam({pageSize:c}),a.fire("pageSize",c)}}),a.unreadCpn=r.transform(a.getEl(".js-unread-ck"),{change:function(){var c=this.isChecked()?1:0;b.addParam({unread:c}),a.fire("unread",c)}}),a.unreadCpn.checked(1===+c.unread),a.orderCpn=r.transform(a.getEl(".js-order-ck"),{change:function(){var c=this.isChecked()?1:0;b.addParam({orderBy:c}),a.fire("orderBy",c)}}),a.orderCpn.checked(1===+c.orderBy)}function e(){function a(a,b){if(a.sub){var c=m(['<li class="manage-sub-oprt">','<i class="resume-ico',a.icon,'"></i>','<span class="manage-oprt-',a.color,'">',a.name,"</span>",'<span class="icon-angle-down"></span><span class="icon-angle-up"></span>',"<ul></ul>","</li>"].join("")),d=c.find("ul");return n.forEach(a.sub,function(a,c){var e=m(['<li data-index="',b,'" data-sub-index="',c,'">',a.name,"</li>"].join(""));e.addClass(void 0===a.cls?"js-action":a.cls),a.attr&&e.attr(a.attr),d.append(e)}),c[0].outerHTML}var c=m(['<li data-index="',b,'">','<i class="resume-ico',a.icon,'"></i>','<span class="manage-oprt-',a.color,'">',a.name,"</span>","</li>"].join(""));return c.addClass(void 0===a.cls?"js-action":a.cls),a.attr&&c.attr(a.attr),c[0].outerHTML}var b=this,c=b.actionConf=[u.has(120)?{name:"查看简历",icon:9,color:"green",method:"readResume"}:null,u.has(121)?{name:"下载",icon:8,color:"green",sub:[{name:"简历PDF",method:"downloadPDF"},{name:"简历Excel",method:"downloadExcel"}]}:null],d="";n.forEach(c,function(b,c){b&&(d+=a(b,c))}),b.getEl(".js-batch-ul").html(d)}function f(a){var b=this;b.getEl(".js-count").html(a)}function g(a){var b=this,c=b.rawConfig,d=c.getBatchCond();v.removeDb(v.DB_FILTER),v.setDb(v.DB_COND,d);var e=c.module.getNavUrl("resume",{action:"deliver/preview/index",id:1===a?d.ids[0]:null,stage:b.stage,referralStage:b.getReferralStage()});window.open(e)}function h(){var a=this,b=a.rawConfig;t.download(b.getBatchCond(),{taskTitle:b.getDownloadName("pdf")})}function i(){var a=this,b=a.rawConfig;t.downloadExcel(b.getBatchCond())}function j(){var a=this,b=[];return n.forEach(a.rawConfig.getSummaryData().stageList,function(a){var c=a.stage;(7===c||8===c||9===c)&&b.push(c)}),b}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Base,o=k.Clazz,p=k.Component,q=l.Select,r=l.CheckBox,s=l.Popup,t=a("../../../../extend/bll/resumeDeliver"),u=a("../../../../../../util/switch"),v=a("../../util"),w=c.exports=o.create();o.mix(w,p,{_template:['<div class="manage-hd clearfix">','<ul class="manage-hd-oprt js-batch-ul" style="padding:10px 10px 0px 0px;line-height:30px;"></ul>','<div class="result-info">','<span class="result-num">共<span class="font-green js-count"></span>份</span>','<span>每页显示 <div class="js-pagesize"></div></span>','<label class="checkbox label-sm js-unread-ck" style="width:auto; margin-left:10px">','<span class="icons"></span>隐藏已查看的',"</label>",'<label class="checkbox label-sm js-order-ck" style="width:auto; margin-left:10px">','<span class="icons"></span>智能排序',"</label>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.initCpns(),a.fixAction()}},{name:"click .js-action",handler:function(a){var b=this,c=b.rawConfig.getSelectCount();if(1>c)return s.alert("请先选择投递简历");var d=m(a.currentTarget),e=d.attr("data-index"),f=d.attr("data-sub-index"),g=b.actionConf[e]||{};if(g.sub){var h=g;g=h.sub[f]||{}}n.isFunction(b[g.method])&&b[g.method](c,g,h)}}]},{initCpns:d,fixAction:e,fixCount:f,readResume:g,downloadPDF:h,downloadExcel:i,getReferralStage:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/checkAll/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../cpn/searchTarget","../cpn/popupSearchTarget","../../../../../action/resumeDeliver","./cpn/position","../../util/util"],function(a,b,c){function d(a,b){var c=this;c.summaryData=a?a:c.summaryData;var b=c.project=b?b:c.project;c.projectId=c.project.id,c.jobLimitCount=Math.min(b.deliverJobLimit||9999,b.jobCount),c.fixDepartment(),c.fixJob(),c.fixTag(),c.fixPosition(),c.fixJobLimitCount(),c.fixStatus(),c.fixNcsr()}function e(){var a=this,b={},c=a.rawConfig.module.getParam(),d=[{text:"不限",value:100,checked:t.id(c.stage)?100===c.stage:!0}];t.forEach(a.summaryData.stageList,function(a){100!==a.stage&&d.push({text:a.name,value:a.stage,checked:t.id(c.stage)===t.id(a.stage)})}),b.volunteer={id:"volunteer",title:"投递志愿",type:"select",conf:{options:[]}},b.resumeStage={id:"stage",title:"阶段",type:"select",conf:{options:d,change:function(){a.fixStatus(this.val())}}},b.status={id:"status",title:"状态",type:"selectMult",conf:{options:[]}},b.department={id:"department",title:"部门",type:"selectMult",conf:{needSearch:!0,options:[],change:function(){a.fixJob()}}},b.job={id:"job",title:"职位",type:"selectMult",conf:{needSearch:!0,options:[]}},b.sendDate={id:"sendDate",title:"投递日期",type:"duration",ext:{today:!0}},b.school={id:"school",title:"学校",type:"school"},b.edu={id:"edu",title:"学历",type:"selectMult",conf:{cls:"filter-item-txt none",options:[{text:"博士",value:"博士"},{text:"硕士",value:"硕士"},{text:"本科",value:"本科"},{text:"专科",value:"专科"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="ico-level"></i>')}}}},b.major={id:"major",title:"专业",type:"input",conf:{placeholder:"多个用空格分隔",listeners:{render:function(){this.getEl().css("marginRight",10).append('<i class="icon-wrench"></i>')}}},ext:{chkTitle:"包含任一专业"}},b.gender={id:"gender",title:"性别",type:"select",conf:{options:[{text:"不限",value:"不限",checked:!0},{text:"男",value:"男"},{text:"女",value:"女"}]}},b.location={id:"location",title:"所在地",type:"selectMult",conf:{cls:"filter-item-txt none",needSearch:!0,options:[{text:"北京",value:"北京"},{text:"上海",value:"上海"},{text:"广州",value:"广州"},{text:"深圳",value:"深圳"},{text:"杭州",value:"杭州"},{text:"南京",value:"南京"},{text:"西安",value:"西安"},{text:"武汉",value:"武汉"},{text:"哈尔滨",value:"哈尔滨"},{text:"长春",value:"长春"},{text:"成都",value:"成都"},{text:"长沙",value:"长沙"},{text:"合肥",value:"合肥"},{text:"其他",value:"其他"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="icon-map-marker"></i>')}}}};var e=(new Date).getFullYear();return b.graduate={id:"graduate",title:"毕业年份",type:"selectMult",conf:{options:t.map(t.range(e-3,e+5,1).reverse(),function(a){return{text:a+"年",value:t.id(a)}})}},b.tag={id:"tag",title:"标签",type:"selectMult",conf:{needSearch:!0,options:[]}},b.referral={id:"referral",title:"内推",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"是",value:"1"},{text:"否",value:"2"}]}},b.ncsr={id:"ncsr",title:"投递来源",type:"selectMult",conf:{needSearch:!0,options:[]}},b.position={id:"position",condTitle:"志愿状态",type:"diy",create:function(b,c,d){b.removeClass().prepend('<label class="filter-label-left">志愿状态</label>');var e=a.project,f=new x({renderTo:b,stageList:a.summaryData.stageList,jobCount:e.jobCount,positionCount:e.deliverJobLimit});d.cpn=f}},b.search={id:"search",title:"关键词",type:"search",conf:{placeholder:"姓名/手机/邮箱/ACM/实习信息等，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的简历，多个关键词用空格分割"}},b.searchTarget={id:"searchTarget",condTitle:"搜索指定名单",type:"diy",create:function(b,d,e){var f=new w({renderTo:b,renderBy:"html",projectId:a.projectId,stage:c.stage||100,module:a.rawConfig.module,search:function(){a.submit()}});e.cpn=f},condVal:function(a){return t.isFunction(a.getSearchIdLength)&&a.getSearchIdLength()},clear:function(a){t.isFunction(a.clearData)&&a.clearData()}},b}function f(){var a=this;a.filter.getItem("department").replaceOptions(t.map(a.summaryData.departmentList,function(a){return{text:a.departmentName||"默认部门",value:a.departmentName||"默认部门"}}))}function g(){var a=this,b=a.filter,c=[],d=b.getItem("department").val()||[];t.forEach(a.summaryData.departmentList,function(a){(0===d.length||t.contains(d,a.departmentName||"默认部门"))&&t.forEach(a.jobList,function(a){c.push({text:a.name,value:t.id(a.id),checked:!0,position:a.position})})}),c.sort(function(a,b){return a.position-b.position}),t.forEach(c,function(a){delete a.position}),b.getItem("job").replaceOptions(c)}function h(){var a=this;a.filter.getItem("tag").replaceOptions(t.map(a.summaryData.tagList,function(a){return{text:a,value:a}}))}function i(){var a=this,b=a.project;a.filter.getItem("position").update({stageList:a.summaryData.stageList,jobCount:b.jobCount,positionCount:b.deliverJobLimit})}function j(){var a=this,b=a.filter,c=a.jobLimitCount>1;b.getItemEl("stage")[c?"hide":"show"](),b.getItemEl("status")[c?"hide":"show"](),b.getItemEl("position")[c?"show":"hide"](),b.getItemConf("stage").condHide=c,b.getItemConf("status").condHide=c,b.getItemConf("position").condHide=!c,b.getItemEl("volunteer")[c?"show":"hide"](),b.getItemConf("volunteer").condHide=!c;var d=a.volunteerOption=[{text:"不限",value:0,checked:!0}];t.forCount(a.jobLimitCount,function(a){a+=1,d.push({text:"第"+a+"志愿",value:a})}),b.getItem("volunteer").replaceOptions(d),b.updateCond()}function k(a){var b=this,c=b.filter;a=a||c.getItem("stage").val();var d=100!==a;if(c.getItemEl("status")[d?"show":"hide"](),c.getItemConf("status").condHide=!d,c.updateCond(),d){var e=t.find(b.summaryData.stageList,function(b){return+b.stage===+a}),f=t.map(e.subStageList,function(a){return{text:a.subName,value:a.subStage,checked:!0}});b.filter.getItem("status").replaceOptions(f)}}function l(){var a=this;a.filter.getItem("ncsr").replaceOptions(t.map(a.summaryData.ncsrs,function(a){return{text:a,value:a}}))}function m(a){var b=this,c=(b.rawConfig,b.filter);if(c){var d=b.jobLimitCount<=1,e=c.getItem("volunteer"),f=c.getItem("stage"),g=c.getItem("department"),h=c.getItem("job"),i=c.getItem("sendDate"),j=c.getItem("edu"),k=c.getItem("school"),l=c.getItem("major"),m=c.getItem("gender"),n=c.getItem("location"),o=c.getItem("graduate"),p=c.getItem("tag"),q=c.getItem("referral"),r=c.getItem("search"),s=c.getItem("searchTarget"),v=c.getItem("position"),w=c.getItem("status"),x=c.getItem("ncsr");if(0===arguments.length){var z=v.val(),A=e.val(),B=!c.getItemConf("status").condHide,a={graduationYearList:y.wrapVal(o.val()),liveAddressList:y.wrapVal(n.val()),schoolList:y.wrapVal(k.getSchool()),eduLevelList:y.wrapVal(j.val()),majorList:y.wrapVal(y.split(l.ipt.val())),gender:{"男":"男","女":"女"}[m.val()]||void 0,tagList:y.wrapVal(p.val()),keywordList:y.wrapVal(y.split(r.ipt.val())),jobIds:y.wrapVal(h.val()),positionStageCondition:!d&&t.size(z)?JSON.stringify(z):void 0,ncSrs:y.wrapVal(x.val()),projectId:y.wrapVal(b.projectId),deliverBegin:i.startIpt.val()?i.startIpt.val()+" 00:00:00":void 0,deliverEnd:i.endIpt.val()?i.endIpt.val()+" 23:59:59":void 0,union:y.wrapNum(r.chk.isChecked()?1:0),majorUnion:y.wrapNum(l.chk.isChecked()?1:0),departmentList:y.wrapVal(g.val()),stage:d?y.wrapNum(f.val()):100,status:B?w.val():void 0,referral:y.wrapNum(q.val()),searchIds:s.val().searchId,searchIdType:s.val().searchType-1,positionSet:0===A?void 0:[A]};return t.forEach(a,function(b,c){void 0===b&&delete a[c]}),a}a=t.isObject(a)?a:{},g.val(a.departmentList),h.val(a.jobIds),i.todayChk.checked(!1),i.todayChk.fire("change"),i.startIpt.val(a.deliverBegin?u.form(new Date(a.deliverBegin),"yyyy-MM-dd"):""),i.endIpt.val(a.deliverEnd?u.form(new Date(a.deliverEnd),"yyyy-MM-dd"):"");var C=(a.schoolList||[]).join(",");k.val(C).getEl().attr("title",C),j.val(a.eduLevelList),l.ipt.val((a.majorList||[]).join(" ")),l.chk.checked("1"===t.id(a.majorUnion)),m.val(a.gender||"不限"),n.val(a.liveAddressList),o.val(a.graduationYearList),p.val(a.tagList||[]),q.val(a.referral||"0"),r.ipt.val((a.keywordList||[]).join(" ")),r.chk.checked("1"===t.id(a.union)),d&&f.val(t.id(a.stage)?+a.stage:100,!0),d||v.val(t.json(a.positionStageCondition)),s.val({searchId:a.searchIds||"",searchType:(a.searchIdType||0)+1}),e.val((a.positionSet||[])[0]||0),w.val(a.status||[]),x.val(a.ncSrs||[])}}function n(){var a=this,b=a.val(),c=!0,d={sendDate:{begin:"deliverBegin",end:"deliverEnd",tip:"结束日期不能早于开始日期"}};return t.forEach(d,function(d,e){var f=a.filter.getItem(e);b[d.begin]&&b[d.end]&&f&&+b[d.begin]>+b[d.end]&&(f.startIpt.setErrorTips(d.tip),f.startIpt.getEl(".input-tip").width(200),c=!1)}),c}function o(){var a=this,b=a.rawConfig;b.ok&&a.check()&&b.ok(a.val())}var p=a("nc"),q=a("cpn"),r=(p.$,p.Component),s=p.Clazz,t=p.Base,u=p.Time,v=(q.Popup,a("../../../../../component/filter/filter")),w=a("../cpn/searchTarget"),x=a("./cpn/position"),y=a("../../util/util"),z=c.exports=s.create();s.mix(z,r,{_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.summaryData=b.summary||{},a.project=b.project||{},a.projectId=a.project.id;var c=a.getFilterConfs();a.filter=new v({renderTo:a.getEl(),submitTxt:"查询",line:[{items:[c.volunteer]},{items:[c.resumeStage,c.status,c.department,c.job,c.sendDate]},{border:!0,items:[c.position]},{items:[c.school,c.edu,c.major]},{items:[c.gender,c.location,c.graduate]},{items:[c.tag,c.referral,c.ncsr]},{items:[c.search,c.searchTarget]}],clearAll:function(){a.val({})},listeners:{submit:t.bind(a.submit,a)}}),a.val({}),a.refresh()}}]},{refresh:d,getFilterConfs:e,fixDepartment:f,fixJob:g,fixTag:h,fixPosition:i,fixJobLimitCount:j,fixStatus:k,fixNcsr:l,val:m,check:n,submit:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/checkAll/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../cpn/searchTarget","../cpn/popupSearchTarget","../../../../../action/resumeDeliver","./cpn/position","../../util/util","./list","../../../../../component/selectAll","../../../../../component/table","./cpn/toolBar","../../../extend/bll/resumeDeliver","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../util/switch","../util","../../../../../action/position","../../../extend/bll/resume","../../../../../action/resume"],function(a,b,c){function d(a){function b(a){var b=c.projectMap=c.projectMap||{};b[a.id]=a}var c=this,d=c.getParam();c.projectData=a,c.getEl().html(['<div class="project-types clearfix">','<div class="project-count">','<a href="javascript:void(0);" class="resume-count js-go-analyze">简历统计</a>',"</div>",'<div class="project-types-pic">','<img src="//uploadfiles.nowcoder.com/images/20170215/56_1487137391502_7060599B1E63FB274C2BA6B32CBD2AD6" />',"</div>",'<div class="project-types-main js-project-home"></div>',"</div>",'<div class="manage-mod">','<div class="manage-title clearfix">','<h2 style="margin-right:20px;">查看全部投递<a href="javascript:void(0);" class="font-green js-go-back" style="margin-left:20px;font-weight:normal;">返回应聘管理首页</a></h2>',"</div>","</div>",'<div class="js-main"></div>'].join("")),c.projectSelect=new m({renderTo:c.getEl(".js-project-home"),renderBy:"html",autoWidth:!0,needSearch:!0,options:k.map(a,function(a,c){return b(a),{text:a.name,value:k.id(a.id),checked:d.projectId&&"0"!==d.projectId?d.projectId===k.id(a.id):0===c}}),change:function(){var a=c.projectId,b=this.val();c.projectId=b,c.addParam({projectId:b}),c.getSummary(function(a){c.summaryData=a,c.filter.refresh(a,c.projectMap[b]),c.list.refresh(c.projectMap[b],c.filter.val(),c.summaryData)},function(b){t.alert(b),c.projectSelect.val(a)})}}),c.projectId=c.projectSelect.val(),c.addParam({projectId:c.projectId})}function e(){var a=this,b=a.summaryData;a.filter=new o({renderTo:a.getEl(".js-filter-home"),summary:b,project:a.projectMap[a.projectId],module:a,ok:function(){a.list.refresh(a.projectId,a.filter.val(),a.summaryData)}}),a.list=new p({renderTo:a.getEl(".js-list-home"),module:a,project:a.projectMap[a.projectId],summary:b,filter:a.filter.val()})}function f(a,b){r.listRecruitProject({query:{version:1},call:function(b){var c=b.data||[];a&&a(s.filterStatus(c,0))},error:function(a){b&&b(a.msg)}})}function g(a,b){var c=this;q.getSummary({params:{userId:c.getUserId()},query:{projectId:c.projectId},call:function(b){var c=k.isObject(b.data)?b.data:{};k.isFunction(a)&&a(c)},error:function(a){k.isFunction(b)&&b(a.msg)}})}function h(){var a=this;return{crumb:[{title:"应聘管理",module:"resume",action:"deliver/index/index",projectId:a.projectId}]}}var i=a("nc"),j=a("cpn"),k=i.Base,l=(i.$,i.Clazz),m=j.Select,n=a("../../../../../core/module"),o=a("./filter"),p=a("./list"),q=a("../../../../../action/resumeDeliver"),r=a("../../../../../action/position"),s=(a("../../../../../util/util"),a("../../util/util"),a("../../../extend/bll/resume")),t=j.Popup,u=c.exports=l.create();l.mix(u,n,{style:"/stylesheets/styles/system/resumeManage.css",title:"查看全部投递",showTask:!0,_template:["<div></div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getParam()}a.renderWait(a.getEl(),"加载中..."),a.getProject(function(b){return 0===b.length?void a.renderNone(a.getEl(),"您尚未创建招聘项目！"):(a.initProjectBar(b),a.renderWait(a.getEl(".js-main"),"加载中..."),void a.getSummary(function(b){a.summaryData=b,a.getEl(".js-main").html('<div class="js-filter-home"></div><div class="js-list-home"></div>'),a.initCpn()}))},function(b){a.renderNone(a.getEl(),b)}),a.sizeScroll()}},{name:"click .js-go-analyze",handler:function(){var a=this;a.nav("resume",{action:"analyze/index",projectId:a.projectId})}},{name:"click .js-go-back",handler:function(){var a=this;a.nav("resume",{action:"deliver/index/index",projectId:a.projectId})}}]},{initProjectBar:d,initCpn:e,getProject:f,getSummary:g,getCrumbConf:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/checkAll/list",["nc","cpn","../../../../../component/selectAll","../../../../../component/table","../../../../../util/util","../../../../../core/siteConfig","./cpn/toolBar","../../../extend/bll/resumeDeliver","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/resumeDeliver","../../../../../action/common","../../../../../util/switch","../util"],function(a,b,c){function d(){{var a=this,b=a.getEl();a.rawConfig.module.getParam()}a.tableCpn=new v({renderTo:b.find(".js-table"),needSelect:!0,needFixHeader:!0,pageChange:function(b){a.page=b,a.search()}}),a.toolBar=new w({renderTo:a.getEl(".js-tool-bar"),renderBy:"replaceWith",module:a.rawConfig.module,getBatchCond:function(){return a.getBatchCond()},getSelectCount:function(){return a.getSelectCount()},getDownloadName:function(b){var c=a.getBatchCond();if(2===c.isAll&&1===c.ids.length){var d=c.ids[0]+"",e=q.find(a.data.data,function(a){return a.id+""===d});return((e||{}).candidateName||"简历")+"."+b}return"简历("+a.getSelectCount()+"份).zip"},getSummaryData:function(){return a.summaryData},listeners:{pageSize:function(b){a.pageSize=b,a.page=1,a.search()},unread:function(b){a.unread=b,a.page=1,a.search()},orderBy:function(b){a.orderBy=b,a.page=1,a.search()}}}),a.pageSize=a.toolBar.pageSizeCpn.val(),a.unread=a.toolBar.unreadCpn.isChecked()?1:0,a.orderBy=a.toolBar.orderCpn.isChecked()?1:0}function e(a,b,c){var d=this;d.project=a,d.projectId=a.id,d.filter=b,d.summaryData=c,d.jobLimitCount=Math.min(a.deliverJobLimit||9999,a.jobCount),d.page=1,d.search()}function f(){var a=this;x.search({params:{userId:a.rawConfig.module.getUserId()},body:a.getCond(),call:function(b){if(b.isOrder){var c=a.data=b.data||{};a.toolBar.fixCount(c.totalCount||0),a.renderList(c)}},error:function(b){a.toolBar.fixCount(0),b.isOrder&&a.tableCpn.renderNone(b.msg)}})}function g(a){var b=this,c=b.rawConfig.module;if(b.tableCpn.selectAll.clear(),0===(a.data||[]).length)return b.tableCpn.renderNone();var d=z.has(120),e=b.jobLimitCount<=1,f={head:[{text:"投递编号",width:"15%"},{text:"网申职位",width:"8%"},{text:"其他网申职位",width:"8%"},{text:"姓名"},{text:"性别"},{text:"学校"},{text:"专业"},{text:"最高学历",width:"8%"},{text:"所在地"},{text:"阶段"},{text:"状态"}],list:[]};d&&f.head.push({text:"简历查看",style:{"text-align":"center"}}),e&&f.head.splice(2,1),q.forEach(a.data,function(a,g){var h=((a.writeRecordList||[])[0]||{},(a.rounds||[])[a.latestInterviewRound-1]||{},c.getNavUrl("resume",{action:"deliver/preview/index",id:a.id,referralStage:b.getReferralStage()})),i=a.jobNameList||[],j=a.position,k=[("0"===q.id(a.unread)?"":'<i class="icon-spot-red"></i>')+q.id(a.id),i.length>0?'<a href="javascript:void(0);" class="link-green js-job-detail">'+(e?"":'<span class="resume-rank rank'+j+'">'+j+"</span> ")+i[0]+"</a>":"无",i.length>1?'<a href="javascript:void(0);" class="link-green js-job-detail">'+i.slice(1).join(" | ")+"</a>":"无",a.candidateName,a.candidateGender,a.candidateSchool,a.candidateMajor,a.candidateEduLevel,a.candidateLiveAddress,a.stageName,a.subStageName];e&&k.splice(2,1),d&&k.push('<a href="'+h+'" target="_blank" class="js-preview btn btn-auto btn-primary btn-xs">查看</a>'),f.list.push({attr:{"class":"js-tr-"+a.id,"data-id":a.id,"data-index":g},items:k})}),b.tableCpn.updateHtml(f,{totalPage:a.totalPage,currentPage:a.currentPage,totalCount:a.totalCount})}function h(){var a=this;return q.extend({},a.filter,{currentPage:a.page,pageSize:a.pageSize,unread:a.unread,orderBy:a.orderBy})}function i(){var a=this,b=a.tableCpn.selectAll;return q.extend({},a.filter,{isAll:b.isSelectAll?1:2,ids:b.selectIds,unread:a.unread,orderBy:a.orderBy})}function j(a){var b=p(a).closest("tr");return p.trim(b.attr("data-id"))}function k(a){var b=p(a).closest("tr");return p.trim(b.attr("data-index"))}function l(){var a=this,b=[];return q.forEach(a.summaryData.stageList,function(a){var c=a.stage;(7===c||8===c||9===c)&&b.push(c)}),b}function m(){var a=this,b=a.tableCpn.selectAll;return b.isSelectAll?b.totalCount-b.selectIds.length:b.selectIds.length}var n=a("nc"),o=a("cpn"),p=n.$,q=n.Base,r=n.Component,s=n.Clazz,t=n.Time,u=(o.Select,o.Popup),v=(o.Pager,a("../../../../../component/selectAll"),a("../../../../../component/table")),w=a("./cpn/toolBar"),x=a("../../../../../action/resumeDeliver"),y=a("../util"),z=a("../../../../../util/switch"),A=c.exports=s.create();s.mix(A,r,{_template:['<div class="manage-box" style="padding-bottom:20px;">','<div class="js-main">','<div class="js-tool-bar"></div>','<div class="manage-bd">','<div class="js-select-tips"></div>','<div class="js-table"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.refresh(b.project,b.filter,b.summary),a.initCpns(),a.search()}},{name:"click .js-preview",handler:function(a){var b=this,c=p(a.currentTarget);b.getLineId(c)&&(y.removeDb(y.DB_FILTER),y.removeDb(y.DB_COND),c.closest("tr").find(".icon-spot-red").hide())}},{name:"click .js-job-detail",handler:function(a){var b=this,c=b.getLineIndex(p(a.target)),d=b.data.data[c],e={head:[{text:"投递编号"},{text:"投递时间"},{text:"网申职位"},{text:"投递来源"},{text:"阶段"},{text:"状态"}],list:[]},f=e.head;q.forEach(d.jobDeliverList,function(a){var c=a.position,d=[a.deliverId,t.form(new Date(a.createTime)),(b.jobLimitCount<=1?"":'<span class="resume-rank rank'+c+'">'+c+"</span> ")+a.jobName,a.ncsr,a.stageName,a.subStageName];q.forEach(a.ext,function(a){var b=q.findIndex(f,function(b){return b.text===a.name});if(-1===b){var c=f.push({text:a.name,style:{"text-align":"center"}});d[c-1]=a.value.join("|")}else d[b]=a.value.join("|")}),e.list.push({items:d})});var g=f.length;q.forEach(e.list,function(a){var b=a.items;q.forCount(g,function(a){b[a]=void 0===b[a]?"--":b[a]})}),new u({title:"申请职位",content:'<div style="width:100%;overflow-x:auto;">'+v.getHtml(e)+"</div>",width:1e3,okTxt:"确定"})}}]},{initCpns:d,refresh:e,search:f,renderList:g,getCond:h,getBatchCond:i,getLineId:j,getLineIndex:k,getReferralStage:l,getSelectCount:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupBatchAddTag",["nc","cpn","../../../../../action/resume","../../../../../util/ajax","../../../../../action/resumeDeliver","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){a=a||{};{var b=new B(a);w.wrap(b,{title:"添加标签",content:b.html(),width:600,ok:function(){return b.submit(),!0},cancel:function(){}})}return b}function e(){}function f(){var a=this,b=a.rawConfig;a.setData("entity-type",b.entityType),a.setData("search-param",b.searchParam),a.setData("cpn-val-input",[]),a.reqTags(function(b){a.setData("data-tag",b),a.initCpns(),a.popup.fixPosition()})}function g(){var a=this;a.initHtml(),a.initInput(),a.initTags()}function h(){var a=this,b=['<div class="tag-edit-input">',"<span>输入标签：</span>",'<div class="js-input" style="display:inline-block;"></div>',"</div>",'<div class="pop-collect-tag js-collect-tag" style="margin-bottom:20px;">','<span class="pop-collect-label">我的标签：</span>','<div class="tags-box js-tags-home"></div>',"</div>"].join("");a.getEl().html(b)}function i(){var a=this,b=["input"];t.forEach(b,function(b){var c=new x({renderTo:a.getEl(".js-"+b),renderBy:"html",placeholder:"多个标签用空格隔开",listeners:{change:function(){var c=s.trim(this.val());if(!c)return a.setData("cpn-val-"+b,[]),void a.refreshTags();var d=c.split(/\s+/);a.setData("cpn-val-"+b,d),a.refreshTags()}}});a.setData("cpn-"+b,c)})}function j(){var a=this,b=a.getData("data-tag"),c="";t.forEach(b,function(a,b){c+=['<a class="tag-label js-tag-',b,'" href="javascript:void(0);" data-tag="',a,'">',a,"</a>"].join("")}),a.getEl(".js-tags-home").html(c)}function k(){var a=this,b=a.getData("cpn-val-input"),c=a.getData("data-tag"),d=a.getEl(".js-tags-home");t.forEach(c,function(a,c){var e=-1===t.indexOf(b,a);d.find(".js-tag-"+c)[e?"removeClass":"addClass"]("selected")})}function l(a){var b=this,c=b.getData("cpn-val-input"),d=b.getData("cpn-input"),e=-1===t.indexOf(c,a);e&&(c.push(a),d.val(c.join(" ")),b.refreshTags())}function m(a){var b=this;y.getHrTags({query:{entityType:b.getData("entity-type")},call:function(b){a&&a(b.data||[])},error:function(a){b.getEl().html(a.msg)}})}function n(){var a=this,b=a.getData("search-param"),c=t.extend(b,{operation:"add",updateTags:a.getData("cpn-val-input")});z.batchUpdateTags({type:"PUT",body:c,call:function(b){var c=w.mask("请稍等...");A.getTaskProgress(!0,b.data,function(b){var d=b.end,e=b.content,f=b.error;return"暂无进度"!==e?f?(c.close(),void w.alert(e)):!d&&e?void c.getEl(".pop-content div").html(e):d?(c.close(),a.popup.close(),void w.tips("操作成功！")):void 0:void 0})},error:function(a){w.alert(a.msg)}})}function o(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function p(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var q=a("nc"),r=a("cpn"),s=q.$,t=q.Base,u=q.Clazz,v=q.Component,w=r.Popup,x=r.Input,y=a("../../../../../action/resume"),z=a("../../../../../action/resumeDeliver"),A=a("../../../extend/bll/task"),B=c.exports=u.create();u.mix(B,v,{_template:'<div><div style="font-size:14px;">数据加载中...</div></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}},{name:"click .tag-label",handler:function(a){var b=this,c=s(a.currentTarget),d=c.attr("data-tag");b.inputTag(d)}}],show:d},{initialize:e,initData:f,initCpns:g,initHtml:h,initInput:i,initTags:j,refreshTags:k,inputTag:l,reqTags:m,submit:n,setData:o,getData:p})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupBatchDeleteTag",["nc","cpn","../../../../../action/resume","../../../../../util/ajax","../../../../../action/resumeDeliver","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new z(a);return v.wrap(b,{title:"撤销标签",content:b.html(),width:600,ok:function(){return b.submit(),!0},cancel:function(){}}),b}function e(){}function f(){var a=this,b=a.rawConfig;a.setData("entity-type",b.entityType),a.setData("search-param",b.searchParam),a.setData("choice",[]),a.reqTags(function(b){a.setData("data-tag",b),a.initCpns(),a.popup.fixPosition()})}function g(){var a=this;a.initHtml(),a.initTags()}function h(){var a=this,b=['<div class="tag-edit-input">',"<span>请选择该批简历要撤销的标签</span>","</div>",'<div class="pop-collect-tag js-collect-tag" style="margin-bottom:20px;">','<div class="tags-box js-tags-home"></div>',"</div>",'<div class="tag-edit-input">','<span>选择撤销：</span><span class="js-choice"></span>',"</div>"].join("");a.getEl().html(b)}function i(){var a=this,b=a.getData("data-tag"),c="";s.forEach(b,function(a,b){c+=['<a class="tag-label selected js-tag-',b,'" href="javascript:void(0);" data-tag="',a,'">',a,"</a>"].join("")}),a.getEl(".js-tags-home").html(c)}function j(){var a=this,b=a.getData("choice");a.getEl(".js-choice").html(b.join(" "))}function k(a,b){var c=this,d=c.getData("choice");if(b)return d.push(a),void c.refreshTags();var e=s.indexOf(d,a);d.splice(e,1),c.refreshTags()}function l(a){var b=this;w.getHrTags({query:{entityType:b.getData("entity-type")},call:function(b){a&&a(b.data||[])},error:function(a){b.getEl().html(a.msg)}})}function m(){var a=this,b=a.getData("search-param"),c=s.extend(b,{operation:"delete",updateTags:a.getData("choice")});x.batchUpdateTags({type:"PUT",body:c,call:function(b){var c=v.mask("请稍等...");y.getTaskProgress(!0,b.data,function(b){var d=b.end,e=b.content,f=b.error;return"暂无进度"!==e?f?(c.close(),void v.alert(e)):!d&&e?void c.getEl(".pop-content div").html(e):d?(c.close(),a.popup.close(),void v.tips("操作成功！")):void 0:void 0})},error:function(a){v.alert(a.msg)}})}function n(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function o(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Base,t=p.Clazz,u=p.Component,v=q.Popup,w=(q.Input,a("../../../../../action/resume")),x=a("../../../../../action/resumeDeliver"),y=a("../../../extend/bll/task"),z=c.exports=t.create();t.mix(z,u,{_template:'<div><div style="font-size:14px;">数据加载中...</div></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}},{name:"click .tag-label",handler:function(a){var b=this,c=r(a.currentTarget),d=c.attr("data-tag"),e=c.hasClass("selected");b.updateTags(d,e),c[e?"removeClass":"addClass"]("selected")}}],show:d},{initialize:e,initData:f,initCpns:g,initHtml:h,initTags:i,refreshTags:j,updateTags:k,reqTags:l,submit:m,setData:n,getData:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupBatchTransfer",["nc","cpn"],function(a,b,c){function d(a){a=a||{};var b=new p(a);return o.wrap(b,{title:"转移到",content:b.html(),width:600,cancelTxt:"取消",ok:function(){return b.value?void(a.call&&a.call(b.value)):o.alert("请选择想要转移到的阶段")}}),b.popup.fixPosition(),b}function e(){function a(a){return m.execTpl(['<li v-for="(item, index) in items" :class="cls(item)" :data-index="index">','<span v-if="item.referral" class="pop-tag-push">内推</span>','<i :class="icon(item)"></i>#{item.text}','<div v-if="item.sub" class="tooltip bottom tooltip-info js-tooltip-home" style="max-width:none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner js-tooltip-main"><ul>','<li v-for="(subItem, subIndex) in item.sub" :class="subCls(subItem)" :data-index="subIndex">#{subItem.text}</li>',"</ul></div>","</div>","</li>"],{items:a,cls:function(a){return"js-option js-option-"+a.stage},icon:function(a){return"pop-interview-step"+a.icon},subCls:function(a){return"js-sub-option js-sub-option-"+a.subStage}})}var b=this,c={7:{text:'简历初选 -- <span class="js-sub-name"></span>',stage:7,referral:!0,icon:1,sub:[{text:"待处理",subStage:0},{text:"待定",subStage:1},{text:"不合适",subStage:2}]},8:{text:"笔试",stage:8,referral:!0,icon:3},9:{text:"面试",stage:9,referral:!0,icon:2}},d=b.optionConf=(k.map(b.rawConfig.referralStage||[],function(a){return c[a]})||[]).concat([{text:'简历初选 -- <span class="js-sub-name"></span>',stage:0,icon:1,sub:[{text:"待处理",subStage:0},{text:"待定",subStage:1},{text:"不合适",subStage:2}]},{text:"笔试",stage:2,icon:3},{text:"面试",stage:3,icon:2},{text:"待发offer",stage:6,icon:4}]);b.getEl(".js-option-home").html(a(d))}function f(){var a=this,b=a.rawConfig.value||{},c=k.id(b.stage),d=k.id(b.subStage);return"0"!==c&&"7"!==c||!d?c&&"0"!==c&&"7"!==c?a.getEl(".js-option-"+b.stage).addClass("disabled"):void 0:a.getEl(".js-option-"+b.stage+" .js-sub-option-"+b.subStage).addClass("disabled")}function g(a,b,c){var d=this,e=c?c:d.getEl();k.forEach(e.find(a),function(a){j(a).removeClass("selected")}),k.id(b)&&e.find([a,b].join("-")).addClass("selected")}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Base,l=h.Clazz,m=h.Node,n=h.Component,o=i.Popup,p=c.exports=l.create();l.mix(p,n,{_template:['<div class="pop-interview-set">','<div class="pop-interview-remove js-stage-home">','<ul class="pop-interview-steps js-option-home"></ul>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initOption(),a.initDisabled()}},{name:"click .js-option",handler:function(a){var b=this,c=j(a.currentTarget);if(!c.hasClass("disabled")){var d=c.attr("data-index"),e=b.optionConf[d]||{};if(!e.sub)return b.selectOption(".js-option",e.stage),void(b.value={toStage:e.stage});var f=k.filter(c.find(".js-sub-option"),function(a){return j(a).hasClass("selected")})[0];if(f){f=j(f),b.selectOption(".js-option",e.stage);var g=f.attr("data-index"),h=e.sub[g]||{};b.value={toStage:e.stage,toSubStage:h.stage}}}}},{name:"click.stop .js-sub-option",handler:function(a){var b=this,c=j(a.currentTarget);if(!c.hasClass("disabled")){var d=c.closest(".js-option"),e=d.attr("data-index"),f=b.optionConf[e]||{},g=c.attr("data-index"),h=f.sub[g]||{};b.selectOption(".js-sub-option",h.subStage,d),b.selectOption(".js-option",f.stage),d.find(".js-sub-name").html(c.html()),b.value={toStage:f.stage,toSubStage:h.subStage}}}}],show:d},{initOption:e,initDisabled:f,selectOption:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupConnectPaper",["nc","cpn","../../../../../action/resumeDeliver","../../../../../util/ajax","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new D(a),c={2:"关联笔试试卷",3:"关联面试项目",8:"关联笔试试卷",9:"关联面试项目"};return b.popup=y.wrap(b,{content:b.html(),title:c[a.type],width:650,okTxt:"确定",noUnique:!0,cancelTxt:"取消",ok:function(){return b.bindSome(),!0}}),b}function e(){}function f(){var a=this,b=a.rawConfig;a.setData("id-project",w.id(b.projectId)),a.setData("papers",b.papers),a.setData("project",b.project),a.setData("type",b.type),a.setData("summary",b.summary),a.setData("page-result",1),a.setData("page-size-result",5)}function g(){var a=this;a.initSelect()}function h(){var a=this,b=a.getData("type"),c={2:{key:"papers",text:"paperName",value:"id"},3:{key:"project",text:"name",value:"id"},8:{key:"papers",text:"paperName",value:"id"},9:{key:"project",text:"name",value:"id"}},d=c[b];if(!d)return void a.tip("配置错误");var e=a.getData(d.key),f=[],g={};w.forEach(e,function(a){f.push({text:a[d.text],value:w.id(a[d.value])}),g[w.id(a[d.value])]=a[d.text]});var h=new x({renderTo:a.getEl(".js-paper-select"),renderBy:"replaceWith",options:f,needSearch:!0,change:function(){var b=this.val();a.setData("cpn-val-select",b),a.renderResult(),a.renderPager(),a.popup.fixPosition()}});a.setData("map-name",g),a.setData("cpn-select",h)}function i(){var a=this,b=a.getData("summary"),c=a.getData("type"),d={2:"paperList",3:"interviewProjectList",8:"referralPaperList",9:"referralInterviewProjectList"},e=d[c],f=[];e&&(w.forEach(b[e],function(a){f.push(w.id(a.id))}),a.getData("cpn-select").val(f,!0))}function j(){var a=this,b=a.getData("cpn-val-select"),c=a.getData("map-name"),d=a.getData("page-size-result"),e=Math.ceil(b.length/d),f=Math.min(a.getData("page-result"),e),g=b.slice((f-1)*d,f*d),h="";w.forEach(g,function(a){h+=['<div class="pop-checked-item">','<span class="pop-checked-title">',c[a],"</span>",'<a href="javascript:void(0);" title="删除" class="icon-trash js-del" data-id="',a,'"></a>',"</div>"].join("")}),a.getEl(".js-result-home").html(h)}function k(){var a=this,b=a.getData("cpn-val-select"),c=a.getData("page-size-result"),d=Math.ceil(b.length/c);new z({renderTo:a.getEl(".js-pager"),renderBy:"html",current:a.getData("page-result"),total:d,pageChange:function(b){a.setData("page-result",b),a.renderResult()}})}function l(){var a=this,b=(a.getData("cpn-val-select"),a.getData("type")),c={2:{bindMethod:"bindPaper",idName:"paperIdList"},3:{bindMethod:"bindInterview",idName:"arrangeInterviewProjectIdList"},8:{bindMethod:"bindPaper",idName:"paperIdList"},9:{bindMethod:"bindInterview",idName:"arrangeInterviewProjectIdList"}}[b],d={projectId:a.getData("id-project"),isReferral:a.rawConfig.isReferral};d[c.idName]=a.getData("cpn-val-select"),A[c.bindMethod]({type:"POST",body:d,call:function(c){if(c.data){var d=y.mask("关联中...");C.getTaskProgress(!0,c.data,function(c){var e=c.end,f=c.content,g=c.error;g?(d.close(),y.alert(f)):e||"暂无进度"===f?e&&(d.close(),a.popup.close(),y.tips({2:"试卷",3:"项目",8:"试卷",9:"项目"}[b]+"关联成功",function(){a.rawConfig.refreshSummary&&a.rawConfig.refreshSummary()})):(d.close(),d=y.mask(f))})}},error:function(a){y.alert(a.msg)}})}function m(a,b,c){var d=this,e=w.isFunction(b);a=e?[a,'<a href="javascript:void(0);" class="link-green js-tip">',c||"请重试","</a>"].join(""):a,d.setData("call-tip",b),B.renderWait(d.getEl(".js-tip"),a)}function n(a){var b=this,c=["tip","main"];w.forEach(c,function(c){b.getEl(".js-"+c)[a===c?"show":"hide"]()})}function o(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function p(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function q(a){var b={2:"笔试试卷",3:"面试项目",8:"笔试试卷",9:"面试项目"};return{selectName:b[a.type]}}var r=a("nc"),s=a("cpn"),t=r.$,u=r.Component,v=r.Clazz,w=r.Base,x=(r.Limit,r.Select,r.Str,s.SelectMult),y=s.Popup,z=s.Pager,A=a("../../../../../action/resumeDeliver"),B=a("../../../../../util/util"),C=a("../../../extend/bll/task"),D=c.exports=v.create();v.mix(D,u,{_template:['<div class="pop-written" style="overflow-y:inherit;max-height:none;">','<div class="js-main">','<div class="form-group">','<label class="control-label">#{selectName}</label>','<div class="js-paper-select control-group" style="display:inline-block;"></div>',"</div>",'<div class="pop-written-checked" style="min-height:30px;">','<div class="pop-checked-label">已选：</div>','<div class="pop-checked-cont js-result-home"></div>',"</div>",'<div class="js-pager"></div>',"</div>",'<div class="js-tip"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.initVal()}},{name:"click .js-del",handler:function(a){var b=this,c=t(a.currentTarget),d=c.attr("data-id"),e=b.getData("cpn-val-select"),f=b.getData("cpn-select");w.forEach(e,function(a,b){return a===d?(e.splice(b,1),w.BREAK):void 0}),f.val(e,!0)}}],show:d},{initialize:e,initData:f,initCpns:g,initSelect:h,initVal:i,renderResult:j,renderPager:k,tip:m,bindSome:l,switchContent:n,getData:p,setData:o,_getData:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupInterviewProject",["nc","cpn","../../../../../component/department","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/user","../../../../../util/ajax","../../../../../component/popupSub/popupIvEdit","../../../../../component/popupSub/popupIvSucc","../../../../../util/interview","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../../interview/cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../action/interview","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../extend/bll/interview","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price"],function(a,b,c){function d(a){a=a||{};var b=new D(a);return s.wrap(b,{title:"选择面试项目",content:b.html(),width:600,ok:function(){return b.submit(),!0},cancelTxt:"取消"}),b}function e(){var a=this,b=a.rawConfig;a.getEl().html([b.isBatch?['<div class="pop-written-status">','<i class="icon-group"></i>共勾选应聘者：<span class="font-green">',b.batchCount,"</span>","</div>"].join(""):"",'<div class="pop-interview-type js-choice">','<label class="radio"><input value="0"/>新建面试项目</label>','<label class="radio"><input value="1"/>选择已有项目</label>',"</div>",'<div class="pop-plan-item js-choice-0" style="display:none;">','<div class="form-group">','<div class="pop-plan-label">项目名称</div>','<div class="js-name"></div>',"</div>",'<div class="form-group">','<div class="pop-plan-label">项目备注</div>','<div class="js-remark"></div>',"</div>",'<div class="js-department"></div>','<div class="pop-plan-tip">*安排面试将自动关联到该面试项目</div>',"</div>",'<div class="pop-plan-item js-choice-1" style="display:none;">','<div class="form-group">','<div class="pop-plan-label">面试项目</div>','<div class="js-project"></div>',"</div>",'<div class="pop-plan-tip">*安排面试将自动关联到该面试项目</div>',"</div>"].join(""))}function f(a){var b=this;b.choice=v.mix({el:b.getEl(".js-choice .radio"),listeners:{change:function(){b.fixChoice()}}}),b.name=new t({renderTo:b.getEl(".js-name"),renderBy:"replaceWith",placeholder:"不能超过20个字符",listeners:{change:function(){b.checkProjectName()}}}),b.remark=new t({renderTo:b.getEl(".js-remark"),renderBy:"replaceWith",placeholder:"不能超过100个字符",listeners:{change:function(){b.checkRemark()}}}),b.department=new w({renderTo:b.getEl(".js-department"),renderBy:"replaceWith",type:"selectMult",departmentData:a,tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以看见并管理该面试项目",gap:"4px"}),b.department.getEl(".control-label").width(135),b.projectSel=new u({renderTo:b.getEl(".js-project"),renderBy:"replaceWith",needSearch:!0,options:o.map(b.projectData,function(a,b){return{text:a.name,value:o.id(a.id),checked:0===b}})})}function g(){var a=this,b=a.rawConfig.isReferral,c=a.summaryData,d=(c[b?"referralInterviewProjectList":"interviewProjectList"]||[]).length>0;a.rawConfig.isBatch?a.choice.val("0"):(a.choice.val(d?"1":"0"),d&&a.projectSel.val(o.id(c[b?"referralInterviewProjectList":"interviewProjectList"][0].id))),a.fixChoice()}function h(){function a(a,b){var e=c.resumeData;C.getSimpleFullDepartments({params:{userId:g.getUserId()},query:{entityType:32,entityIdList:a},call:function(c){x.show({projectId:a,resumeProjectId:d.projectId,departmentData:c.data||[],id:(b||{}).id,val:{intervieweeName:e.candidateName,intervieweeEmail:e.email,intervieweePhone:e.phone,job:(e.jobNameList||[])[0],resumeUrl:e.url,deliverId:d.deliverId,testResultUrl:g.getNavUrl("paper",{action:"candidate/result/index",testId:((e.writeRecordList||[])[0]||{}).ctsTestId})},call:function(){o.isFunction(d.ok)&&d.ok()}})},error:function(a){s.alert(a.msg)}})}function b(a){B.checkArrangeInterview({type:"POST",body:o.extend({},d.batchCond,{arrangeInterviewProjectId:a,isReferral:d.isReferral}),call:function(b){var e=b.data||{},f=e.totalCount-e.hasInterviewCount-e.duplicateUserCount,h="本次共勾选应聘者"+e.totalCount+"人，其中"+(e.hasInterviewCount?e.hasInterviewCount+"名应聘者已创建过面试，无需重复创建"+(e.duplicateUserCount?"，":""):"")+(e.duplicateUserCount?e.duplicateUserCount+"人手机或邮箱重复，无法创建面试":"");return 0>=f?s.alert(h):e.hasInterviewCount||e.duplicateUserCount?s.confirm(h+"，是否为剩下"+f+"人创建面试?",function(){c.db.set("toArrangeDeliverId",e.toArrangeDeliverIdSet),g.nav("resume",{action:"deliver/batchInterview/index",projectId:d.projectId,arrangeInterviewProjectId:a,needSetCount:f,isReferral:d.isReferral})}):(c.db.set("toArrangeDeliverId",e.toArrangeDeliverIdSet),void g.nav("resume",{action:"deliver/batchInterview/index",projectId:d.projectId,arrangeInterviewProjectId:a,needSetCount:f,isReferral:d.isReferral}))},error:function(a){s.alert(a.msg)}})}var c=this,d=c.rawConfig,e=c.checkProjectName()&&c.checkRemark(),f=c.choice.val(),g=d.module;return"0"!==f||e?"0"===f&&e?A.addProject({type:"POST",body:{projectName:n.trim(c.name.val()),projectRemark:n.trim(c.remark.val()),departmentIdList:c.department.val()},call:function(c){d.isBatch?b(c.data):a(c.data)},error:function(a){s.alert(a.msg)}}):d.isBatch?b(c.projectSel.val()):void B.queryDeliverInInterviewProject({query:{deliverId:c.resumeData.id,interviewProjectId:c.projectSel.val(),isReferral:d.isReferral},call:function(b){function d(){a(c.projectSel.val(),e)}var e=b.data;if(!e)return d();var f=(e.rounds||[])[e.round-1],g="",h="";f?0===f.status?(g="该候选人面试房间已创建 ，当前状态：第"+e.round+"轮未面试",h="查看详情"):3===f.status?(g="该候选人面试房间已创建 ，当前状态：第"+e.round+"轮"+(f.score>2?"已通过":"已淘汰"),h="继续预约"):(1===f.status||5===f.status)&&(g="该候选人面试房间已创建 ，当前状态：第"+e.round+"轮进行中，面试房间可以直接使用，无须重复创建",h="确定"):(g="该候选人面试房间已创建 ，当前状态：第"+e.round+"轮未预约",h="前往预约"),s.show({noUnique:!0,content:g,okTxt:h,cancelTxt:"确定"===h?"":"知道了",ok:d})},error:function(a){s.alert(a.msg)}}):void 0}function i(){var a=this,b=a.choice.val();o.forEach(["0","1"],function(c){a.getEl(".js-choice-"+c)[b===c?"show":"hide"]()})}function j(){var a=this,b=n.trim(a.name.val());if(b.length>20)return a.name.errorTips("不能超过20个字符"),!1;if(0===b.length)return a.name.errorTips("项目名称不能为空"),!1;var c=!0;return o.forEach(a.projectData,function(a){return a.name===b?(c=!1,o.BREAK):void 0}),a.name.errorTips(c?"":"名字重复"),c}function k(){var a=this;return n.trim(a.remark.val()).length>100?(a.remark.errorTips("不能超过100个字符"),!1):!0}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=l.Component,r=l.Db,s=m.Popup,t=m.Input,u=m.Select,v=m.CheckGroup,w=a("../../../../../component/department"),x=a("../../../../../component/popupSub/popupIvEdit"),y=a("../../../extend/bll/interview"),z=a("../../../../../core/siteConfig"),A=a("../../../../../action/interviewProject"),B=a("../../../../../action/resumeDeliver"),C=a("../../../../../action/user"),D=c.exports=p.create();p.mix(D,q,{_template:'<div class="pop-written" style="overflow-y:inherit;max-height:none;"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=b.module,d=a.getEl();a.summaryData=b.summaryData||{},a.resumeData=b.resumeData||{},a.db=r.create(z.appDb.BatchInterview),c.renderWait(d,"加载中..."),y.getSimpleProject(function(b){a.projectData=b,C.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{},call:function(b){a.initContainer(),a.initCpns(b.data||[]),a.initVal(),a.popup.fixPosition()},error:function(a){c.renderNone(d,a.msg)}})})}}],show:d},{initContainer:e,initCpns:f,initVal:g,submit:h,fixChoice:i,checkProjectName:j,checkRemark:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupSearchTarget",["nc","cpn","../../../../../action/resumeDeliver","../../../../../util/ajax","../../../../../action/common"],function(a,b,c){function d(a){var b=new D(a),c=y.wrap(b,{title:"搜索指定名单",content:b.html(),width:600,height:250,cancelTxt:"取消",noUnique:!0,ok:function(){var d=b.getData("view-key");return"operate"===d?(b.search(),!0):void("result"===d&&(u.isFunction(a.search)&&a.search(),c.close()))}});return b}function e(){}function f(){var a=this,b=a.rawConfig||{};a.setData("parent",b.parent),a.setData("id-project",b.projectId),a.setData("stage",b.stage),a.setData("view-key","operate"),a.setData("cpn-val-deliver-num",b.searchId),a.setData("cpn-val-search-type",(b.searchType||"1")+"")}function g(){var a=this;a.initTextarea(),a.initCheckGroup()}function h(){var a=this,b=["deliver-num"];u.forEach(b,function(b){var c=new z({renderTo:a.getEl(".js-"+b),renderBy:"html",type:"textarea",listeners:{change:function(){var c=v.trim(this.val());a.setData("cpn-val-"+b,c)}}});c.getEl("textarea").width(550).height(160).css("resize","none"),a.setData("cpn-"+b,c)})}function i(){var a=this,b=["search-type"];u.forEach(b,function(b){var c=A.mix({el:a.getEl(".js-"+b+" label.radio"),change:function(){a.setData("cpn-val-"+b,this.val())}});a.setData("cpn-"+b,c)})}function j(){var a=this;a.renderCpnVal("deliver-num"),a.renderCpnVal("search-type"),a.renderView()}function k(){var a=this,b=a.getData("view-key"),c=["operate","result"],d={operate:"确定",result:"查看"},e=d[b];e&&a.popup&&a.popup.getEl(".confirm-btn").html(e),u.forEach(c,function(c){a.getEl(".js-"+c)[b===c?"show":"hide"]()})}function l(){var a=this,b=a.getData("parent"),c=a.getData("cpn-val-deliver-num"),d=b.getFormatSearchId(c);if(!d)return void y.alert("请输入手机号码或投递编号！");var e=y.mask("搜索中...");B.searchBitHit({type:"POST",body:{projectId:a.getData("id-project"),stage:a.getData("stage"),searchIds:d,searchIdType:a.getData("cpn-val-search-type")-1},call:function(b){var c=u.uniq(b.data||[]);a.setData("result",c),a.updateData(),a.showResult()},error:function(a){y.alert(a.msg)},always:function(){e.close()}})}function m(){var a=this,b=a.rawConfig||{},c=a.getData("cpn-val-deliver-num"),d=a.getData("cpn-val-search-type");u.isFunction(b.updateData)&&b.updateData(c,d)}function n(){var a=this,b=a.rawConfig||{},c=b.parent,d=a.getData("cpn-val-deliver-num"),e=a.getData("result"),f=c.getUniqSearchId(d),g=e.length,h=f.length-g,i=["已找到本阶段有效应聘者",h,"人",g?"。录入的名单中有"+g+'人不在列表中。<a href=javascript:void(0); class="font-green js-download-fail">点击下载</a>':"",'<br/><a href="javascript:void(0);" class="font-green js-go-back">&lt;&lt;返回编辑'].join("");a.getEl(".js-result").html(i),a.setData("view-key","result"),a.renderView()}function o(){var a=this,b=a.getData("result"),c="不在此阶段应聘者.txt",d=b.join("\n"),e=C.downloadTxtFileUrl({query:{name:c,content:d}});window.open(e)}function p(a){var b=this,c=b.getData("cpn-"+a),d=b.getData("cpn-val-"+a);c&&c.val&&c.val(d)}function q(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function r(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var s=a("nc"),t=a("cpn"),u=s.Base,v=s.$,w=s.Clazz,x=s.Component,y=(s.Uri,t.Popup),z=t.Input,A=t.CheckGroup,B=a("../../../../../action/resumeDeliver"),C=a("../../../../../action/common"),D=c.exports=w.create();w.mix(D,x,{_template:["<div>",'<div class="js-operate">','<p style="font-size:14px;margin-bottom:20px;">请输入想查看的手机号码或投递编号，多个号码用空格、逗号或换行符分割。最多支持搜索5000人。</p>','<div class="js-search-type">','<label class="radio">','<span class="icons"></span>','<input type="radio" value="1" />投递编号',"</label>",'<label class="radio" style="margin-left:30px;">','<span class="icons"></span>','<input type="radio" value="2" />手机号码',"</label>","</div>",'<div class="js-deliver-num"></div>',"</div>",'<div class="js-result" style="padding:20px;font-size:14px;text-align:center;line-height:30px;">></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.initRender()}},{name:"click .js-download-fail",handler:function(){var a=this;a.downloadFail()}},{name:"click .js-go-back",handler:function(){var a=this;a.setData("view-key","operate"),a.renderView()}}],show:d},{initialize:e,initData:f,initCpns:g,initTextarea:h,initCheckGroup:i,initRender:j,renderView:k,search:l,updateData:m,showResult:n,downloadFail:o,renderCpnVal:p,setData:q,getData:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/popupSettlePaper",["nc","cpn","../../../../../action/resumeDeliver","../../../../../util/ajax","../../../../../util/util","../../../../../core/siteConfig","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new z(a);return b.popup=v.wrap(b,{content:b.html(),title:"安排笔试",width:650,okTxt:"确定",noUnique:!0,cancelTxt:"取消",ok:function(){return b.settlePaper(),!0}}),b}function e(){}function f(){var a=this,b=a.rawConfig;a.setData("id-project",t.id(b.projectId)),a.setData("papers",b.papers),a.setData("deliver-num",b.deliverNum),a.setData("search-body",b.searchBody)}function g(){var a=this;a.getEl(".js-deliver-num").html(a.getData("deliver-num")),a.initPaperSelect()}function h(){var a=this,b=a.getData("papers"),c=[];t.forEach(b,function(a){c.push({text:a.paperName,value:t.id(a.id)})});var d=new u({renderTo:a.getEl(".js-paper-select"),renderBy:"replaceWith",options:c,needSearch:!0,autoWidth:!0,change:function(){var b=t.id(this.val());a.setData("cpn-val-paper",b)}});d.val(t.id((b[0]||{}).id),!0),a.setData("cpn-paper",d)}function i(){var a=this,b=(a.getData("cpn-val-paper"),a.getData("search-body")),c=t.extend(b,{arrangePaperId:a.getData("cpn-val-paper"),isReferral:a.rawConfig.isReferral});w.arrangeCtsTest({type:"POST",body:c,call:function(b){if(b.data){var c=a.mask("关联中...");y.getTaskProgress(!0,b.data,function(b){var d=b.end,e=b.content,f=b.error;if(f){c.close(),a.fire("refreshSummary"),a.popup.close();var g=t.json(e),h=t.isObject(g)?["<p>本次共勾选应聘者",g.totalCount,"人，其中",g.totalCount-g.failCount,"人笔试安排成功</p>","<p>其他",g.failCount,"名应聘者因信息有误(信息重复或格式不正确)安排失败</p>",'<a href="',g.errorFileUrl,'" class="link-green">点击下载错误名单</a>'].join(""):e;v.alert(h)}else d||"暂无进度"===e||""===q.trim(e)?d&&(c.close(),a.fire("refreshSummary"),a.popup.close(),a.fire("refreshSummary"),v.tips("关联成功")):(c.close(),c=a.mask(e))})}},error:function(a){v.alert(a.msg)}})}function j(a,b,c){var d=this,e=t.isFunction(b);a=e?[a,'<a href="javascript:void(0);" class="link-green js-tip">',c||"请重试","</a>"].join(""):a,d.setData("call-tip",b),x.renderWait(d.getEl(".js-tip"),a)}function k(a){var b=this,c=["tip","main"];t.forEach(c,function(c){b.getEl(".js-"+c)[a===c?"show":"hide"]()})}function l(a){return new v({hasNoTitle:!0,hasNoMove:!0,hasNoFooter:!0,width:500,noUnique:!0,content:['<div style="font-size:16px;text-align:center;padding:20px;">',a||"","</div>"].join(""),clickToHide:!1})}function m(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function n(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Component,s=o.Clazz,t=o.Base,u=(o.Limit,o.Select),u=(o.Str,p.Select),v=p.Popup,w=a("../../../../../action/resumeDeliver"),x=a("../../../../../util/util"),y=a("../../../extend/bll/task"),z=c.exports=s.create();s.mix(z,r,{_template:['<div class="pop-written" style="overflow-y:inherit;">','<div class="pop-written-status">','<i class="icon-group"></i>共勾选应聘者：<span class="font-green js-deliver-num">0</span>',"</div>",'<div class="pop-plan-item">','<div class="pop-plan-label">安排笔试</div>','<div class="js-paper-select"></div>','<div class="pop-plan-tip">*安排笔试将自动关联到该招聘项目</div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns()}}],show:d},{initialize:e,initData:f,initCpns:g,initPaperSelect:h,tip:j,settlePaper:i,switchContent:k,mask:l,getData:n,setData:m})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/roundOffLine",["nc","cpn"],function(a,b,c){function d(){var a=this;a.items=[]}function e(a){var b=this,c=b.items;if(0===arguments.length)return n.map(c,function(a,b){return{round:b+1,value:a.cpn.val()}});for(;c.length<a.length;)b.createItem();for(;c.length>a.length;){var d=c.pop();d.cpn.destroy(),d.dv.remove()}n.forEach(a,function(a,b){c[b]&&c[b].cpn.val(a.value)}),b.fixItem(),b.fire("change")}function f(){var a=this,b=a.items;return n.map(b,function(a,b){return{round:b+1,text:a.cpn.text()}})}function g(){var a=this,b=k(['<div class="filter-item">','<span class="item-space js-name"></span>','<div class="js-temp"></div>','<a href="javascript:void(0);" class="icon-trash js-delete"></a>',"</div>"].join(""));a.addEl.before(b);var c=new o({renderTo:b.find(".js-temp"),renderBy:"replaceWith",size:"small",autoWidth:!0,options:[{text:"不限",value:"0",checked:!0},{text:"视频",value:"1"},{text:"线下",value:"2"}],listeners:{change:function(){a.fire("change")}}});a.items.push({dv:b,cpn:c})}function h(){var a=this,b=a.items,c=b.length;n.forEach(b,function(a,b){{var d=a.dv;a.cpn}d.find(".js-name").html("第"+(b+1)+"轮"),d.find(".js-delete")[c>1?"show":"hide"]()}),a.addEl[10>c?"show":"hide"]()}var i=a("nc"),j=a("cpn"),k=i.$,l=i.Component,m=i.Clazz,n=i.Base,o=(i.Str,j.Select),p=(j.Input,c.exports=m.create());m.mix(p,l,{_template:['<div class="filter-cont">','<div class="filter-item js-add"><a href="javascript:void(0);" class="add-item-icon"><i class="icon-plus-sign"></i> 添加方式</a></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.addEl=b.find(".js-add"),n.forCount(3,function(){a.createItem()}),a.fixItem()}},{name:"click .js-add",handler:function(){var a=this;a.createItem(),a.fixItem(),a.fire("change")}},{name:"click .js-delete",handler:function(a){var b=this,c=b.items;if(!(c.length<=1)){var d=k(a.currentTarget),e=d.closest("div.filter-item"),f=-1;n.find(c,function(a,b){a.dv.get(0)===e.get(0)&&(f=b)});var g=c[f];g.cpn.destroy(),g.dv.remove(),c.splice(f,1),b.fixItem(),b.fire("change")}}}]},{initialize:d,val:e,valText:f,createItem:g,fixItem:h})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/cpn/searchTarget",["nc","cpn","./popupSearchTarget","../../../../../action/resumeDeliver","../../../../../util/ajax","../../../../../action/common"],function(a,b,c){function d(){}function e(){var a=this,b=a.rawConfig||{};a.setData("stage",b.stage),a.setData("id-search",""),a.setData("search-type","1")}function f(a){var b=this;if(0===arguments.length){var c=b.getData("id-search");return{searchId:b.getFormatSearchId(c),searchType:b.getData("search-type")}}b.setData("id-search",a.searchId||""),b.setData("search-type",a.searchType||"2")}function g(){var a=this,b=a.getData("id-search"),c=a.getData("search-type"),d={1:"投递编号",2:"手机号"};if(!b)return 0;var e=a.getUniqSearchId(b);return d[c]+"个数："+e.length}function h(){var a=this;a.setData("id-search","")}function i(a){var b=a.split(/[\s\n,]+/);return b=n.uniq(b)||[]}function j(a){var b=this,c=b.getUniqSearchId(a);return c.join("_")}function k(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function l(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var m=a("nc"),n=(a("cpn"),m.$,m.Base),o=m.Clazz,p=m.Component,q=a("./popupSearchTarget"),r=c.exports=o.create();o.mix(r,p,{_template:['<div style="padding:0 30px;">','<a href="javascript:void(0);" class="font-green js-popup" style="line-height:34px;">搜索指定名单</a>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData()}},{name:"click .js-popup",handler:function(){var a=this,b=a.rawConfig||{},c=a.rawConfig.module.getParam();q.show({projectId:c.projectId,stage:a.getData("stage"),searchId:a.getData("id-search"),searchType:a.getData("search-type"),parent:a,updateData:function(b,c){a.setData("id-search",b),a.setData("search-type",c),a.fire("change")},search:function(){n.isFunction(b.search)&&b.search()}})}}]},{initialize:d,initData:e,val:f,getSearchIdLength:g,clearData:h,getUniqSearchId:i,getFormatSearchId:j,setData:k,getData:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/cpn/popupBatchCancelInterview",["nc","cpn","../../../../../../action/resumeDeliver","../../../../../../util/ajax","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new r(a);return o.wrap(b,{title:"取消面试",content:b.html(),width:650,cancelTxt:"取消",ok:function(){return b.check()&&b.submit(),!0}}),b}function e(){var a=this;a.getEl(".js-deliver-num").html(a.deliverNum);var b=a.projectDataMap={};a.projectSel=new n({renderTo:a.getEl(".js-project-select"),renderBy:"replaceWith",needSearch:!0,options:l.map(a.projectData,function(a){return b[a.id]=a,{text:a.name,value:l.id(a.id)}})})}function f(){var a=this,b=a.projectSel.val()||[];return 0===b.length?(o.alert("请选择要取消面试的项目"),!1):!0}function g(){function a(a){m.mark(d)||p.deleteInterview({type:"DELETE",body:l.extend({deleteInterviewProjectId:c.projectSel.val(),confirm:0},c.batchCond),call:b,error:function(b){m.clear(d),1006===b.code&&a&&a(b.msg),1006!==b.code&&o.alert(b.msg)}})}function b(a){var b=o.mask("请稍等...");q.getTaskProgress(!0,a.data,function(a){var d=a.content;a.error?(b.close(),o.alert(d)):a.end?(c.fire("updateSearchData"),b.close(),c.popup.close(),o.tips("操作成功")):d&&"暂无进度"!==d&&b.getEl(".pop-content div").html(d)})}var c=this,d=c.getEl();a(function(a){o.confirm(a,function(){m.mark(d)||p.deleteInterview({type:"DELETE",body:l.extend({deleteInterviewProjectId:c.projectSel.val(),confirm:1,isReferral:c.rawConfig.isReferral},c.batchCond),call:b,error:function(a){o.alert(a.msg)},always:function(){m.clear(d)}})})})}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=h.Limit,n=h.Select,n=i.Select,o=i.Popup,p=a("../../../../../../action/resumeDeliver"),q=a("../../../../extend/bll/task"),r=c.exports=k.create();k.mix(r,j,{_template:['<div class="pop-written" style="overflow-y:inherit;">','<div class="pop-written-status">','<i class="icon-group"></i>共勾选应聘者：<span class="font-green js-deliver-num"></span>',"</div>",'<div class="pop-plan-item">','<div class="pop-plan-label">取消面试</div>','<div class="js-project-select"></div>','<div class="pop-plan-tip">*只支持取消未开始的面试</div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.deliverNum=b.batchCount||0,a.batchCond=b.batchCond||{},a.projectData=b.projectData||[],a.initCpns()}}],show:d},{initCpns:e,check:f,submit:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/cpn/popupBatchCancelTest",["nc","cpn","../../../../../../action/resumeDeliver","../../../../../../util/ajax","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api"],function(a,b,c){function d(a){a=a||{};var b=new r(a);return o.wrap(b,{title:"取消笔试",content:b.html(),width:650,cancelTxt:"取消",ok:function(){return b.check()&&b.submit(),!0}}),b}function e(){var a=this;a.getEl(".js-deliver-num").html(a.deliverNum);var b=a.paperDataMap={};a.paperSel=new n({renderTo:a.getEl(".js-paper-select"),renderBy:"replaceWith",needSearch:!0,options:l.map(a.paperData,function(a){return b[a.id]=a,{text:a.paperName,value:l.id(a.id)}})})}function f(){var a=this,b=a.paperSel.val()||[];return 0===b.length?(o.alert("请选择要取消笔试的试卷"),!1):!0}function g(){function a(a){m.mark(d)||p.deleteCtsTestUser({type:"DELETE",body:l.extend({deletePaperId:c.paperSel.val(),confirm:0},c.batchCond),call:b,error:function(b){m.clear(d),1006===b.code&&a&&a(l.json(b.msg)),1006!==b.code&&o.alert(b.msg)}})}function b(a){var b=o.mask("请稍等...");q.getTaskProgress(!0,a.data,function(a){var d=a.content;a.error?(b.close(),o.alert(d)):a.end?(c.fire("updateSearchData"),b.close(),c.popup.close(),o.tips("操作成功")):d&&"暂无进度"!==d&&b.getEl(".pop-content div").html(d)})}var c=this,d=c.getEl();a(function(a){var e=c.paperSel.val(),f=c.paperDataMap[e].paperName;if(!a.hasCtsTestUserCount)return o.alert("本次共勾选"+a.totalDeliverIdCount+"位应聘者均不在"+f+"考生名单中，无须取消笔试。");var g=a.hasCtsTestUserCount===a.totalDeliverIdCount?"本次共勾选"+a.totalDeliverIdCount+"位应聘者，确定将他们从"+f+"考生名单中删除？":"本次共勾选"+a.totalDeliverIdCount+"位应聘者，其中"+a.hasCtsTestUserCount+"位在"+f+"考生名单中，确定删除这些考生？";o.confirm(g,function(){m.mark(d)||p.deleteCtsTestUser({type:"DELETE",body:l.extend({deletePaperId:e,confirm:1,isReferral:c.rawConfig.isReferral},c.batchCond),call:b,error:function(a){o.alert(a.msg)},always:function(){m.clear(d)}})})})}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=h.Limit,n=h.Select,n=i.Select,o=i.Popup,p=a("../../../../../../action/resumeDeliver"),q=a("../../../../extend/bll/task"),r=c.exports=k.create();k.mix(r,j,{_template:['<div class="pop-written" style="overflow-y:inherit;">','<div class="pop-written-status">','<i class="icon-group"></i>共勾选应聘者：<span class="font-green js-deliver-num"></span>',"</div>",'<div class="pop-plan-item">','<div class="pop-plan-label">取消笔试</div>','<div class="js-paper-select"></div>','<div class="pop-plan-tip">*只支持取消未开始的笔试</div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.deliverNum=b.batchCount||0,a.batchCond=b.batchCond||{},a.paperData=l.filter(b.paperData||[],function(a){return!a.started}),a.initCpns()}}],show:d},{initCpns:e,check:f,submit:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/cpn/popupPaperView",["nc","cpn","../../../../../../component/table","../../../../../../component/selectAll","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/paper","../../../../../../util/ajax","../../../../extend/bll/paper","../../../../extend/bll/base","../../../../extend/bll/task","../../../../../../action/api","../../../../extend/bll/serverTime","../../../../../../action/common"],function(a,b,c){function d(a){a=a||{};var b=new t(a);return o.wrap(b,{title:"笔试成绩",content:b.html(),width:960,okTxt:"确定"}),b}function e(a){var b=this;b.tab=a+"",k.forEach(b.getEl(".js-tab"),function(a){j(a).removeClass("selected")});var c=b.getEl('.js-tab[data-tab="'+a+'"]');c.addClass("selected"),b.renderTable()}function f(){var a=this,b=a.tab,c=a.tableData[b];if(0===c.length)return s.renderNone({el:a.getEl(".js-table"),imgUrl:"//uploadfiles.nowcoder.com/images/20171221/4145441_1513827921677_8266E4BFEDA1BD42D8F9794EB4EA0A13",text:"暂无笔试记录"});var d={head:[{text:"试卷名",style:{"text-align":"center"}},{text:"笔试进度",style:{"text-align":"center"}},{text:"得分",style:{"text-align":"center"}},{text:"排名",style:{"text-align":"center"}},{text:"是否作弊",style:{"text-align":"center"}},{text:"做题用时",style:{"text-align":"center"}},{text:"做题时间",style:{"text-align":"center","min-width":"150px"}},{text:"操作",style:{"text-align":"center"}}],list:[]},e=a.actorMap={};k.forEach(c,function(b){e[b.ctsActorId]=b;var c=a.rawConfig.module.getNavUrl("paper",{action:"candidate/result/index",testId:b.ctsTestId}),f=[b.paperName||"暂无",["","未到场","已打开","已提交"][b.testStatus]||"暂无",3!==b.testStatus?"暂无":'<span class="js-tips" title="试卷总分：'+b.ctsPaperScore+'分">'+b.ctsScore+"</span>",3!==b.testStatus?"暂无":'<span class="js-tips" title="到场人数：'+b.ctsPaperOpenCount+'">'+b.ctsRank+"</span>",3!==b.testStatus?"暂无":1===b.ctsCheated?"是":"否",k.contains([3],b.testStatus)?n.second(b.ctsElapseTime/1e3):"暂无",k.contains([2,3],b.testStatus)?n.form(new Date(b.ctsBeginTime)):"暂无",b.paperStarted?3!==b.testStatus?"暂无":'<a class="font-green" target="_blank" href="'+c+'">查看笔试报告</a>':'<a href="javascript:void(0);" class="link-green js-cancel-test">取消笔试</a>'];d.list.push({items:f,attr:{"data-id":b.ctsActorId}})}),a.getEl(".js-table").html(p.getHtml(d))}function g(a){return j(a).closest("tr").attr("data-id")}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Base,l=h.Clazz,m=h.Component,n=h.Time,o=i.Popup,p=(i.Tips,a("../../../../../../component/table")),q=a("../../../../../../action/paper"),r=a("../../../../extend/bll/paper"),s=a("../../../../../../util/util"),t=c.exports=l.create();l.mix(t,m,{_template:["<div>",'<div class="menu-box pop-interview-menu">','<ul class="menu clearfix">','<li class="js-tab selected" data-tab="0"><a href="javascript:void(0);"><i class="pop-menu-now"></i>当前笔试</a></li>','<li class="js-tab" data-tab="1"><a href="javascript:void(0);"><i class="pop-menu-before"></i>历史笔试</a></li>',"</ul>","</div>",'<div class="panel js-table"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=b.data||{};a.curData=c.currentWriteTests||[],a.historyData=c.historyWriteTests||[],a.tableData=[a.curData,a.historyData],a.selectTab(b.tab||"0"),a.popup.fixPosition()}},{name:"click .js-tab",handler:function(a){var b=this;b.selectTab(j(a.currentTarget).attr("data-tab"))}},{name:"click .js-cancel-test",handler:function(a){var b=this,c=b.actorMap[b.getLineId(j(a.currentTarget))];q.ifApiUser({type:"GET",params:{paperId:c.paperId,userId:c.ctsActorId},call:function(){r.delPaperUser({cond:{isAll:2,ids:c.ctsActorId},paperId:c.paperId,selectCount:1,call:function(){var a=b.tableData[b.tab],d=k.findIndex(a,function(a){return a===c});return a.splice(d,1),0===b.curData.length&&0===b.historyData.length?b.popup.close():(b.fire("updateSearchData"),void b.renderTable())}})},error:function(a){o.alert(a.msg)}})}}],show:d},{selectTab:e,renderTable:f,getLineId:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/cpn/toolBar",["nc","cpn","../../cpn/popupBatchTransfer","../../cpn/popupBatchAddTag","../../../../../../action/resume","../../../../../../util/ajax","../../../../../../action/resumeDeliver","../../../../extend/bll/task","../../../../extend/bll/base","../../../../../../action/api","../../cpn/popupBatchDeleteTag","../../cpn/popupInterviewProject","../../../../../../component/department","../../../../../../util/switch","../../../../../../util/util","../../../../../../core/siteConfig","../../../../../../action/user","../../../../../../component/popupSub/popupIvEdit","../../../../../../component/popupSub/popupIvSucc","../../../../../../util/interview","../../../../../../component/popupSub/popupJoinSession","../../../../../../action/interviewProject","../../../../../../action/interviewSchedule","../../../../interview/cpn/interviewSceneForm","../../../../../../component/dateSelect","../../../../../../action/interview","../../../../../../action/interviewV2","../../../../extend/bll/interview","../../../../extend/bll/money","../../../../../../action/purchase","../../../../../../action/price","../../cpn/popupConnectPaper","../../cpn/popupSettlePaper","./popupBatchCancelTest","./popupBatchCancelInterview","../../../../extend/bll/resumeDeliver","../../../../extend/event","../../../../../../action/common","../../util"],function(a,b,c){function d(){var a=this,b=a.module,c=b.getParam();a.pageSizeCpn=new z({renderTo:a.getEl(".js-pagesize"),renderBy:"replaceWith",size:"xsmall",options:w.map([20,50,100],function(a,b){return{text:a,value:a,checked:c.pageSize?a===c.pageSize:0===b}}),change:function(){var c=this.val();b.addParam({pageSize:c}),a.fire("pageSize",c)}}),a.unreadCpn=A.transform(a.getEl(".js-unread-ck"),{change:function(){var c=this.isChecked()?1:0;b.addParam({unread:c}),a.fire("unread",c)}}),a.unreadCpn.checked(1===+c.unread),a.orderCpn=A.transform(a.getEl(".js-order-ck"),{change:function(){var c=this.isChecked()?1:0;b.addParam({orderBy:c}),a.fire("orderBy",c)}}),a.orderCpn.checked(1===+c.orderBy)}function e(a){function b(a){var b=f.rawConfig.getSummary().stageList,c=a>6?[7,8,9]:[0,2,3,6];return w.find(c,function(c){return c>a&&w.find(b,function(a){return a.stage===c})})}function c(a,b){if(a.sub){var c=v(['<li class="manage-sub-oprt">','<i class="resume-ico',a.icon,'"></i>','<span class="manage-oprt-',a.color,'">',a.name,"</span>",'<span class="icon-angle-down"></span><span class="icon-angle-up"></span>',"<ul></ul>","</li>"].join("")),d=c.find("ul");return w.forEach(a.sub,function(a,c){var e=v(['<li data-index="',b,'" data-sub-index="',c,'">',a.name,"</li>"].join(""));e.addClass(void 0===a.cls?"js-action":a.cls),a.attr&&e.attr(a.attr),d.append(e)}),c[0].outerHTML}var c=v(['<li data-index="',b,'">','<i class="resume-ico',a.icon,'"></i>','<span class="manage-oprt-',a.color,'">',a.name,"</span>","</li>"].join(""));return c.addClass(void 0===a.cls?"js-action":a.cls),a.attr&&c.attr(a.attr),c[0].outerHTML}function d(a){return a?w.extend({isReferral:!0},a):null}function e(a){var b=i[a?"referralWeixinScope":"weixinScope"];return N.can(["resumeArrangeInterview","interview"],"every")?{isReferral:a,name:"对学生"+(b?"显示":"隐藏")+"面试结果",icon:11,color:"green",cls:"js-interview-result js-tips",attr:{title:b?"显示结果后，候选人可以在牛客主站、校招小管家查询到自己详细的面试结果":"隐藏结果后，候选人不能在牛客主站、校招小管家查询到自己详细的面试结果","data-theme":"white"}}:null}var f=this;a=f.stage=+a;var g=0===a||7===a;f.orderCpn.getEl()[g?"show":"hide"]();var h=(f.getReferralStage(),N.has(122)),i=f.rawConfig.getSummary(),j=N.has(120)?{name:"查看简历",icon:9,color:"green",method:"readResume"}:null,k=N.has(121)?{name:"下载",icon:8,color:"green",sub:[{name:"简历PDF",method:"downloadPDF"},{name:"简历Excel",method:"downloadExcel"}]}:null,l=h?{name:"转移",icon:6,color:"orange",method:"transferPopup"}:null,m=N.has(123)?{name:"标签",icon:7,color:"green",sub:[{name:"添加标签",method:"addTag"},{name:"撤销标签",method:"cancelTag"}]}:null,n=N.has(124)?{name:"笔试",icon:1,color:"blue",sub:[{name:"安排笔试",method:"settleTest"},{name:"取消笔试",method:"cancelTest"},{name:"关联试卷",cls:"js-connect-test js-tips",attr:{title:"关联试卷后，系统自动将所选试卷的成绩同步到简历系统","data-theme":"white"}}]}:null,o=N.can(["resumeArrangeInterview","interview"],"every")?{name:"面试",icon:2,color:"blue",sub:[{name:"安排面试",method:"settleInterview"},{name:"取消面试",method:"cancelInterview"},{name:"关联面试",cls:"js-connect-interview js-tips",attr:{title:"关联面试，系统自动将所选面试项目的状态和面试结果同步到简历系统","data-theme":"white"}}]}:null,p=b(0),q=b(2),r=b(7),s=b(8),t=f.stageMap={0:[h?{name:"通过",icon:3,color:"orange",method:p?"transfer":"transferPopup",toStage:p,toSubStage:0}:null,h?{name:"淘汰",icon:4,color:"orange",method:"transfer",toStage:0,toSubStage:2}:null,h?{name:"待定",icon:5,color:"orange",method:"transfer",toStage:0,toSubStage:1}:null,l,m,j,k],2:[n,h?{name:"通过",icon:3,color:"orange",method:q?"transfer":"transferPopup",toStage:q,toSubStage:0}:null,h?{name:"淘汰",icon:4,color:"orange",sub:[{name:"淘汰",method:"transfer",toStage:2,toSubStage:2},{name:"取消淘汰",method:"transfer",toStage:2,toSubStage:0}]}:null,l,m,j,k],3:[o,e(),l,m,j,k],6:[l,j,k],7:[h?{name:"通过",icon:3,color:"orange",method:r?"transfer":"transferPopup",toStage:r,toSubStage:0}:null,h?{name:"淘汰",icon:4,color:"orange",method:"transfer",toStage:7,toSubStage:2}:null,h?{name:"待定",icon:5,color:"orange",method:"transfer",toStage:7,toSubStage:1}:null,l,m,j,k],8:[d(n),h?{name:"通过",icon:3,color:"orange",method:s?"transfer":"transferPopup",toStage:s,toSubStage:0}:null,h?{name:"淘汰",icon:4,color:"orange",sub:[{name:"淘汰",method:"transfer",toStage:8,toSubStage:2},{name:"取消淘汰",method:"transfer",toStage:8,toSubStage:0}]}:null,l,m,j,k],9:[d(o),e(!0),l,m,j,k]},u="";w.forEach(t[a],function(a,b){a&&(u+=c(a,b))}),f.getEl(".js-batch-ul").html(u)}function f(a){var b=this;b.getEl(".js-count").html(a)}function g(){{var a=this;a.rawConfig}C.show({referralStage:a.getReferralStage(),value:{stage:a.stage},call:function(b){a.transferStage(b)}})}function h(a,b){{var c=this;c.rawConfig}c.transferStage({toStage:b.toStage,toSubStage:b.toSubStage},!0)}function i(){var a=this,b=a.rawConfig;D.show({entityType:21,searchParam:b.getBatchCond()})}function j(){var a=this,b=a.rawConfig;E.show({entityType:21,searchParam:b.getBatchCond()})}function k(a){var b=this,c=b.rawConfig,d=c.getBatchCond();M.removeDb(M.DB_FILTER),M.setDb(M.DB_COND,d);var e=c.module.getNavUrl("resume",{action:"deliver/preview/index",id:1===a?d.ids[0]:null,stage:b.stage,referralStage:b.getReferralStage()});window.open(e)}function l(){var a=this,b=a.rawConfig;K.download(b.getBatchCond(),{taskTitle:b.getDownloadName("pdf")})}function m(){var a=this,b=a.rawConfig;K.downloadExcel(b.getBatchCond(),{})}function n(a,b,c){var d=this,e=d.rawConfig;e.getPaperData(function(b){H.show({module:d.module,projectId:e.getProjectId(),papers:b,isReferral:c.isReferral,deliverNum:a,searchBody:e.getBatchCond(),listeners:{refreshSummary:function(){d.fire("refreshSummary")}}})})}function o(a,b,c){var d=this,e=d.rawConfig;I.show({batchCount:a,batchCond:e.getBatchCond(),isReferral:c.isReferral,module:d.module,paperData:e.getSummary()[c.isReferral?"referralPaperList":"paperList"],listeners:{updateSearchData:function(){d.fire("updateSearchData")}}})}function p(a,b,c){var d=this,e=d.rawConfig;J.show({batchCount:a,batchCond:e.getBatchCond(),isReferral:c.isReferral,module:d.module,projectData:e.getSummary()[c.isReferral?"referralInterviewProjectList":"interviewProjectList"],listeners:{updateSearchData:function(){d.fire("updateSearchData")}}})}function q(a,b,c){var d=this,e=d.rawConfig;F.show({isBatch:!0,batchCount:a,batchCond:e.getBatchCond(),isReferral:c.isReferral,module:d.module,projectId:e.getProjectId(),summaryData:e.getSummary(),ok:function(){d.fire("refreshSummary")}})}function r(a,b){var c=this,d=c.rawConfig,e=d.getSummary(),f=K.getStageName(e.stageList,a.toStage,a.toSubStage);O.batchTransfer({type:"POST",body:w.extend(d.getBatchCond(),a),call:function(a){var d=B.mask("转移中...");L.getTaskProgress(!0,a.data,function(a){var e=a.content;if(a.error)d.close(),B.alert(e);else if(a.end){if(d.close(),b)return void B.tips("操作成功！",function(){c.fire("refreshSummary")});B.tips("有"+e+"名同学已转移至【"+f.stageName+(f.subStageName?"-"+f.subStageName:"")+"】",function(){c.fire("refreshSummary")})}else e&&"暂无进度"!==e&&d.getEl(".warning-word").html(e)})},error:function(a){B.alert(a.msg)}})}function s(){var a=this,b=[];return w.forEach(a.rawConfig.getSummary().stageList,function(a){var c=a.stage;!(N.has(110)||N.has(111)||N.has(112))||7!==c&&8!==c&&9!==c||b.push(c)}),b}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Base,x=t.Clazz,y=t.Component,z=u.Select,A=u.CheckBox,B=u.Popup,C=(u.Tips,a("../../cpn/popupBatchTransfer")),D=a("../../cpn/popupBatchAddTag"),E=a("../../cpn/popupBatchDeleteTag"),F=a("../../cpn/popupInterviewProject"),G=a("../../cpn/popupConnectPaper"),H=a("../../cpn/popupSettlePaper"),I=a("./popupBatchCancelTest"),J=a("./popupBatchCancelInterview"),K=a("../../../../extend/bll/resumeDeliver"),L=a("../../../../extend/bll/task"),M=a("../../util"),N=a("../../../../../../util/switch"),O=a("../../../../../../action/resumeDeliver"),P=c.exports=x.create();x.mix(P,y,{_template:['<div class="manage-hd clearfix">','<ul class="manage-hd-oprt js-batch-ul" style="padding:10px 10px 0px 0px;line-height:30px;"></ul>','<div class="result-info">','<span class="result-num">共<span class="font-green js-count"></span>份</span>','<span>每页显示 <div class="js-pagesize"></div></span>','<label class="checkbox label-sm js-unread-ck" style="width:auto; margin-left:10px">','<span class="icons"></span>隐藏已查看的',"</label>",'<label class="checkbox label-sm js-order-ck" style="width:auto; margin-left:10px">','<span class="icons"></span>智能排序',"</label>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.module,a.initCpns()}},{name:"click .js-action",handler:function(a){var b=this,c=b.rawConfig.getSelectCount();if(1>c)return B.alert("请先选择投递简历");var d=v(a.currentTarget),e=d.attr("data-index"),f=d.attr("data-sub-index"),g=(b.stageMap[b.stage]||[])[e]||{};if(g.sub){var h=g;g=h.sub[f]||{}}w.isFunction(b[g.method])&&b[g.method](c,g,h)}},{name:"click .js-connect-test",handler:function(a){var b=this,c=b.rawConfig;c.getPaperData(function(d){var e=v(a.currentTarget).attr("data-index"),f=(b.stageMap[b.stage]||[])[e]||{};G.show({module:b.module,projectId:c.getProjectId(),papers:d,isReferral:f.isReferral,summary:c.getSummary(),type:f.isReferral?8:2,refreshSummary:function(){b.fire("refreshSummary")}})})}},{name:"click .js-connect-interview",handler:function(a){var b=this,c=b.rawConfig;c.getProjectData(function(d){var e=v(a.currentTarget).attr("data-index"),f=(b.stageMap[b.stage]||[])[e]||{};G.show({module:b.module,projectId:c.getProjectId(),project:d,isReferral:f.isReferral,summary:c.getSummary(),type:f.isReferral?9:3,refreshSummary:function(){b.fire("refreshSummary")}})})}},{name:"click .js-interview-result",handler:function(a){var b=this,c=b.rawConfig,d=c.getSummary(),e=v(a.currentTarget).attr("data-index"),f=(b.stageMap[b.stage]||[])[e]||{},g=!!d[f.isReferral?"referralWeixinScope":"weixinScope"];O.updateWeixinScope({type:"PUT",body:{projectId:c.getProjectId(),isReferral:f.isReferral,scope:g?0:1},call:function(){var a=["设置对学生",g?"显示":"隐藏","面试结果成功"].join("");B.tips(a,function(){b.fire("refreshSummary")})},error:function(a){B.alert(a.msg)}})}}]},{initCpns:d,fixAction:e,fixCount:f,transferPopup:g,transfer:h,addTag:i,cancelTag:j,readResume:k,downloadPDF:l,downloadExcel:m,settleTest:n,cancelTest:o,cancelInterview:p,settleInterview:q,transferStage:r,getReferralStage:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../cpn/roundOffLine","../cpn/searchTarget","../cpn/popupSearchTarget","../../../../../action/resumeDeliver","../../util/util"],function(a,b,c){function d(a,b){var c=this,d=c.stage;c.summaryData=a?a:c.summaryData,c.project=b?b:c.project,c.projectId=c.project.id,c.fixResumeStatus(),c.fixDepartment(),c.fixJob(),c.fixTag(),c.fixPositionCount(),c.fixNcsr(),2===d||8===d?(c.fixPaper(),c.fixJudge()):(3===d||9===d)&&(c.fixProject(),c.fixScene())}function e(a){var b=this,c=b.getFilterConfs(a),d=[{border:!1,items:[c.volunteer]},{fold:!0,border:!0,items:[c.resumeStatus,c.department,c.job,c.sendDate]},{fold:!0,items:[c.school,c.edu,c.major]},{fold:!0,items:[c.gender,c.location,c.graduate]},{fold:!0,border:!0,items:[c.tag,c.referral,c.ncsr]},{fold:!0,items:[c.search,c.searchTarget]}],e=[{border:!1,items:[c.volunteer]},{fold:!0,border:!0,items:[c.resumeStatus,c.department,c.job,c.sendDate]},{fold:!0,border:!0,items:[c.paper,c.testTime,c.testProgress,c.grade,c.ifCheat]},{fold:!0,border:!0,items:[c.judge,c.judgeFinish,c.judgeProgress]},{fold:!0,items:[c.school,c.edu,c.major]},{fold:!0,items:[c.gender,c.location,c.graduate]},{fold:!0,border:!0,items:[c.tag,c.referral,c.ncsr]},{fold:!0,items:[c.search,c.searchTarget]}],f=[{border:!1,items:[c.volunteer]},{fold:!0,items:[c.resumeStatus,c.department,c.job,c.sendDate]},{fold:!0,border:!0,items:[c.project,c.scene]},{fold:!0,items:[c.create,c.book,c.start]},{fold:!0,border:!0,items:[c.mode]},{fold:!0,items:[c.school,c.edu,c.major]},{fold:!0,items:[c.gender,c.location,c.graduate]},{fold:!0,border:!0,items:[c.tag,c.referral,c.ncsr]},{fold:!0,items:[c.search,c.searchTarget]}],g=[{border:!1,items:[c.volunteer]},{fold:!0,border:!0,items:[c.resumeStatus,c.department,c.job,c.sendDate]},{fold:!0,items:[c.school,c.edu,c.major]},{fold:!0,items:[c.gender,c.location,c.graduate]},{fold:!0,border:!0,items:[c.tag,c.referral,c.ncsr]},{fold:!0,items:[c.search,c.searchTarget]}];return{0:d,2:e,3:f,6:g,7:d,8:e,9:f}[a]}function f(a){var b=this,c={};c.volunteer={id:"volunteer",title:"投递志愿",type:"select",conf:{options:[]}},c.resumeStatus={id:"status",title:"筛选状态",type:3===a||9===a?"selectMult":"select",conf:{options:[]}},c.department={id:"department",title:"部门",type:"selectMult",conf:{needSearch:!0,options:[],change:function(){b.fixJob()}}},c.job={id:"job",title:"职位",type:"selectMult",conf:{needSearch:!0,options:[]}},c.sendDate={id:"sendDate",title:"投递日期",type:"duration",ext:{today:!0}},c.school={id:"school",title:"学校",type:"school"},c.edu={id:"edu",title:"学历",type:"selectMult",conf:{cls:"filter-item-txt none",options:[{text:"博士",value:"博士"},{text:"硕士",value:"硕士"},{text:"本科",value:"本科"},{text:"专科",value:"专科"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="ico-level"></i>')}}}},c.major={id:"major",title:"专业",type:"input",conf:{placeholder:"多个用空格分隔",listeners:{render:function(){this.getEl().css("marginRight",10).append('<i class="icon-wrench"></i>')}}},ext:{chkTitle:"包含任一专业"}},c.gender={id:"gender",title:"性别",type:"select",conf:{options:[{text:"不限",value:"不限",checked:!0},{text:"男",value:"男"},{text:"女",value:"女"}]}},c.location={id:"location",title:"所在地",type:"selectMult",conf:{cls:"filter-item-txt none",needSearch:!0,options:[{text:"北京",value:"北京"},{text:"上海",value:"上海"},{text:"广州",value:"广州"},{text:"深圳",value:"深圳"},{text:"杭州",value:"杭州"},{text:"南京",value:"南京"},{text:"西安",value:"西安"},{text:"武汉",value:"武汉"},{text:"哈尔滨",value:"哈尔滨"},{text:"长春",value:"长春"},{text:"成都",value:"成都"},{text:"长沙",value:"长沙"},{text:"合肥",value:"合肥"},{text:"其他",value:"其他"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="icon-map-marker"></i>')}}}};var d=(new Date).getFullYear();return c.graduate={id:"graduate",title:"毕业年份",type:"selectMult",conf:{options:B.map(B.range(d-3,d+5,1).reverse(),function(a){return{text:a+"年",value:B.id(a)}})}},c.tag={id:"tag",title:"标签",type:"selectMult",conf:{needSearch:!0,options:[]}},c.referral={id:"referral",title:"内推",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"是",value:"1"},{text:"否",value:"2"}]}},c.ncsr={id:"ncsr",title:"投递来源",type:"selectMult",conf:{needSearch:!0,options:[]}},c.search={id:"search",title:"关键词",type:"search",conf:{placeholder:"姓名/手机/邮箱/ACM/实习信息等，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的简历，多个关键词用空格分割"}},c.searchTarget={id:"searchTarget",condTitle:"搜索指定名单",type:"diy",create:function(a,c,d){var e=new F({renderTo:a,renderBy:"html",module:b.module,projectId:b.projectId,stage:b.stage,search:function(){b.submit()}});d.cpn=e},condVal:function(a){return B.isFunction(a.getSearchIdLength)&&a.getSearchIdLength()},clear:function(a){B.isFunction(a.clearData)&&a.clearData()}},c.paper={id:"paper",title:"笔试试卷",type:"selectMult",conf:{needSearch:!0,options:[]}},c.testTime={id:"testTime",title:"考试时间段",type:"duration",ext:{today:!0}},c.testProgress={id:"testProgress",title:"笔试进度",type:"select",conf:{options:[{text:"不限",value:-1,checked:!0},{text:"未到场",value:1},{text:"已打开",value:2},{text:"已提交",value:3}]}},c.grade={id:"grade",title:"成绩区间",type:"range"},c.ifCheat={id:"ifCheat",title:"是否作弊",type:"select",conf:{options:[{text:"不限",value:-1,checked:!0},{text:"是",value:1},{text:"否",value:2}]}},c.judge={id:"judge",title:"人工阅卷",type:"select",conf:{options:[{text:"不限",value:"-1"},{text:"是",value:"1"},{text:"否",value:"0"}],change:B.bind(b.fixJudge,b)}},c.judgeFinish={id:"judgeFinish",title:"判卷完毕",type:"select",conf:{options:[{text:"不限",value:"-1"},{text:"是",value:"1"},{text:"否",value:"0"}],change:B.bind(b.fixJudge,b)}},c.judgeProgress={id:"judgeProgress",title:"阅卷进度",type:"selectMult",conf:{options:[]}},c.project={id:"project",title:"面试项目",type:"selectMult",conf:{needSearch:!0,options:[]}},c.scene={id:"scene",title:"面试场次",type:"selectMult",conf:{needSearch:!0,options:[]}},B.map([{id:"create",title:"面试创建日期"},{id:"book",title:"预约日期"},{id:"start",title:"实际面试日期"}],function(a){c[a.id]={id:a.id,title:a.title,type:"duration",ext:{today:!0}}}),c.mode={id:"mode",type:"diy",create:B.bind(b.createRoundOfflineList,b),condTitle:"面试方式",condVal:function(a){return B.map(a.valText(),function(a){return"第"+a.round+"轮: "+a.text})}},c}function g(){var a=this,b=a.stage,c=B.find(a.summaryData.stageList,function(a){return a.stage===b})||{},d=B.map(c.subStageList,function(a){return{text:a.subName,value:a.subStage}})||[];3===b||9===b||d.unshift({text:"不限",value:-1,checked:!0}),a.filter.getItem("status").replaceOptions(d)}function h(){var a=this;a.filter.getItem("department").replaceOptions(B.map(a.summaryData.departmentList,function(a){return{text:a.departmentName||"默认部门",value:a.departmentName||"默认部门"}}))}function i(){var a=this,b=a.filter,c=[],d=b.getItem("department").val()||[];B.forEach(a.summaryData.departmentList,function(a){(0===d.length||B.contains(d,a.departmentName||"默认部门"))&&B.forEach(a.jobList,function(a){c.push({text:a.name,value:B.id(a.id),checked:!0,position:a.position})})}),c.sort(function(a,b){return a.position-b.position}),B.forEach(c,function(a){delete a.position}),b.getItem("job").replaceOptions(c)}function j(){var a=this;a.filter.getItem("tag").replaceOptions(B.map(a.summaryData.tagList,function(a){return{text:a,value:a}}))}function k(){var a=this;a.filter.getItem("paper").replaceOptions(B.map(a.summaryData[8===+a.stage?"referralPaperList":"paperList"],function(a){return{text:a.paperName,value:B.id(a.id)}}))}function l(){var a=this;a.filter.getItem("project").replaceOptions(B.map(a.summaryData[9===+a.stage?"referralInterviewProjectList":"interviewProjectList"],function(a){return{text:a.name,value:B.id(a.id)}}))}function m(){var a=this;a.filter.getItem("scene").replaceOptions(B.map(a.summaryData[9===+a.stage?"referralSceneList":"sceneList"],function(a){return{text:a.name,value:B.id(a.id)}}))}function n(){var a=this,b=a.filter,c=a.volunteerOption=[{text:"不限",value:0,checked:!0}],d=Math.min(a.project.deliverJobLimit||9999,a.project.jobCount);B.forCount(d,function(a){a+=1,c.push({text:"第"+a+"志愿",value:a})}),a.filter.getItem("volunteer").replaceOptions(c);var e=d>1;b.getItemEl("volunteer")[e?"show":"hide"](),b.getItemConf("volunteer").condHide=!e,b.updateCond()}function o(){var a=this,b=a.filter,c=b.getItem("judge"),d=b.getItemConf("judgeFinish"),e=b.getItem("judgeFinish"),f=b.getItemEl("judgeFinish"),g=b.getItemConf("judgeProgress"),h=b.getItem("judgeProgress"),i=b.getItemEl("judgeProgress"),j=c.val(),k=e.val(),l={text:"无需分配",value:"-1",checked:!0},m={text:"待判题",value:"0",checked:!0},n={text:"部分题目已判题",value:"1",checked:!0},o={text:"已判题",value:"2",checked:!0},p={text:"待分配",value:"3",checked:!0},q={text:"无需人工阅卷",value:"4",checked:!0},r={"-11":[l,q,o],"-10":[p,m,n],"1-1":[l,m,o,p,n],11:[l,o],10:[m,p,n]}[j+k]||[],s=r.length>0,t="0"!==j;f[t?"show":"hide"](),d.condHide=!t,h.replaceOptions(r),i[s?"show":"hide"](),g.condHide=!s,b.updateCond()}function p(){var a=this;a.filter.getItem("ncsr").replaceOptions(B.map(a.summaryData.ncsrs,function(a){return{text:a,value:a}}))}function q(a){var b=this,c=b.filter,d=b.stage;if(c){var e=c.getItem("department"),f=c.getItem("job"),g=c.getItem("sendDate"),h=c.getItem("edu"),i=c.getItem("school"),j=c.getItem("major"),k=c.getItem("gender"),l=c.getItem("location"),m=c.getItem("graduate"),n=c.getItem("tag"),o=c.getItem("referral"),p=c.getItem("ncsr"),q=c.getItem("search"),r=c.getItem("status"),s=c.getItem("paper"),t=c.getItem("testTime"),u=c.getItem("testProgress"),v=c.getItem("grade"),w=c.getItem("ifCheat"),x=c.getItem("judge"),z=c.getItem("judgeProgress"),A=c.getItem("searchTarget"),D=c.getItem("volunteer"),E=c.getItem("project"),F=c.getItem("scene"),H=c.getItem("create"),I=c.getItem("book"),J=c.getItem("start"),K=c.getItem("mode");if(0===arguments.length){var a={graduationYearList:G.wrapVal(m.val()),liveAddressList:G.wrapVal(l.val()),schoolList:G.wrapVal(i.getSchool()),eduLevelList:G.wrapVal(h.val()),majorList:G.wrapVal(G.split(j.ipt.val())),gender:{"男":"男","女":"女"}[k.val()]||void 0,tagList:G.wrapVal(n.val()),ncSrs:G.wrapVal(p.val()),keywordList:G.wrapVal(G.split(q.ipt.val())),jobIds:G.wrapVal(f.val()),projectId:G.wrapVal(b.projectId),deliverBegin:g.startIpt.val()?g.startIpt.val()+" 00:00:00":void 0,deliverEnd:g.endIpt.val()?g.endIpt.val()+" 23:59:59":void 0,union:G.wrapNum(q.chk.isChecked()?1:0),majorUnion:G.wrapNum(j.chk.isChecked()?1:0),departmentList:G.wrapVal(e.val()),stage:G.wrapNum(b.stage),subStage:G.wrapVal(-1===r.val()?void 0:r.val()),referral:G.wrapNum(o.val()),searchIds:A.val().searchId,searchIdType:A.val().searchType-1,positionSet:D.val()?[D.val()]:null};return(2===d||8===d)&&B.extend(a,{paperIds:s.val(),testFinishBeginTime:t.startIpt.val()?t.startIpt.val()+" 00:00:00":void 0,testFinishEndTime:t.endIpt.val()?t.endIpt.val()+" 23:59:59":void 0,minScore:G.wrapVal(v.startIpt.val()),maxScore:G.wrapVal(v.endIpt.val()),isCheated:-1===w.val()?void 0:1===w.val(),testStatus:-1===u.val()?void 0:u.val(),judgeType:"-1"===x.val()?void 0:x.val(),judgeStatusList:z.val()}),(3===d||9===d)&&B.extend(a,{interviewBegin:J.startIpt.val()?J.startIpt.val()+" 00:00:00":void 0,interviewEnd:J.endIpt.val()?J.endIpt.val()+" 23:59:59":void 0,interviewBookBegin:I.startIpt.val()?I.startIpt.val()+" 00:00:00":void 0,interviewBookEnd:I.endIpt.val()?I.endIpt.val()+" 23:59:59":void 0,interviewCreateBegin:H.startIpt.val()?H.startIpt.val()+" 00:00:00":void 0,interviewCreateEnd:H.endIpt.val()?H.endIpt.val()+" 23:59:59":void 0,offlineJson:0===K.val().length?void 0:JSON.stringify(K.val()),interviewProjectIdList:0!==E.val().length?E.val():void 0,interviewSceneIdList:0!==F.val().length?F.val():void 0}),B.forEach(a,function(b,c){void 0===b&&delete a[c]}),a}a=B.isObject(a)?a:{},e.val(a.departmentList),f.val(a.jobIds),g.todayChk.checked(!1),g.todayChk.fire("change"),g.startIpt.val(a.deliverBegin?C.form(new Date(a.deliverBegin),"yyyy-MM-dd"):""),g.endIpt.val(a.deliverEnd?C.form(new Date(a.deliverEnd),"yyyy-MM-dd"):"");var L=(a.schoolList||[]).join(",");i.val(L).getEl().attr("title",L),h.val(a.eduLevelList),j.ipt.val((a.majorList||[]).join(" ")),j.chk.checked("1"===B.id(a.majorUnion)),k.val(a.gender||"不限"),l.val(a.liveAddressList),m.val(a.graduationYearList),n.val(a.tagList||[]),o.val(a.referral||"0"),p.val(a.ncSrs||[]),q.ipt.val((a.keywordList||[]).join(" ")),q.chk.checked("1"===B.id(a.union)),r.val(void 0===a.subStage?-1:a.subStage);var M=(a.positionSet||[])[0],N=B.find(b.volunteerOption,function(a){return B.id(a.value)===B.id(M)});D.val(N?M:0),A.val({searchId:a.searchIds||"",searchType:(a.searchIdType||0)+1}),(2===d||8===d)&&(s.val(a.paperIds),t.startIpt.val(a.testFinishBeginTime?C.form(new Date(a.testFinishBeginTime),"yyyy-MM-dd"):""),t.endIpt.val(a.testFinishEndTime?C.form(new Date(a.testFinishEndTime),"yyyy-MM-dd"):""),v.startIpt.val(y.trim(a.minScore)),v.endIpt.val(y.trim(a.maxScore)),w.val(void 0===a.isCheated?-1:a.isCheated?1:2),u.val(a.testStatus?+a.testStatus:-1),x.val(a.judgeType?a.judgeType:"-1"),(a.judgeStatusList||[]).length>0&&z.val(a.judgeStatusList)),(3===d||9===d)&&(J.startIpt.val(a.interviewBegin?b.getFomDate(a.interviewBegin):""),J.endIpt.val(a.interviewEnd?b.getFomDate(a.interviewEnd):""),I.startIpt.val(a.interviewBookBegin?b.getFomDate(a.interviewBookBegin):""),I.endIpt.val(a.interviewBookEnd?b.getFomDate(a.interviewBookEnd):""),H.startIpt.val(a.interviewCreateBegin?b.getFomDate(a.interviewCreateBegin):""),H.endIpt.val(a.interviewCreateEnd?b.getFomDate(a.interviewCreateEnd):""),K.val(B.json(a.offlineJson)||[]),E.val(a.interviewProjectIdList),F.val(a.interviewSceneIdList))}}function r(){var a=this,b=a.filter,c=a.val(),d=!0,e={sendDate:{begin:"deliverBegin",end:"deliverEnd",tip:"结束日期不能早于开始日期"},testTime:{begin:"testFinishBeginTime",end:"testFinishEndTime",tip:"结束日期不能早于开始日期"},start:{begin:"interviewBegin",end:"interviewEnd",tip:"结束日期不能早于开始日期"},book:{begin:"interviewBookBegin",end:"interviewBookEnd",tip:"结束日期不能早于开始日期"},create:{begin:"interviewCreateBegin",end:"interviewCreateEnd",tip:"结束日期不能早于开始日期"},grade:{begin:"minScore",end:"maxScore",tip:"起始成绩不能高于结束成绩"}};return B.forEach(e,function(a,e){var f=b.getItem(e);c[a.begin]&&c[a.end]&&f&&+c[a.begin]>+c[a.end]&&(f.startIpt.setErrorTips(a.tip),f.startIpt.getEl(".input-tip").width(200),d=!1)}),d}function s(){var a=this,b=a.rawConfig;b.ok&&a.check()&&b.ok(a.val())}function t(a,b,c){a.removeClass().prepend('<label class="filter-label-left">面试方式</label>'),c.cpn=new E({renderTo:a}),c.cpn.val([])}function u(a){return C.form(new Date(a),"yyyy-MM-dd")}function v(){var a=this;return"ResumeDeliverCondition_"+a.projectId+"_"+a.stage}var w=a("nc"),x=a("cpn"),y=w.$,z=w.Component,A=w.Clazz,B=w.Base,C=w.Time,D=(x.Popup,a("../../../../../component/filter/filter")),E=a("../cpn/roundOffLine"),F=a("../cpn/searchTarget"),G=a("../../util/util"),H=c.exports=A.create();A.mix(H,z,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.stage=b.stage,a.summaryData=b.summary||{},a.project=b.project,a.projectId=a.project.id,a.module=b.module;var c=a.getLine(a.stage);return c?(a.filter=new D({renderTo:a.getEl(),submitTxt:"查询",line:c,clearAll:function(){a.val({})},getCondInfo:function(b,c){0===+b&&c&&c({key:a.getCondKey(),name:{0:"简历初选",2:"笔试",3:"面试",6:"待发offer",7:"内推简历初选",8:"内推笔试",9:"内推面试"}[a.stage],content:a.val()}),1===+b&&c&&c({key:a.getCondKey(),call:function(b){a.val(b)}})},listeners:{submit:B.bind(a.submit,a)}}),a.val({}),void a.refresh()):b.module.renderNone("暂无数据")}}]},{refresh:d,getLine:e,getFilterConfs:f,fixResumeStatus:g,fixDepartment:h,fixJob:i,fixTag:j,fixPaper:k,fixProject:l,fixScene:m,fixPositionCount:n,fixJudge:o,fixNcsr:p,val:q,check:r,submit:s,createRoundOfflineList:t,getFomDate:u,getCondKey:v})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../cpn/roundOffLine","../cpn/searchTarget","../cpn/popupSearchTarget","../../../../../action/resumeDeliver","../../util/util","./list","../../../../../component/popupSub/popupIvDeliver","../../../../../util/interview","../../../../../action/interview","../../../../../action/resume","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../../interview/cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interviewV2","../../../../../component/popupSub/popupIvScore","../../../../../component/selectAll","../../../../../component/table","../cpn/popupInterviewProject","../../../extend/bll/interview","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","./cpn/toolBar","../cpn/popupBatchTransfer","../cpn/popupBatchAddTag","../cpn/popupBatchDeleteTag","../cpn/popupConnectPaper","../cpn/popupSettlePaper","./cpn/popupBatchCancelTest","./cpn/popupBatchCancelInterview","../../../extend/bll/resumeDeliver","../../../extend/event","../util","./cpn/popupPaperView","../../../../../action/paper","../../../extend/bll/paper","../../../extend/bll/serverTime","../../../../../action/position","../../../extend/bll/resume"],function(a,b,c){function d(a){function b(a){var b=c.projectMap=c.projectMap||{};b[a.id]=a}var c=this,d=c.getParam();c.projectData=a,c.getEl().html(['<div class="project-types clearfix">',v.has(130)?['<div class="project-count">','<a href="javascript:void(0);" class="resume-count js-go-analyze">简历统计</a>',"</div>"].join(""):"",'<div class="project-types-pic">','<img src="//uploadfiles.nowcoder.com/images/20170215/56_1487137391502_7060599B1E63FB274C2BA6B32CBD2AD6" />',"</div>",'<div class="project-types-main js-project-home"></div>',"</div>",'<div class="js-main"></div>','<div class="js-tip"></div>'].join("")),c.projectSelect=new p({renderTo:c.getEl(".js-project-home"),renderBy:"html",autoWidth:!0,needSearch:!0,options:m.map(a,function(a,c){return b(a),{text:a.name,value:m.id(a.id),checked:d.projectId&&"0"!==d.projectId?d.projectId===m.id(a.id):0===c}}),change:function(){var a=c.projectId,b=c.projectId=this.val();c.getSummary(function(a){c.summaryData=a,c.addParam({projectId:b}),c.refreshStageBar(a)},function(b){x.alert(b),c.projectSelect.val(a),c.projectId=a})}}),c.projectId=c.projectSelect.val(),c.addParam({projectId:c.projectId})}function e(a){var b=this;b.summaryData=a,b.getEl(".js-main").html(['<div class="menu-box">','<ul class="menu clearfix js-stage-home"></ul>','<div class="menu-oprtbar">','<div class="resume-num" style="display:inline-block;">共收到简历 <span class="js-count-total"></span></div>','<a href="javascript:void(0);" class="font-green js-go-check-all" style="font-size:14px;margin-right:20px;">查看全部投递</a>',"</div>","</div>",'<div class="manage-box">','<div class="manage-bd">',m.map([0,2,3,6,7,8,9],function(a){return'<div class="js-filter js-filter-'+a+'" data-stage="'+a+'" style="display:none;"></div>'}).join(""),"</div>","</div>",'<div class="js-list-home"></div>'].join("")),b.refreshStageBar(a)}function f(a){function b(a){c.getEl(".js-count-total").html(a.totalCount),m.forEach(a.stageList,function(a){c.getEl(".js-count-"+a.stage).html(a.deliverCount)})}var c=this,d=c.summaryData;c.stage=a+="",c.addParam({stage:a}),m.forEach(c.getEl(".js-stage"),function(b){b=n(b),b[b.attr("data-stage")===a?"addClass":"removeClass"]("selected")}),m.forEach(c.getEl(".js-filter"),function(b){b=n(b),b[b.attr("data-stage")===a?"show":"hide"]()});var e=c.projectMap[c.projectId];c["filter"+a]?c.getCurFilter().refresh(d,e):c["filter"+a]=new r({renderTo:c.getEl(".js-filter-"+a),stage:+a,summary:d,project:e,module:c,ok:function(){c.refreshList(!0)}}),c.list?c.refreshList(!0):c.list=new s({renderTo:c.getEl(".js-list-home"),module:c,project:c.projectMap[c.projectId],summary:c.summaryData,stage:c.stage,filter:c.getCurFilter().val(),listeners:{refreshSummary:function(){c.getSummary(function(a){c.summaryData=a,b(a),c.getCurFilter().refresh(a),c.refreshList()},function(a){c.renderNone(c.getEl(),a)})}}})}function g(a){var b=this,c=!1,d=b.getParam().stage,e={7:110,8:111,9:112,0:113,2:114,3:115,6:116},f=m.filter(a.stageList,function(a){return v.has(e[a.stage])})||[];b.getEl(".js-count-total").html(a.totalCount),b.getEl(".js-stage-home").html(m.map(f,function(a){return c=c||+a.stage===+d,100===a.stage?"":['<li class="js-stage" data-stage="',a.stage,'">','<a href="javascript:void(0);">',a.name,'(<span class="js-count-',a.stage,'">',a.deliverCount,"</span>)</a>","</li>"].join("")}).join("")),0===f.length?(b.getEl(".js-main").hide(),b.getEl(".js-tip").show(),b.renderNone(b.getEl(".js-tip"),"暂无数据")):(b.getEl(".js-main").show(),b.getEl(".js-tip").hide(),b.selectStage(c?d:(f[0]||{}).stage),b.getEl(".js-go-check-all")[f.length<a.stageList.length-1?"hide":"show"]())}function h(a){var b=this;b.list.refresh({project:b.projectMap[b.projectId],stage:b.stage,filter:b.getCurFilter().val(),summary:b.summaryData,refresh:a})}function i(a,b){var c=this;t.getSummary({params:{userId:c.getUserId()},query:{projectId:c.projectId},call:function(b){var c=m.isObject(b.data)?b.data:{};m.isFunction(a)&&a(c)},error:function(a){m.isFunction(b)?b(a.msg):x.alert(a.msg)}})}function j(){var a=this;return a["filter"+a.stage]}var k=a("nc"),l=a("cpn"),m=k.Base,n=k.$,o=k.Clazz,p=l.Select,q=a("../../../../../core/module"),r=a("./filter"),s=a("./list"),t=a("../../../../../action/resumeDeliver"),u=a("../../../../../action/position"),v=a("../../../../../util/switch"),w=(a("../../util/util"),a("../../../extend/bll/resume")),x=l.Popup,y=c.exports=o.create();o.mix(y,q,{style:"/stylesheets/styles/system/resumeManage.css",title:"应聘管理",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){function a(a){u.listRecruitProject({query:{version:1},call:function(b){a(w.filterStatus(b.data||[],0))},error:function(a){b.renderNone(c,a.msg)}})}var b=this,c=(b.getParam(),b.getEl());b.renderWait(c,"加载中..."),a(function(a){return 0===a.length?void b.renderNone(c,"您尚未创建招聘项目！"):(b.initProjectBar(a),b.renderWait(b.getEl(".js-main"),"加载中..."),void b.getSummary(function(a){b.initFilterContainer(a)},function(a){b.renderNone(b.getEl(".js-main"),a)}))}),b.sizeScroll()}},{name:"click .js-go-analyze",handler:function(){var a=this;a.nav("resume",{action:"analyze/index",projectId:a.projectId})}},{name:"click .js-go-check-all",handler:function(){var a=this;a.nav("resume",{action:"deliver/checkAll/index",projectId:a.projectId})}},{name:"click .js-stage",handler:function(a){var b=this;b.selectStage(n(a.currentTarget).attr("data-stage"))}}]},{initProjectBar:d,initFilterContainer:e,selectStage:f,refreshStageBar:g,refreshList:h,getSummary:i,getCurFilter:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/index/list",["nc","cpn","../../../../../component/popupSub/popupIvDeliver","../../../../../util/interview","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/interview","../../../../../util/ajax","../../../../../action/resume","../../../../../component/popupSub/popupIvEdit","../../../../../util/switch","../../../../../component/popupSub/popupIvSucc","../../../../../component/popupSub/popupJoinSession","../../../../../action/interviewProject","../../../../../action/interviewSchedule","../../../interview/cpn/interviewSceneForm","../../../../../component/dateSelect","../../../extend/bll/task","../../../extend/bll/base","../../../../../action/api","../../../../../component/department","../../../../../action/user","../../../../../action/interviewV2","../../../../../action/resumeDeliver","../../../../../component/popupSub/popupIvScore","../../../../../component/selectAll","../../../../../component/table","../cpn/popupInterviewProject","../../../extend/bll/interview","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","./cpn/toolBar","../cpn/popupBatchTransfer","../cpn/popupBatchAddTag","../cpn/popupBatchDeleteTag","../cpn/popupConnectPaper","../cpn/popupSettlePaper","./cpn/popupBatchCancelTest","./cpn/popupBatchCancelInterview","../../../extend/bll/resumeDeliver","../../../extend/event","../../../../../action/common","../util","./cpn/popupPaperView","../../../../../action/paper","../../../extend/bll/paper","../../../extend/bll/serverTime"],function(a,b,c){function d(){var a=this;a.getPapers(null,!0),a.getProject(null,!0),a.getDepartment(null,!0)}function e(){{var a=this,b=a.getEl();a.rawConfig.module.getParam()}a.tableCpn=new B({renderTo:b.find(".js-table"),needSelect:!0,needFixHeader:!0,pageChange:function(b){a.page=b,a.search()}}),a.toolBar=new D({renderTo:b.find(".js-tool-bar"),renderBy:"replaceWith",module:a.rawConfig.module,getProjectId:function(){return a.projectId},getBatchCond:function(){return a.getBatchCond()},getSummary:function(){return a.summaryData},getSelectCount:function(){return a.getSelectCount()},getDownloadName:function(b){var c=a.getBatchCond();if(2===c.isAll&&1===c.ids.length){var d=c.ids[0]+"",e=v.find(a.data.data,function(a){return a.id+""===d});return((e||{}).candidateName||"简历")+"."+b}return"简历("+a.getSelectCount()+"份).zip"},getPaperData:function(b){a.getPapers(b)},getProjectData:function(b){a.getProject(b)},listeners:{refreshSummary:function(){a.fire("refreshSummary")},updateSearchData:function(){a.refresh()},pageSize:function(b){a.pageSize=b,a.page=1,a.search()},unread:function(b){a.unread=b,a.page=1,a.search()},orderBy:function(b){a.orderBy=b,a.page=1,a.search()}}}),a.pageSize=a.toolBar.pageSizeCpn.val(),a.unread=a.toolBar.unreadCpn.isChecked()?1:0;var c=+a.stage;a.orderBy=(0===c||7===c)&&a.toolBar.orderCpn.isChecked()?1:0}function f(a){var b=this;a=a||{};var c=b.project=a.project||b.project;b.projectId=c.id,b.stage=void 0===a.stage?b.stage:a.stage,b.filter=a.filter||b.filter,b.summaryData=a.summary||b.summaryData,b.jobLimitCount=Math.min(c.deliverJobLimit||9999,c.jobCount),a.refresh&&(b.page=1),a.inited||(b.fixBatchBtn(),b.search())}function g(){var a=this,b=a.rawConfig;a.tableCpn.renderWait(),G.search({params:{userId:b.module.getUserId()},body:a.getCond(),call:function(b){var c=a.data=b.data||{};return 0!==c.totalPage&&c.currentPage>c.totalPage?(a.page=c.totalPage,a.search()):void(b.isOrder&&(a.toolBar.fixCount(c.totalCount),a.renderList(c)))},error:function(b){b.isOrder&&a.tableCpn.renderNone(b.msg)}})}function h(){var a=this;a.toolBar.fixAction(a.stage)}function i(a){var b=this,c=b.rawConfig.module,d=+b.stage;if(b.tableCpn.selectAll.clear(),0===(a.data||[]).length)return b.tableCpn.renderNone();var e={0:"#E6F7F4",2:"#F9F4E3",3:"#E6EFF7",6:"FCE7E2",7:"#E6F7F4",8:"#F9F4E3",9:"#E6EFF7"}[d],f={"text-align":"center"},g={"text-align":"center","background-color":e},h=b.jobLimitCount<=1,i=[{text:"投递编号",style:f,width:"8%"},{text:"网申职位",style:f,width:"6%"},{text:"其他网申职位",style:f,width:"8%"},{text:"姓名",style:f,width:"6%"},{text:"性别",style:f,width:"3%"},{text:"学校",style:f},{text:"专业",style:f},{text:"最高学历",style:f,width:"6%"},{text:"所在地",style:f,width:"6%"},{text:"阶段",style:g},{text:"状态",style:g}];h&&i.splice(2,1),(3===d||9===d)&&i.push({text:"面试项目",style:g}),(2===d||8===d)&&(i=i.concat([{text:"笔试时间",style:g,width:"6%"},{text:"笔试试卷",style:g,width:"6%"},{text:"得分",style:g},{text:"作弊",style:g},{text:"判卷完毕",style:g,width:"6%"}])),(2===d||8===d)&&K.has(124)&&i.push({text:"试卷查看",style:g,width:"6%"}),(3===d||9===d)&&i.push({text:"面试得分",style:g,width:"6%"}),(3===d||9===d)&&K.has(125)&&i.push({text:"评价详情",style:g,width:"6%"}),(3===d||9===d)&&i.push({text:"面试时间",style:g,width:"6%"}),i.push({text:"操作账号",style:f,width:"6%"}),K.has(120)&&i.push({text:"简历查看",width:"6%",style:f});var j={head:i,list:[]};b.searchData={},v.forEach(a.data,function(a,e){var f=(a.writeRecordList||[])[0]||{},g=(a.rounds||[])[a.latestInterviewRound-1]||{},i=a.jobNameList||[],k=a.position,l=[("0"===v.id(a.unread)?"":'<i class="icon-spot-red"></i>')+v.id(a.id),i.length>0?'<a href="javascript:void(0);" class="link-green js-job-detail">'+(h?"":'<span class="resume-rank rank'+k+'">'+k+"</span> ")+i[0]+"</a>":"无",i.length>1?'<a href="javascript:void(0);" class="link-green js-job-detail">'+i.slice(1).join(" | ")+"</a>":"无",a.referral?'<span class="js-tips" title="内推员工：'+a.source+'">'+a.candidateName+'<span class="tag-push'+(v.contains([0,2,3],d)?"-gray":"")+'">荐</span><span>':a.candidateName,a.candidateGender,a.candidateSchool,a.candidateMajor,a.candidateEduLevel,a.candidateLiveAddress,{0:"简历初选",2:"笔试",3:"面试",6:"待发offer",7:"内推简历初选",8:"内推笔试",9:"内推面试"}[d],"待安排"!==a.subStageName||3!==d&&9!==d||!K.can(["resumeArrangeInterview","interview"],"every")?a.subStageName:a.subStageName+'<a href="javascript:void(0);" class="font-green js-create-interview" style="margin-left:5px;">创建面试</a>'];h&&l.splice(2,1),(3===d||9===d)&&l.push(a.interviewProjectName||"暂无"),(2===d||8===d)&&(l=l.concat([v.contains([2,3],f.testStatus)?y.form(new Date(f.ctsBeginTime)):"暂无",f.paperName||"暂无",3===f.testStatus?'<span class="js-tips" title="试卷总分：'+f.ctsPaperScore+'分">'+f.ctsScore+"</span>":"暂无",3===f.testStatus?1===f.ctsCheated?"是":"否":"暂无",'<span class="js-tips" title="'+(f.judgingTip||"")+'">'+(f.judged?"是":f.notJudgedReason?"否（"+f.notJudgedReason+")":"否")+"</span>"])),(2===d||8===d)&&K.has(124)&&l.push(0!==(a.writeRecordList||[]).length?'<a href="javascript:void(0);" class="link-green js-paper-view" data-type="0">点击查看</a>':a.hasWriteHistory?'<a href="javascript:void(0);" class="link-green js-paper-view" data-type="1">历史记录</a>':"暂无"),(3===d||9===d)&&l.push(["","淘汰（1分）","搁置（2分）","标准（3分）","优秀（4分）","卓越（5分）"][g.score]||"暂无"),(3===d||9===d)&&K.has(125)&&l.push(a.interviewId?'<a href="javascript:void(0);" class="link-green js-evaluate-view" data-type="0">查看</a>':a.hasHistory?'<a href="javascript:void(0);" class="link-green js-evaluate-view" data-type="1">历史记录</a>':"暂无"),(3===d||9===d)&&l.push(g.beginTime?y.form(new Date(g.beginTime)):"待定");var m=c.getNavUrl("resume",{action:"deliver/preview/index",id:a.id,stage:b.stage,referralStage:b.getReferralStage(),projectId:b.projectId});l.push(a.transferList.length?'<a href="javascript:void(0);" class="link-green js-transfer-detail">'+a.transferList[0].userName+"</a>":"--"),K.has(120)&&l.push('<a href="'+m+'" target="_blank" class="js-preview btn btn-auto btn-primary btn-xs">查看</a>'),j.list.push({attr:{"class":"js-tr-"+a.id,"data-id":a.id,"data-index":e},items:l}),b.searchData[a.id]=a}),b.tableCpn.updateHtml(j,{totalPage:a.totalPage,currentPage:a.currentPage,totalCount:a.totalCount})}function j(a,b){var c=this;if(c.paperData)return void(a&&a(c.paperData));var d=c.rawConfig.module;F.getSimplePapers({params:{userId:d.getUserId()},query:{},call:function(b){c.paperData=v.filter(b.data||[],function(a){return!a.end}),a&&a(c.paperData)},error:function(a){b||z.alert(a.msg)}})}function k(a){var b=this;return b.projectData?void(a&&a(b.projectData)):void I.getSimpleProject(function(c){b.projectData=c,a&&a(c)})}function l(a,b){var c=this;return c.departmentData?a&&a(c.departmentData):void H.getSimpleFullDepartments({params:{userId:c.rawConfig.module.getUserId()},query:{},call:function(b){var d=c.departmentData=b.data||[];a&&a(d)},error:function(a){b||z.alert(a.msg)}})}function m(){var a=this,b=+a.stage;return v.extend({},a.filter,{currentPage:a.page,pageSize:a.pageSize,unread:a.unread,orderBy:7===b||0===b?a.orderBy:0})}function n(){var a=this,b=+a.stage,c=a.tableCpn.selectAll;return v.extend({},a.filter,{isAll:c.isSelectAll?1:2,ids:c.selectIds,unread:a.unread,orderBy:7===b||0===b?a.orderBy:0})}function o(a){var b=u(a).closest("tr");return u.trim(b.attr("data-id"))}function p(a){var b=u(a).closest("tr");return u.trim(b.attr("data-index"))}function q(){var a=this,b=[];return v.forEach(a.summaryData.stageList,function(a){var c=a.stage;!(K.has(110)||K.has(111)||K.has(112))||7!==c&&8!==c&&9!==c||b.push(c)}),b}function r(){var a=this,b=a.tableCpn.selectAll;return b.isSelectAll?b.totalCount-b.selectIds.length:b.selectIds.length}var s=a("nc"),t=a("cpn"),u=s.$,v=s.Base,w=s.Component,x=s.Clazz,y=(s.Db,s.Time),z=(t.Select,t.Popup),A=(t.Pager,t.Tips,a("../../../../../component/popupSub/popupIvDeliver")),B=(a("../../../../../component/selectAll"),a("../../../../../component/table")),C=a("../cpn/popupInterviewProject"),D=a("./cpn/toolBar"),E=a("./cpn/popupPaperView"),F=a("../../../../../action/api"),G=a("../../../../../action/resumeDeliver"),H=a("../../../../../action/user"),I=a("../../../extend/bll/interview"),J=a("../util"),K=a("../../../../../util/switch"),L=c.exports=x.create();x.mix(L,w,{_template:['<div class="manage-box" style="padding-bottom:20px;">','<div class="js-main">','<div class="js-tool-bar"></div>','<div class="manage-bd">','<div class="js-table" style="min-height:160px;"></div>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig||{};a.refresh({project:b.project,stage:b.stage,filter:b.filter,summary:b.summary,inited:!0}),a.initPopupData(),a.initCpns(),a.fixBatchBtn(),a.search()}},{name:"click .js-preview",handler:function(a){var b=this,c=u(a.currentTarget);b.getLineId(c)&&(J.removeDb(J.DB_FILTER),J.removeDb(J.DB_COND),c.closest("tr").find(".icon-spot-red").hide())}},{name:"click .js-paper-view",handler:function(a){function b(a){G.getBindCtsTests({params:{deliverId:e.id},query:{},call:a,error:function(a){z.alert(a.msg)}})}var c=this,d=c.getLineIndex(u(a.target)),e=c.data.data[d];b(function(b){E.show({module:c.rawConfig.module,data:b.data,deliverId:e.id,tab:u(a.currentTarget).attr("data-type"),listeners:{updateSearchData:function(){c.refresh()}}})})}},{name:"click .js-evaluate-view",handler:function(a){var b=this;b.getDepartment(function(c){var d=b.getLineIndex(u(a.target)),e=b.data.data[d];A.show({projectId:b.projectId,deliverId:e.id,departmentData:c,tab:u(a.currentTarget).attr("data-type"),change:function(){b.search()}})})}},{name:"click .js-create-interview",handler:function(a){var b=this,c=b.getLineIndex(u(a.target)),d=b.data.data[c];C.show({module:b.rawConfig.module,projectId:b.projectId,deliverId:d.id,isReferral:9===+b.stage,summaryData:b.summaryData,resumeData:b.searchData[b.getLineId(u(a.currentTarget))],ok:function(){b.fire("refreshSummary")}})}},{name:"click .js-transfer-detail",handler:function(a){var b=this,c=b.getLineIndex(u(a.target)),d=b.data.data[c],e={head:[{text:"账号",width:"20%",style:{"text-align":"center"}},{text:"邮箱",width:"20%",style:{"text-align":"center"}},{text:"简历流转情况",width:"40%",style:{"text-align":"center"}},{text:"操作时间",width:"20%",style:{"text-align":"center"}}],list:[]};v.forEach(d.transferList,function(a){var b=[a.userName,a.userEmail,a.preStageName+" 至 "+a.stageName,y.form(new Date(a.createTime))];e.list.push({items:b})}),new z({title:"简历流转记录",content:B.getHtml(e),width:1e3,okTxt:"确定"})}},{name:"click .js-job-detail",handler:function(a){var b=this,c=b.getLineIndex(u(a.target)),d=b.data.data[c],e={head:[{text:"投递编号",style:{"text-align":"center"}},{text:"投递时间",style:{"text-align":"center"}},{text:"网申职位",style:{"text-align":"center"}},{text:"投递来源",style:{"text-align":"center"}},{text:"阶段",style:{"text-align":"center"}},{text:"状态",style:{"text-align":"center"}}],list:[]},f=e.head;v.forEach(d.jobDeliverList,function(a){var c=a.position,d=[a.deliverId,y.form(new Date(a.createTime)),(b.jobLimitCount<=1?"":'<span class="resume-rank rank'+c+'">'+c+"</span> ")+a.jobName,a.ncsr,a.stageName,a.subStageName];v.forEach(a.ext,function(a){var b=v.findIndex(f,function(b){return b.text===a.name});if(-1===b){var c=f.push({text:a.name,style:{"text-align":"center"}});d[c-1]=a.value.join("|")}else d[b]=a.value.join("|")}),e.list.push({items:d})});var g=f.length;v.forEach(e.list,function(a){var b=a.items;v.forCount(g,function(a){b[a]=void 0===b[a]?"--":b[a]})}),new z({title:"申请职位",content:'<div style="width:100%;overflow-x:auto;">'+B.getHtml(e)+"</div>",width:1e3,okTxt:"确定"})}}]},{initPopupData:d,initCpns:e,refresh:f,search:g,renderList:i,fixBatchBtn:h,getPapers:j,getProject:k,getDepartment:l,getCond:m,getBatchCond:n,getLineId:o,getLineIndex:p,getReferralStage:q,getSelectCount:r})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/preview/cpn/popupCancelTansfer",["nc","cpn"],function(a,b,c){function d(a){var b=new r(a);return p.wrap(b,{title:"转移到",content:b.html(),width:650,cancel:function(){},ok:function(){a.ok&&a.ok({choice:b.getData("cpn-val-choice")})}}),b}function e(){}function f(){var a=this;a.setData("cpn-val-choice","1")}function g(){var a=this,b=q.mix({el:a.getEl(".js-choice label.radio"),listeners:{change:function(){var b=this.val();a.setData("cpn-val-choice",b)}}});a.setData("cpn-choice",b)}function h(){var a=this,b=["choice"];m.forEach(b,function(b){var c=a.getData("cpn-"+b),d=a.getData("cpn-val-"+b);c&&c.val&&c.val(d)})}function i(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function j(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var k=a("nc"),l=a("cpn"),m=k.Base,n=(k.$,k.Clazz),o=k.Component,p=l.Popup,q=l.CheckGroup,r=c.exports=n.create();n.mix(r,o,{_template:['<div class="pop-written pop-written-plan" style="overflow-y:inherit;">','<div class="check-radio-box js-choice">','<label class="radio" style="display:block;padding-left:30%;margin-bottom:10px;"><span class="icons"></span><input type="radio" value="1"> 撤销通过操作</label>','<label class="radio" style="display:block;padding-left:30%;"><span class="icons"></span><input type="radio" value="2"> 修改通过后的转移阶段</label>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.initRender()}}],show:d},{initialize:e,initData:f,initCpns:g,initRender:h,setData:i,getData:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/preview/cpn/popupTransfer",["nc","cpn"],function(a,b,c){function d(a){a=a||{};var b=new q(a);return o.wrap(b,{title:"转移到",content:b.html(),width:600,cancelTxt:"取消",ok:function(){return b.value&&k.size(b.value)?(a.ok&&a.ok({toStage:b.value.toStage,job:b.checkbox_job.isChecked(),all:b.checkbox_all.isChecked()}),!0):(o.alert("请选择阶段"),!0)}}),b}function e(){function a(a){return n.execTpl(['<li v-for="(item, index) in items" :class="cls(item)" :data-index="index">','<span v-if="item.referral" class="pop-tag-push">内推</span>','<i :class="icon(item)"></i>#{item.text}','<div v-if="item.sub" class="tooltip bottom tooltip-info js-tooltip-home" style="max-width:none;">','<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner js-tooltip-main"><ul>','<li v-for="(subItem, subIndex) in item.sub" :class="subCls(subItem)" :data-index="subIndex">#{subItem.text}</li>',"</ul></div>","</div>","</li>"],{items:a,cls:function(a){return"js-option js-option-"+a.stage},icon:function(a){return"pop-interview-step"+a.icon},subCls:function(a){return"js-sub-option js-sub-option-"+a.subStage}})}var b=this,c={7:{text:'简历初选 -- <span class="js-sub-name"></span>',stage:7,referral:!0,icon:1,sub:[{text:"待处理",subStage:0},{text:"待定",subStage:1},{text:"不合适",subStage:2}]},8:{text:"笔试",stage:8,referral:!0,icon:3},9:{text:"面试",stage:9,referral:!0,icon:2}},d=b.optionConf=(k.map(b.rawConfig.referralStage||[],function(a){return c[a]})||[]).concat([{text:'简历初选 -- <span class="js-sub-name"></span>',stage:0,icon:1,sub:[{text:"待处理",subStage:0},{text:"待定",subStage:1},{text:"不合适",subStage:2}]},{text:"笔试",stage:2,icon:3},{text:"面试",stage:3,icon:2},{text:"待发offer",stage:6,icon:4}]);b.getEl(".js-option-home").html(a(d)),b.getEl(".js-option-"+b.rawConfig.stage).remove()}function f(){var a=this,b=[{key:"job",name:"相同职位通过的简历默认转移至同一阶段"},{key:"all",name:"全部通过的简历默认转移至同一阶段"}];k.forEach(b,function(c){var d=new p({renderTo:a.getEl(".js-"+c.key),renderBy:"html",text:c.name,change:function(){var d=this.isChecked();d===!0&&k.forEach(b,function(b){b.key!==c.key&&a["checkbox_"+b.key].checked(!1)})}});a["checkbox_"+c.key]=d});var c=a.rawConfig.val||{},d=!!c.cancel,e=c.jobOrAll;a.checkbox_job.checked(d?1===e:!0),a.checkbox_all.checked(d?2===e:!1)}function g(a,b,c){var d=this,e=c?c:d.getEl();k.forEach(e.find(a),function(a){j(a).removeClass("selected")}),k.id(b)&&e.find([a,b].join("-")).addClass("selected")}var h=a("nc"),i=a("cpn"),j=h.$,k=h.Base,l=h.Clazz,m=h.Component,n=h.Node,o=i.Popup,p=i.CheckBox,q=c.exports=l.create();l.mix(q,m,{_template:['<div class="pop-written pop-written-plan" style="overflow-y:inherit;max-height:none;">','<div class="pop-plan-item" style="text-align:center">',"通过筛选的简历将转移到以下阶段","</div>",'<div class="pop-plan-item">','<div class="" style="display:inline-block;margin-left:145px;">','<ul class="pop-interview-steps js-option-home" style="margin-bottom:30px;"></ul>',"</div>","</div>",'<div class="pop-plan-item" style="margin-left:145px;">','<div class="js-job"></div>',"</div>",'<div class="pop-plan-item" style="margin-left:145px;">','<div class="js-all"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initOption(),a.initCheckbox()}},{name:"click .js-option",handler:function(a){var b=this,c=j(a.currentTarget);if(!c.hasClass("disabled")){var d=c.attr("data-index"),e=b.optionConf[d]||{};if(!e.sub)return b.selectOption(".js-option",e.stage),void(b.value={toStage:e.stage});var f=k.filter(c.find(".js-sub-option"),function(a){return j(a).hasClass("selected")})[0];if(f){f=j(f),b.selectOption(".js-option",e.stage);var g=f.attr("data-index"),h=e.sub[g]||{};b.value={toStage:e.stage,toSubStage:h.stage}}}}},{name:"click.stop .js-sub-option",handler:function(a){var b=this,c=j(a.currentTarget);if(!c.hasClass("disabled")){var d=c.closest(".js-option"),e=d.attr("data-index"),f=b.optionConf[e]||{},g=c.attr("data-index"),h=f.sub[g]||{};b.selectOption(".js-sub-option",h.subStage,d),b.selectOption(".js-option",f.stage),d.find(".js-sub-name").html(c.html()),b.value={toStage:f.stage,toSubStage:h.subStage}}}}],show:d},{initOption:e,initCheckbox:f,selectOption:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/preview/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../util","../../../extend/event","../../viewResume/index","../../render/theme0","../../render/util","../../render/dataMenu","../../render/dataItem","../../../../../util/switch","../../../../../component/popupSub/popupResumeTag","../../../../../action/resume","../../../../../util/ajax","../../../extend/bll/resume","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/position","../../../../../action/common","../../../extend/bll/resumeDeliver","../../../../../action/resumeDeliver","./cpn/popupTransfer","./cpn/popupCancelTansfer","../cpn/popupBatchTransfer"],function(a,b,c){function d(){var a=this;a.initEvent()}function e(){var a=this,b=function(){a.viewResume.initResume&&a.viewResume.initResume()};y.listen(D.RESUME_UPDATE,b),a.listen("destroy",function(){y.unlisten(D.RESUME_UPDATE,b)})}function f(){var a=this;a.viewResume=new E({renderTo:a.getEl(),module:a,nav:a.getNavConf(),resume:a.getResumeConf()})}function g(){var a=this,b={getNavData:x.bind(a.getNavData,a)};return b}function h(a,b,c){var d=this,e=d.getParam();if(!d.getCond()||e.id)return void(b&&b({data:[{id:e.id}],totalPage:1,currentPage:1,totalCount:1}));var f=x.extend({},d.getCond(),{currentPage:a||1,pageSize:20});f.operation="search",I.search({body:f,call:function(a){var c=a.data.data;x.isArray(c)&&(x.forEach(c,function(a){a.name=a.candidateName,a.id=a.id,a.unread=a.unread,a.orderBy=a.orderBy,a.info=[a.candidateSchool,a.candidateMajor]}),b&&b(a.data))},error:function(a){c&&c(a.msg)}})}function i(){var a=this,b={showDeliverJob:!0,tagTypeConf:{entityType:21,sceneType:1},getResumeData:x.bind(a.getResumeData,a),getFooterConf:x.bind(a.getFooterConf,a)};return b}function j(a,b,c){var d=this;I.getDeliverDetail({params:{deliverId:a.id},query:{},call:function(a){var c=a.data;x.extend(c,d.projectData,{name:c.resumeName}),b&&b(c)},error:function(a){c&&c(a.msg)}})}function k(a){var b=this;b.resumeData=a;var c=b.getParam(),d=x.id(c.stage)||a.stage||0,e=b.getFooterHome(a),f=K.has(121)?[e.download]:[],g=b.viewResume.hasNextResume()?e.next:null,h=K.has(122);return{0:f.concat(h?[e.passStage0,e.outStage0,e.waitStage0,e.transferStage0,g&&e.handledStage0?g:null]:[]),2:f.concat(h?[e.passStage2,e.outStage2,e.transferStage,g&&e.handledStage2?g:null]:[]),3:f.concat(h?[e.transferStage,g&&e.handledStage36?g:null]:[]),6:f.concat(h?[e.transferStage,g&&e.handledStage36?g:null]:[]),7:f.concat(h?[e.passStage7,e.outStage7,e.waitStage7,e.transferStage7,g&&e.handledStage7?g:null]:[]),8:f.concat(h?[e.passStage8,e.outStage8,e.transferStage,g&&e.handledStage8?g:null]:[]),9:f.concat(h?[e.transferStage,g&&e.handledStage369?g:null]:[])}[d]}function l(a){function b(b){function c(){if(2===l.jobOrAll)return e.transferStage({toStage:l.toDeliverStage,toSubStage:0});var b=!1;1===l.jobOrAll&&x.forEach(a.jobIds,function(a){var c=l.transferJobs[a];return c?(e.transferStage({toStage:c,toSubStage:0}),b=!0,x.BREAK):void 0}),!b&&e.popupTansfer(j)}m?b?A.confirm("是否确定修改为通过?",c):c():e.popupCancelTansfer(j,{jobOrAll:l.jobOrAll,stage:h,cancel:!0})}function c(a){x.forEach(a,function(a){return a.stay?(a.confirm?A.confirm(a.confirm,function(){e.transferStage({toStage:a.toStage,toSubStage:a.toSubStage})}):e.transferStage({toStage:a.toStage,toSubStage:a.toSubStage}),x.BREAK):void 0})}function d(a){N.show({referralStage:g,value:{stage:h||a,subStage:i},call:function(a){e.transferStage(a)}})}var e=this,f=e.getParam(),g=f.referralStage,h=+a.stage,i=+a.subStage,j=x.id(f.stage)?+f.stage:h,k={0:"简历初选",2:"笔试",3:"面试",6:"待发offer",7:"内推简历初选",8:"内推笔试",9:"内推面试"},a=e.resumeData,l=x.json(a[x.contains([7,8,9],h)?"referralTransferConfig":"transferConfig"])||{},m=h===j,n=0===h&&2===i,o=2===h&&2===i,p=0===h&&1===i,q=7===h&&2===i,r=8===h&&2===i,s=7===h&&1===i,t=!m||n||p,u=!m||o,v=!m||q||s,w=!m||r,y=!m,z={curStage:m,stage0Out:n,stage2out:o,stage0Stay:p,stage7Out:q,stage8out:r,stage7Stay:s,handledStage0:t,handledStage2:u,handledStage7:v,handledStage8:w,handledStage369:y,download:{name:"下载简历",side:"left",cls:"",call:function(){var b=F.getCondById(a.id);G.download(b,{count:1})}},next:{name:"下一份 >",side:"right",cls:"link-green",call:function(){e.viewResume.changeResume("next")}},passStage0:{name:m?"通过":"已通过",side:"right",cls:"resume-oprt-icon roi-pass"+(m?"":" active"),call:function(){b(t)}},outStage0:{name:"不通过",side:"right",cls:"resume-oprt-icon roi-nopass"+(n?" active":""),call:function(){c([{stay:n,confirm:"是否撤销不通过操作，让简历回退至未筛选状态？",toStage:0,toSubStage:0},{stay:t,confirm:"是否确定修改为不通过？",toStage:0,toSubStage:2},{stay:!0,toStage:0,toSubStage:2}])}},waitStage0:{name:"待定",side:"right",cls:"resume-oprt-icon roi-waiting"+(p?" active":""),call:function(){c([{stay:p,confirm:"是否撤销待定操作，让简历回退至未筛选状态？",toStage:0,toSubStage:0},{stay:t,confirm:"是否确定修改为待定？",toStage:0,toSubStage:1},{stay:!0,toStage:0,toSubStage:1}])}},transferStage0:{name:"转移到"+(m?"":"（"+k[h]+"）"),side:"right",cls:"resume-oprt-icon roi-tranform"+(m?"":" active"),call:function(){d(0)}},passStage2:{name:m?"通过":"已通过（"+k[h]+"）",side:"right",cls:"resume-oprt-icon roi-pass"+(m?"":" active"),call:function(){m?e.transferStage({toStage:3,toSubStage:0}):A.confirm("是否撤销通过操作？",function(){e.transferStage({toStage:2,toSubStage:0})})}},outStage2:{name:"不通过",side:"right",cls:"resume-oprt-icon roi-nopass"+(o?" active":""),call:function(){o?A.confirm("是否撤销不通过操作？",function(){e.transferStage({toStage:2,toSubStage:0})}):e.transferStage({toStage:2,toSubStage:2})}},transferStage:{name:"转移到"+(m?"":"（"+k[h]+"）"),side:"right",cls:"resume-oprt-icon roi-tranform"+(m?"":" active"),call:function(){d(0)}},passStage7:{name:m?"通过":"已通过",side:"right",cls:"resume-oprt-icon roi-pass"+(m?"":" active"),call:function(){b(v)}},outStage7:{name:"不通过",side:"right",cls:"resume-oprt-icon roi-nopass"+(q?" active":""),call:function(){c([{stay:q,confirm:"是否撤销不通过操作，让简历回退至未筛选状态？",toStage:7,toSubStage:0},{stay:v,confirm:"是否确定修改为不通过？",toStage:7,toSubStage:0},{stay:!0,toStage:7,toSubStage:2}])}},waitStage7:{name:"待定",side:"right",cls:"resume-oprt-icon roi-waiting"+(s?" active":""),call:function(){c([{stay:s,confirm:"是否撤销待定操作，让简历回退至未筛选状态？",toStage:7,toSubStage:0},{stay:v,confirm:"是否确定修改为待定？",toStage:7,toSubStage:1},{stay:!0,toStage:7,toSubStage:1}])}},transferStage7:{name:"转移到"+(m?"":"（"+k[h]+"）"),side:"right",cls:"resume-oprt-icon roi-tranform"+(m?"":" active"),call:function(){d(7)}},passStage8:{name:m?"通过":"已通过（"+k[h]+"）",side:"right",cls:"resume-oprt-icon roi-pass"+(m?"":" active"),call:function(){return m&&x.contains(g,9)?e.transferStage({toStage:9,toSubStage:0}):m?d(0):void A.confirm("是否撤销通过操作？",function(){e.transferStage({toStage:8,toSubStage:0})})}},outStage8:{name:"不通过",side:"right",cls:"resume-oprt-icon roi-nopass"+(r?" active":""),call:function(){r?A.confirm("是否撤销不通过操作？",function(){e.transferStage({toStage:8,toSubStage:0})}):e.transferStage({toStage:8,toSubStage:2})}}};return z}function m(a,b){var c=this;I.transfer({type:"PUT",body:{deliverId:c.resumeData.id,toStage:a.toStage,toSubStage:a.toSubStage,jobOrAll:a.jobOrAll},call:function(){var d=c.resumeData;d.stage=a.toStage,d.subStage=a.toSubStage,c.viewResume.renderResumeFooter(),x.isFunction(b)&&b()},error:function(a){A.alert(a.msg)}})}function n(a){var b=this,c=b.getEl(),d=b.resumeData;z.mark(c)||H.markSelect({body:{entityType:21,entityId:d.id,status:a},call:function(){d.selectStatus=a,b.viewResume.renderResumeFooter(),A.tips("操作成功")},error:function(a){A.alert(a.msg)},always:function(){z.pause(c)}})}function o(){var a=this,b=a.getParam();return x.id(b.id)||a.getCond()?!0:(a.nav("resume"),!1)}function p(){return C.getDb(C.DB_COND)}function q(a,b){var c=this,d=c.resumeData,e=x.json(d.transferConfig),f=L.show({stage:a,referralStage:c.getParam().referralStage,val:b,ok:function(a){var b=a.all?2:a.job?1:3;c.transferStage({toStage:a.toStage,toSubStage:0,jobOrAll:b},function(){if(e.jobOrAll=b,2===b)e.toDeliverStage=a.toStage;else if(1===b){var c={};c[d.jobIds[0]]=a.toStage,e.transferJobs=c}d.transferConfig=JSON.stringify(e),f.popup&&f.popup.close()})}})}function r(a,b){var c=this,d=M.show({ok:function(e){1===+e.choice?c.transferStage({toStage:a,toSubStage:0},function(){d&&d.popup.close()}):c.popupTansfer(a,b)}})}function s(a){var b=this,c=b.getParam(),d=c.projectId;return d?void J.getRecruitProject({type:"GET",params:{id:d},call:function(b){var c=b.data,d=x.json(c.projectConfig,{}),e=(d.customMenu||[]).concat([{id:"1",name:"基本资料"},{id:"999",name:"个人照片"},{id:"2",name:"教育经历"},{id:"3",name:"校内经历"},{id:"4",name:"工作经历"},{id:"6",name:"项目经历"},{id:"7",name:"获奖情况"},{id:"8",name:"个人技能"},{id:"9",name:"自我评价"},{id:"10",name:"论文发表"},{id:"11",name:"附件说明"}]);a&&a({menus:e,rule:{need:d.resumeMenuNeed||[],hide:d.resumeMenuHide||[],order:d.resumeMenuOrder||[]}})},error:function(){a&&a()}}):a&&a()}function t(){var a=this;return{crumb:[{title:"应聘管理",module:"resume",action:"deliver/index/index",projectId:a.projectId}]}}var u=a("nc"),v=a("cpn"),w=(u.$,u.Clazz),x=u.Base,y=u.Event,z=u.Limit,A=v.Popup,B=a("../../../../../core/module"),C=a("../util"),D=a("../../../extend/event"),E=a("../../viewResume/index"),F=a("../../../extend/bll/resume"),G=a("../../../extend/bll/resumeDeliver"),H=a("../../../../../action/resume"),I=a("../../../../../action/resumeDeliver"),J=a("../../../../../action/position"),K=a("../../../../../util/switch"),L=a("./cpn/popupTransfer"),M=a("./cpn/popupCancelTansfer"),N=a("../cpn/popupBatchTransfer"),O=(a("../util"),c.exports=w.create());w.mix(O,B,{style:"/stylesheets/styles/system/resumeManage.css",title:"查看简历",showTask:!0,_template:'<div class="manage-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;window.setTimeout(function(){a.check()&&a.fetchProject(function(b){a.projectData=b,a.initViewResume(),a.sizeFull(function(b,c){a.viewResume&&a.viewResume.reHeight(c)})})},250)}}]},{initialize:d,initEvent:e,initViewResume:f,getNavConf:g,getNavData:h,getResumeConf:i,getResumeData:j,getFooterConf:k,getFooterHome:l,transferStage:m,markSelect:n,check:o,getCond:p,popupTansfer:q,popupCancelTansfer:r,fetchProject:s,getCrumbConf:t})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/deliver/util",["nc","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b._db=b._db||new i(j.appDb.DeliverResume);return h.trim(a)?c.get(a)||{}:c}function e(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function f(a){var b=this,c=b.getDb();b._db.refresh(),c.remove(a)}var g=a("nc"),h=(g.Base,g.$),i=g.Db,j=a("../../../../core/siteConfig");c.exports={DB_PROJECT_CHOOSE:"DB_PROJECT_CHOOSE",DB_COND:"DB_RESUME_DELIVER_COND",DB_FILTER:"DB_RESUME_DELIVER_FILTER",getDb:d,setDb:e,removeDb:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/cpn/popupDeliverDetail",["nc","cpn","../../../../../action/resumeDoneTest","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new r(a),c=p.wrap(b,{content:b.html(),title:"投递详情",width:650,okTxt:"确定",hasScroll:!0,ok:function(){}});return c.popupContent.addClass("clearfix"),c.fixPosition(),b}function e(){}function f(a){var b=this,c=b.rawConfig;q.listDeliverDetailData({query:{uid:c.uid,page:a,pageSize:10},call:function(a){b.data=a.data||[],b.renderList(b.data)},error:function(a){b.popup.close(),p.alert(a.msg)}})}function g(a){var b=this;if(a&&+a.totalCount>0){var c="<table><tbody>";c+=["<tr>",'<th width="170">投递id</th>','<th width="120">职位</th>','<th width="120">项目</th>','<th width="120">申请时间</th>',"</tr>"].join(""),l.forEach(a.data,function(a){c+=m.execTpl(["<tr>",'<th width="50">#{deliverId}</th>','<th width="150">#{jobName}</th>','<th width="50">#{projectName}</th>','<th width="50">#{deliverTime}</th>',"</tr>"].join(""),{deliverId:a.deliverId,jobName:a.jobName,projectName:a.projectName,deliverTime:n.form(new Date(a.createTime),"yyyy-MM-dd HH:mm")})}),c+="</table></tbody>",b.getEl().html(c),new o({renderTo:b.getEl(),current:a.currentPage,total:a.totalPage,pageChange:function(a){b.getDeliverData(a)}})}else b.getEl().html('<div style="text-align:center;font-size:14px;">没有数据</div>')}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=(h.Limit,h.Str),n=h.Time,o=i.Pager,p=i.Popup,q=(i.Input,a("../../../../../action/resumeDoneTest")),r=c.exports=k.create();k.mix(r,j,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getDeliverData()}}],show:d},{initialize:e,renderList:g,getDeliverData:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/cpn/popupDoneTestDetail",["nc","cpn","../../../../../action/resumeDoneTest","../../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=new q(a),c=o.wrap(b,{content:b.html(),title:"做题详情",width:650,okTxt:"确定",hasScroll:!0,ok:function(){}});return c.popupContent.addClass("clearfix"),c.fixPosition(),b}function e(){}function f(a){var b=this,c=b.rawConfig;p.listDoneTestDetail({query:{uid:c.uid,page:a,pageSize:10},call:function(a){b.data=a.data||[],b.renderList(b.data)},error:function(a){b.popup.close(),o.alert(a.msg)}})}function g(a){var b=this;if(a&&+a.totalCount>0){var c="<table><tbody>";c+=["<tr>",'<th width="170">试卷</th>','<th width="120">做题次数</th>','<th width="120">平均分</th>',"</tr>"].join(""),l.forEach(a.data,function(a){c+=m.execTpl(["<tr>",'<th width="170">#{paperName}</th>','<th width="50">#{doneCount}</th>','<th width="50">#{avgScore}</th>',"</tr>"].join(""),a)}),c+="</table></tbody>",b.getEl().html(c),new n({renderTo:b.getEl(),current:a.currentPage,total:a.totalPage,pageChange:function(a){b.getDoneTestData(a)}})}else b.getEl().html('<div style="text-align:center;font-size:14px;">没有数据</div>')}var h=a("nc"),i=a("cpn"),j=(h.$,h.Component),k=h.Clazz,l=h.Base,m=(h.Limit,h.Str),n=i.Pager,o=i.Popup,p=(i.Input,a("../../../../../action/resumeDoneTest")),q=c.exports=k.create();k.mix(q,j,{_template:"<div>#{content}</div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getDoneTestData()}}],show:d},{initialize:e,renderList:g,getDoneTestData:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/index/filter",["nc","cpn","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../action/resumeDoneTest","../../util/util"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=(a.rawConfig,{id:"school",title:"学校",type:"school"}),d={id:"edu",title:"学历",type:"selectMult",conf:{cls:"filter-item-txt none",options:[{text:"博士",value:"博士"},{text:"硕士",value:"硕士"},{text:"本科",value:"本科"},{text:"专科",value:"专科"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="ico-level"></i>')}}}},e={id:"major",title:"专业",type:"input",conf:{placeholder:"多个用空格分隔",listeners:{render:function(){this.getEl().css("marginRight",10).append('<i class="icon-wrench"></i>')}}},ext:{chkTitle:"包含任一专业"}},f={id:"gender",title:"性别",type:"select",conf:{options:[{text:"不限",value:"不限",checked:!0},{text:"男",value:"男"},{text:"女",value:"女"}]}},g={id:"location",title:"所在地",type:"selectMult",conf:{cls:"filter-item-txt none",needSearch:!0,options:[{text:"北京",value:"北京"},{text:"上海",value:"上海"},{text:"广州",value:"广州"},{text:"深圳",value:"深圳"},{text:"杭州",value:"杭州"},{text:"南京",value:"南京"},{text:"西安",value:"西安"},{text:"武汉",value:"武汉"},{text:"哈尔滨",value:"哈尔滨"},{text:"长春",value:"长春"},{text:"成都",value:"成都"},{text:"长沙",value:"长沙"},{text:"合肥",value:"合肥"},{text:"其他",value:"其他"}],listeners:{render:function(){this.getEl().find("span.caret").replaceWith('<i class="icon-map-marker"></i>')}}}},h=(new Date).getFullYear(),i={id:"graduate",title:"毕业年份",type:"selectMult",conf:{options:o.map(o.range(h-3,h+5,1).reverse(),function(a){return{text:a+"年",value:o.id(a)}})}},j={id:"tag",title:"标签",type:"selectMult",conf:{needSearch:!0,options:o.map(a.tagList,function(a){return{text:a,value:a}})}},k={id:"score",title:"平均分区间",type:"range"},l={id:"deliver",title:"是否应聘",type:"select",conf:{options:[{text:"不限",value:"0",checked:!0},{text:"是",value:"1"},{text:"否",value:"2"}]}},m={id:"paper",title:"试卷",type:"selectMult",conf:{needSearch:!0,options:o.map(a.papers,function(a){return{text:a.paperName,value:o.id(a.id)}})}},n={id:"doneDate",title:"投递日期",type:"duration",ext:{today:!0}},p={id:"search",title:"关键词",type:"search",conf:{placeholder:"姓名/手机/邮箱/ACM/实习信息等，多个关键词用空格分割"},ext:{chkTitle:"包含任一关键词",chkTips:"默认是搜索包含了所有关键字的简历，多个关键词用空格分割"}},r=a.filter=new q({renderTo:b.find(".manage-bd"),renderBy:"html",submitTxt:"查询",line:[{items:[c,d,e]},{fold:!0,items:[f,g,i]},{fold:!0,items:[j,k]},{fold:!0,border:!0,items:[l,m,n]},{fold:!0,items:[p]}],clearAll:function(){a.val({})},getCondInfo:function(b,c){0===+b&&c&&c({key:a.getCondKey(),content:a.val()}),1===+b&&c&&c({key:a.getCondKey(),call:function(b){a.val(b)}})},listeners:{submit:o.bind(a.submit,a)}}),s=r.getItem("tag");0===a.tagList.length&&s.disabled()}function e(a){var b=this,c=b.rawConfig,d=b.filter,e=d.getItem("edu"),f=d.getItem("school"),g=d.getItem("major"),h=d.getItem("gender"),i=d.getItem("location"),j=d.getItem("graduate"),k=d.getItem("tag"),l=d.getItem("score"),m=d.getItem("deliver"),n=d.getItem("paper"),q=d.getItem("doneDate"),r=d.getItem("search");if(0===arguments.length){var a={graduationYearList:s.wrapVal(j.val()),liveAddressList:s.wrapVal(i.val()),schoolList:s.wrapVal(f.getSchool()),eduLevelList:s.wrapVal(e.val()),majorList:s.wrapVal(s.split(g.ipt.val())),gender:{"男":"男","女":"女"}[h.val()]||void 0,tagList:s.wrapVal(k.val()),keywordList:s.wrapVal(s.split(r.ipt.val())),scoreStart:s.wrapVal(s.wrapNum(l.startIpt.val())),scoreEnd:s.wrapVal(s.wrapNum(l.endIpt.val())),selectStatus:s.wrapNum(c.selectStatus),union:s.wrapNum(r.chk.isChecked()?1:0),majorUnion:s.wrapNum(g.chk.isChecked()?1:0),deliver:s.wrapNum(m.val()),paperIds:s.wrapVal(n.val()),beginTimeBegin:q.startIpt.val()?q.startIpt.val()+" 00:00:00":void 0,beginTimeEnd:q.endIpt.val()?q.endIpt.val()+" 23:59:59":void 0};return o.forEach(a,function(b,c){void 0===b&&delete a[c]}),a}var t=(a.schoolList||[]).join(",");f.val(t).getEl().attr("title",t),e.val(a.eduLevelList),g.ipt.val((a.majorList||[]).join(" ")),g.chk.checked("1"===o.id(a.majorUnion)),h.val(a.gender||"不限"),i.val(a.liveAddressList),j.val(a.graduationYearList),k.val(a.tagList||[]),l.startIpt.val(a.scoreStart||""),l.endIpt.val(a.scoreEnd||""),m.val(a.deliver||"0"),n.val(a.paperIds),q.todayChk.checked(!1),q.todayChk.fire("change"),q.startIpt.val(a.beginTimeBegin?p.form(new Date(a.beginTimeBegin),"yyyy-MM-dd"):""),q.endIpt.val(a.beginTimeEnd?p.form(new Date(a.beginTimeEnd),"yyyy-MM-dd"):""),r.ipt.val((a.keywordList||[]).join(" ")),r.chk.checked("1"===o.id(a.union))}function f(){var a=this,b=a.filter,c=b.getItem("score"),d=a.val();if(d.rankStart&&!d.rankEnd)return c.endIpt.setErrorTips("不能为空"),!1;if(!d.rankStart&&d.rankEnd)return c.startIpt.setErrorTips("不能为空"),!1;if(d.rankStart&&d.rankEnd&&+d.rankStart>+d.rankEnd)return c.startIpt.setErrorTips("值错误"),c.endIpt.setErrorTips("值错误"),!1;if(c.startIpt.setNone(),c.endIpt.setNone(),d.beginTimeBegin&&d.beginTimeEnd&&d.beginTimeBegin>d.beginTimeEnd){var e=b.getItem("doneDate");return e.endIpt.setErrorTips("结束日期不能早于开始日期"),!1}return!0}function g(){var a=this,b=a.rawConfig;b.ok&&a.check()&&b.ok(a.val())}function h(a){{var b=this;b.rawConfig}r.getCondition({query:{},call:function(c){var d=c.data;b.tagList=d.tags||[],b.papers=c.data.papers||[],a&&a()},error:function(a){b.renderWait(a.msg)}})}function i(){var a="ResumeDonetestCondition";return a}function j(a){var b=this,c=b.getEl();c.find(".manage-bd").html(a?'<div style="text-align:center;padding:20px;font-size:14px;">'+a+"</div>":"")}var k=a("nc"),l=a("cpn"),m=(k.$,k.Component),n=k.Clazz,o=k.Base,p=k.Time,q=(l.Popup,a("../../../../../component/filter/filter")),r=a("../../../../../action/resumeDoneTest"),s=a("../../util/util"),t=c.exports=n.create();n.mix(t,m,{_template:['<div class="manage-box">','<div class="manage-bd"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderWait("条件加载中..."),a.getTagData(function(){a.initCpn(),a.submit()})}}]},{initCpn:d,val:e,check:f,submit:g,getTagData:h,getCondKey:i,renderWait:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/index/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","./filter","../../../../../component/filter/filter","../../../../../component/filter/filterCond","../../../../../component/filter/condUtil","../../../../../action/common","../../../../../util/ajax","../../../../../component/popupSub/popupCommon","../../../../../component/filter/popupCustomCond","../../../../../action/resumeDoneTest","../../util/util","./list","../cpn/popupDoneTestDetail","../cpn/popupDeliverDetail","../../../../../component/table","../../../../../component/selectAll","../../../../../action/resume","../../../extend/bll/resumeDoneTest","../../../extend/event","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../util"],function(a,b,c){function d(){var a=this;a.page=0,a.pageCount=20}function e(a){var b=this;s.listVPaperIds({query:{},call:function(c){var d=c.data;b.paperIds=d.paperIds||[],b.paperIds.length>0?a&&a():b.renderNone(d.sale)},error:function(a){b.renderNone(b.getEl(),a.msg)}})}function f(){var a=this,b=a.getParam(),c=m.id(b.selectStatus)||"0";new o({renderTo:a.getEl(".js-tab"),noFireChangeOnRender:!0,items:[{text:"全部",value:"0",checked:"0"===c},{text:"合适",value:"2",checked:"2"===c},{text:"不合适",value:"1",checked:"1"===c}],change:function(){var b=this.val();a.nav("resume",{action:"donetest/index/index",selectStatus:b})}})}function g(){var a=this,b=a.getParam(),c=a.getEl();a.filterModule=new q({renderTo:c.find("div.js-filter"),win:a.getWin(),userId:a.getUserId(),selectStatus:b.selectStatus,ok:function(b){var c=a.listModule;c&&c.reload(b)}})}function h(){var a=this,b=a.getParam(),c=a.getEl();a.listModule=new r({renderTo:c.find("div.js-list"),selectStatus:b.selectStatus,parent:a})}function i(){var a=this;a.renderWait(a.getEl(),n.execTpl(['<div class="com-empty-wrap" style="text-align:center;padding:30px;">','<img src="//uploadfiles.nowcoder.com/images/20151217/56_1450325680316_364BE8860E8D72B4358B5E88099A935A">','<div class="com-empty-tip" style="font-size:14px;margin:20px 0;">',"<p>您暂未购买此服务。授权牛客企业往年笔试真题，可查看做题用户信息。详询：</p>","<p>座机：010-84873384&nbsp;&nbsp;&nbsp;&nbsp;邮箱：admin@nowcoder.com</p>","</div>","</div>"].join(""),{}))}var j=a("nc"),k=a("cpn"),l=(j.$,j.Clazz),m=j.Base,n=j.Str,o=k.Tab,p=a("../../../../../core/module"),q=a("./filter"),r=a("./list"),s=a("../../../../../action/resumeDoneTest"),t=(k.Popup,c.exports=l.create());l.mix(t,p,{style:"/stylesheets/styles/system/resumeManage.css",title:"做题简历",showTask:!0,_template:["<div>",'<div class="js-tab"></div>','<div class="js-filter"></div>','<div class="js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.checkHasVPapers(function(){a.initTab(),a.initFilter(),a.initList()})}}]},{initialize:d,initTab:f,initFilter:g,initList:h,checkHasVPapers:e,renderNone:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/index/list",["nc","cpn","../cpn/popupDoneTestDetail","../../../../../action/resumeDoneTest","../../../../../util/ajax","../cpn/popupDeliverDetail","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/resume","../../../extend/bll/resumeDoneTest","../../../extend/event","../../../extend/bll/base","../../../extend/bll/task","../../../../../action/api","../util"],function(a,b,c){function d(a){var b=this;b.parent=a.parent,b.allIds=[]}function e(){var a=this,b=a.getEl();b.find(".js-batch-ul").html(['<li><a href="javascript:void(0);" class="js-batch-preview">批量查看简历</a></li>','<li><a href="javascript:void(0);" class="js-batch-select js-batch-accept" data-status="2">批量通过</a></li>','<li><a href="javascript:void(0);" class="js-batch-select js-batch-fail" data-status="1">批量淘汰</a></li>','<li><a href="javascript:void(0);" class="js-batch-download">批量下载简历</a></li>','<li><a href="javascript:void(0);" class="js-batch-excel">导出excel</a></li>'].join('<li class="menu-pipe">|</li>'))}function f(){var a=this,b=a.getEl();a.pageSelect=new B({renderTo:b.find(".js-tmp-page"),renderBy:"replaceWith",size:"xsmall",options:[{text:"20",value:20,checked:!0},{text:"50",value:50},{text:"100",value:100}],change:function(){a.load()}}),a.tableCpn=new F({renderTo:b.find(".js-list"),needSelect:!0,needFixHeader:!0,pageChange:function(b){a.parent.goTop(),a.load(null,b)},selectAllChange:w.bind(a.updatePreviewUrl,a),selectAllToggle:w.bind(a.updatePreviewUrl,a)})}function g(a){var b=this;b.allIds.length=0,b.tableCpn.selectAll.clear(),b.load(a)}function h(a,b){var c=this;if(a&&(c.condition=a),0===w.size(c.condition))return c.renderNone();c.tableCpn.renderWait();var d=c.getCond(b);w.extend(d,{operation:"search"}),H.syncDo({body:d,call:function(a){a.isOrder&&(c.listData=a.data,c.renderList(a.data))},error:function(a){a.isOrder&&c.tableCpn.renderNone(a.msg)}})}function i(a){var b=this,c=b.rawConfig,d=b.getEl(),e='共<span class="font-green">'+a.totalCount+"</span>份";d.find("span.js-count").html(e),"1"===w.id(c.selectStatus)&&d.find(".js-batch-fail").html("批量取消淘汰").attr("data-status","0"),"2"===w.id(c.selectStatus)&&d.find(".js-batch-accept").html("批量取消通过").attr("data-status","0")}function j(a){var b=this,c=b.tableCpn,d=b.parent;if(0===(a.data||[]).length)return b.renderNone();b.renderTotal(a);var e={head:[{text:"用户id",width:"8%"},{text:"姓名"},{text:"性别"},{text:"手机"},{text:"邮箱"},{text:"学校"},{text:"专业"},{text:"最高学历",width:"6%"},{text:"毕业时间",width:"6%"},{text:"所在地",width:"6%"},{text:"是否应聘",width:"6%"},{text:"完成试卷",width:"10%"},{text:"最近做题时间",width:"8%"},{text:"平均分数",width:"6%"},{text:"牛客主页",width:"6%"},{text:"简历查看",width:"6%"}],list:[]},f=[];w.forEach(a.data,function(a){f.push(a.uid+"");var c=d.getNavUrl("resume",{action:"donetest/preview/index",id:a.uid}),g="http://www.nowcoder.com/profile/"+a.uid,h=a.resumeUUID?'<a href="'+c+'" target="_blank" class="js-preview btn btn-auto btn-primary btn-xs">查看</a>':"",i='<a href="'+g+'" target="_blank" class="btn btn-auto btn-primary btn-xs">查看</a>',j=[{text:'<a href="'+g+'" target="_blank" >'+a.uid+"</a>"},b.wrapStr(a.name),b.wrapStr(a.gender),b.wrapStr(a.phone),b.wrapStr(a.email),b.wrapStr(a.school),b.wrapStr(a.major),b.wrapStr(a.degree),b.wrapStr(a.workTime),b.wrapStr(a.city),a.delivered?'<a href="javascript:void(0);" class="js-deliver-link link-green">是</a>':"否",' <a href="javascript:void(0);" class="js-test-link">'+a.paperName+"</a>",a.latestDoneTestTime?A.form(new Date(a.latestDoneTestTime),"yyyy-MM-dd HH:mm"):"-",a.avgScore.toFixed(1),i,h];e.list.push({items:j,attr:{"data-id":a.uid,"data-markId":a.uid}})}),c.updateHtml(e,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage}),b.actionEl.show(),b.saveIds(f,a.currentPage)}function k(){var a=this,b=w.size(a.condition);a.renderTotal({totalCount:0,hasBuyCount:0}),a.actionEl.show(),a.tableCpn.renderNone(b?"没有符合条件的简历":"请先选择筛选条件")}function l(a){var b=this,c=w.extend({},b.condition,{currentPage:a||1,pageSize:b.pageSelect.val()});return c}function m(){var a=this,b=a.tableCpn.selectAll;return w.extend({},a.condition,{isAll:b.isSelectAll?1:2,ids:b.selectIds})}function n(a){var b=v(a).closest("tr");return v.trim(b.attr("data-id"))}function o(){var a=this,b=a.tableCpn.selectAll,c=a.parent,d=a.getEl(),e=d.find("a.js-batch-preview");if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return e.attr("href","javascript:void(0);").removeAttr("target");var f="",g=!b.isSelectAll&&1===b.selectIds.length,f=c.getNavUrl("resume",{action:"donetest/preview/index",id:g?b.selectIds[0]:null});e.attr("href",f).attr("target","_blank")}function p(a,b){return v.trim(a)||v.trim(b)||"---"}function q(a,b){var c=this,d=c.allIds,e=Math.max(b-1,0)*c.pageSelect.val();w.forEach(a,function(a,b){d[e+b]=a})}function r(a){function b(a,b){a=a||[];for(var c=0,d=a.length;d>c;c++)if(a[c]&&a[c]===b)return c;return-1}var c=this,d=20,e=c.tableCpn.selectAll,f=c.allIds,g=e.selectIds;if(!a)return 1;if(a=a,e.isSelectAll){var h=b(f,a);if(d>h)return 1;if((g||[]).length>0){var i={};w.forEach(g,function(a){i[a]=1});for(var j=h-1;j>=0;j--)h+=f[j]&&i[f[j]]?-1:0}return z.page(h+1,d)}var h=b(g,a);return-1===h?1:z.page(h+1,d)}function s(a){var b=this,c=b.getBatchCond(),d=b.tableCpn.selectAll;if(2===c.isAll&&1===c.ids.length){var e=c.ids[0]+"",f=w.find(b.listData.data,function(a){return a.uid+""===e});return((f||{}).name||"简历")+"."+a}var g=d.isSelectAll?d.totalCount-d.selectIds.length:d.selectIds.length;return"简历("+g+"份).zip"}var t=a("nc"),u=a("cpn"),v=t.$,w=t.Base,x=t.Component,y=t.Clazz,z=(t.Db,t.Str,t.Num),A=t.Time,B=u.Select,C=(u.CheckBox,u.Popup),D=(u.Pager,a("../cpn/popupDoneTestDetail")),E=a("../cpn/popupDeliverDetail"),F=a("../../../../../component/table"),G=(a("../../../../../action/resume"),a("../../../extend/bll/resumeDoneTest")),H=a("../../../../../action/resumeDoneTest"),I=a("../util"),J=a("../../../extend/bll/task"),K=c.exports=y.create();y.mix(K,x,{_template:['<div class="manage-box" style="padding-bottom:20px;">','<div class="manage-hd clearfix js-action">','<div class="menu-txt-box">','<ul class="menu-txt clearfix js-batch-ul"></ul>',"</div>",'<div class="result-info">','<span class="result-num js-count"></span>','<span>每页显示 <div class="js-tmp-page"></div></span>',"</div>","</div>",'<div class="manage-bd js-list"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl();a.actionEl=b.find("div.js-action"),a.listEl=b.find("div.js-list"),a.renderBatchOperation(),a.initCpn()}},{name:"click .js-batch-accept",handler:function(a){var b=this,c=b.tableCpn.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return a.preventDefault(),C.alert("请先选择简历");var d=b.parent;if(d){b.getBatchCond()}}},{name:"click .js-batch-select",handler:function(a){var b=this,c=b.tableCpn.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return C.alert("请先选择简历");var d=b.parent,e=d.getWin(),f=v(a.currentTarget),g=b.getBatchCond(),f=(d.getUserId(),v(a.currentTarget)),h=f.attr("data-status");g.updateSelectStatus=h,g.operation="select",H.asyncDo({body:g,call:function(a){var c=e.showLoading("标记中...");J.getTaskProgress(!0,a.data,function(a){var d=a.end,e=a.content,f=a.error;f?(c.close(),C.alert(e)):d&&(c.close(),C.tips("标记成功",function(){b.load()}))})},error:function(a){C.alert(a.msg)}})}},{name:"click .js-batch-preview",handler:function(a){var b=this,c=b.tableCpn.selectAll;if(!b.condition||!c.isSelectAll&&0===c.selectIds.length)return a.preventDefault(),C.alert("请先选择简历");var d=b.parent;if(d){var e=b.getBatchCond();I.setDb(I.DB_COND,e)}}},{name:"click .js-preview",handler:function(a){var b=this,c=b.parent,d=(b.tableCpn.selectAll,v(a.currentTarget)),e=b.getLineId(d);e&&c&&(I.removeDb(I.DB_COND),I.removeDb(I.DB_FILTER),d.attr("href",c.getNavUrl("resume",{action:"donetest/preview/index",id:e})),d.closest("tr").find(".icon-spot-red").hide())}},{name:"click .js-batch-download",handler:function(){var a=this,b=a.tableCpn.selectAll;if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return C.alert("请先选择简历");var c=a.getBatchCond();G.download(c,{taskTitle:a.getDownloadName("pdf")})}},{name:"click .js-batch-excel",handler:function(){var a=this,b=a.tableCpn.selectAll;if(!a.condition||!b.isSelectAll&&0===b.selectIds.length)return C.alert("请先选择简历");var c=a.getBatchCond();G.downloadExcel(c,{})}},{name:"click .js-test-link",handler:function(a){var b=v(a.currentTarget),c=b.parent().parent().attr("data-id");D.show({uid:c})}},{name:"click .js-deliver-link",handler:function(a){var b=v(a.currentTarget),c=b.parent().parent().attr("data-id");E.show({uid:c})}}]},{initialize:d,initCpn:f,reload:g,load:h,renderBatchOperation:e,renderTotal:i,renderList:j,renderNone:k,getCond:l,getBatchCond:m,getLineId:n,updatePreviewUrl:o,wrapStr:p,saveIds:q,getIdPageIndex:r,getDownloadName:s})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/preview/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../extend/event","../util","../../viewResume/index","../../render/theme0","../../render/util","../../render/dataMenu","../../render/dataItem","../../../../../util/switch","../../../../../component/popupSub/popupResumeTag","../../../../../action/resume","../../../../../util/ajax","../../../extend/bll/resume","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/position","../../../../../action/common","../../../extend/bll/resumeDoneTest","../../../../../action/resumeDoneTest"],function(a,b,c){function d(){var a=this;a.initEvent()}function e(){var a=this,b=function(){a.viewResume.initResume&&a.viewResume.initResume()};v.listen(z.RESUME_UPDATE,b),a.listen("destroy",function(){v.unlisten(z.RESUME_UPDATE,b)})}function f(){var a=this;a.viewResume=new B({renderTo:a.getEl(),module:a,nav:a.getNavConf(),resume:a.getResumeConf()})}function g(){var a=this,b={getNavData:u.bind(a.getNavData,a)};return b}function h(a,b,c){var d=this,e=d.getParam();if(!d.getCond()||e.id)return void(b&&b({data:[{uid:e.id}],totalPage:1,currentPage:1,totalCount:1}));var f=u.extend({},d.getCond(),{currentPage:a||1,pageSize:20});f.operation="search",F.syncDo({body:f,call:function(a){var c=a.data.data;u.isArray(c)&&(u.forEach(c,function(a){a.name=a.name,a.unread=a.unread,a.info=[a.school,a.major]}),b&&b(a.data))},error:function(a){c&&c(a.msg)}})}function i(){var a=this,b={tagTypeConf:{entityType:2002,sceneType:2},getResumeData:u.bind(a.getResumeData,a),getFooterConf:u.bind(a.getFooterConf,a)};return b}function j(a,b,c){F.getDetail({params:{userId:a.uid},query:{},call:function(a){var c=a.data;c.name=c.resumeName,b&&b(c)},error:function(a){c&&c(a.msg)}})}function k(a){{var b=this;b.getEl()}return b.resumeData=a,[].concat(b.getLeftFooter(),b.getRightFooter())}function l(){var a=this,b=a.resumeData,c=[{name:"下载简历",side:"left",cls:"",call:function(){var a=C.getCondById(b.id);E.download(a,{count:1})}}];return c}function m(){var a=this,b=a.resumeData,c=b.selectStatus,d=a.viewResume,e=[];if(c){var e=[{name:1===c?"已淘汰":"已通过",hoverName:1===c?"撤回淘汰":"撤回通过",side:"right",cls:"btn btn-default",call:function(){a.markSelect(0)}}];return d.hasNextResume()&&e.push({name:"下一份 >",side:"right",cls:"link-green",call:function(){d.changeResume("next")}}),e}var e=[{name:"合适",side:"right",cls:"btn btn-primary",call:function(){a.markSelect(2)}},{name:"不合适",side:"right",cls:"btn btn-primary",call:function(){a.markSelect(1)}}];return e}function n(a){var b=this,c=b.getEl(),d=b.resumeData;w.mark(c)||D.markSelect({body:{entityType:2002,entityId:d.userId,status:a},call:function(){d.selectStatus=a,b.viewResume.renderResumeFooter(),x.tips("操作成功")},error:function(a){x.alert(a.msg)},always:function(){w.pause(c)}})}function o(){var a=this,b=a.getParam();return u.id(b.id)||a.getCond()?!0:(a.nav("resume"),!1)}function p(){return A.getDb(A.DB_COND)}function q(){return{crumb:[{title:"做题简历",module:"resume",action:"donetest/index/index"}]}}var r=a("nc"),s=a("cpn"),t=(r.$,r.Clazz),u=(r.Db,r.Base),v=r.Event,w=r.Limit,x=s.Popup,y=a("../../../../../core/module"),z=a("../../../extend/event"),A=a("../util"),B=a("../../viewResume/index"),C=a("../../../extend/bll/resume"),D=a("../../../../../action/resume"),E=a("../../../extend/bll/resumeDoneTest"),F=a("../../../../../action/resumeDoneTest"),G=c.exports=t.create();t.mix(G,y,{style:"/stylesheets/styles/system/resumeManage.css",title:"查看做题简历",showTask:!0,_template:['<div class="manage-box"></div>'].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;window.setTimeout(function(){a.check()&&(a.initViewResume(),a.sizeFull(function(b,c){a.viewResume&&a.viewResume.reHeight(c)}))},250)}}]},{initialize:d,initEvent:e,initViewResume:f,getNavConf:g,getNavData:h,getResumeConf:i,getResumeData:j,getFooterConf:k,getLeftFooter:l,getRightFooter:m,markSelect:n,check:o,getCond:p,getCrumbConf:q})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/donetest/util",["nc","../../../../core/siteConfig"],function(a,b,c){function d(a){var b=this,c=b._db=b._db||new i(j.appDb.DoneVTestResume);return h.trim(a)?c.get(a)||{}:c}function e(a,b){var c=this,d=c.getDb();c._db.refresh(),d.set(a,b)}function f(a){var b=this,c=b.getDb();b._db.refresh(),c.remove(a)}var g=a("nc"),h=(g.Base,g.$),i=g.Db,j=a("../../../../core/siteConfig");c.exports={DB_COND:"DB_RESUME_DONE_TEST_COND",DB_FILTER:"DB_RESUME_DONE_TEST_FILTER",getDb:d,setDb:e,removeDb:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/companyPage/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/position","../../../../../util/ajax"],function(a,b,c){function d(){var a=this;a.companyData||(a.db=new w(E))}function e(){var a=this,b=[{key:"name",text:"公司名称",tips:"必填项"},{key:"logo",text:"公司LOGO",tips:"必填项，建议尺寸80 x 80，宽度最大不超过200(单位: px)",tipsLineHeight:60,html:['<div class="company-logo" style="height:60px;">','<img class="js-logo-cover" src="//uploadfiles.nowcoder.com/images/20160520/56_1463728821615_B856A5CA00C64BEA1A77436F8FE39D5E" style="height:100%;">',"</div>",'<a href="javascript:void(0);" class="link-green js-upload-logo-btn">点击上传</a>','<span class="error js-logo-error" style="display:none;"><span class="input-tip">务必上传图片！</span></span>'].join("")},{key:"scale",text:"公司规模"},{key:"category",text:"公司业务类别"},{key:"city",text:"公司所在城市"},{key:"website",text:"公司官网"},{key:"intro",text:"公司简介",tips:"不要超过150字",tipsLineHeight:100},{key:"domain",text:"网申个性化域名",tips:"必填项，此域名设置好后不可修改，请谨慎填写！",html:["www.nowcoder.com/careers/","<span></span>","/项目编号"].join("")}];a.getEl().html(v.execTpl(['<div class="module-body">','<div class="recruit-setting">','<div v-for="item in items" class="form-group">','<label class="control-label">#{item.text}</label>','<div :class="cls(item)">#{item.html}</div>','<span v-if="item.tips" class="choose-tips" :style="tipsStyle(item)">#{item.tips}</span>',"</div>",'<div class="form-group">','<label class="control-label"></label>','<div class="control-group">','<a href="javascript:void(0);" class="btn btn-primary js-confirm-btn">确定</a>',"</div>","</div>","</div>","</div>"],{items:b,cls:function(a){return"control-group js-cpn-"+a.key},tipsStyle:function(a){return"top:"+((a.tipsLineHeight||42)-22)/2+"px"}}))}function f(){var a=this;a.nameCpn=new x({renderTo:a.getEl(".js-cpn-name"),placeholder:"例如：百度，牛客网",listeners:{change:t.bind(a.inputChange,a)}});var b=A.show({target:a.getEl(".js-upload-logo-btn"),fileType:"*.jpg;*.JPG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP;*.jpeg;*.JPEG",url:C.getUploadUrl(1),call:function(b){a.getEl(".js-cpn-logo img").attr("src",b.data),a.getEl(".js-logo-error").hide(),a.picUrl=b.data,a.inputChange(),y.tips("上传成功")}});a.pushChild(b),a.scaleCpn=new x({renderTo:a.getEl(".js-cpn-scale"),placeholder:"例如：天使轮，A轮,上市",listeners:{change:t.bind(a.inputChange,a)}}),a.categoryCpn=new x({renderTo:a.getEl(".js-cpn-category"),placeholder:"例如：电商，在线教育",listeners:{change:t.bind(a.inputChange,a)}});a.cityCpn=new z({renderTo:a.getEl(".js-cpn-city"),text:"可多选",noSelectAll:!0,needSearch:!0,options:[],listeners:{change:t.bind(a.inputChange,a)}});a.fixCityOption(),a.websiteCpn=new x({renderTo:a.getEl(".js-cpn-website"),listeners:{change:t.bind(a.inputChange,a)}}),a.introCpn=new x({renderTo:a.getEl(".js-cpn-intro"),type:"textarea",placeholder:"例如：牛客网是一个面向IT程序员的专业笔试、面试题库平台，专注于程序员的学习和成长服务",listeners:{change:t.bind(a.inputChange,a)}}),a.introCpn.getEl("textarea").css({width:248,height:80,resize:"none"}),a.domainCpn=new x({renderTo:a.getEl(".js-cpn-domain span"),renderBy:"replaceWith",placeholder:"例如：niuke, baidu, Tencent",listeners:{change:t.bind(a.inputChange,a)}}),a.domainCpn.getEl().css({display:"inline-block","float":"none"})}function g(a){var b=this;return 0===arguments.length?{companyName:r.trim(b.nameCpn.val()),picUrl:b.picUrl,scale:r.trim(b.scaleCpn.val()),category:r.trim(b.categoryCpn.val()),place:b.cityCpn.val().join(" "),siteUrl:r.trim(b.websiteCpn.val()),detail:r.trim(b.introCpn.val()),url:r.trim(b.domainCpn.val())}:(a=a||{},b.nameCpn.val(a.companyName),b.picUrl=a.picUrl,b.getEl(".js-cpn-logo img").attr("src",a.picUrl),b.scaleCpn.val(a.scale),b.categoryCpn.val(a.category),b.cityCpn.val((a.place||"").split(" ")),b.websiteCpn.val(a.siteUrl),b.introCpn.val(a.detail),b.domainCpn.val(a.url),void b.fixDomain())}function h(){var a=this,b=a.val(),c=!0;return b.companyName||(c=!1,a.nameCpn.errorTips("务必填写此项！")),b.picUrl||(c=!1,a.getEl(".js-logo-error").show()),b.detail.length>150&&(c=!1,a.introCpn.errorTips("字数超出150字")),b.url?/^\w+$/.test(b.url)||(c=!1,a.domainCpn.errorTips("只能包含英文和数字")):(c=!1,a.domainCpn.errorTips("务必填写此项！")),c}function i(){var a=this,b=a.getEl();if(!u.mark(b)){{var c=!!a.companyData;a.val()}D[c?"updateCompany":"setCompany"]({type:c?"PUT":"POST",body:t.extend(a.val(),c?{companyId:a.companyData.id}:{}),call:function(){a.db&&a.db.remove();var b=a.getParam(),c=b.back;return c&&c.module&&c.param?a.nav(c.module,c.param):void a.nav("resume",{action:"position/project/index"})},error:function(a){y.alert(a.msg)},always:function(){u.clear(a.getEl())}})}}function j(){var a=this;a.companyData||(a.db.refresh(),a.db.set(a.getUserId(),a.val()))}function k(a){var b=this,c=b.cityCpn,d=b.cityData,e=c.val(),f=t.map(d,function(a){return{text:a,value:a}});a&&e.push(a),b.cityCpn&&c.replaceOptions(f),c.val(e);var g=c.attachSel.noneEl;g.html('<a class="link-green" href="javascript:void(0);">+把这个城市添加为选项</a>'),g.find("a").on("click",function(){var a=c.attachSel.searchIpt,e=r.trim(a.val());c.attachSel.attach.forceHide(),d.push(e),D.updateJobPlace({type:"PUT",body:{jobPlaceList:d},call:function(){b.fixCityOption(e)},error:function(a){y.alert(a.msg)}})})}function l(){var a=this;a.companyData&&a.domainCpn.disabled()}function m(a,b){var c=this;D.getCompany({query:{},call:function(b){a&&a(b.data)},error:function(a){t.isFunction(b)?b(a.msg):"popup"===b?y.alert(a.msg):c.renderNone(c.getEl(b),a.msg)}})}function n(a,b){var c=this;D.getJobPlace({query:{},call:function(b){a&&a(b.data)},error:function(a){t.isFunction(b)?b(a.msg):"popup"===b?y.alert(a.msg):c.renderNone(c.getEl(b),a.msg)}})}function o(){var a=this,b=(a.getParam(),t.extend({},{action:"position/project/index"}));return{crumb:[{title:"职位管理",module:"resume",param:b}]}}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Clazz,t=p.Base,u=p.Limit,v=p.Node,w=p.Db,x=q.Input,y=q.Popup,z=q.SelectMult,A=q.AttachUpload,B=a("../../../../../core/module"),C=a("../../../../../util/util"),D=a("../../../../../action/position"),E="DB_COMPANY_PAGE",F=c.exports=s.create();s.mix(F,B,{style:"/stylesheets/styles/system/myJobs.css",title:"公司招聘主页设置",showTask:!0,_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getCompanyInfo(function(b){a.companyData=b,a.getCity(function(b){a.cityData=b,a.initDb(),a.initContainer(),a.initField();var c=a.companyData?a.companyData:a.db.get(a.getUserId());c&&a.val(c)})})}},{name:"click .js-confirm-btn",handler:function(){var a=this;a.check()&&a.submit()}}]},{initDb:d,initContainer:e,initField:f,val:g,check:h,submit:i,inputChange:j,fixCityOption:k,fixDomain:l,getCity:n,getCompanyInfo:m,getCrumbConf:o})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/cpn/field",["nc","cpn","./orderList"],function(a,b,c){function d(){var a=this,b=a.getEl(),c=b.find(".js-list"),d=b.find(".js-order");a.orderCpn=new s({renderTo:d,listeners:{submit:function(b){var c=a.listDv,d=l.toMap(a.items,function(a){return{key:a.id,value:a}});a.items.length=0,l.forEach(b,function(b){var e=b.id;c.append(c.find(".js-list-item[data-id="+e+"]")),e&&d[e]&&a.items.push(d[e])}),a.fire("change")},order:function(){b.css("display","block"),c.hide(),d.show(),a.fire("changeShow")},exit:function(){b.css("display","inline-block"),d.hide(),c.show(),a.fire("changeShow")}}})}function e(){{var a=this,b=a.rawConfig,c=a.getEl(),d=c.find(".js-action-add"),e=c.find(".js-action-order");c.find(".js-action-save"),c.find(".js-action-cacel")}!b.addItem&&d.hide(),b.addBtnTxt&&d.html(b.addBtnTxt),e[a.items.length>1&&b.needOrder?"show":"hide"](),d.on("click",function(){b.addItem(function(c){var d={id:l.key(),data:c};a.items.push(d),a.renderItem(d),e[a.items.length>1&&b.needOrder?"show":"hide"](),a.fire("change")})}),e.on("click",function(){var b=l.map(a.items,function(a){var b=a.data;return{id:a.id,name:b.name,noMovable:b.noMovable}});a.orderCpn.order(b)})}function f(a){var b=this;l.forEach(a,function(a){b.renderItem(a)})}function g(a,b,c){var d=this,e=a.data;b=b||d.listDv,c=c||"append";var f=m('<div class="js-list-item" style="line-height:40px;" data-id="'+a.id+'"></div>');b[c](f);var g=new p({renderTo:f,text:e.name,checked:e.checked,disabled:e.disabled,change:function(){e.checked=this.isChecked(),d.fire("change")}}),h=m('<span class="choose-tips" style="display:none;">必填项</span>');g.getEl().append(h),e.need&&h.show(),d.renderItemTips(a,g)}function h(a,b){var c=this,d=a.data;if(!d.noTips){var e=c.rawConfig,f=b.getEl().parent(),g=f.find("label.checkbox"),h=new q({target:g,attach:{horz:!0,reverse:!1,center:!0},content:['<div class="tooltip-arrow"><i></i></div>','<div class="tooltip-inner">',d.noChoice?"":'<label class="radio '+(d.need?"checked":"")+'" style="margin-right:5px;"><span class="icons"></span><input value="0"> 必填</label>',d.noChoice?"":'<label class="radio '+(d.need?"":"checked")+'" style="margin-right:10px;"><span class="icons"></span><input value="1"> 选填</label>',d.editable?'<a href="javascript:void(0);" class="icon-edit js-edit"></a>':"","</div>"].join("")});h.getEl().addClass("tooltip tooltip-info right"),b.pushChild(h),r.mix({el:h.getEl("label.radio"),listeners:{change:function(){d.need="0"===this.val(),g.find(".choose-tips")[d.need?"show":"hide"](),c.fire("change")}}}),h.getEl(".js-edit").on("click",function(){h.forceHide(),e.editItem({item:d,call:function(){var b=l.findIndex(c.items,function(a){return a.data===d});b>=0&&(c.renderItem(a,f,"after"),o.recycle(f),c.fire("change"))}})})}}function i(a){var b=this;return 0===arguments.length?l.map(b.items,function(a){return a.data}):(o.recycle(b.listDv,!1),b.items=l.map(a,function(a){return{id:l.key(),data:a}}),void b.renderList(b.items))}var j=a("nc"),k=a("cpn"),l=j.Base,m=j.$,n=j.Clazz,o=j.Component,p=(j.Dom,j.Str,j.DragDrop,k.CheckBox),q=k.Attach,r=k.CheckGroup,s=a("./orderList"),t=c.exports=n.create();n.mix(t,o,{_template:['<div class="clearfix" style="display:inline-block;">','<div class="js-list">','<div class="js-item-list"></div>','<div class="btn-setting-port">','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-action-add">+ 新增简历字段</a>','<a href="javascript:void(0);" class="btn btn-primary btn-auto js-action-order"><i class="icon-th-large"></i> 排序</a>',"</div>","</div>",'<div class="js-order" style="display:none;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.getEl(),c=a.rawConfig;a.items=[],a.listDv=b.find(".js-item-list"),a.val(c.data),a.initOrder(),a.initAction()}}]},{initOrder:d,initAction:e,renderList:f,renderItem:g,renderItemTips:h,val:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/cpn/orderList",["nc","cpn"],function(a,b,c){function d(a){var b=this,c=b.getEl();a=a||[],c.hide(),a.length>0&&(b.items=a,c.show(),b.clear(),b.renderItem(a),b.initDrag(a),b.fire("order"))}function e(){var a=this;a.fire("cancel"),a.fire("exit"),a.clear()}function f(){var a=this,b=a.getEl(),c=[],d=m.toMap(a.items,function(a){return{key:a.id,value:a}});return m.forEach(b.find(".js-order-item"),function(a){a=k(a);var b=k.trim(a.attr("data-id"));b&&d[b]&&c.push(d[b])}),c}function g(a){var b=this,c=b.orderEl,d=m.map(a,function(a,b){return n.execTpl(['<div class="job-item js-order-item #{cls}" data-id="#{id}">','<div class="job-item-num">#{index}</div>','<div class="job-item-main">',"<span>#{name}</span>",a.noMovable?"":'<i class="icon-th-large"></i>',"</div>","</div>"].join(""),{cls:a.noMovable?"item-disabled":"",id:a.id,name:a.name,index:b+1})});c.html(d.join(""))}function h(){function a(a,b,c,d){var f=e.find(".js-order-item"),g=b.replaceBox;m.forEach(f,function(f,i){f=k(f);var j=k.trim(f.attr("data-id"));if(j&&h[j]&&!h[j].noMovable&&f.get(0)!==a.get(0)){var l=o.getPosLeft(f,e),n=o.getPosTop(f,e),p=f.outerWidth(),q=f.outerHeight();if(c>=l&&l+p>=c&&d>=n&&n+q>=d){var r=b.itemIndex<=i;return f[r?"after":"before"](g),b.itemIndex=i+(r?1:0),m.BREAK}}})}var b,c,d=this,e=d.orderEl,f=e.find(".js-order-item"),g=!1,h=m.toMap(d.items,function(a){return{key:a.id,value:a}});m.forEach(f,function(d,f){d=k(d);var i=k.trim(d.attr("data-id"));if(i&&h[i]&&!h[i].noMovable){var j=d.outerWidth(),l=d.outerHeight();new p({drag:d,listeners:[{name:"start",handler:function(){b=e.outerWidth(),c=e.outerHeight();var a=o.getPosLeft(d,e),g=o.getPosTop(d,e);this.startLeft=a,this.startTop=g,this.replaceBox=k('<div class="job-item item-drag"><div class="job-item-num"></div><div class="job-item-main"><span></span></div></div>'),this.itemIndex=f,d.before(this.replaceBox),d.css("left",a).css("top",g).css("position","absolute").css("z-index",9)}},{name:"drag",handler:function(){g=!0;var e=this.startLeft+this._moveX-this._downX,f=this.startTop+this._moveY-this._downY;d.css("left",Math.min(b-j,Math.max(0,e))),d.css("top",Math.min(c-l,Math.max(0,f))),a(d,this,e+j/2,f+l/2)}},{name:"drop",handler:function(){g&&(g=!1,d.removeAttr("style"),this.replaceBox.before(d),this.replaceBox.remove(),delete this.startTop,delete this.startLeft,delete this.replaceBox,m.forEach(e.find(".js-order-item"),function(a,b){k(a).find(".job-item-num").html(b+1)}))}}]})}})}function i(){var a=this,b=a.orderEl,c=b.find(".js-order-item");c.unbind(),q.recycle(b,!1)}var j=a("nc"),k=(a("cpn"),j.$),l=j.Clazz,m=j.Base,n=j.Str,o=j.Dom,p=j.DragDrop,q=j.Component,r=c.exports=l.create();l.mix(r,q,{_template:['<div style="display:none;">','<div class="module-head clearfix" style="padding:10px 0;">','<div class="module-head-oprt">','<button type="button" class="btn btn-primary btn-xs js-action-save">保存</button> ','<button type="button" class="btn btn-default btn-xs js-action-cacel">取消</button>',"</div>","<h1>请直接拖动字段到你想要的位置，位置1最靠前</h1>","</div>",'<div class="js-order-container job-item-wrapper" style="margin:0;position:relative;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig,c=a.getEl();a.orderEl=c.find(".js-order-container"),a.order(b.items)}},{name:"click .js-action-save",handler:function(){var a=this;a.fire("submit",a.val()),a.fire("exit",!0),a.clear()}},{name:"click .js-action-cacel",handler:function(){var a=this;a.cancel()}}]},{order:d,cancel:e,val:f,renderItem:g,initDrag:h,clear:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/cpn/popupDeliver",["nc","cpn"],function(a,b,c){function d(a){a=a||{};var b=new u(a);return r.wrap(b,{title:a.title||"增加投递字段",content:b.html(),width:550,cancelTxt:"取消",ok:function(){return b.check()?void(a.ok&&a.ok(b.val())):!0}}),b}function e(){var a=this;a.nameCpn=new s({renderTo:a.getEl(".js-name"),renderBy:"replaceWith"}),a.typeCpn=t.mix({el:a.getEl(".js-type label.radio")}),a.typeCpn.val("select"),a.getEl(".js-type").hide(),a.addChoice()}function f(a){var b=this;if(0===arguments.length){var c=[];return o.forEach(b.choiceHome,function(a){var b=n.trim(a.val());b&&c.push({text:b,value:b})}),{name:n.trim(b.nameCpn.val()),type:b.typeCpn.val(),select:c}}a=a||{},b.nameCpn.val(a.name),b.clearChoice(),a.select&&a.select.length?o.forEach(a.select,function(a){b.addChoice().val(a.value)}):b.addChoice()}function g(){var a=this,b=a.choiceHome=a.choiceHome||{},c=a.choiceKey=a.choiceKey||1,d=n(['<div class="form-group js-choice-item">','<label class="control-label">选项<span class="js-index"></span></label>','<div class="js-ipt"></div>','<a href="javascript:void(0);" class="icon-trash js-trash" data-index="',c,'" style="line-height:42px;font-size:20px;margin-left:10px;"></a>',"</div>"].join(""));return a.getEl(".js-choice-home").append(d),b[c]=new s({renderTo:d.find(".js-ipt"),renderBy:"replaceWith",placeholder:"输入选项，不能超过18个字符"}),a.choiceKey++,a.fixChoice(),b[c]}function h(){var a=this,b=a.getEl(".js-choice-item"),c=b.length>1;o.forEach(b,function(a,b){a=n(a),a.find(".js-index").html(b+1),a.find(".js-trash")[c?"show":"hide"]()})}function i(){var a=this;o.forEach(a.choiceHome,function(b,c){b.getEl().closest(".js-choice-item").remove(),b.destroy(),delete a.choiceHome[c]})}function j(){{var a=this,b=!0;a.val()}n.trim(a.nameCpn.val())||(b=!1,a.nameCpn.errorTips("请填写名称"));var c=0;return o.forEach(a.choiceHome,function(a){n.trim(a.val())||(a.errorTips("请设置选项"),b=!1,c++)}),c===o.size(a.choiceHome)?!0:b}function k(a){var b=this;b.nameCpn.disabled(a)}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=l.Component,r=m.Popup,s=m.Input,t=m.CheckGroup,u=c.exports=p.create();p.mix(u,q,{_template:["<div>",'<div class="form-group">','<label class="control-label">名称</label>','<div class="js-name"></div>',"</div>",'<div class="form-group js-type">','<label class="control-label">填写方式</label>','<label class="radio" style="margin-right:10px;line-height:42px;"><span class="icons"></span><input type="radio" value="select">固定选项-单选</label>','<label class="radio" style="line-height:42px;"><span class="icons"></span><input type="radio" value="selectMult">固定选项-多选</label>',"</div>",'<div class="js-choice-home"></div>','<div style="text-align:center;font-size:14px;"><a href="javascript:void(0);" class="link-green js-add-choice">+ 添加选项</a></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.initCpns(),b.val&&a.val(b.val)}},{name:"click .js-add-choice",handler:function(){var a=this;a.addChoice()}},{name:"click .js-trash",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-index");c.closest(".js-choice-item").remove(),delete b.choiceHome[d],b.fixChoice()}}],show:d},{initCpns:e,val:f,addChoice:g,fixChoice:h,clearChoice:i,check:j,disableName:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/cpn/popupName",["nc","cpn"],function(a,b,c){function d(a){a=a||{};var b=new n(a);l.wrap(b,{title:a.title||"增加简历字段",content:b.html(),width:550,cancelTxt:"取消",ok:function(){return b.check()?void(a.ok&&a.ok({name:i.trim(b.nameCpn.val())})):!0}})}function e(){var a=this;a.nameCpn=new m({renderTo:a.getEl(".js-name"),renderBy:"replaceWith",value:(a.rawConfig.val||{}).name})}function f(){var a=this;return i.trim(a.nameCpn.val())?!0:void 0}var g=a("nc"),h=a("cpn"),i=g.$,j=(g.Base,g.Clazz),k=g.Component,l=h.Popup,m=h.Input,n=c.exports=j.create();j.mix(n,k,{_template:['<div class="form-group">','<label class="control-label">名称</label>','<div class="js-name"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns()}}],show:d},{initCpns:e,check:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editPosition/field",["nc","cpn","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage","../../../../../component/department","../../../../../util/switch","../../../../../action/user","../../../../../util/ajax","./popupLoadPosition","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/resume","../../../../../action/position","../../../../../action/common","../../../../../component/table","../../../../../component/selectAll","../cpn/popupDeliver","../cpn/field","../cpn/orderList"],function(a,b,c){function d(){function a(a){return['<span class="choose-tips"'+(a?' style="position:relative;top:100px;left:10px;"':"")+">必填项</span>",'<span class="input-tip" style="position:relative;top:202px;left:-855px;color:#ff5400;">务必填写此项</span>'].join("")}var b=this,c='<a href="javascript:void(0);" class="load-position-link font-green js-load-position"><i class="icon-download-alt"></i>载入已有职位设置</a>',d='<span class="input-tip" style="color:#ff5400;position:relative;top:0;left:-28px;"></span>',e=[{title:"职位名称",cls:"js-name",ext:a()+c},{title:"职能部门",cls:"js-department"},{title:"工作城市",cls:"js-job-city"},{title:"面试城市",cls:"js-interview-city"},{title:"投递字段",cls:"js-deliver",ext:d},{title:"职位描述",cls:"js-position-describe",ext:a(!0)},{title:"任职要求",cls:"js-demand",ext:a(!0)}],f=u.execTpl(['<div v-for="item in items" class="form-group">','<label class="control-label">#{item.title}</label>','<div :class="cls(item.cls)"></div>',"#{item.ext}","</div>",'<div class="js-authority"></div>'],{items:e,cls:function(a){return a+" control-group"}});b.getEl().html(f)}function e(){function a(a){var c={job:{cpn:"jobCityCpn",text:"+添加为新工作城市"},interview:{cpn:"interviewCityCpn",text:"+添加为新面试城市"}}[a],d=b[c.cpn],e=d.attachSel.noneEl;e.html('<a class="link-green" href="javascript:void">'+c.text+"</a>"),e.find("a").on("click",function(){var c=d.attachSel.searchIpt,e=q.trim(c.val());d.attachSel.attach.forceHide(),b.fixCity(e,a)})}var b=this;r.forEach([{name:"nameCpn",cls:".js-name"},{name:"departmentCpn",cls:".js-department"}],function(a){b[a.name]=new w({renderTo:b.getEl(a.cls),renderBy:"replaceWith",listeners:{change:function(){b.fire("inputChange")}}})}),r.forEach([{name:"jobCityCpn",cls:".js-job-city",options:"jobCityData",fixName:"job"},{name:"interviewCityCpn",cls:".js-interview-city",options:"interviewCityData",fixName:"interview"}],function(c){b[c.name]=new y({renderTo:b.getEl(c.cls),renderBy:"replaceWith",needSearch:!0,options:r.map(b[c.options],function(a){return{text:a,value:a}}),listeners:{change:function(){b.fire("inputChange")}}}),a(c.fixName)});var c=r.json(b.projectData.projectConfig)||{};r.forEach(c.deliverMenu,function(a){a.checked=a.editable=a.disabled=a.noChoice=!0}),(c.deliverMenu||[]).length?b.deliverFieldCpn=new D({renderTo:b.getEl(".js-deliver"),renderBy:"replaceWith",data:c.deliverMenu,editItem:function(a){var c=a.item;C.show({val:c,ok:function(d){r.extend(c,d),b.getCpnErrorEl(b.deliverFieldCpn).hide(),b.fire("inputChange"),a.call&&a.call()}}).disableName()},listeners:{change:function(){b.fire("inputChange")}}}):b.getEl(".js-deliver").closest(".form-group").hide(),r.forEach([{name:"positionDescribeCpn",cls:".js-position-describe"},{name:"demandCpn",cls:".js-demand"}],function(a){var c=b[a.name]=new z({renderTo:b.getEl(a.cls),width:800,height:200,noCodeSelect:!0,draftChange:function(){b.fire("inputChange")},afterFocus:function(){b.getCpnErrorEl(c).hide()}})}),b.authorityCpn=new A({renderTo:b.getEl(".js-authority"),renderBy:"replaceWith",tip:"选择设置管理权限，只有设置的机构以及它的上级机构可以管理该职位的简历；所属部门只做展示和筛选使用，与机构无关",departmentData:b.rawConfig.departmentData,marginLeft:"-23px",listeners:{change:function(){b.fire("inputChange")}}}),b.authorityCpn.getEl(".control-label").width(135)}function f(){function a(a){E[a.method]({query:{projectId:d.projectId},call:function(b){r.forEach(b.data||[],function(b){a.data.push({text:b})})}})}function b(a,b,c){var d=r.filter(a.data,function(a){return b&&a.text&&-1!==a.text.indexOf(b)});r.isFunction(c)&&c(d)}function c(a){var b=['<li class="js-item" ','data-id="',a._sid,'" style="width:',e,'px;">','<a href="javascript:void(0);">',a.text,"</a>","</li>"].join("");return b}var d=this,e=d.departmentCpn.getEl("input").outerWidth()-2,f=[{cpnKey:"departmentCpn",method:"getDepartments",data:[]}];r.forEach(f,function(e){var f=d[e.cpnKey].getEl("input"),g=x.show({input:f,attach:{extOffset:{left:-1}},needReWidth:!0,needSame:!0,reqList:function(a,c){b(e,a,c)},getItemStr:function(a){return c(a)},ok:function(a){f.val(a.text),d.fire("inputChange")}});d.pushChild(g),a(e)})}function g(a){var b=this,c=b.deliverFieldCpn;if(0===arguments.length){var d={jobName:q.trim(b.nameCpn.val()),tags:q.trim(b.departmentCpn.val()),jobCity:b.jobCityCpn.val().join(","),interviewCity:b.interviewCityCpn.val().join(","),infos:q.trim(b.positionDescribeCpn.val()),requirements:q.trim(b.demandCpn.val()),departmentId:b.authorityCpn.val()};if(c&&c.val()){var e=[];r.forEach(c.val(),function(a){a.checked&&a.select&&a.select.length>0&&e.push({key:a.key,name:a.name,type:a.type,select:a.select})}),d.deliverConfig=JSON.stringify(e)}return d}if(b.nameCpn.val(a.jobName),b.departmentCpn.val(a.tags),b.jobCityCpn.val((a.jobCity||"").split(",")),b.interviewCityCpn.val((a.interviewCity||"").split(",")),b.positionDescribeCpn.val(a.infos),b.demandCpn.val(a.requirements),b.authorityCpn.val(r.id(a.department)),c){var f={};r.forEach(r.json(a.ext),function(a){f[a.name]=a});var g=r.map(c.val(),function(a){return r.extend({checked:!0,editable:!0,disabled:!0,noChoice:!0},f[a.name]||a)});c.val(g)}b.fixName(a)}function h(a){var b=this,c=b.deliverFieldCpn;if(0===arguments.length){var d={jobName:q.trim(b.nameCpn.val()),tags:q.trim(b.departmentCpn.val()),jobCity:b.jobCityCpn.val(),interviewCity:b.interviewCityCpn.val(),infos:q.trim(b.positionDescribeCpn.val()),requirements:q.trim(b.demandCpn.val()),departmentId:b.authorityCpn.val()};if(c&&c.val()){var e=[];r.forEach(c.val(),function(a){a.checked&&e.push({key:a.key,name:a.name,type:a.type,select:a.select})}),d.deliverConfig=JSON.stringify(e)}return d}if(a=a||{},b.nameCpn.val(a.jobName),b.departmentCpn.val(a.tags),b.jobCityCpn.val(a.jobCity),b.interviewCityCpn.val(a.interviewCity),b.positionDescribeCpn.val(a.infos),b.demandCpn.val(a.requirements),b.authorityCpn.val(r.id(a.departmentId)),c){var f={};r.forEach(r.json(a.ext),function(a){f[a.name]=a});var g=r.map(c.val(),function(a){return r.extend({checked:!0,editable:!0,disabled:!0,noChoice:!0},f[a.name]||a)});c.val(g)}}function i(){function a(a){v.scrollToEl({el:a,scrollEl:v.getScrollParent(a),ext:-20,animation:!0})}var b=this,c=b.val(),d=!0;c.jobName||(b.nameCpn.errorTips("务必填写此项"),a(b.nameCpn.getEl()),d=!1);var e=b.deliverFieldCpn&&b.deliverFieldCpn.val(),f=[];return r.forEach(e,function(a){a.select&&0!==a.select.length||f.push(a.name)}),c.infos||(b.getCpnErrorEl(b.positionDescribeCpn).show(),a(b.positionDescribeCpn.getEl()),d=!1),c.requirements||(b.getCpnErrorEl(b.demandCpn).show(),a(b.demandCpn.getEl()),d=!1),/^[a-zA-Z0-9\u4e00-\u9fa5]*$/.test(c.tags)||(b.departmentCpn.errorTips("只能使用中英文和数字"),a(b.departmentCpn.getEl()),d=!1),f.length&&(b.deliverFieldCpn.getEl().closest(".form-group").find(".input-tip").html("投递字段"+f.join("、")+"选项为空").show(),d=d===!1?d:"该职位投递字段"+f.join("、")+"选项为空，确定保存？"),d}function j(a){var b=this,c=a.deliverCount>0,d=b.nameCpn;d.disabled(c),d[c?"addClass":"removeClass"](d.getEl(),"js-tips"),d.getEl().attr("title",c?"该职位有人投递，不能修改职位名字":"")}function k(a,b){var c=this,d={job:{cpn:"jobCityCpn"},interview:{cpn:"interviewCityCpn"}}[b],e=c[d.cpn],f=e.val(),g=e.rawConfig.options;f.push(a),g.push({text:a,value:a,checked:!0}),e.replaceOptions(g)}function l(a){return a.getEl().closest(".form-group").find(".input-tip")}function m(a,b){var c=this;E.getJobCities({query:{projectId:c.projectId},call:function(b){a&&a(b.data||[])},error:function(a){b?b(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}function n(a,b){var c=this;E.getInterviewCities({query:{projectId:c.projectId},call:function(b){a&&a(b.data||[])},error:function(a){b?b(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Base,s=o.Clazz,t=o.Component,u=o.Node,v=o.Dom,w=p.Input,x=p.AttachSuggest,y=p.SelectMult,z=a("../../../../../component/editorSub/hEditor/index"),A=a("../../../../../component/department"),B=a("./popupLoadPosition"),C=a("../cpn/popupDeliver"),D=a("../cpn/field"),E=a("../../../../../action/position"),F=c.exports=s.create();s.mix(F,t,{_template:'<div class="recruit-setting"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this,b=a.rawConfig;a.module=b.parent,a.projectId=b.projectId,a.departmentData=b.departmentData,a.projectData=b.projectData,a.isNew=b.isNew,a.getJobCities(function(b){a.jobCityData=b,a.getInterviewCities(function(b){a.interviewCityData=b,a.initContainer(),a.initCpns(),a.initSuggest(),a.fire("loaded")})})}},{name:"click .js-load-position",handler:function(){var a=this;B.show({module:a.module,listeners:{load:function(b){a.val(b,!0)}}})}}]},{initContainer:d,initCpns:e,initSuggest:f,val:g,localVal:h,check:i,fixCity:k,fixName:j,getCpnErrorEl:l,getJobCities:m,getInterviewCities:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editPosition/index",["nc","cpn","./field","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage","../../../../../component/department","../../../../../util/switch","../../../../../action/user","../../../../../util/ajax","./popupLoadPosition","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/resume","../../../../../action/position","../../../../../action/common","../../../../../component/table","../../../../../component/selectAll","../cpn/popupDeliver","../cpn/field","../cpn/orderList","../../../../../core/module"],function(a,b,c){function d(a){var b=this;b.rawConfig=a,b.db=new r(y.appDb.positionResume),b.constructor.title=b.isNewPosition()?"新建职位":"编辑职位"}function e(){{var a=this,b=a.getEl();a.getParam()}b.html(['<div class="module-body">','<div class="js-field"></div>','<div class="recruit-setting-btn" style="display:none;">','<a href="javascript:void(0);" class="btn btn-primary js-conform">确定</a>',"</div>","</div>"].join(""))}function f(){var a=this,b=a.getParam();a.field=new t({renderTo:a.getEl(".js-field"),renderBy:"html",projectId:b.projectId,departmentData:a.departmentData,projectData:a.projectData,isNew:a.isNewPosition(),parent:a,listeners:{inputChange:function(){if(a.isNewPosition()){var b=this.localVal();a.db.refresh(),a.db.set("DB_ADD_POSITION",b)}},loaded:function(){a.getEl(".recruit-setting-btn").show(),a.recoverForm()}}})}function g(){{var a=this;a.rawConfig}if(a.isNewPosition()){var b=a.db.get("DB_ADD_POSITION");return void a.field.localVal(b,!0)}x.getJob({query:{id:a.getPositionId()},call:function(b){a.field.val(b.data)},error:function(a){s.alert(a.msg)}})}function h(){{var a=this,b=a.getParam(),c=p.extend({recruitProjectId:a.projectId},a.field.val());a.isNewPosition()}return a.isNewPosition()?void x.addJob({type:"POST",body:c,call:function(){a.db.remove(),a.nav("resume",a.positionDisplayParam)},error:function(a){s.alert(a.msg)},always:function(){q.clear(a.getEl())}}):void x.updateJob({type:"PUT",params:{id:b.itemId},body:c,call:function(){a.nav("resume",a.positionDisplayParam)},error:function(a){s.alert(a.msg)},always:function(){q.clear(a.getEl())}})}function i(a,b){var c=this,d=c.getParam();v.getSimpleFullDepartments({params:{userId:c.getUserId()},query:{entityIdList:d.projectId,entityType:33},call:function(b){var d=b.data||[];c.departmentData=d,p.isFunction(a)&&a(d)},error:function(a){p.isFunction(b)&&b(a.msg)}})}function j(){var a=this,b=a.getParam();return b.itemId&&b.itemId}function k(){var a=this;return!a.getPositionId()}function l(){var a=this,b=a.getParam(),c=p.extend({action:"position/project/index"});a.positionDisplayParam=b.positionDisplayParam;var d={crumb:[{title:"职位管理",module:"resume",param:c},{title:"职位展示",module:"resume",param:b.positionDisplayParam}]};return w.has(102)&&(d.ext=[{html:'<a href="javascript:void(0);" class="link-green" style="font-size:14px;"><i class="icon-cog" style="margin-right:5px;"></i> 修改项目设置</a>',listeners:{click:{handler:function(){var b=a.getParam();a.nav("resume",{action:"position/editProject/index",id:b.projectId,back:{module:"resume",param:b}})}}}}]),d}var m=a("nc"),n=a("cpn"),o=(m.$,m.Clazz),p=m.Base,q=m.Limit,r=m.Db,s=(n.Tab,n.Popup),t=(n.Select,n.Pager,a("./field")),u=a("../../../../../core/module"),v=a("../../../../../action/user"),w=a("../../../../../util/switch"),x=a("../../../../../action/position"),y=a("../../../../../core/siteConfig"),z=c.exports=o.create();o.mix(z,u,{style:"/stylesheets/styles/system/myJobsList.css",title:"新建职位",showTask:!0,_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.projectId=a.getParam().projectId,a.renderWait(a.getEl(),"加载中..."),a.getDepartment(function(){x.getRecruitProject({params:{id:a.projectId},query:{},call:function(b){a.projectData=b.data||{},a.initContainer(),a.initField()},error:function(b){a.renderNone(a.getEl(),b.msg)}})},function(b){a.renderNone(a.getEl(),b)})}},{name:"click .js-conform",handler:function(){function a(){q.mark(b.getEl())||b.conform()}var b=this,c=b.field.check();c&&(p.isString(c)?s.confirm(c,a):a())}}]},{initialize:d,initContainer:e,initField:f,recoverForm:g,conform:h,getDepartment:i,getPositionId:j,isNewPosition:k,getCrumbConf:l})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editPosition/popupLoadPosition",["nc","cpn","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../util/ajax","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/resume","../../../../../action/position","../../../../../action/common","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(a){a=a||{};var b=new x(a);r.wrap(b,{title:"加载职位配置",content:b.html(),width:700,cancelTxt:"取消"})}function e(){var a=this;a.getEl().html(['<div style="margin-bottom:20px;">','<span style="font-size:14px;line-height:38px;margin-right:20px;">招聘项目</span>','<div class="js-project-cpn"></div>',"</div>",'<div class="js-main"></div>'].join(""))}function f(a){var b=this;b.projectCpn=new s({renderTo:b.getEl(".js-project-cpn"),renderBy:"replaceWith",needSearch:!0,options:[{text:"不限",value:"0",checked:!0}].concat(n.map(a,function(a){return{text:a.name,value:n.id(a.id)}})),change:function(){b.projectId=this.val(),b.page=1,b.renderMain()}}),b.projectId=b.projectCpn.val()}function g(){var a=this;a.page=a.page||1,a.pageSize=5,a.getJob(function(b){a.renderTable(b)})}function h(a){var b=this;if(!a.data||0===a.data.length)return b.renderNone(b.getEl(".js-main"),"该招聘项目暂无职位");var c={head:[{text:"职位名 ",width:"30%"},{text:"所属部门",width:"30%"},{text:"更新时间",width:"25%",style:{"min-width":"140px"}},{text:"操作",width:"15%"}],list:[]};n.forEach(a.data,function(a){var b=[a.jobName,a.tags,q.form(new Date(a.updateTime)),'<a href="javascript:void(0);" class="btn btn-primary btn-auto js-load">载入</a>'];c.list.push({items:b,attr:{"data-id":n.id(a.id)}})}),b.getEl(".js-main").html(v.getHtml(c)),new t({renderTo:b.getEl(".js-main"),current:b.page,total:a.totalPage,pageChange:function(a){b.page=a,b.renderMain()}}),b.popup.fixPosition()}function i(a,b){var c=this;w.listJob({query:{projectId:c.projectId,page:c.page,pageSize:c.pageSize},call:function(b){a&&a(b.data||{})},error:function(a){n.isFunction(b)?b(a.msg):"popup"===b?r.alert(a.msg):c.module.renderNone(c.getEl(".js-main"),a.msg)}})}function j(a,b){var c=this;w.listRecruitProject({query:{},call:function(b){a&&a(u.filterStatus(b.data||[],0))},error:function(a){n.isFunction(b)?b(a.msg):"popup"===b?r.alert(a.msg):c.module.renderNone(c.getEl(),a.msg)}})}var k=a("nc"),l=a("cpn"),m=k.$,n=k.Base,o=k.Clazz,p=k.Component,q=k.Time,r=l.Popup,s=l.Select,t=l.Pager,u=a("../../../extend/bll/resume"),v=a("../../../../../component/table"),w=a("../../../../../action/position"),x=c.exports=o.create();o.mix(x,p,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.module=a.rawConfig.module,a.module.renderWait(a.getEl(),"加载中"),a.getProject(function(b){a.initContainer(),a.initCpns(b),a.renderMain()})}},{name:"click .js-load",handler:function(a){var b=this,c=m(a.currentTarget),d=m.trim(c.closest("tr").attr("data-id"));w.getJob({query:{id:d},call:function(a){b.fire("load",a.data),b.popup.close()},error:function(a){r.alert(a.msg)}})}}],show:d},{initContainer:e,initCpns:f,renderMain:g,renderTable:h,getJob:i,getProject:j})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editProject/customModule",["nc","cpn","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(){var a=this;a.nameCpn=new n({renderTo:a.getEl(".js-name"),renderBy:"replaceWith",placeholder:"例如：招聘说明，公司福利，简历投递说明",listeners:{change:function(){a.fire("change")}}}),a.nameCpn.inputEl.width(275),a.infoCpn=new o({renderTo:a.getEl(".js-info"),placeholder:"上传的图片宽度不要超过650px,图片大小不超过5M",width:"100%",height:200,noAutoHeight:!0,listeners:{draftChange:function(){a.getEl(".js-info-error").hide(),a.fire("change")}}})}function e(a){var b=this;return 0===arguments.length?{name:j.trim(b.nameCpn.val()),info:b.infoCpn.val()}:(a=a||{},b.nameCpn.val(a.name),void b.infoCpn.val(a.info))}function f(){var a=this,b=a.infoCpn.val(),c=a.nameCpn.val(),d=!0;if(!c&&!b)return d;c||(d=!1,a.nameCpn.errorTips("请填写标题")),b||(d=!1,a.getEl(".js-info-error").html("请填写内容").show());var e=!0,f=a.infoCpn.getEl("iframe").contents(),g=f.find("img");return l.forEach(g,function(a){return e=j(a).width()<=650,e||l.BREAK}),e||(d=!1,a.getEl(".js-info-error").html("上传的图片宽度不要超过650px,图片大小不超过5M").show()),d}function g(a,b){var c=this,d=c.getEl();d.find(".js-del-btn")[b>1?"show":"hide"]()}var h=a("nc"),h=a("nc"),i=a("cpn"),j=h.$,k=h.Clazz,l=h.Base,m=h.Component,n=(i.Popup,i.Input),o=a("../../../../../component/editorSub/hEditor/index"),p=c.exports=k.create();k.mix(p,m,{_template:['<div class="user-defined">','<div class="user-defined-hd">','<span class="exercise-order">页面自定义模块</span>','<a href="javascript:void(0);" class="icon-trash js-del-btn" title="删除"></a>',"</div>",'<div class="user-defined-bd" style="min-height:340px;">','<div class="form-group inline-group">','<label class="control-label">标题</label>','<div class="js-name"></div>','<span class="input-tip">请填写标题！</span>',"</div>",'<div class="form-group">','<label class="control-label">内容</label>','<div class="js-info control-group" style="float:left;width:80%;"></div>','<span class="js-info-error" style="display:none;position:relative;left:60px;top:10px;color:#ff5400;font-size:14px;clear:both;float:left;">请填写内容，上传的图片宽度不要超过650px,图片大小不超过5M</span>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns()}},{name:"click .js-del-btn",handler:function(){var a=this;a.destroy(),a.fire("destroy")}}]},{initCpns:d,val:e,check:f,fix:g})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editProject/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/user","../../../../../util/ajax","../../../../../action/position","../../../../../component/department","../../../../../util/switch","../../../../../component/dateSelect","../cpn/field","../cpn/orderList","../cpn/popupName","../cpn/popupDeliver","./customModule","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage","./referral"],function(a,b,c){function d(){var a=this;a.getEl().html(['<div class="module-body">','<div class="js-tab"></div>','<div class="recruit-setting">','<div class="form-group">','<label class="control-label">项目名称</label>','<div class="js-name"></div>','<span class="choose-tips" style="top:10px;">必填项，不超过24个字符</span>',"</div>",'<div class="form-group">','<label class="control-label">项目备注</label>','<div class="js-remark"></div>',"</div>",'<div class="js-department"></div>','<div class="form-group">','<label class="control-label long-label">本项目中最多可同时投递的职位数</label>','<div class="js-resume-num"></div>','<span class="choose-tips" style="top:10px;">只能填写数字，如不限请留空</span>',"</div>",'<div class="form-group">','<label class="control-label">网申投递开放时间</label>','<div class="js-time"></div>','<span class="choose-tips" style="bottom:15px;">必填项</span>',"</div>",'<div class="form-group">','<label class="control-label">简历字段要求</label>','<div class="js-resume-field"></div>',"</div>",'<div class="form-group">','<label class="control-label">投递字段要求</label>','<div class="js-deliver-field"></div>',"</div>",'<div class="js-referral"></div>','<div class="js-module-home"></div>','<div class="user-defined-ft">','<a href="javascript:void(0);" class="js-add-custom-module"><i class="icon-plus-sign"></i>新增自定义模块</a>',"</div>","</div>",'<div class="recruit-setting-btn">','<a href="javascript:void(0);" class="btn btn-primary js-submit-btn">设置完毕</a>',"</div>","</div>"].join(""))}function e(){var a=this;a.nameCpn=new y({renderTo:a.getEl(".js-name"),renderBy:"replaceWith",listeners:{change:function(){a.formChange()}}}),a.remarkCpn=new y({renderTo:a.getEl(".js-remark"),renderBy:"replaceWith",listeners:{change:function(){a.formChange()}}}),a.departmentCpn=new D({renderTo:a.getEl(".js-department"),renderBy:"replaceWith",departmentData:a.departmentData,marginLeft:"-23px",type:"selectMult",tip:"只有拥有参与管理的机构权限的账号可以在该招聘项目中新建职位和管理简历",listeners:{change:function(){a.formChange()}}}),a.departmentCpn.getEl("label.control-label").width(135),a.resumeNumCpn=new y({renderTo:a.getEl(".js-resume-num"),renderBy:"replaceWith",placeholder:"同一候选人最多可申请的职位数",listeners:{change:function(){a.formChange()}}});var b=a.timeCpn=new E({renderTo:a.getEl(".js-time"),renderBy:"replaceWith",startDate:u.form(new Date,"yyyy-MM-dd"),change:function(){a.formChange()}});new z({renderTo:a.timeCpn.getEl(".input-line"),renderBy:"before",text:"即日起",change:function(){if(!this.isChecked())return void b.disabledStart(!1);var c=b.val();c.startDate=u.form(new Date,"yyyy-MM-dd"),c.startTime="00:00:00",b.val(c),b.disabledStart(),a.formChange()}}).getEl().css({"float":"left",margin:"10px"}),a.fieldId=101;var c=a.builtInResumeField=[{id:"1",name:"基本资料",need:!0,checked:!0,disabled:!0,noTips:!0,noMovable:!0},{id:"999",name:"个人照片",checked:!0,noTips:!0,noMovable:!0},{id:"2",name:"教育经历",checked:!0},{id:"3",name:"校内经历",checked:!0},{id:"4",name:"工作经历",checked:!0},{id:"6",name:"项目经历",checked:!0},{id:"7",name:"获奖情况",checked:!0},{id:"8",name:"个人技能",checked:!0},{id:"9",name:"自我评价",checked:!0},{id:"10",name:"论文发表",checked:!0},{id:"11",name:"附件说明",checked:!0}];a.resumeField=new G({renderTo:a.getEl(".js-resume-field"),renderBy:"replaceWith",addBtnTxt:"+ 新增简历字段",data:c,needOrder:!0,addItem:function(b){H.show({ok:function(c){b&&b({id:s.id(a.fieldId),name:c.name,editable:!0,checked:!0}),a.fieldId++}})},editItem:function(a){var b=a.item;H.show({val:{name:b.name},ok:function(c){b.name=c.name,a.call&&a.call()}})},listeners:{change:function(){a.formChange()},changeShow:function(){w.scrollToEl({scrollEl:a.getSysWinEl(),el:this.getEl(),animation:!0})}}}),a.deliverField=new G({renderTo:a.getEl(".js-deliver-field"),renderBy:"replaceWith",addBtnTxt:"+ 新增投递字段",addItem:function(a){H.show({title:"增加投递字段",ok:function(b){a&&a(s.extend({editable:!0,noChoice:!0,checked:!0},b))}})},editItem:function(a){var b=a.item;H.show({title:"修改投递字段",val:b,ok:function(c){s.extend(b,c),a.call&&a.call()}})},listeners:{change:function(){a.formChange()}}}),a.referralCpn=new J({renderTo:a.getEl(".js-referral"),renderBy:"replaceWith",listeners:{change:function(){a.formChange()}}}),a.addCustomModule()}function f(a){var b=this;return 0===arguments.length?{name:b.nameCpn.val(),description:b.remarkCpn.val(),departmentIdList:b.departmentCpn.val(),deliverJobLimit:b.resumeNumCpn.val(),time:b.timeCpn.val(),ext:b.extVal(),resumeField:b.resumeField.val(),deliverField:b.deliverField.val(),referralConfig:b.referralCpn.localVal()}:(a=a||{},b.nameCpn.val(a.name),b.remarkCpn.val(a.description),b.departmentCpn.val(a.departmentIdList),b.resumeNumCpn.val(a.deliverJobLimit),b.timeCpn.val(a.time),b.extVal(a.ext),b.resumeField.val(a.resumeField),b.deliverField.val(a.deliverField),b.referralCpn.localVal(a.referralConfig),void b.updateFieldId(a.resumeField))}function g(a){function b(){var a=d.resumeField.val(),b=[],c=[],e=[],f=[],g=[];return s.forEach(a,function(a){+a.id>100&&999!==+a.id&&b.push({name:a.name,id:s.id(a.id)}),a.need&&c.push(s.id(a.id)),e.push(s.id(a.id)),a.checked||f.push(s.id(a.id))}),s.forEach(d.deliverField.val(),function(a){a.checked&&g.push({key:a.key,name:a.name,type:a.type,select:a.select})}),JSON.stringify({customMenu:b,resumeMenuNeed:c,resumeMenuOrder:e,resumeMenuHide:f,deliverMenu:g})}function c(){var a={};s.forEach(d.builtInResumeField,function(b){a[b.id]=b});var b={};s.forEach(h.customMenu,function(a){b[a.id]=a}),h.resumeMenuOrder&&d.resumeField.val(s.map(h.resumeMenuOrder,function(c){var d=+c,e=100>=d||999===d?a[c]:b[c];return s.extend(e||{},{need:s.contains(h.resumeMenuNeed,c),checked:!s.contains(h.resumeMenuHide,c)})})),s.forEach(h.deliverMenu,function(a){a.checked=!0,a.noChoice=!0,a.editable=!0}),h.deliverMenu&&d.deliverField.val(h.deliverMenu),d.updateFieldId(h.customMenu)}var d=this;if(0===arguments.length){var e=d.timeCpn.val();return{name:q.trim(d.nameCpn.val()),description:q.trim(d.remarkCpn.val()),displayType:"2",departmentIdList:d.departmentCpn.val(),deliverJobLimit:q.trim(d.resumeNumCpn.val()),beginTime:[e.startDate,e.startTime||"00:00:00"].join(" "),endTime:[e.endDate,e.endTime||"23:59:59"].join(" "),ext:JSON.stringify(d.extVal()),resumeConfig:b(),referralConfig:JSON.stringify(d.referralCpn.val())}}a=a||{};var f=u.form(new Date(a.beginTime)).split(" "),g=u.form(new Date(a.endTime)).split(" "),h=s.json(a.projectConfig)||{};d.nameCpn.val(a.name),d.remarkCpn.val(a.description),d.departmentCpn.val(s.map(a.departmentList,function(a){return s.id(a.id)})),d.resumeNumCpn.val(0===a.deliverJobLimit?"":a.deliverJobLimit),d.timeCpn.val({startDate:f[0],startTime:f[1],endDate:g[0],endTime:g[1]}),d.extVal(s.json(a.ext)),d.referralCpn.val(h.referral),c()}function h(a){var b=this,c=b.customModuleList;return 0===arguments.length?s.map(c,function(a){return a.val()}):void s.forEach(a,function(a,d){var e=c[d]||b.addCustomModule();e.val(a)})}function i(){var a,b=this,c=!0,d=b.val(),e=b.timeCpn.val();return d.name||(c=!1,a=b.nameCpn.getEl(),b.nameCpn.errorTips("请填写项目名称")),d.name.length>24&&(c=!1,a=b.nameCpn.getEl(),b.nameCpn.errorTips("项目名称不能超过24个字符")),isNaN(+d.deliverJobLimit)&&(c=!1,a=a||b.resumeNumCpn.getEl(),b.resumeNumCpn.errorTips("只能填写数字")),e.startDate&&e.endDate||(c=!1,a=a||b.timeCpn.getEl(),b.timeCpn.errorTips("请填写网申投递开放时间")),new Date([e.startDate,e.startTime||"00:00:00"].join("")).getTime()>new Date([e.endDate,e.endTime||"23:59:59"].join(""))&&(c=!1,a=a||b.timeCpn.getEl(),b.timeCpn.errorTips("开始时间不得晚于结束时间")),b.referralCpn.check()||(c=!1,a=a||b.referralCpn.getEl()),s.forEach(b.customModuleList,function(b){b.check()||(a=a||b.getEl(),c=!1)}),a&&w.scrollToEl({el:a,scrollEl:w.getScrollParent(a),animation:!0,ext:-20}),c}function j(){var a=this,b=a.customModuleList=a.customModuleList||[],c=new I({renderTo:a.getEl(".js-module-home"),listeners:{destroy:function(){b.length>1&&s.forReverse(b,function(a,d){a===c&&b.splice(d,1)}),a.fixCustomModule()},change:function(){a.formChange()}}});return b.push(c),a.fixCustomModule(),c}function k(){var a=this,b=a.customModuleList,c=b.length;s.forEach(a.customModuleList,function(a,b){a.fix(b,c)})}function l(){var a=this;a.projectId||a.db.set(a.dbKey,a.localVal())}function m(a){var b=this;s.forEach(a,function(a){var c=+a.id;c>100&&999!==c&&(b.fieldId=Math.max(b.fieldId,+a.id))}),b.fieldId++}function n(){var a=this,b=s.extend({action:"position/project/index"}),c={crumb:[{title:"职位管理",module:"resume",param:b}]};return F.has(101)&&(c.ext=[{html:'<a href="javascript:void(0);" class="link-green" style="font-size:14px;"><i class="icon-cog" style="margin-right:5px;"></i> 设置公司招聘主页</a>',listeners:{click:{handler:function(){var b=a.getParam();a.nav("resume",{action:"position/companyPage/index",back:{module:"resume",param:b}})}}}}]),c}var o=a("nc"),p=a("cpn"),q=o.$,r=o.Clazz,s=o.Base,t=o.Limit,u=o.Time,v=o.Db,w=o.Dom,x=(p.Tab,p.Popup),y=p.Input,z=(p.Select,p.CheckBox),A=a("../../../../../core/module"),B=a("../../../../../action/user"),C=a("../../../../../action/position"),D=a("../../../../../component/department"),E=a("../../../../../component/dateSelect"),F=a("../../../../../util/switch"),G=a("../cpn/field"),H=a("../cpn/popupName"),I=(a("../cpn/popupDeliver"),a("./customModule")),J=a("./referral"),K="DB_ADD_PROJECT",L=c.exports=r.create();r.mix(L,A,{style:"/stylesheets/styles/system/myJobs.css",title:"新建招聘项目",showTask:!0,_template:'<div class="module-box"></div>',listeners:[{name:"render",type:"custom",handler:function(){function a(a,b){d.initContainer(),d.initCpns(),a&&d[b?"localVal":"val"](a)}function b(a){B.getSimpleFullDepartments({type:"GET",params:{userId:d.getUserId()},call:function(b){a&&a(b.data||[])},error:function(a){d.renderNone(e,a.msg)}})}function c(a){C.getRecruitProject({type:"GET",params:{id:d.projectId},call:function(b){a&&a(b.data)},error:function(a){d.renderNone(e,a.msg)}})}var d=this,e=d.getEl();d.projectId=s.id(d.getParam().id),d.projectId&&(d.crumbTitle="编辑招聘项目",d.refreshCrumb()),d.renderWait(d.getEl(),"加载中..."),b(function(b){if(d.departmentData=b,!d.projectId){d.dbKey=d.getUserId();var e=d.db=new v(K);return a(e.get(d.dbKey),!0)}c(a)})}},{name:"click .js-add-custom-module",handler:function(){var a=this;a.addCustomModule()}},{name:"click .js-submit-btn",handler:function(){function a(){if(!t.mark(d)){var a=!!c.projectId;C[a?"updateRecruitProject":"addRecruitProject"]({type:a?"PUT":"POST",body:c.val(),params:a?{id:c.projectId}:void 0,call:function(){a||c.db.remove(c.dbKey);var b=c.getParam(),d=b.back;return d&&d.module&&d.param?c.nav(d.module,d.param):void c.nav("resume",{action:"position/project/index"})},error:function(a){x.alert(a.msg)},always:function(){t.clear(d)}})}}function b(a){return new Date(a).getTime()}var c=this;if(c.check()){var d=c.getEl(),e=c.val(),f=s.json(e.referralConfig),g=b(f.beginTime)>b(e.beginTime),h=b(f.endTime)>b(e.endTime),i=g&&h?"内推开始时间晚于网申开始时间且内推结束时间晚于网申结束时间，确定创建？":g?"内推开始时间晚于网申开始时间，确定创建？":h?"内推结束时间晚于网申结束时间，确定创建？":"";i?x.confirm(i,a):a()}}}]},{initContainer:d,initCpns:e,localVal:f,val:g,extVal:h,check:i,addCustomModule:j,fixCustomModule:k,formChange:l,updateFieldId:m,getCrumbConf:n})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/editProject/referral",["nc","cpn","../../../../../component/dateSelect","../../../../../core/siteConfig","../../../../../component/editorSub/hEditor/index","ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","../../../../../component/editorSub/hEditor/plugin/autoHeight","../../../../../component/editorSub/hEditor/plugin/autoLink","../../../../../component/editorSub/hEditor/plugin/uploadPaste","../../../../../util/util","../../../../../component/editorSub/hEditor/plugin/imageBar","../../../../../component/editorSub/hEditor/plugin/toolbar","../../../../../component/editorSub/hEditor/plugin/uploadRemote","../../../../../util/uploadRemote","../../../../../component/editorSub/hEditor/plugin/defaultAction","../../../../../component/popupSub/popupUploadImage"],function(a,b,c){function d(){var a=this;a.ifReferralCpn=s.mix({el:a.getEl(".js-if-referral label.radio"),change:function(){a.fixConf(),a.fire("change")}}),a.fixConf()}function e(){var a=this;if(!a.confCpnsInited){var b=a.timeCpn=new v({renderTo:a.getEl(".js-time"),renderBy:"replaceWith",startDate:r.form(new Date,"yyyy-MM-dd"),change:function(){a.fire("change")}});new t({renderTo:a.timeCpn.getEl(".input-line"),renderBy:"before",text:"即日起",change:function(){if(!this.isChecked())return void b.disabledStart(!1);var c=b.val();c.startDate=r.form(new Date,"yyyy-MM-dd"),c.startTime="00:00:00",b.val(c),b.disabledStart(),a.fire("change")}}).getEl().css({"float":"left",margin:"10px"}),a.stageCpn=s.mix({el:a.getEl(".js-stage label.checkbox"),change:function(){a.fire("change")}}),a.studentNoteCpn=new w({renderTo:a.getEl(".js-student-note"),placeholder:"上传的图片宽度不要超过650px,图片大小不超过5M",width:"100%",height:200,noAutoHeight:!0,listeners:{draftChange:function(){a.getEl(".js-student-error").hide(),a.fire("change")}}}),a.workerNoteCpn=new w({renderTo:a.getEl(".js-worker-note"),placeholder:"上传的图片宽度不要超过650px,图片大小不超过5M",width:"100%",height:200,noAutoHeight:!0,listeners:{draftChange:function(){a.getEl(".js-worker-error").hide(),a.fire("change")}}}),a.verifyCpn=s.mix({el:a.getEl(".js-verify .verify-line>label.radio"),change:function(){a.fixVerify(),a.fire("change")}}),a.emailTailCpn=new u({renderTo:a.getEl(".js-email-class"),placeholder:"请输入邮箱后缀，多个后缀通过空格分割",listeners:{change:function(){a.fire("change")}}}),a.emailTailCpn.getEl().css({"float":"none",display:"inline-block"}),a.emailTailCpn.inputEl.width(280),a.jobNumBeginCpn=new u({renderTo:a.getEl(".js-job-num-begin"),clsIpt:"w80",listeners:{change:function(){a.fire("change")}}}),a.jobNumBeginCpn.getEl(".input-tip").width(200),a.jobNumBeginCpn.getEl().css("display","inline-block"),a.jobNumEndCpn=new u({renderTo:a.getEl(".js-job-num-end"),clsIpt:"w80",listeners:{change:function(){a.fire("change")}}}),a.jobNumEndCpn.getEl(".input-tip").width(200),a.jobNumEndCpn.getEl().css("display","inline-block"),a.ifIncludeLetterCpn=s.mix({el:a.getEl(".js-if-include-letter label.radio"),change:function(){a.fixIfIncludeLetter(),a.fire("change")}}),a.jobNumBeginCpn.getEl().css("float","none"),a.jobNumEndCpn.getEl().css("float","none"),a.letterPosition=s.mix({el:a.getEl(".js-letter-position label.radio"),listeners:{change:function(){a.fire("change")}}}),a.confCpnsInited=!0,a.fixVerify(),a.fixIfIncludeLetter()}}function f(a){var b=this;return 0===arguments.length?(a={turnOn:b.ifReferralCpn.val()},+a.turnOn?(o.extend(a,{time:b.timeCpn.val(),stage:b.stageCpn.val(),workerNote:b.workerNoteCpn.val(),studentNote:b.studentNoteCpn.val(),verifyType:b.verifyCpn.val(),emailTail:b.emailTailCpn.val(),jobNumMinLength:b.jobNumBeginCpn.val(),jobNumMaxLength:b.jobNumEndCpn.val(),ifIncludeLetter:b.ifIncludeLetterCpn.val(),letterPositionType:b.letterPosition.val()}),a):a):(a=a||{},b.ifReferralCpn.val(a.turnOn,!0),void(+a.turnOn&&(b.timeCpn.val(a.time),b.stageCpn.val(a.stage),b.workerNoteCpn.val(a.workerNote),b.studentNoteCpn.val(a.studentNote),b.verifyCpn.val(a.verifyType,!0),b.emailTailCpn.val(a.emailTail),b.jobNumBeginCpn.val(a.jobNumMinLength),b.jobNumEndCpn.val(a.jobNumMaxLength),b.ifIncludeLetterCpn.val(a.ifIncludeLetter,!0),b.letterPosition.val(a.letterPositionType))))}function g(a){var b=this;if(0===arguments.length){if(a={turnOn:!!+b.ifReferralCpn.val()},!a.turnOn)return a;var c=b.timeCpn.val();a.beginTime=[c.startDate,c.startTime||"00:00:00"].join(" "),a.endTime=[c.endDate,c.endTime||"23:59:59"].join(" "),a.stages=b.stageCpn.val(),a.employeeInstruction=n.trim(b.workerNoteCpn.val()),a.userInstruction=n.trim(b.studentNoteCpn.val());var d=a.rule={type:+b.verifyCpn.val()};return 1===+d.type&&(d.emailSuffix=(b.emailTailCpn.val()||"").split(/\s+/)),2===+d.type&&(d.jobNumber={"min-length":n.trim(b.jobNumBeginCpn.val()),"max-length":n.trim(b.jobNumEndCpn.val())},d.jobNumber.includeLetter=!!+b.ifIncludeLetterCpn.val(),d.jobNumber.includeLetter&&(d.jobNumber.letterPositionType=b.letterPosition.val())),a}if(a=a||{},b.ifReferralCpn.val(a.turnOn?"1":"0",!0),a.turnOn){var e=r.form(new Date(a.beginTime)).split(" "),f=r.form(new Date(a.endTime)).split(" ");b.timeCpn.val({startDate:e[0],startTime:e[1],endDate:f[0],endTime:f[1]}),b.stageCpn.val(a.stages||["7"]),b.workerNoteCpn.val(a.employeeInstruction),b.studentNoteCpn.val(a.userInstruction);var d=a.rule||{},g=d.type+"";if(b.verifyCpn.val(g,!0),"1"===g&&b.emailTailCpn.val(d.emailSuffix.join(" ")),"2"===g){var h=d.jobNumber||{};b.jobNumBeginCpn.val(h["min-length"]),b.jobNumEndCpn.val(h["max-length"]),b.ifIncludeLetterCpn.val(h.includeLetter?"1":"0",!0),h.includeLetter&&b.letterPosition.val(h.letterPositionType+"")}}}function h(){function a(a){var c=!0,d=b[a].getEl("iframe").contents(),e=d.find("img");return o.forEach(e,function(a){return c=n(a).width()<=650,c||o.BREAK}),c}var b=this,c=!0;if(!+b.ifReferralCpn.val())return!0;var d=b.timeCpn.val();d.startDate&&d.endDate||(b.timeCpn.errorTips("请填写内推日期"),c=!1),n.trim(b.workerNoteCpn.val())?a("workerNoteCpn")||(b.getEl(".js-worker-error").html("上传的图片宽度不要超过650px,图片大小不超过5M").show(),c=!1):(b.getEl(".js-worker-error").html("请填写员工端内推说明").show(),c=!1),n.trim(b.studentNoteCpn.val())?a("studentNoteCpn")||(b.getEl(".js-student-error").html("上传的图片宽度不要超过650px,图片大小不超过5M").show(),c=!1):(b.getEl(".js-student-error").html("请填写学生端内推说明").show(),c=!1);var e=+b.verifyCpn.val();if(1===e&&(n.trim(b.emailTailCpn.val())||(b.emailTailCpn.errorTips("请输入邮箱后缀"),c=!1)),2===e){b.jobNumBeginCpn.error(!1),b.jobNumEndCpn.error(!1);var f=n.trim(b.jobNumBeginCpn.val()),g=n.trim(b.jobNumEndCpn.val()),h=!0;f?isNaN(+f)&&(b.jobNumBeginCpn.errorTips("只能输入数字"),c=h=!1):(b.jobNumBeginCpn.errorTips("请输入最小长度"),c=h=!1),g?isNaN(+g)&&(b.jobNumEndCpn.errorTips("只能输入数字"),c=h=!1):(b.jobNumEndCpn.errorTips("请输入最大长度"),c=h=!1),h&&+f>+g&&(b.jobNumBeginCpn.errorTips("最大长度需大于等于最小长度"),b.jobNumEndCpn.errorTips(" "),c=!1)}return c}function i(){var a=this,b=!!+a.ifReferralCpn.val();a.getEl(".js-conf")[b?"show":"hide"](),b&&a.initConfCpns()}function j(){var a=this,b=+a.verifyCpn.val();a.getEl(".js-email-class")[1===b?"show":"hide"](),a.getEl(".js-job-num-class")[2===b?"show":"hide"]()}function k(){var a=this,b=!!+a.ifIncludeLetterCpn.val();a.getEl(".js-letter-position")[b?"show":"hide"]()}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Base,p=l.Clazz,q=l.Component,r=l.Time,s=m.CheckGroup,t=m.CheckBox,u=m.Input,v=a("../../../../../component/dateSelect"),w=a("../../../../../component/editorSub/hEditor/index"),x=c.exports=p.create();p.mix(x,q,{_template:["<div>",'<div class="form-group">','<label class="control-label">是否内推</label>','<div class="control-group with-label-box js-if-referral">','<label class="radio checked"><input type="radio" value="0">否</label>','<label class="radio radio-true"><input type="radio" value="1">是</label>',"</div>","</div>",'<div class="recommend-in-mod js-conf">','<div class="form-group">','<label class="control-label">内推时间</label>','<div class="js-time"></div>','<span class="choose-tips" style="bottom:15px;">必填项</span>',"</div>",'<div class="form-group">','<label class="control-label">内推流程</label>','<div class="control-group with-label-box js-stage">','<label class="checkbox checked disabled"><input type="checkbox" value="7">简历初选</label>','<label class="checkbox"><input type="checkbox" value="8">笔试</label>','<label class="checkbox"><input type="checkbox" value="9">面试</label>',"</div>","</div>",'<div class="form-group" style="margin-bottom:20px;">','<label class="control-label">学生端内推说明</label>','<div class="control-group js-student-note" style="width:80%"></div>','<span class="choose-tips" style="top:80px;">必填项</span>','<span class="js-student-error" style="display:none;position:relative;left:140px;top:10px;color:#ff5400;font-size:14px;clear:both;float:left;">请填写内容，上传的图片宽度不要超过650px,图片大小不超过5M</span>',"</div>",'<div class="form-group" style="margin-bottom:20px;">','<label class="control-label">员工端内推说明</label>','<div class="control-group js-worker-note" style="width:80%"></div>','<span class="choose-tips" style="top:80px;">必填项</span>','<span class="js-worker-error" style="display:none;position:relative;left:140px;top:10px;color:#ff5400;font-size:14px;clear:both;float:left;">请填写内容，上传的图片宽度不要超过650px,图片大小不超过5M</span>',"</div>",'<div class="form-group">','<label class="control-label">内推员工验证标准</label>','<div class="control-group js-verify">','<div class="verify-line">','<label class="radio checked"><input type="radio" value="1">企业邮箱验证</label>','<span class="js-email-class" style="margin-left:50px;"></span>',"</div>",'<div class="verify-line">','<label class="radio"><input type="radio" value="2">工号验证</label>','<span class="js-job-num-class" style="margin-left:78px;">','<span class="control-block">',"<span>长度范围</span>",'<span class="js-job-num-begin" style="margin-left:5px;"></span>—','<span class="js-job-num-end" style="margin-right:15px;"></span>',"</span>",'<span class="control-block js-if-include-letter">','<span class="text">是否包含字母</span>','<label class="radio checked"><input type="radio" value="0">否</label>','<label class="radio"><input type="radio" value="1">是</label>',"</span>",'<span class="control-block js-letter-position">','<span class="text">字母位置</span>','<label class="radio checked"><input type="radio" value="0">首</label>','<label class="radio"><input type="radio" value="1">末</label>','<label class="radio"><input type="radio" value="2">其他</label>',"</span>","</span>","</div>","</div>","</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initCpns()}}]},{initCpns:d,initConfCpns:e,localVal:f,val:g,check:h,fixConf:i,fixVerify:j,fixIfIncludeLetter:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/list/index",["nc","cpn","../../../../../core/module","../../../../../util/util","../../../../../core/siteConfig","../../../../../component/table","../../../../../component/selectAll","../../../../../component/navProject","../../../../../action/position","../../../../../util/ajax","../../../extend/bll/resume","../../../extend/event","../../../extend/bll/base","../../../extend/bll/money","../../../../../action/purchase","../../../../../action/price","../../../extend/bll/task","../../../../../action/api","../../../../../action/resume","../../../../../action/common","../../../../../util/switch","../cpn/orderList","./popupDown","./popupCopy"],function(a,b,c){function d(a){var b=this,c=b.getEl(),d=b.getParam(),e=b.projectId=E.id(d.curProjectId);b.renderWait(c,"加载中..."),P.listRecruitProject({type:"GET",call:function(d){var f=Q.filterStatus(d.data||[],0),g=E.find(f,function(a){return E.id(a.id)===e}),h=0===f.length?"您尚未创建招聘项目！":g?"":"不存在的招聘项目";return h?b.renderNone(c,h):(b.projectList=f,b.project=g,void(a&&a()))},error:function(a){b.renderNone(c,a.msg)}})}function e(){function a(a,b){return['<li class="with-sub-oprt">','<a href="javascript:void(0);">'+a+"</a>",'<span class="icon-angle-down"></span>','<span class="icon-angle-up"></span>',"<ul>",E.map(b,function(a,b){return a?'<li class="js-toolbar-action" data-index="'+b+'" data-method="'+a.method+'" '+(a.isBatch?'data-batch="1"':"")+">"+a.title+"</li>":""}).join(""),"</ul>","</li>"].join("")}var b=this,c=b.getEl(),d=b.project,e=1===d.progress,f=[];d.referralUrl&&f.push('<li><a href="'+d.referralUrl+'" target="_blank">内推链接</a></li>'),f.push(a("招聘主页",[{title:"查看",method:"navRecruitPage"},S.has(102)?{title:"设置",method:"navSetting"}:""])),f.push('<li><a href="javascript:void(0);" class="js-toolbar-action" data-method="batchCheck" data-batch="1">批量查看</a></li>'),f.push(a("批量上下线",[{title:"批量下线",method:"batchDown",isBatch:!0},{title:"批量上线",method:"batchDown",isBatch:!0}])),f.push(a("新增职位",[{title:"新建职位",method:"addPosition"},{title:"复制其他项目职位",method:"copyPosition"}])),!e&&f.push('<li><a href="javascript:void(0);" class="js-toolbar-action" data-method="orderList">排序</a></li>'),f.push('<li><a href="javascript:void(0);" class="js-toolbar-action" data-method="batchExport" data-batch="1">导出Excel</a></li>'),c.html(['<div class="js-nav"></div>','<div class="js-list">','<div class="joblist-oprt clearfix js-toolbar" style="margin:0;padding:0 10px;display:none;">','<div class="menu-txt-box"><ul class="menu-txt job-oprt clearfix">',f.join('<li class="menu-pipe">|</li>'),"</ul></div>",'<div class="result-info"><span class="result-num"></span><span>每页显示 <span class="js-pagesize"></span></span></div>',"</div>",'<div class="joblist-data" style="padding:0 0 100px;"><div class="js-table"></div></div>',"</div>",'<div class="js-order" style="padding:20px;"></div>'].join(""));var g=b.getParam(),h={20:20,50:50,100:100}[g.pageSize]||20;new K({renderTo:b.getEl(".js-pagesize"),renderBy:"replaceWith",size:"xsmall",options:E.map([20,50,100],function(a){return{text:a,value:a,checked:a===h}}),change:function(){b.addParam({pageSize:this.val()}),b.renderList()}}),b.tableCpn=new N({renderTo:c.find(".js-table"),needSelect:!0,needFixHeader:!1,pageChange:function(a){b.goTop(),b.addParam({page:a}),b.renderList()}})}function f(){var a=this,b=a.getEl(),c=b.find(".js-list"),d=b.find(".js-order");a.orderCpn=new T({renderTo:d,listeners:{submit:function(b){var c=[],d=[];E.forEach(b,function(a,b){c.push(a.id),d.push(b)}),P.updateJobsPosition({type:"PUT",params:{id:a.projectId},body:{ids:c,positions:d},call:function(){J.tips("操作成功"),a.resetParam({curProjectId:a.projectId}),a.renderList(!0)},error:function(a){J.alert(a.msg)}})},order:function(){c.hide(),d.show()},exit:function(){d.hide(),c.show()}}})}function g(a,b){var c=this,d=c.getEl();new O({renderTo:d.find(".js-nav"),notAll:!0,items:a,current:b,change:function(a){c.nav("resume",{action:"position/list/index",curProjectId:a})}})}function h(){var a=this,b=a.getRecruitPageUrl();b&&window.open(b),!b&&J.confirm("你尚未发布职位，招聘主页无法查看。请先新建职位吧。",function(){a.nav("resume",{action:"position/editPosition/index",projectId:a.projectId,positionDisplayParam:a.getParam()})})}function i(){var a=this,b=a.getParam();a.nav("resume",{action:"position/editProject/index",id:a.projectId,back:{module:"resume",param:b}})}function j(){var a=this;a.nav("resume",{action:"position/editPosition/index",projectId:a.projectId,positionDisplayParam:a.getParam()})}function k(){var a=this;V.show({projectId:E.id(a.project.id),call:E.bind(a.renderList,a,!0)})}function l(){function a(c,d,e){d=d||1,e=e||[],P.listJob({query:{projectId:b.projectId,page:d,pageSize:100},call:function(b){var f=b.data||{},g=d>=f.totalPage;E.forEach(f.data,function(a){!a.status&&e.push({id:a.id,name:a.jobName})}),!g&&a(c,d+1,e),g&&c&&c(e)},error:function(a){J.alert(a.msg)}})}var b=this;return 1===b.project.progress?J.alert("该招聘项目已结束，无法对职位进行排序"):void a(function(a){var c=a.length>1;c&&b.orderCpn.order(a),!c&&J.alert("当前共有"+a.length+"个已上线职位数量，不需要排序")})}function m(a){var b=this;if(!F.mark(a)){var c=window.open();P.batchGetJobIds({type:"GET",body:b.getBatchCond(),call:function(a){var d=H.addParam({jobIds:(a.data||[]).join("_")},b.getRecruitPageUrl());c.location=d},error:function(a){J.alert(a.msg)},always:function(){F.clear(a)}})}}function n(a){var b=this,c="1"===a.attr("data-index");return c&&1===b.project.progress?J.alert("该招聘项目已结束，无法上线这个职位"):void J.confirm("确定要"+(c?"上线":"下线")+"这些职位吗？",function(){!F.mark(a)&&P.batchUpdateStatus({type:"PUT",body:E.extend({status:c?0:1},b.getBatchCond()),call:function(){J.tips("操作成功",E.bind(b.renderList,b,!0))},error:function(a){J.alert(a.msg)},always:function(){F.clear(a)}})})}function o(){var a=this,b=a.getWin(),c=a.project;P.downExcelJob({body:a.getBatchCond(),call:function(a){var d=a.data,e=d&&0!==d.length?2:1,f="";b.addTask({title:"[下载]"+(c.name||"")+"职位列表",waitTxt:"生成中",okTxt:"点击下载",getStatus:function(a){2!==e&&a&&a(e),2===e&&R.getTaskProgress(!1,d,function(b){var c=b.progress;b.error?e=1:b.end&&(e=0,f=b.content),a&&a(e,c)})},getResult:function(){return{type:3,data:f}}})},error:function(a){J.alert(a.msg)}})}function p(a,b){var c=this;if(!F.mark(b)){var d=window.open();P.batchGetJobIds({type:"GET",body:{projectId:c.projectId,isAll:2,ids:[a.id]},call:function(a){var b=H.addParam({jobIds:a.data.join("_")},c.getRecruitPageUrl());d.location=b},error:function(a){J.alert(a.msg)},always:function(){F.clear(b)}})}}function q(a){var b=this;J.confirm("确定要删除这个职位吗？删除后所有投递该职位的简历将不可见！",function(){var c=b.getEl();!F.mark(c)&&P.deleteJob({type:"DELETE",params:{id:a.id},body:{},call:function(){J.tips("删除成功",E.bind(b.renderList,b,!0))},error:function(a){J.alert(a.msg)},always:function(){F.clear(c)}})})}function r(a,b){function c(c){!F.mark(b)&&P.batchUpdateStatus({type:"PUT",body:{status:e?0:c?3:1,projectId:d.projectId,ids:[a.id],isAll:2},call:function(){J.tips((e?"上":"下")+"线成功",E.bind(d.renderList,d,!0))},error:function(a){J.alert(a.msg)},always:function(){F.clear(b)}})}var d=this,e=a.status;1===d.project.progress?J.alert("该招聘项目已结束，无法上线这个职位"):e?J.confirm("确定要上线这个职位吗？",c):U.show({ok:c})}function s(a){var b=this;b.nav("resume",{action:"position/editPosition/index",projectId:b.projectId,itemId:a.id,positionDisplayParam:b.getParam()})}function t(a){var b=this;b.orderCpn.cancel();var c=b.getEl(),d=b.getParam();a&&b.tableCpn.selectAll.clear(),b.tableCpn.renderWait(),P.listJob({query:{projectId:b.projectId,page:+d.page||1,pageSize:+d.pageSize||20,query:d.queryWord},call:function(a){if(a.isOrder){var d=a.data||{};if(b.listItems=d.data,0!==d.totalPage&&d.currentPage>d.totalPage)return b.addParam({page:d.totalPage}),b.renderList();var e=c.find(".js-toolbar");e.find(".result-num").html('共有<span class="font-green">'+d.totalCount+"</span>个职位"),e.show(),b.renderTable(d)}},error:function(a){a.isOrder&&b.tableCpn.renderNone(a.msg)}})}function u(a){function b(a){return['<a href="javascript:void(0);" class="btn btn-xs btn-primary js-action" data-method="checkItem">查看</a> ',f?['<a href="javascript:void(0);" class="btn btn-xs btn-primary js-action" data-method="editItem">编辑</a> ','<a href="javascript:void(0);" class="btn btn-xs btn-primary js-action ',1===a.progress||a.status?"disabled":"",'" data-method="downItem">',1===a.progress||a.status?"已下线":"下线","</a> ",'<a href="javascript:void(0);" class="btn btn-xs btn-primary js-action" data-method="delItem">删除</a> '].join(""):""].join("")}function c(a){var b=d.project;return b.referralTurnOn&&1===b.progress&&1===b.referralProgress||!b.referralTurnOn&&1===b.progress||1===a.progress?"已结束":b.referralTurnOn&&0!==b.progress&&0!==b.referralProgress||!b.referralTurnOn&&2===b.progress?"未开始":b.referralTurnOn&&0===b.referralProgress?"内推中":"网申中"}var d=this;if(0===a.totalCount)return d.tableCpn.renderNone("暂无职位");var e=d.project.referralTurnOn,f=S.has(103),g=[{text:"职位名 ",width:20},{text:"职能部门",width:10},{text:"已收到简历"}].concat(e?[{text:"未处理简历"},{text:"内推-未处理"}]:[],[{text:"网申-未处理"},{text:"职位状态"},{text:"更新时间",width:15},{text:"操作",width:30,style:{"min-width":"270px"}}]),h={head:g,list:[]};E.forEach(a.data,function(a,d){var f=[{text:a.jobName,cls:"txt-left"},a.tags,a.deliverCount||"0",e?[a.needProcessCount,a.internalRecommendationNeedProcessCount]:[],a.onlineApplicationNeedProcessCount,c(a),G.form(new Date(a.updateTime)),b(a,d)];h.list.push({items:f,attr:{"data-id":E.id(a.id)}})}),d.tableCpn.updateHtml(h,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage})}function v(){var a=this,b=((a.listItems||[])[0]||{}).companyUrl;return b?[window.host.nowcoderDomain,"careers",b,a.projectId].join("/"):""}function w(){var a=this,b=a.getParam(),c=a.tableCpn.selectAll;return{projectId:a.projectId,isAll:c.isSelectAll?1:2,ids:c.selectIds,queryWord:b.queryWord}}function x(a){var b=C(a).closest("tr");return C.trim(b.attr("data-id"))}function y(a){var b=this;return E.find(b.listItems,function(b){return E.id(b.id)===a})}function z(){function a(a){var d=a.getEl(),e=d.find("input"),f=L.show({input:e,defaultIndex:-1,target:d,attach:{extOffset:{left:6}},needSame:!0,reqList:function(a,c){b(a,c)},getItemStr:function(a){return I.execTpl('<li class="js-item" data-id="#{id}"><a href="javascript:void(0);">#{name}</a></li>',{id:a._sid,name:a.jobName})},ok:function(a){e.val(a.jobName),c.addParam({queryWord:a.jobName}),c.renderList(!0)}});a.pushChild(f),f.getEl().css("min-width",a.getEl().outerWidth())}function b(a,b){P.listJob({query:{projectId:c.projectId,page:1,pageSize:100,query:a},call:function(a){var c=a.data.data;b&&b(c||[])},error:function(){b&&b([])}})}var c=this,d=c.getParam();return{crumb:[{title:"职位管理",module:"resume",param:{action:"position/project/index"}}],ext:[{input:{value:C.trim(d.queryWord),placeholder:"输入职位名，回车搜索"},listeners:{ok:function(a){c.addParam({queryWord:C.trim(a.val())}),c.renderList(!0)},render:function(){a(this)}}}]}}var A=a("nc"),B=a("cpn"),C=A.$,D=A.Clazz,E=A.Base,F=A.Limit,G=A.Time,H=A.Uri,I=A.Str,J=(A.Dom,A.Component,B.Popup),K=B.Select,L=(B.Pager,B.AttachSuggest),M=(B.Attach,a("../../../../../core/module")),N=a("../../../../../component/table"),O=a("../../../../../component/navProject"),P=a("../../../../../action/position"),Q=a("../../../extend/bll/resume"),R=a("../../../extend/bll/task"),S=a("../../../../../util/switch"),T=a("../cpn/orderList"),U=a("./popupDown"),V=a("./popupCopy"),W=c.exports=D.create();D.mix(W,M,{style:"/stylesheets/styles/system/myJobsList.css",title:"职位展示",showTask:!0,_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(function(){a.initContainer(),a.initOrder(),a.initProjectBar(a.projectList,a.projectId),a.renderList(!0)})}},{name:"click .js-toolbar-action",handler:function(a){var b=this,c=C(a.currentTarget),d=b.tableCpn.selectAll,e=C.trim(c.attr("data-method")),f=C.trim(c.attr("data-batch"));return f&&!d.isSelectAll&&0===d.selectIds.length?J.alert("请先选择职位！"):void(b[e]&&b[e](c))}},{name:"click .js-action",handler:function(a){var b=this,c=C(a.currentTarget),d=C.trim(c.attr("data-method")),e=b.getLineId(c),f=b.getItemById(e);f&&d&&b[d]&&b[d](f,c)}}]},{initData:d,initContainer:e,initOrder:f,initProjectBar:g,navRecruitPage:h,navSetting:i,addPosition:j,copyPosition:k,orderList:l,batchCheck:m,batchDown:n,batchExport:o,checkItem:p,delItem:q,downItem:r,editItem:s,renderList:t,renderTable:u,getRecruitPageUrl:v,getBatchCond:w,getLineId:x,getItemById:y,getCrumbConf:z})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/list/popupCopy",["nc","cpn","../../../../../component/table","../../../../../component/selectAll","../../../../../util/util","../../../../../core/siteConfig","../../../../../action/position","../../../../../util/ajax"],function(a,b,c){function d(a){var b=new w(a);return r.wrap(b,{title:"复制其他项目职位",content:b.html(),width:760,okTxt:"一键复制",ok:function(){return b.submit(),!0},cancel:function(){}}),b}function e(a){var b=this;b.projectId=n.id(a.projectId)}function f(){var a=this,b=a.getEl();b.html(["<div>",'<div class="form-group">','<label class="control-label">招聘项目</label>','<div class="btn-group js-project"></div>',"</div>",'<div class="js-list"></div>',"</div>"].join(""))}function g(a){var b=this,c=b.getEl(),d=b.cpn={},e=b.projectId,f=[];n.forEach(a,function(a){var b=n.id(a.id);b!==e&&f.push({text:a.name,value:b,checked:0===f.length})}),d.project=new s({renderTo:c.find(".js-project"),renderBy:"replaceWith",options:f,change:function(){b.renderList(1,!0)}}),d.project.getEl().css("margin-bottom",0),d.table=new t({renderTo:c.find(".js-list"),needSelect:!0,pageChange:function(a){b.renderList(a)}})}function h(){function a(a,f){u[a?"copyJobCheck":"copyJob"]({body:{projectId:b.projectId,fromProjectId:d.project.val(),isAll:e.isSelectAll?1:2,ids:e.selectIds},call:function(d){f&&f(d.data),a||(b.popup.close(),r.tips("操作成功"),c.call&&c.call())},error:function(a){r.alert(a.msg)}})}var b=this,c=b.rawConfig,d=b.cpn,e=d.table.selectAll;return e.isSelectAll||0!==e.selectIds.length?void a(!0,function(b){var c=+b.existJobNameCount||0;0===c&&a(),c>0&&r.confirm("项目中已经存在"+b.existJobNames+"，无法复制到该项目，是否将其他职位复制到该项目？",a)}):r.alert("请先选择职位！")}function i(a,b){var c=this,d=c.cpn,e=d.table;e.renderWait(),c.popup.fixPosition(),b&&e.selectAll.clear(),u.listJob({query:{projectId:d.project.val(),page:+a||1,pageSize:20},call:function(a){a.isOrder&&c.renderTable(a.data||{})},error:function(a){a.isOrder&&e.renderNone(a.msg)}})}function j(a){var b=this,c=b.cpn.table;if(0===a.totalCount)return c.renderNone("暂无职位");var d={head:[{text:"职位名 "},{text:"所属部门"},{text:"更新时间",width:30}],list:[]};n.forEach(a.data,function(a){var b=[{text:a.jobName,cls:"txt-left"},a.tags,q.form(new Date(a.updateTime))];d.list.push({items:b,attr:{"data-id":n.id(a.id)}})}),c.updateHtml(d,{totalPage:a.totalPage,totalCount:a.totalCount,currentPage:a.currentPage}),b.popup.fixPosition()}function k(a){var b=this;u.listRecruitProject({type:"GET",call:function(b){a&&a(b.data)},error:function(a){v.renderNone({el:b.getEl(),text:a.msg})}})}var l=a("nc"),m=a("cpn"),n=l.Base,o=(l.$,l.Clazz),p=l.Component,q=l.Time,r=m.Popup,s=m.Select,t=a("../../../../../component/table"),u=a("../../../../../action/position"),v=a("../../../../../util/util"),w=c.exports=o.create();o.mix(w,p,{_template:"<div></div>",listeners:[{name:"render",type:"custom",handler:function(){var a=this;v.renderWait(a.getEl()),a.getProject(function(b){a.initContainer(),a.initCpn(b),a.renderList()})}}],show:d},{initialize:e,initContainer:f,initCpn:g,submit:h,renderList:i,renderTable:j,getProject:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/list/popupDown",["nc","cpn"],function(a,b,c){function d(a){var b=new s(a);return q.wrap(b,{title:"下线职位",content:b.html(),width:650,ok:function(){var c="1"===b.getData("cpn-val-down-type");n.isFunction(a.ok)&&a.ok(c)},cancel:function(){}}),b}function e(){var a=this;a.setData("cpn-val-down-type","0")}function f(){var a=this;a.initCheckGroup()}function g(){var a=this,b=["down-type"];n.forEach(b,function(b){var c=r.mix({el:a.getEl(".js-down-type label.radio"),change:function(){a.setData("cpn-val-down-type",this.val())}});a.setData("cpn-"+b,c)})}function h(){var a=this;a.renderCheckGroup()}function i(){var a=this,b=["down-type"];n.forEach(b,function(b){var c=(a.getData("cpn-"+b),a.getData("cpn-val-"+b));a.getData("cpn-"+b).val(c)})}function j(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}function k(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}var l=a("nc"),m=a("cpn"),n=l.Base,o=(l.$,l.Clazz),p=l.Component,q=m.Popup,r=m.CheckGroup,s=c.exports=o.create();o.mix(s,p,{_template:["<div>",'<div class="form-group">','<div class="control-group js-down-type" style="width:100%;margin-top:20px;">','<label class="radio" style="margin-left:14%;"><input type="radio" value="0">职位显示“已结束”且不可投递</label>','<label class="radio" style="margin-left:14%;"><input type="radio" value="1">职位在招聘主页隐藏</label>',"</div>","</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initCpns(),a.initRender()}}],show:d},{initData:e,initCpns:f,initCheckGroup:g,initRender:h,renderCheckGroup:i,setData:j,getData:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/project/index",["nc","cpn","./projectCard","../../../../../action/position","../../../../../util/ajax","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig","../../../../../core/module"],function(a,b,c){function d(){var a=this,b=a.getEl(".js-project-items"),c=a.isClose="1"===j.id(a.getParam().type);a.crumbTitle=c?"已归档项目":"职位管理",a.refreshCrumb(),k.mark(b),o.listRecruitProject({query:{},call:function(b){a.renderList(b.data||[])},error:function(c){a.renderNone(b,c.msg)},always:function(){k.clear(b)}})}function e(a){var b=this,c=b.getEl(".js-project-items"),d=b.isClose,e=0,f=!0;c.html(""),j.forEach(a,function(a){var g=1===a.status;e+=g?1:0,d===g&&(f=!1,new m({renderTo:c,module:b,data:a,listeners:{refresh:function(){b.refresh()}}}))}),d||c.append([p.has(102)?['<div class="p-item js-add-project">','<div class="add-project-box"><i class="ico-plus">+</i><p class="add-project-font">新建招聘项目</p></div>',"</div>"].join(""):"",'<div class="p-item file-item js-close-card">','<div class="file-wrap"><div class="file-content">已归档项目<span class="js-close-count">0</span></div></div>',"</div>"].join("")),c.find(".js-close-count").html(e),f&&d&&b.renderNone(c,"没有已归档的项目")}function f(){var a=this,b={crumb:a.isClose?[{title:"职位管理",module:"resume",param:{action:"position/project/index"}}]:[]};return p.has(101)&&(b.ext=[{html:'<a href="javascript:void(0);" class="link-green" style="font-size:14px;"><i class="icon-cog" style="margin-right:5px;"></i> 设置公司招聘主页</a>',listeners:{click:{handler:function(){a.nav("resume","position/companyPage/index")}}}}]),b}var g=a("nc"),h=a("cpn"),i=(g.$,g.Clazz),j=g.Base,k=g.Limit,l=h.Popup,m=a("./projectCard"),n=a("../../../../../core/module"),o=a("../../../../../action/position"),p=a("../../../../../util/switch"),q=c.exports=i.create();i.mix(q,n,{style:"/stylesheets/styles/system/myJobs.css",title:"职位管理",_template:['<div class="module-box">','<div class="module-body project-items js-project-items"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.renderWait(a.getEl(".js-project-items"),"加载中..."),a.refresh()}},{name:"click .js-add-project",handler:function(){var a=this,b=a.getEl();k.mark(b)||o.getCompany({query:{},call:function(b){var c=b.data;return c?a.nav("resume",{action:"position/editProject/index"}):void l.confirm("你还未设置公司招聘主页，点击确定，设置公司招聘主页;",function(){a.nav("resume",{action:"position/companyPage/index"})})},error:function(a){l.alert(a.msg)},always:function(){k.clear(b)}})}},{name:"click .js-set-page",handler:function(){var a=this;a.nav("resume",{action:"position/companyPage/index"})}},{name:"click .js-close-card",handler:function(){var a=this;a.addParam({type:"1"}),a.refresh()}}]},{refresh:d,renderList:e,getCrumbConf:f})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/position/project/projectCard",["nc","cpn","../../../../../action/position","../../../../../util/ajax","../../../../../util/switch","../../../../../util/util","../../../../../core/siteConfig"],function(a,b,c){function d(){var a=this,b=a.rawConfig.data,c=b.referralTurnOn&&1===b.progress&&1===b.referralProgress||!b.referralTurnOn&&1===b.progress,d=!c&&b.referralTurnOn&&0!==b.progress&&0!==b.referralProgress||!b.referralTurnOn&&2===b.progress;a.getEl().html(k.execTpl(['<div class="p-item-hd">',"#{data.name}",'<div :class="progressCls()" :title="progressTitle()">#{progressTxt()}</div>',"</div>",'<div class="p-item-bd">','<ul class="p-item-info">','<li v-for="item in items" class="clearfix">','<span class="p-item-label"><i :class=itemIcon(item)></i>#{item.name}</span>','<span class="p-item-num">#{item.num}</span>',"</li>","</ul>","</div>",'<div class="p-item-ft clearfix">','<a v-for="(item, index) in btns" v-if="btnShow(index)" href="javascript:void(0);" :title="btnTitle(item, index)" :class="btnCls(item, index)"></a>',"</div>"],{data:b,progressCls:function(){var a="";return c?a="end":d&&(a="nostart"),"js-temp-tips project-status"+(a?" project-status-"+a:"")},progressTitle:function(){return(b.referralTurnOn?"内推时间："+m.form(new Date(b.referralBeginTime))+"--"+m.form(new Date(b.referralEndTime))+"<br>":"")+"网申时间："+m.form(new Date(b.beginTime))+"--"+m.form(new Date(b.endTime))},progressTxt:function(){return c?"已结束":d?"未开始":b.referralTurnOn&&0===b.referralProgress?"内推中":"网申中"},items:[{name:"职位",icon:"suitcase",num:b.jobCount||0},{name:"简历总数",icon:"user",num:b.deliverCount||0},{name:"未处理简历",icon:"time",num:b.notProcessedCount||0}],itemIcon:function(a){return"icon-"+a.icon},btns:[{key:"star"},{key:"edit"},{key:"status"}],btnShow:function(a){return q.has(102)?2===a?!0:!b.status:!1},btnTitle:function(a,c){var d=[{0:"项目置顶",1:"取消置顶"},"设置",{0:"项目归档",1:"取消归档"}][c];return i.isString(d)?d:d[b[a.key]]},btnCls:function(a,c){var d=[{0:"icon-star-empty",1:"icon-star-empty selected"},"p-item-oprt icon-gear",{0:"p-item-oprt icon-inbox",1:"p-item-oprt icon-repeat"}][c];return[i.isString(d)?d:d[b[a.key]],"js-"+a.key,"js-temp-tips"].join(" ")}})),o.titleEl(a.getEl(".js-temp-tips"),function(b){b.getEl().css("max-width",320),a.pushChild(b)})}function e(){var a=this,b=a.getEl(),c=a.data;n.confirm(1===c.status?"该项目已归档，还原后可查看详情。确定撤销归档，还原至正常项目？":"确定归档本项目吗？确定后项目将转移至归档文件夹中，项目中的简历将不再出现在简历库相关操作中",function(){l.mark(b)||p.updateRecruitProjectClose({type:"PUT",params:{id:a.data.id},body:{status:1===c.status?0:1},call:function(){a.fire("refresh")},error:function(a){n.alert(a.msg)},always:function(){l.clear(b)}})})}var f=a("nc"),g=a("cpn"),h=(f.$,f.Clazz),i=f.Base,j=f.Component,k=f.Node,l=f.Limit,m=f.Time,n=g.Popup,o=g.Tips,p=a("../../../../../action/position"),q=a("../../../../../util/switch"),r=c.exports=h.create();h.mix(r,j,{_template:'<div class="p-item"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.data=a.rawConfig.data||{},a.initContent()}},{name:"click.stop .js-star",handler:function(){var a=this,b=a.getEl();if(!l.mark(b)){var c=a.data;p.updateRecruitProjectStar({type:"PUT",params:{id:c.id},body:{star:1===c.star?0:1},call:function(){a.fire("refresh")},error:function(a){n.alert(a.msg)},always:function(){l.clear(b)}})}}},{name:"click.stop .js-status",handler:function(){var a=this;a.close()}},{name:"click.stop .js-edit",handler:function(){var a=this;a.rawConfig.module.nav("resume",{action:"position/editProject/index",id:a.data.id})}},{name:"click",handler:function(){var a=this;return 1===a.rawConfig.data.status?a.close():void a.rawConfig.module.nav("resume",{action:"position/list/index",curProjectId:a.data.id})}}]},{initContent:d,close:e})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/render/dataItem",["nc","./dataMenu"],function(a,b,c){function d(a){var b=this;b.rawConfig=a,b.initData(),b.initDefault(),a.value&&b.updateVal(a.value)}function e(){var a=this,b=a.rawConfig;a.id=n.id(b.id),a.name=b.name,a.canMove=b.canMove!==!1,a.isSelected=b.isSelected!==!1,a.isSystem=!(!b.isSystem&&!p.map[a.id]),a.isBase=a.id===p.ID_BASE,a.isAvatar=a.id===p.ID_AVATAR}function f(){var a=this,b=a.id;a.name=a.name||p.getName(b),a.value=a.value||p.getDefault(b)}function g(a){var b=this,c=b.id;c===p.ID_ATTACH&&(a=n.filter(a,function(a){return a.name&&a.url}));var d=p.getIsMult(c),e=p.getKey(c);d?b.value=(n.isArray(a)?a:a?[a]:[]).slice(0):e.length>0?(a=n.isArray(a)?a[0]:n.isObject(a)?a:null,b.value=n.extend({},b.value,a)):b.value=a;var a=b.value;if(b.isBase){if(a.workTime){var f=b._getYear(a.workTime);a.workYears=0>f?"在校生":0===f?"应届生":f+"年工作经验"}var g=b._getYear(a.birthTime);a.age=0===g?"":g+"岁"}}function h(){var a=this;if(!a.isSystem&&(!a.value||n.isString(a.value)))return[{desc:a.value}];var b=[],c=a.id,d=n.isArray(a.value)?a.value:[a.value];return n.forEach(d,function(d){var e=null,f=p.getKey(c);if(f=0===f.length&&n.isObject(d)?Object.keys(d):f,0===f.length)e={desc:d};else{var e=c===p.ID_ATTACH&&d&&d.url&&d.name?{html:'<a href="'+d.url+'" target="_blank">'+o.encodeHTML(d.name)+"</a>"}:null;if(!e){var g=n.contains(f,"start")&&n.contains(f,"end"),h=(n.contains(f,"description"),[]);n.forEach(f,function(a){if(!({description:1}[a]||g&&{start:1,end:1}[a])){var b={start:1,location:1,edu:1}[a],e=d[a];c===p.ID_EDU&&"rank"===a&&e&&(e="专业排名"+e),h[b?"unshift":"push"](e)}}),g&&h.unshift(a._getDurationStr(d.start,d.end)),e={title:h,desc:d.description}}}e&&b.push(e)}),b}function i(a){a=a||"";var b=0;return/\d{4}\.\d{2}/.test(a)&&(b=+/(\d{4}).\d{2}/.exec(a)[1]||0),0===b?0:(new Date).getFullYear()-b}function j(a){return a+""=="-1"?"至今":a||""}function k(a,b){var c=this;return b=c._getYearDesc(b),a||b?(a||"未知")+" - "+(b||"未知"):""}var l=a("nc"),m=l.Clazz,n=l.Base,o=l.Str,p=a("./dataMenu"),q=c.exports=m.create();n.extend(q.prototype,{initialize:d,initData:e,initDefault:f,updateVal:g,getRenderVal:h,_getYear:i,_getYearDesc:j,_getDurationStr:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/render/dataMenu",["nc"],function(a,b,c){function d(a){var b=this;if(a=a||[],!n.isArray(a)&&(a=n.json(o.decodeHTML(a),[])),!(b._loadedInit&&a.length>0||b._loadDefault&&0===a.length)){var c=a.length,d=b._getSystem();0===c&&(a=n.values(d)),b.items.length=0,n.forEach(a,function(a){var c=n.id(a.id);a=d[c]?d[c]:a,a.id=c,b.items.push(a)}),b.map=n.toMap(b.items,function(a){return{key:a.id,value:a}}),b._loadedInit=b._loadedInit||c>0,b._loadDefault=b._loadedInit||b._loadDefault||0>=c}}function e(a){var b=this,c=b.map[a];return c.name||""}function f(a,b){var c=this,d=c.getInput(a);if(!d||!d.data)return[];var e=[];return n.forEach(d.data,function(a){(!b||!a.empty)&&e.push(a.key)}),e}function g(a){var b=this,c=b.getInput(a);if(!c||!c.data)return"";var d={};return n.forEach(c.data,function(a){d[a.key]=""}),a===b.ID_ATTACH?[]:c.mult?[d]:d}function h(a){var b=this,c=b.getInput(a);return!(!c||!c.mult)}function i(a){var b=this,c=b.map[a];return(c||{}).inputType}function j(a){var b={1:"base",2:"edu",3:"sch",4:"job",5:"want",6:"file",7:"award",8:"skill",9:"self",999:"photo"};return b[a]||""}function k(){var a=this,b=[{id:a.ID_BASE,name:"基本资料",inputType:{data:[{key:"name",name:"姓名"},{key:"gender",name:"性别"},{key:"liveAddress",name:"出生年月"},{key:"eduLevel",name:"最高学历"},{key:"workTime",name:"工作年份"},{key:"birthTime",name:"出生年份"},{key:"phone",name:"手机"},{key:"email",name:"邮箱"}]}},{id:a.ID_EDU,name:"教育经历",inputType:{mult:!0,data:[{key:"school",name:"学校"},{key:"major",name:"专业",empty:!0},{key:"edu",name:"学历"},{key:"rank",name:"专业排名"},{key:"start",name:"在校时间-结束"},{key:"end",name:"在校时间-结束"}]}},{id:a.ID_SCHOOLEXP,name:"校内经历",inputType:{mult:!0,data:[{key:"organization",name:"组织"},{key:"position",name:"职位"},{key:"start",name:"经历时间-开始"},{key:"end",name:"经历时间-结束"},{key:"description",name:"描述"}]}},{id:a.ID_WORKEXP,name:"工作经历",inputType:{mult:!0,data:[{key:"company",name:"公司"},{key:"job",name:"职位"},{key:"start",name:"工作时间-开始"},{key:"end",name:"工作时间-结束"},{key:"description",name:"工作描述"}]}},{id:a.ID_WANT,name:"求职意向",inputType:{mult:!0,data:[{key:"job",name:"期望职位"},{key:"location",name:"期望地点"}]}},{id:a.ID_PROJEXP,name:"项目经历",inputType:{mult:!0,data:[{key:"name",name:"项目"},{key:"position",name:"职位"},{key:"start",name:"项目时间-开始"},{key:"end",name:"项目时间-结束"},{key:"description",name:"项目描述"}]}},{id:a.ID_AWARD,name:"获奖情况",inputType:{mult:!0,data:[{key:"name",name:"所获奖项"},{key:"start",name:"获奖时间"}]}},{id:a.ID_SKILL,name:"个人技能"},{id:a.ID_ASSESS,name:"自我评价"},{id:a.ID_PAPER,name:"论文发表"},{id:a.ID_ATTACH,name:"附件作品",inputType:{mult:!0,data:[{key:"name",name:"附件名称"},{key:"url",name:"附件链接"}]}},{id:a.ID_AVATAR,name:"个人照片"}];return n.toMap(b,function(a){return{key:a.id,value:a}})}var l=a("nc"),m=l.Clazz,n=l.Base,o=l.Str,p=c.exports=m.create();n.extend(p,{ID_BASE:"1",ID_EDU:"2",ID_SCHOOLEXP:"3",ID_WORKEXP:"4",ID_WANT:"5",ID_PROJEXP:"6",ID_AWARD:"7",ID_SKILL:"8",ID_ASSESS:"9",ID_PAPER:"10",ID_ATTACH:"11",ID_AVATAR:"999",items:[],map:{},load:d,getName:e,getKey:f,getDefault:g,getIsMult:h,getInput:i,getIconCls:j,_getSystem:k}),p.load([])});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/render/theme0",["nc","./util","cpn","./dataMenu","./dataItem"],function(a,b,c){function d(a){var b=this;b.isPreview=!0,b.isBuy=!!a.isBuy;var c=b.map={base:[],content:[]};return p.load(a.menus),b.items=o.getData(a.data).items,m.forEach(b.items,function(a){b.renderItem(a)}),['<div class="mod-info" style="word-break:break-word;">','<div class="user-info clearfix js-base">'+c.base.join("")+"</div>",'<div class="mod-items js-content">'+c.content.join("")+"</div>","</div>"].join("")}function e(a){var b=this,c=b.items;a+="";for(var d=0,e=c.length;e>d;d++)if(c[d].id===a&&c[d].isSelected)return c[d]}function f(a){var b=this;if(b.canRenderItem(a)){var c=b.getItemHtml(a);a.isAvatar?b.map.base.unshift(c):a.isBase?b.map.base.push(c):b.map.content.push(c)}}function g(a){return a.isSelected}function h(a){var b=this;return b[a.isAvatar?"getAvatarHtml":a.isBase?"getBaseHtml":"getExtHtml"](a)}function i(a){var b=this;return n.execTpl(['<div class="head-pic js-avatar">','<div style="position:absolute;top:0;left:0;z-index:999;"><div class="js-avatar-hock" style="width:90px;height:90px;"></div></div>','<img alt="头像" src="#{url || //uploadfiles.nowcoder.com/images/20151225/56_1451011385985_4A301072DEC6B6A49050E5B294CD7983}" class="js-avatar-img">',"#{ext}","</div>"].join(""),{url:a.value,ext:b.isPreview?"":'<div class="change-photo"><img src="//uploadfiles.nowcoder.com/images/20151225/56_1451011319770_4A301072DEC6B6A49050E5B294CD7983"></div>'})}function j(a){var b=this,c=a.value,d=b.isPreview;return b.isBuy||(c.phone="手机: *",c.email="邮箱: *"),n.execTpl(['<div data-id="',a.id,'" class="user-brief js-edit">','<p class="user-call">#{name || 姓名未填写}</p>','<p class="user-base">',c.gender?"<span>#{gender}</span>":"",c.age?"<span>#{age}</span>":"",c.liveAddress?"<span>#{liveAddress}</span>":"",c.eduLevel&&c.workYears?"<span>#{eduLevel} | #{workYears}</span>":"",c.eduLevel&&!c.workYears?"<span>#{eduLevel}</span>":"",!c.eduLevel&&c.workYears?"<span>#{workYears}</span>":"","</p>",'<p class="user-contact">',c.phone?"<span>#{phone}</span>":"",c.email?"<span>#{email}</span>":"","</p>","</div>",d?"":'<div class="modify-btn"><a class="link-green js-edit" data-id="'+a.id+'"  href="javascript:void(0);">编辑</a></div>'].join(""),c,!0)}function k(a){var b=this,c=a.getRenderVal(),d=b.isPreview,e=n.execTpl('<dl class="mod-item js-edit" data-id="#{id}"><dt>#{{name}}</dt>',{id:a.id,name:a.name});return m.forEach(c,function(a){e+=n.execTpl('<dd><p>#{title}</p><div class="detail">#{desc}</div></dd>',{title:m.map(a.title,function(a){return a?"<span>"+n.encodeHTML(a)+"</span>":""}).join(""),desc:a.desc?n.encodeHTML(a.desc||"").replace(/\n+/g,"<br />"):a.html||""})}),e+=d?"":'<div class="modify-btn"><a data-id="'+a.id+'"  class="link-green js-edit" href="javascript:void(0);">编辑</a><a data-id="'+a.id+'" class="link-green js-del" href="javascript:void(0);">隐藏</a></div>',e+="</dl>"}var l=a("nc"),m=l.Base,n=l.Str,o=a("./util"),p=a("./dataMenu");c.exports={getAllHtml:d,getItem:e,renderItem:f,canRenderItem:g,getItemHtml:h,getAvatarHtml:i,getBaseHtml:j,getExtHtml:k}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/render/util",["nc","cpn","./dataMenu","./dataItem"],function(a,b,c){function d(a){function b(){return{name:i.trim(f.userName),gender:i.trim(f.gender),liveAddress:i.trim(f.liveAddress&&"未填写所在地区"!==f.liveAddress?f.liveAddress:""),eduLevel:i.trim(f.eduLevel),workTime:i.trim(f.workTime),birthTime:i.trim(f.birthTime),phone:i.trim(f.phone),email:i.trim(f.email)}}function c(){return f.headUrl}var d=this,e=1e4,f=a.resumeInfo||{},g=a.recommandInfo||{};j.isString(f.ext)&&(f.ext=j.json(k.decodeHTML(f.ext),[]));var h=d.getRule(a.rule),n=(d.expand(h.need),l.items),o=j.toMap(n,function(a){return{key:j.id(a.id)}}),p=[],q={};return j.forEach(f.ext,function(a){var d=j.id(a.id);if(e=Math.max(e,(+d||0)+1),!q[d]){var f=!!o[d],g=j.contains(h.need,d),i=j.contains(h.hide,d),k=new m({id:d,name:a.name,value:d===l.ID_BASE?b():d===l.ID_AVATAR?c():a.value,isSystem:f,isNeed:g,isHide:i,isSelected:!(i||f&&a.noSelected&&!g)});p.push(k),q[d]=k}}),j.forEach(n,function(a){var d=j.id(a.id);if(!q[d]){var e=j.contains(h.need,d),f=j.contains(h.hide,d),a=new m({id:d,name:a.name,value:d===l.ID_BASE?b():d===l.ID_AVATAR?c():null,isSystem:!0,isNeed:e,isHide:f,isSelected:!f});p.push(a),q[d]=a}}),j.forEach(h.order,function(a,b){var c=q[a];c&&(d.ensureOrder(p,a,b),c.canMove=!1)}),{id:a.id,seed:e,template:f.templateId||"0",name:f.resumeName||"未命名简历",rule:h,items:p,itemMap:q,isOpenRecommand:!!g.isOpenRecommand,isDefault:!!g.isDefaultDelivery,completeness:+g.completeness||0,hideAction:!!g.hideAction,hideTpl:!!g.hideTpl,hideCreate:!!g.hideCreate,hideResumeList:!!g.hideResumeList,resumes:a.resumes||[]}}function e(a){a=j.extend({},a),a.sort=a.sort!==!1,a.need=j.isArray(a.need)?j.map(a.need,function(a){return k.str(a)}):[l.ID_BASE,l.ID_EDU,[l.ID_SCHOOLEXP,l.ID_WORKEXP,l.ID_PROJEXP]],a.order=j.isArray(a.order)&&a.order.length>0?j.map(a.order,function(a){return k.str(a)}):[l.ID_BASE,l.ID_AVATAR],a.need=j.uniq(a.need),a.order=j.filter(j.uniq(a.order),function(a){return l.map[a]});var b=a.need;if(j.forReverse(b,function(a,c){j.isArray(a)?(j.forReverse(a,function(d,e){if(l.map[d]){if(j.contains(b,d))return b.splice(c,1),j.BREAK}else a.splice(e,1)}),0===a.length&&b.splice(c,1),1===a.length&&(b[c]=a[0])):l.map[a]||b.splice(c,1)}),!a.tips&&a.need){var c=j.map(a.need,function(a){return j.isArray(a)?j.map(a,function(a){return l.getName(a)}).join("/")+"至少一项":l.getName(a)}).join("、");a.tips="<span>一份完整的简历需至少包含"+c+"。</span>"}return a}function f(a,b,c){var d;b=j.id(b),j.forReverse(a,function(c,e){b===c.id&&(d=a[e],a.splice(e,1))}),d&&a.splice(c,0,d)}function g(a){var b=this,c=[];return j.forEach(a,function(a){j.isArray(a)?c=c.concat(b.expand(a)):c.push(j.id(a))}),c}var h=a("nc"),i=(a("cpn"),h.$),j=h.Base,k=h.Str,l=a("./dataMenu"),m=a("./dataItem");c.exports={getData:d,getRule:e,ensureOrder:f,expand:g}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/util/popupCustomCond",["nc","cpn","../../../../action/common","../../../../util/ajax"],function(a,b,c){function d(a){a=a||{};var b=this,c=new t(a);return b.popup=r.wrap(c,{title:a.title||"选择条件",content:c.html(),width:600,cancel:function(){}}),c}function e(){}function f(){var a=this,b=a.rawConfig,c=b.data,d={};q.forEach(c,function(a,b){var c=q.json(a);c&&(d[b]=c)}),a.setData("optionData",d),a.setData("key",b.key)}function g(){var a=this,b=a.getData("optionData"),c="";q.forEach(b,function(b,d){c+=a.getItemHtml(b,d)}),a.getEl(".js-option-home").html(c)}function h(a,b){var c=['<li class="js-option" data-index="',b,'">',"<span>",a.title,"</span>",'<div class="pop-mod-oprt js-action">','<a href="javascript:void(0);" title="删除" class="icon-trash js-del-option"></a>',"</div>","</li>"].join("");return c}function i(a){var b=this,c=n(a.currentTarget),d=c.closest(".js-option"),e=d.attr("data-index"),f=b.getData("optionData"),g=f[e];s.deleteCondition({type:"DELETE",body:{key:b.getData("key"),title:g.title},call:function(){delete f[e],d.remove()},error:function(a){r.alert(a.msg)}})}function j(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function k(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var l=a("nc"),m=a("cpn"),n=l.$,o=l.Component,p=l.Clazz,q=l.Base,r=m.Popup,s=a("../../../../action/common"),t=c.exports=p.create();p.mix(t,o,{_template:['<div class="pop-mod-set">','<ul class="pop-mod-list js-option-home"></ul>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initData(),a.initOption(),a.popup.fixPosition()}},{name:"click .js-del-option",handler:function(a){var b=this;r.confirm("是否删除当前条件？",function(){b.delOption(a)}),a.stopPropagation()}},{name:"click .js-option",handler:function(a){var b=this,c=n(a.currentTarget),d=c.attr("data-index"),e=b.getData("optionData"),f=e[d],g=q.json(f.content)||{};q.isFunction(b.rawConfig.clickOption)&&b.rawConfig.clickOption(g,b.popup)}}],show:d},{initialize:e,initData:f,initOption:g,getItemHtml:h,delOption:i,getData:j,setData:k})});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/util/util",["nc","cpn"],function(a,b,c){function d(a){var b=(a||"").split(/\s+/),c=[];return h.forEach(b,function(a){a=i.trim(a),a&&c.push(a)}),c}function e(a,b){return h.isArray(a)?a.length>0?a:b:h.isString(a)?i.trim(a)||b:a}function f(a){return i.trim(a).replace(/[^\d]+/g,"")}var g=a("nc"),h=(a("cpn"),g.Base),i=g.$;c.exports={split:d,wrapVal:e,wrapNum:f}});
define("company/nowcoder/1.0.740/javascripts/site/main/resume/viewResume/index",["nc","cpn","../render/theme0","../render/util","../render/dataMenu","../render/dataItem","../../../../util/util","../../../../core/siteConfig","../../../../util/switch","../../../../component/popupSub/popupResumeTag","../../../../action/resume","../../../../util/ajax"],function(a,b,c){function d(){}function e(){var a=this;G(document).on("keyup",function(b){return 38===b.keyCode?void(a.hasPreResume()&&a.changeResume("pre")):40===b.keyCode?void(a.hasNextResume()&&a.changeResume("next")):void 0})}function f(){var a=this,b=a.getNavConf(),c=b.toSelectNavIndex||0,d=b.pageSize||20;a.setData("navPageSize",d),a.setData("toSelectNavIndex",c)}function g(){var a=this;a.initNav()}function h(){var a=this,b=a.getNavConf(),c=a.getData("toSelectNavIndex"),d=a.getNavPageNum(c);P.renderWait(a.getEl(".js-nav-home"),"加载中..."),b.getNavData(d,function(b){a.setData("navData",b),a.renderNav(),a.setData("showingNavPageNum",d),a.initResume()},function(b){P.renderWait(a.getEl(".js-nav-main"),b)})}function i(){var a=this,b=a.getData("navData");if(b.data=b.data?b.data:b.datas,!(I.isObject(b)&&I.isArray(b.data)&&b.totalPage&&b.currentPage))return P.renderWait(a.getEl(".js-nav-main"),"数据出现错误"),void a.setData("hasNoNavData",!0);var c=['<ul class="resume-list js-nav-main"></ul>','<div class="js-nav-pager"></div>'].join("");a.getEl(".js-nav-home").html(c)[1===b.data.length?"hide":"show"](),a.renderNavMain(),a.renderNavPager(),a.renderNavSelect()}function j(){var a=this,b=a.getData("navData"),c="";I.forEach(b.data,function(b,d){if(I.isObject(b)){var e=a.getData("toSelectNavIndex"),f=a.getNavPageNum(e),g=a.getNavIndex(d,f),h=a.getItemNavHtml(b,g);c+=h}}),a.getEl(".js-nav-main").html(c)}function k(a,b){var c=I.filter(a.info,function(a){return G.trim(a)}),d=J.execTpl(['<li class="js-nav-item js-nav-index-#{index}" data-index="#{index}">',"<p>","1"===I.id(a.unread)?'<span class="tag-spot-red"></span> ':"",'<span class="rl-name">#{name}</span>',"</p>","<p>#{info}</p>","</li>"].join(""),{index:b,name:a.name||"未命名用户",info:c.join("|")});return d}function l(){var a=this,b=a.getData("navData");new N({renderTo:a.getEl(".js-nav-pager"),renderBy:"html",current:b.currentPage,total:b.totalPage,noExt:!0,interval:3,render:function(){this.getEl().css("margin-bottom","20px")},pageChange:function(b){var c=a.getData("navPageSize"),d=c*(b-1);a.setData("toSelectNavIndex",d),a.initNav()}})}function m(){{var a=this,b=a.getData("toSelectNavIndex"),c=a.getData("selectedNavIndex");a.getData("navData")}a.getEl(".js-nav-index-"+c).removeClass("active"),a.getEl(".js-nav-index-"+b).addClass("active"),a.getEl(".js-nav-index-"+b+" .tag-spot-red").remove(),a.setData("selectedNavIndex",b)}function n(){var a=this;if(!a.getData("hasNoNavData")){var b=a.getResumeConf(),c=a.getData("selectedNavIndex"),d=a.getNavPageIndex(c),e=a.getData("navData"),f=e.data[d]||{};P.renderWait(a.getEl(".js-resume-home"),"加载中..."),b.getResumeData(f,function(b){b=I.isObject(b)?b:{},a.setData("toShowResumeData",b),a.renderResume(),a.setData("showingResumeData",b)},function(b){var c=['<div class="resume-detail-hd js-resume-header">','<div class="resume-detail-title">',"<h2>",b,"</h2>","</div>",'<div class="resume-detail-tool clearfix">',a.hasPreResume()?'<a href="javascript:void(0);" class="icon-angle-left js-change-resume" data-type="pre" style="float:left;"></a>':"",a.hasNextResume()?'<a href="javascript:void(0);" class="icon-angle-right js-change-resume" data-type="next" style="float:right;"></a>':"","</div>","</div>"].join("");a.getEl(".js-resume-home").html(c)})}}function o(){var a=this,b=['<div class="resume-detail-hd js-resume-header"></div>','<div class="resume-detail-bd js-resume-body" style="overflow-y:auto"></div>','<div class="resume-detail-ft js-resume-footer"></div>'].join("");a.getEl(".js-resume-home").html(b),a.renderResumeHeader(),a.renderResumeBody(),a.renderResumeFooter(),a.reHeight()}function p(){function a(){return c.showDeliverJob&&0!==(d.jobDeliverList||[]).length?I.map(d.jobDeliverList,function(a,b){var c='<span class="deliver-position" style="margin-left:'+(0===b?20:h+20)+'px">第'+(b+1)+"志愿："+a.jobName+"；",d=I.map(a.ext,function(a){return a.name+"："+a.value});return c+=d.join("；"),c+=d.length?"；":"",c+="投递时间："+L.form(new Date(a.createTime))}).join("<br>"):""}var b=this,c=b.getResumeConf(),d=b.getData("toShowResumeData"),e="";I.forEach(d.tags,function(a){a=(a||"").trim(),e+=a&&'<a class="tag-label js-edit-tag" href="javascript:void(0);">'+a+"</a>"}),Q.has(123)&&(e+='<a class="tag-label js-edit-tag" href="javascript:void(0);">'+(e?"修改标签":"添加标签")+"</a>");var f=['<div class="resume-detail-title">',"<h2>",'<span class="js-name">',d.name||"未命名简历","</span>",'<span class="js-job-deliver-list"></span>',"</h2>","<div>",e,"</div>","</div>",'<div class="resume-detail-tool clearfix">',b.hasPreResume()?'<a href="javascript:void(0);" class="icon-angle-left js-change-resume" data-type="pre" style="float:left;"></a>':"",b.hasNextResume()?'<a href="javascript:void(0);" class="icon-angle-right js-change-resume" data-type="next" style="float:right;"></a>':"","</div>"].join(""),g=b.getEl(".js-resume-header");g.html(f);var h=g.find(".js-name").width();g.find(".js-job-deliver-list").html(a())}function q(){var a=this,b=a.getData("toShowResumeData"),c=O.getAllHtml({isPreview:!0,menus:b.menus,data:{resumeInfo:b,rule:b.rule},isBuy:!0});a.getEl(".js-resume-body").html(c)}function r(){var a=this,b=a.getResumeConf(),c=a.getData("toShowResumeData"),d=b.getFooterConf(c)||[],e=0,f=[],g='<ul class="menu-txt clearfix">',h='<div class="float-right">';I.forEach(d,function(a){a&&("left"===a.side?g+=['<li><a href="javascript:void(0);" class="js-footer-btn" data-index="',e,'">',a.name,"</a></li>"].join(""):h+=['<a href="javascript:void(0);" class="',a.cls,' js-footer-btn" data-index="',e,'"><i></i>',a.name,"</a>"].join(""),f[e]=a.call,e++)}),g+="</ul>",h+="</div>",a.getEl(".js-resume-footer").html(h+g),a.renderHoverOnSelect()}function s(a){var b=this,c=b.getData("selectedNavIndex"),d="pre"===a?c-1:c+1,e=b.getNavPageNum(d),f=b.getData("showingNavPageNum");return b.setData("toSelectNavIndex",d),e===f?(b.renderNavSelect(),void b.initResume()):void b.initCpns()}function t(){var a=this,b=a.getData("selectedNavIndex");return 0===b?!1:!0}function u(){var a=this,b=a.getData("selectedNavIndex"),c=a.getData("navData");return b===c.totalCount-1?!1:!0}function v(a){var b=this,c=b.getData("navPageSize"),d=Math.ceil((a+1)/c);return d}function w(a,b){var c=this,d=c.getData("navPageSize"),e=(b-1)*d+a;return e}function x(){var a=this,b=a.rawConfig;return b.nav||{}}function y(){var a=this,b=a.rawConfig;return b.resume||{}}function z(){var a=this,b=a.getResumeConf(),c=a.getData("toShowResumeData"),d=a.getEl("a.js-footer-btn");I.forEach(d,function(a){a=G(a);var d=a.attr("data-index"),e=b.getFooterConf(c)[d]||{};e.hoverName&&K.hover(a,function(){a.html(e.hoverName)},function(){a.html(e.name)})})}function A(a){var b=this,c=b.getEl(".js-nav-home"),d=Math.max(200,a||c.parent().height());c.outerHeight(d);{var e=b.getEl(".js-resume-home");Math.max(200,a||e.parent().height())}e.outerHeight(a);var f=e.height()-b.getEl(".js-resume-header").outerHeight()-b.getEl(".js-resume-footer").outerHeight();b.getEl(".js-resume-body").outerHeight(f)}function B(a){var b=this,c=b.getData("navPageSize");return a%c}function C(a){var b=this,c=b.dataHome=b.dataHome||{};return 0===arguments.length?c:c[a]}function D(a,b){var c=this,d=c.dataHome=c.dataHome||{};d[a]=b}var E=a("nc"),F=a("cpn"),G=E.$,H=E.Clazz,I=(E.Db,E.Base),J=(E.Event,E.Limit,E.Str),K=E.Dom,L=E.Time,M=E.Component,N=F.Pager,O=(F.Popup,a("../render/theme0")),P=a("../../../../util/util"),Q=a("../../../../util/switch"),R=a("../../../../component/popupSub/popupResumeTag"),S=c.exports=H.create();H.mix(S,M,{_template:['<div class="manage-box">','<div class="resume-list-wrap js-nav-home" style="overflow-y:scroll;z-index:99;"></div>','<div class="resume-detail-box js-resume-home" style="overflow:hidden;margin-left:0;"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.initEvent(),a.initData(),a.initCpns()}},{name:"click .js-nav-item",handler:function(a){var b=this,c=G(a.currentTarget),d=+c.attr("data-index");b.setData("toSelectNavIndex",d),b.renderNavSelect(),b.initResume()}},{name:"click .js-change-resume",handler:function(a){var b=this,c=G(a.currentTarget),d=c.attr("data-type");b.changeResume(d)}},{name:"click .js-edit-tag",handler:function(){var a=this;if(Q.has(123)){var b=a.getData("showingResumeData"),c=a.rawConfig.module,d=a.getResumeConf().tagTypeConf;R.show({entityId:b.id,entityType:d.entityType,sceneType:d.sceneType,userId:c.getUserId(),isEdit:(b.tags||[]).length>0,ok:function(c){b&&(b.tags=c,a.renderResumeHeader(b))}})}}},{name:"click .js-footer-btn",handler:function(a){var b=this,c=G(a.currentTarget),d=c.attr("data-index"),e=b.getResumeConf(),f=b.getData("showingResumeData"),g=(e.getFooterConf(f)[d]||{}).call;I.isFunction(g)&&g(f)}}]},{initialize:d,initEvent:e,initData:f,initCpns:g,initNav:h,renderNav:i,renderNavMain:j,getItemNavHtml:k,renderNavPager:l,renderNavSelect:m,initResume:n,renderResume:o,renderResumeHeader:p,renderResumeBody:q,renderResumeFooter:r,changeResume:s,hasPreResume:t,hasNextResume:u,getNavPageNum:v,getNavIndex:w,getNavConf:x,getResumeConf:y,renderHoverOnSelect:z,reHeight:A,getNavPageIndex:B,getData:C,setData:D})});
define("company/nowcoder/1.0.740/javascripts/site/main/status/404",["nc","../../../core/module","../../../util/util","../../../core/siteConfig"],function(a,b,c){function d(){}var e=a("nc"),f=(e.$,e.Clazz),g=(e.Base,a("../../../core/module")),h=c.exports=f.create();f.mix(h,g,{title:"404",_template:'<div style="padding:20px;text-align:center;"><img src="//uploadfiles.nowcoder.com/images/20170720/55_1500536587674_BC5795DB2C6FF54B41B645CC261006F2"></div>'},{initialize:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/test/fonticon",["nc","cpn","../../../core/module","../../../util/util","../../../core/siteConfig"],function(a,b,c){function d(){var a=this,b=a.getEl(".js-content"),c=["icon-rotate-180","icon-rotate-270","icon-flip-horizontal","icon-flip-vertical","icon-rotate-90","icon-glass","icon-music","icon-search","icon-envelope-alt","icon-heart","icon-star","icon-star-empty","icon-user","icon-film","icon-th-large","icon-th","icon-th-list","icon-ok","icon-remove","icon-zoom-in","icon-zoom-out","icon-power-off","icon-signal","icon-gear","icon-trash","icon-home","icon-file-alt","icon-time","icon-road","icon-download-alt","icon-download","icon-upload","icon-inbox","icon-play-circle","icon-rotate-right","icon-refresh","icon-list-alt","icon-lock","icon-flag","icon-headphones","icon-volume-off","icon-volume-down","icon-volume-up","icon-qrcode","icon-barcode","icon-tag","icon-tags","icon-book","icon-bookmark","icon-print","icon-camera","icon-font","icon-bold","icon-italic","icon-text-height","icon-text-width","icon-align-left","icon-align-center","icon-align-right","icon-align-justify","icon-list","icon-indent-left","icon-indent-right","icon-facetime-video","icon-picture","icon-pencil","icon-map-marker","icon-adjust","icon-tint","icon-edit","icon-share","icon-check","icon-move","icon-step-backward","icon-fast-backward","icon-backward","icon-play","icon-pause","icon-stop","icon-forward","icon-fast-forward","icon-step-forward","icon-eject","icon-chevron-left","icon-chevron-right","icon-plus-sign","icon-minus-sign","icon-remove-sign","icon-ok-sign","icon-question-sign","icon-info-sign","icon-screenshot","icon-remove-circle","icon-ok-circle","icon-ban-circle","icon-arrow-left","icon-arrow-right","icon-arrow-up","icon-arrow-down","icon-mail-forward","icon-resize-full","icon-resize-small","icon-plus","icon-minus","icon-asterisk","icon-exclamation-sign","icon-gift","icon-leaf","icon-fire","icon-eye-open","icon-eye-close","icon-warning-sign","icon-plane","icon-calendar","icon-random","icon-comment","icon-magnet","icon-chevron-up","icon-chevron-down","icon-retweet","icon-shopping-cart","icon-folder-close","icon-folder-open","icon-resize-vertical","icon-resize-horizontal","icon-bar-chart","icon-twitter-sign","icon-facebook-sign","icon-camera-retro","icon-key","icon-gears","icon-comments","icon-thumbs-up-alt","icon-thumbs-down-alt","icon-star-half","icon-heart-empty","icon-signout","icon-linkedin-sign","icon-pushpin","icon-external-link","icon-signin","icon-trophy","icon-github-sign","icon-upload-alt","icon-lemon","icon-phone","icon-unchecked","icon-bookmark-empty","icon-phone-sign","icon-twitter","icon-facebook","icon-github","icon-unlock","icon-credit-card","icon-rss","icon-hdd","icon-bullhorn","icon-bell","icon-certificate","icon-hand-right","icon-hand-left","icon-hand-up","icon-hand-down","icon-circle-arrow-left","icon-circle-arrow-right","icon-circle-arrow-up","icon-circle-arrow-down","icon-globe","icon-wrench","icon-tasks","icon-filter","icon-briefcase","icon-fullscreen","icon-group","icon-link","icon-cloud","icon-beaker","icon-cut","icon-copy","icon-paperclip","icon-save","icon-sign-blank","icon-reorder","icon-list-ul","icon-list-ol","icon-strikethrough","icon-underline","icon-table","icon-magic","icon-truck","icon-pinterest","icon-pinterest-sign","icon-google-plus-sign","icon-google-plus","icon-money","icon-caret-down","icon-caret-up","icon-caret-left","icon-caret-right","icon-columns","icon-sort","icon-sort-down","icon-sort-up","icon-envelope","icon-linkedin","icon-rotate-left","icon-legal","icon-dashboard","icon-comment-alt","icon-comments-alt","icon-bolt","icon-sitemap","icon-umbrella","icon-paste","icon-lightbulb","icon-exchange","icon-cloud-download","icon-cloud-upload","icon-user-md","icon-stethoscope","icon-suitcase","icon-bell-alt","icon-coffee","icon-food","icon-file-text-alt","icon-building","icon-hospital","icon-ambulance","icon-medkit","icon-fighter-jet","icon-beer","icon-h-sign","icon-plus-sign-alt","icon-double-angle-left","icon-double-angle-right","icon-double-angle-up","icon-double-angle-down","icon-angle-left","icon-angle-right","icon-angle-up","icon-angle-down","icon-desktop","icon-laptop","icon-tablet","icon-mobile-phone","icon-circle-blank","icon-quote-left","icon-quote-right","icon-spinner","icon-circle","icon-mail-reply","icon-github-alt","icon-folder-close-alt","icon-folder-open-alt","icon-expand-alt","icon-collapse-alt","icon-smile","icon-frown","icon-meh","icon-gamepad","icon-keyboard","icon-flag-alt","icon-flag-checkered","icon-terminal","icon-code","icon-reply-all","icon-mail-reply-all","icon-star-half-full","icon-location-arrow","icon-crop","icon-code-fork","icon-unlink","icon-question","icon-info","icon-exclamation","icon-superscript","icon-subscript","icon-eraser","icon-puzzle-piece","icon-microphone","icon-microphone-off","icon-shield","icon-calendar-empty","icon-fire-extinguisher","icon-rocket","icon-maxcdn","icon-chevron-sign-left","icon-chevron-sign-right","icon-chevron-sign-up","icon-chevron-sign-down","icon-html5","icon-css3","icon-anchor","icon-unlock-alt","icon-bullseye","icon-ellipsis-horizontal","icon-ellipsis-vertical","icon-rss-sign","icon-play-sign","icon-ticket","icon-minus-sign-alt","icon-check-minus","icon-level-up","icon-level-down","icon-check-sign","icon-edit-sign","icon-external-link-sign","icon-share-sign","icon-compass","icon-collapse","icon-collapse-top","icon-expand","icon-euro","icon-gbp","icon-dollar","icon-rupee","icon-yen","icon-renminbi","icon-won","icon-bitcoin","icon-file","icon-file-text","icon-sort-by-alphabet","icon-sort-by-alphabet-alt","icon-sort-by-attributes","icon-sort-by-attributes-alt","icon-sort-by-order","icon-sort-by-order-alt","icon-thumbs-up","icon-thumbs-down","icon-youtube-sign","icon-youtube","icon-xing","icon-xing-sign","icon-youtube-play","icon-dropbox","icon-stackexchange","icon-instagram","icon-flickr","icon-adn","icon-bitbucket","icon-bitbucket-sign","icon-tumblr","icon-tumblr-sign","icon-long-arrow-down","icon-long-arrow-up","icon-long-arrow-left","icon-long-arrow-right","icon-apple","icon-windows","icon-android","icon-linux","icon-dribbble","icon-skype","icon-foursquare","icon-trello","icon-female","icon-male","icon-gittip","icon-sun","icon-moon","icon-archive","icon-bug","icon-vk","icon-weibo","icon-renren"],d=c.map(function(a){return'<div style="margin:10px;display:inline-block;width:180px;"><i class="'+a+'"></i> '+a+"</div>"}).join("");b.html('<div style="font-size:14px;">'+d+"</div>")}var e=a("nc"),f=(a("cpn"),e.$,e.Clazz),g=(e.Base,e.Str,a("../../../core/module")),h=c.exports=f.create();f.mix(h,g,{title:"字体图标展示",_template:['<div class="module-box">','<div class="module-body js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this;a.getEl()}a.renderIcon()}}]},{renderIcon:d})});
define("company/nowcoder/1.0.740/javascripts/site/main/test/index",["nc","cpn","../../../core/module","../../../util/util","../../../core/siteConfig"],function(a,b,c){function d(){var b=this,c=b.createDv();a.async("../../../util/uploadOss",function(a){var b=l('<a href="javascript:void(0);">点击上传</a>');c.append(b),o.show({target:b,url:r.getUploadUrl(q.uploadType.file),getUpload:function(b){return a.getAttachUpload({context:this,file:b,type:"ali"})},fileType:"*.jpg",getFileTypeTips:function(){return'文件类型不正确，支持的类型：zip  ，建议使用<a href="https://sparanoid.com/lab/7z/" class="link-green" target="_blank">7-Zip</a>压缩成zip格式'},call:function(a){c.append("<div>done:<br/>"+JSON.stringify(a)+"</div>")},error:function(a){c.append("<div>error:<br />"+JSON.stringify(a)+"</div>")}})})}function e(){var b=this;b.createBtn({text:"点击显示消息模板弹窗",click:function(){a.async("../../../component/popupSub/tpl/popupTplList",function(a){a.show({reqType:"1005",isMsg:!1,isOversea:!1,isInterviewer:!1})})}})}function f(){var b=this;b.createBtn({text:"点击显示历史面试记录",click:function(){a.async("../../../component/popupSub/popupIvDeliver",function(a){a.show({projectId:13,deliverId:0xf924528f604,tab:"1"})})}})}function g(){var a=this;a.createBtn({text:"点击显示数学公式",click:function(){n.show({})}})}function h(){var a=this,b=l('<div style="padding-bottom:20px;"></div>');return a.contentEl.append(b),b}function i(a){var b=this,c=b.createDv(),d=l('<a href="javascript:void(0);">'+a.text+"</a>");c.append(d),d.on("click",function(){a.click&&a.click(d,c)})}var j=a("nc"),k=a("cpn"),l=j.$,m=j.Clazz,n=(j.Base,j.Str,k.PopupFormula),o=k.AttachUpload,p=a("../../../core/module"),q=a("../../../core/siteConfig"),r=a("../../../util/util"),s=c.exports=m.create();m.mix(s,p,{title:"测试",_template:['<div class="module-box">','<div class="module-body js-content"></div>',"</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.contentEl=a.getEl(".js-content"),a.initUpload()}}]},{initUpload:d,initTplList:e,initPopupIvDeliver:f,initFormula:g,createDv:h,createBtn:i})});
define("company/nowcoder/1.0.740/javascripts/site/main/test/san",["nc","cpn","../../../core/moduleSan","../../../util/util","../../../core/siteConfig"],function(a,b,c){{var d=a("nc"),e=(a("cpn"),d.$,d.Clazz,d.Base,d.Str,a("../../../core/moduleSan"));c.exports=e.defineComponent({title:"测试San模块",template:"<div>{{name}}</div>"},{initData:function(){return{name:""}},attached:function(){var a=this;a.data.set("name",(new Date).getTime())}})}});